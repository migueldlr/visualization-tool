{"version":3,"sources":["serviceWorker.js","algo/Algorithm.js","algo/AVL.js","algo/ArrayList.js","algo/util/GraphUtil.js","algo/Graph.js","algo/BFS.js","algo/BST.js","algo/BTree.js","algo/BoyerMoore.js","algo/BruteForce.js","algo/BubbleSort.js","algo/Hash.js","algo/ClosedHash.js","algo/CocktailSort.js","algo/DFS.js","algo/DPLCS.js","algo/DequeArray.js","algo/DequeLL.js","algo/DijkstraPrim.js","algo/DoublyLinkedList.js","algo/Floyd.js","algo/Heap.js","algo/InsertionSort.js","algo/KMP.js","algo/Kruskal.js","algo/LSDRadix.js","algo/LinkedList.js","algo/MergeSort.js","algo/OpenHash.js","algo/QueueArray.js","algo/QueueLL.js","algo/QuickSelect.js","algo/QuickSort.js","algo/RabinKarp.js","algo/SelectionSort.js","algo/SinglyCircularlyLinkedList.js","algo/SkipList.js","algo/SplayTree.js","AlgorithmList.js","algo/StackArray.js","algo/StackLL.js","examples/ExampleModals.js","anim/SingleAnimation.js","anim/UndoFunctions.js","anim/CustomEvents.js","anim/AnimatedObject.js","anim/AnimatedBTreeNode.js","anim/AnimatedCircle.js","anim/AnimatedCircularlyLinkedList.js","anim/AnimatedDoublyLinkedList.js","anim/AnimatedLabel.js","anim/AnimatedLinkedList.js","anim/AnimatedRectangle.js","anim/AnimatedSkipList.js","anim/HighlightCircle.js","anim/Line.js","anim/ObjectManager.js","anim/AnimationMain.js","screens/AlgoScreen.js","screens/AboutContent.js","screens/Home.js","App.js","index.js"],"names":["Boolean","window","location","hostname","match","addLabelToAlgorithmBar","labelName","group","element","document","createTextNode","appendChild","tableEntry","createElement","getElementById","addCheckboxToAlgorithmBar","boxLabel","checked","setAttribute","label","span","addRadioButtonGroupToAlgorithmBar","buttonNames","groupName","buttonList","newTable","i","length","midLevel","bottomLevel","button","txtNode","push","topLevelTableEntry","addControlToAlgorithmBar","type","value","addGroupToAlgorithmBar","horizontal","parentGroup","Algorithm","am","w","h","this","animationManager","addListener","disableUI","enableUI","undo","canvasWidth","canvasHeight","actionHistory","recordAnimation","commands","code","start_x","start_y","line_height","standard_color","layer","j","codeID","Array","nextIndex","cmd","newAlpha","command","arguments","String","pop","reset","len","funct","val","nxt","retVal","StartNewAnimation","input","maxLen","test","substr","field","maxsize","intOnly","undefined","size","event","keyASCII","keyCode","which","controlKey","newWidth","newHeight","Error","prototype","returnSubmitFloat","indexOf","addReturnSubmit","action","onkeydown","returnSubmit","AVL","first_print_pos_y","PRINT_VERTICAL_GAP","print_max","startingX","addControls","edges","EXPLANITORY_TEXT_X","EXPLANITORY_TEXT_Y","skipForward","clearHistory","controls","insertField","insertCallback","bind","insertButton","onclick","deleteField","deleteCallback","deleteButton","findField","findCallback","findButton","printButton","printCallback","clearButton","clearCallback","predSuccButtonList","predButton","succButton","predSucc","treeRoot","insertedValue","normalizeNumber","implementAction","_","add","deletedValue","remove","findValue","findElement","printTree","clear","highlightID","firstLabel","HIGHLIGHT_COLOR","x","y","xPosOfNextLabel","FIRST_PRINT_POS_X","yPosOfNextLabel","printTreeRec","tree","left","nextLabelID","data","PRINT_COLOR","PRINT_HORIZONTAL_GAP","right","doFind","graphicID","curr","LINK_COLOR","remakeTree","addH","resizeTree","treeNodeID","heightLabelID","bfLabelID","STARTING_Y","FOREGROUND_COLOR","BACKGROUND_COLOR","HEIGHT_LABEL_COLOR","AVLNode","parent","connectSmart","balance","id1","id2","some","e","updateHeightAndBF","height","bf","HIGHLIGHT_LABEL_COLOR","singleRotateRight","singleRotateLeft","B","A","t2","isLeftChild","Math","max","getHeight","removeH","deleteNode","dummy","removeSucc","removePred","startingPoint","resizeWidths","leftWidth","rightWidth","setNewPositions","animateNewPositions","xPosition","yPosition","side","heightLabelX","bfLabelX","heightLabelY","bfLabelY","HEIGHT_DELTA","WIDTH_DELTA","recClear","disabled","id","hid","bfid","initialX","initialY","node","l","r","HIGHLIGHT_LINK_COLOR","HIGHLIGHT_CIRCLE_COLOR","ArrayList","setup","addValueField","addIndexCallback","addIndexField","addIndexButton","addFrontButton","addFrontCallback","addBackButton","addBackCallback","removeField","removeIndexCallback","removeIndexButton","removeFrontButton","removeFrontCallback","removeBackButton","removeBackCallback","arrayData","arrayID","arrayLabelID","xpos","ypos","floor","highlight1ID","highlight2ID","addVal","index","clearAll","params","elemToAdd","parseInt","split","labPushID","labPushValID","presentID","labPopValID","LARGE_ALLOWED","LARGE_CURVE","LARGE_X_POS_LOGICAL","LARGE_Y_POS_LOGICAL","SMALL_ALLLOWED","SMALL_CURVE","SMALL_X_POS_LOGICAL","SMALL_Y_POS_LOGICAL","Graph","dir","dag","currentLayer","isDAG","directed","setup_small","addDirection","newGraphButton","newGraphCallback","radioButtonList","directedGraphButton","directedGraphCallback","undirectedGraphButton","smallGraphButton","smallGraphCallback","largeGraphButton","largeGraphCallback","logicalButton","graphRepChangedCallback","adjacencyListButton","adjacencyMatrixButton","newDirected","resetAll","setup_large","newLayer","setAllLayers","adj_matrix","setEdgeColor","highlightVal","adj_list_edges","adj_matrixID","circleID","color","clearEdges","buildEdges","edgeLabel","showEdgeCosts","adjustCurveForDirectedEdges","curve","allowed","x_pos_logical","y_pos_logical","adj_matrix_x_start","adj_matrix_y_start","adj_matrix_width","adj_matrix_height","adj_list_x_start","adj_list_y_start","adj_list_elem_width","adj_list_elem_height","adj_list_height","adj_list_width","adj_list_spacing","bidirectional","abs","fromCharCode","edgePercent","random","buildAdjList","buildAdjMatrix","adj_matrix_index_x","adj_matrix_index_y","lab","adj_list_list","adj_list_index","lastElem","nextXPos","hasEdges","BFS","startField","startCallback","startButton","messageID","visitedID","visitedIndexID","parentID","parentIndexID","VISITED_START_X","PARENT_START_X","AUX_ARRAY_START_Y","QUEUE_START_Y","highlightCircleL","highlightCircleAL","highlightCircleAM","startvalue","toUpperCase","charCodeAt","doBFS","startVetex","visited","queue","head","tail","queueID","queueSize","rebuildEdges","vertex","neighbor","highlightEdge","nextQueueIndex","BST","insertElement","deleteElement","BSTNode","insertElem","insert","elem","foundDuplicate","treeDelete","valueToDelete","leftchild","tmp","labelID","MESSAGE_X","MESSAGE_Y","BTree","starting_x","preemptiveSplit","max_keys","min_keys","split_index","max_degree","moveLabel1ID","moveLabel2ID","ignoreInputs","newMaxDegree","changeDegree","clearTree","premptiveSplitBox","changePreemtiveSplit","newValue","isLeaf","numKeys","keys","getLabelX","children","deleteTree","degree","newDegree","maxDegreeRadioButtons","findInTree","BTreeNode","insertNotFull","insertValue","insertIndex","findIndex","newTree","insertRepair","newNode","rightNode","currentParent","parentIndex","risingNode","leftNode","doDeleteNotEmpty","doDelete","nextNode","stealFromLeft","mergeRight","stealFromRight","maxNode","minNode","repairAfterDelete","parentNode","rightSib","fromParentIndex","tmpLabel1","tmpLabel2","leftSib","WIDTH_PER_ELEM","leftEdge","width","priorWidth","widths","treeWidth","BoyerMoore","textField","patternField","textRowID","comparisonMatrixID","patternTableLableID","patternTableCharacterID","patternTableIndexID","lastTableLabelID","lastTableCharacterID","lastTableValueID","text","pattern","find","cellSize","charAt","row","col","lastTable","buildLastTable","iPointerID","jPointerID","k","shift","textLength","labelsX","patternTableStartX","characters","character","BruteForce","lastSwapEnabled","BubbleSort","listField","sortCallback","lastSwapCheckbox","toggleLastSwap","displayData","list","sort","map","Number","filter","slice","elemCounts","Map","letterMap","count","has","get","set","toString","currChar","ARRAY_START_X","sorted","end","lastSwapped","movePointers","swap","iXPos","jXPos","iLabelID","jLabelID","temp","Hash","hashingIntegers","hashIntegerButton","changeHashTypeCallback","hashStringButton","newHashingIntegers","changeHashType","newHashingIntegerValue","labelID1","labelID2","table_size","currHash","HASH_LABEL_X","indexXPos","indexYPos","label1","wordToHashID","wordToHash","digits","hashValue","nextByte","nextByteID","resultDigits","floatingDigits","floatingVals","operatorID","barID","nextChar","carry","HASH_NUMBER_START_X","label2","HASH_NUMBER_START_Y","ARRAY_ELEM_WIDTH","ClosedHash","elements_per_row","linearProblingButton","linearProbeCallback","quadraticProbingButton","quadraticProbeCallback","doubleHashingButton","doubleHashingCallback","currentHashingTypeButtonState","newProbingType","skipDist","changeProbeType","ExplainLabel","doHash","getEmptyIndex","labID","hashTableVisual","hashTableValues","empty","deleted","skipVal","resetSkipDist","foundIndex","candidateIndex","getElemIndex","hashTableIndices","nextID","nextYPos","resetIndex","CocktailSort","start","DFS","doDFS","startVertex","messageY","dfsVisit","messageX","nextMessage","DPLCS","CODE_START_X","CODE_START_Y","CODE_LINE_HEIGHT","CODE_STANDARD_COLOR","initialIndex","oldIDs","S1Field","emptyCallback","MAX_SEQUENCE_LENGTH","S2Field","recursiveButton","recursiveCallback","tableButton","tableCallback","memoizedButton","memoizedCallback","S1","S2","tableID","tableVals","tableXPos","tableYPos","S1TableID","TABLE_START_X","TABLE_ELEM_WIDTH","TABLE_START_Y","TABLE_ELEM_HEIGHT","S2TableID","helpMessage","recursiveLCS","tableLCS","memoizedLCS","clearOldIDs","RECURSIVE_START_X","RECURSIVE_START_Y","sequences","currentY","functionCallID","final","LCS","xPos","ID","ID2","substring","CODE_HIGHLIGHT_COLOR","RECURSIVE_DELTA_Y","subProb","RECURSIVE_DELTA_X","firstID","secondID","subProb1","subProb2","best","currX","currY","sequence","header","SEQUENCE_START_X","SEQUENCE_START_Y","nextSequenceID","SEQUENCE_DELTA_X","buildTable","moveID","buildLCSFromTable","movingLabel","LCSMem","TABLE_DIFF_X","TABLE_INDEX_COLOR","CODE_RECURSIVE_1_COLOR","CODE_RECURSIVE_2_COLOR","MAX_VALUE","MESSAGE_ID","DequeArray","addField","addFirstButton","addLastButton","addFirstCallBack","addLastCallback","removeFirstButton","removeFirstCallback","removeLastButton","removeLastCallback","frontID","frontLabelID","sizeID","sizeLabelID","front","leftoverLabelID","top","pushVal","addLast","removeFirst","removeLast","addFirst","elemToaddLast","labaddLastID","labaddLastValID","addIndex","labelAddID","QUEUE_LABEL_X","labremoveFirstID","labremoveFirstValID","removeFirstdVal","adjustIfEmpty","remLabelID","remLabelValID","remIndex","removedVal","DequeLL","linkedListElemID","resetNodePositions","labPopID","nodePosX","LINKED_LIST_START_Y","nextX","nextY","DijkstraPrim","runningDijkstra","message1ID","vertexID","knownID","distanceID","pathID","known","distance","path","comparisonMessageID","bestIndex","recolorGraph","current","findCheapestUnknown","distString","compare","createPaths","highlightTree","pathList","nextInPath","doDijkstraPrim","Dijkstra","Prim","DoublyLinkedList","Floyd","costTable","pathTable","alwaysUseINF","cost_table_width","SMALL_COST_TABLE_WIDTH","cost_table_height","SMALL_COST_TABLE_HEIGHT","cost_table_start_x","SMALL_COST_TABLE_START_X","cost_table_start_y","SMALL_COST_TABLE_START_Y","path_table_width","SMALL_PATH_TABLE_WIDTH","path_table_height","SMALL_PATH_TABLE_HEIGHT","path_table_start_x","SMALL_PATH_TABLE_START_X","path_table_start_y","SMALL_PATH_TABLE_START_Y","node_1_x_pos","SMALL_NODE_1_X_POS","node_1_y_pos","SMALL_NODE_1_Y_POS","node_2_x_pos","SMALL_NODE_2_X_POS","node_2_y_pos","SMALL_NODE_2_Y_POS","node_3_x_pos","SMALL_NODE_3_X_POS","node_3_y_pos","SMALL_NODE_3_Y_POS","message_x","SMALL_MESSAGE_X","message_y","SMALL_MESSAGE_Y","LARGE_COST_TABLE_WIDTH","LARGE_COST_TABLE_HEIGHT","LARGE_COST_TABLE_START_X","LARGE_COST_TABLE_START_Y","LARGE_PATH_TABLE_WIDTH","LARGE_PATH_TABLE_HEIGHT","LARGE_PATH_TABLE_START_X","LARGE_PATH_TABLE_START_Y","LARGE_NODE_1_X_POS","LARGE_NODE_1_Y_POS","LARGE_NODE_2_X_POS","LARGE_NODE_2_Y_POS","LARGE_NODE_3_X_POS","LARGE_NODE_3_Y_POS","LARGE_MESSAGE_X","LARGE_MESSAGE_Y","costTableID","pathTableID","pathIndexXID","pathIndexYID","costIndexXID","costIndexYID","node1ID","node2ID","node3ID","costTableHeader","pathTableHeader","getCostLabel","doFloydWarshall","oldIndex","Heap","HeapXPositions","HeapYPositions","createArray","removeSmallestButton","removeSmallestCallback","clearHeapButton","buildHeapButton","buildHeapCallback","arrayLabels","arrayRects","circleObjs","ArrayXPositions","currentHeapSize","swapLabel1","swapLabel2","swapLabel3","swapLabel4","descriptLabel1","descriptLabel2","removeSmallest","index1","index2","smallestIndex","setIndexHighlight","pushDown","buildHeap","ARRAY_SIZE","nextElem","currentIndex","InsertionSort","KMP","failureTableLabelID","failureTableCharacterID","failureTableValueID","failureTable","buildFailureTable","nextAlignment","labelX","tableStartX","Kruskal","setID","setIndexID","setData","SET_ARRAY_ELEM_WIDTH","SET_ARRAY_ELEM_HEIGHT","SET_ARRAY_START_X","SET_ARRAY_START_Y","doKruskal","valueToFind","highlightCircleID","edgesListLeftID","edgesListRightID","edgesListLeft","edgesListRight","EDGE_LIST_START_X","EDGE_LIST_MAX_PER_COLUMN","EDGE_LIST_COLUMN_WIDTH","EDGE_LIST_START_Y","EDGE_LIST_ELEM_HEIGHT","EDGE_LIST_ELEM_WIDTH","tmpLeftID","tmpRightID","tmpLeft","tmpRight","edgeCount","findLabelLeft","findLabelRight","highlightCircle1","highlightCircle2","moveLabelID","messageLabelID","edgesAdded","nextListIndex","FIND_LABEL_1_X","FIND_LABEL_1_Y","FIND_LABEL_2_X","FIND_LABEL_2_Y","HIGHLIGHT_CIRCLE_COLOR_1","disjointSetFind","HIGHLIGHT_CIRCLE_COLOR_2","MESSAGE_LABEL_X","MESSAGE_LABEL_Y","LSDRadix","arrayDisplay","bucketsData","bucketsID","bucketsDisplay","infoLabelID","greatest","log10","longData","display","digit","nthDigit","idBucket","dataBucket","displayBucket","nodeID","splice","BUCKETS_START_Y","pow","LinkedList","MergeSort","kPointerID","mid","ceil","leftHelper","rightHelper","merge","offset","prevOffset","tempArrayID","drawArrayAndCopy","extraOffset","yPos","copyData","currOffset","leftOffset","rightOffset","currArrayID","tempArray","tempDisplay","bottomYPos","kXPos","topYPos","movePointer","fromIndex","toIndex","fromOffset","toOffset","fromRow","toRow","cellID","pointerID","fromXPos","fromYPos","toXPos","toYPos","POINTER_ARRAY_ELEM_WIDTH","OpenHash","POINTER_ARRAY_ELEM_Y","LinkedListNode","found","compareIndex","next","repositionList","startX","startY","tmpPrev","QueueArray","enqueueField","enqueueCallback","enqueueButton","dequeueButton","dequeueCallback","headID","headLabelID","tailID","tailLabelID","enqueue","dequeue","elemToEnqueue","labEnqueueID","labEnqueueValID","labDequeueID","labDequeueValID","dequeuedVal","LINKED_LIST_ELEM_HEIGHT","QueueLL","tail_pos_y","tail_label_y","elemToPush","resetLinkedListPositions","worstPivotEnabled","firstPivotEnabled","QuickSelect","runCallback","kField","togglesGroup","worstPivotToggle","toggleWorstPivot","firstPivotToggle","toggleFirstPivot","pPointerID","listStr","run","helper","pivot","min","pXPos","swapPivot","other","moveJ","lLabelID","lXPos","pLabelID","QuickSort","RabinKarp","baseLabelID","characterValuesLabelID","textHashLabelID","textHashCalculationID","patternHashLabelID","patternHashCalculationID","replace","toLowerCase","textCalculation","textHash","patternCalculation","patternHash","calculationsX","SelectionSort","smallest","CircularlySinglyLinkedList","labCopiedValID","copiedData","firstNodeID","lastX","lastY","LINKED_LIST_START_X","secondNodeY","removedNodeIndex","SkipList","addRandomlyCallback","headsField","addWithHeadsCallback","addWithHeadsButton","addRandomlyButton","removeCallback","removeButton","getField","getCallback","getButton","NEGATIVE_INFINITY","POSITIVE_INFINITY","SKIP_LIST_START_X","heads","valueLabelId","valueStringId","cfLabelId","cfStringId","headsString","rightPhantomsCol","newCol","nextCol","getNextCol","shiftColumns","prevCol","getPrevCol","removedCol","maxHeight","leftPhantomID","rightPhantomID","SplayTree","splay","zigZigRight","doubleRotateRight","zigZigLeft","doubleRotateLeft","treeRot","splayUp","inTree","oldGraphicID","largestLeft","findMax","C","t3","AlgorithmList","SinglyCircularlyLinkedList","StackArray","pushField","pushCallback","pushButton","popButton","popCallback","topID","topLabelID","clearData","StackLL","isAlgorithm","name","Object","includes","modals","className","style","marginTop","SingleAnimation","fromX","fromY","toX","toY","objectID","UndoBlock","animationList","world","UndoMove","fmX","fmy","tx","ty","nextAnim","UndoCreate","removeObject","UndoHighlight","highlightValue","setHighlight","UndoSetHeight","setHeight","UndoSetWidth","setWidth","UndoSetNumElements","obj","newNumElems","sizeBeforeChange","getNumElements","sizeAfterChange","labels","colors","getText","getTextColor","setNumElements","setText","setTextColor","UndoSetAlpha","alph","alphaVal","setAlpha","UndoSetNull","nv","nullVal","setNull","UndoSetPrevNull","SetPrevNull","UndoSetNextNull","SetNextNull","UndoSetForegroundColor","setForegroundColor","UndoSetBackgroundColor","setBackgroundColor","UndoSetHighlightIndex","setHighlightIndex","UndoSetText","str","newText","labelIndex","UndoSetTextColor","UndoHighlightEdge","from","to","fromID","toID","setEdgeHighlight","UndoSetEdgeColor","oldColor","UndoSetEdgeAlpha","oldAplha","alpha","setEdgeAlpha","UndoSetPosition","setNodePosition","EventListener","events","kind","scope","func","scopeFunctions","functions","objects","functs","call","AnimatedObject","backgroundColor","foregroundColor","highlighted","addedToScene","labelColor","minHeightDiff","range","highlightIndex","highlightIndexDirty","alwaysOnTop","newColor","highlightColor","otherObject","getWidth","centerY","centerX","bottom","xDelta","yDelta","frameNum","frameMod","delta","highlightDiff","anchorPoint","textIndex","hlIndex","AnimatedBTreeNode","widthPerElem","numElems","fillColor","edgeColor","widthPerElement","nodeHeight","numLabels","labelColors","MIN_WIDTH","EDGE_POINTER_DISPLACEMENT","newNumElements","context","isNaN","strokeStyle","fillStyle","beginPath","moveTo","lineTo","closePath","stroke","fill","textAlign","textBaseline","labelx","labely","fillText","anchor","UndoDeleteBTreeNode","numLab","labelText","wPerElement","nHeight","lColors","bgColor","fgColor","posX","posY","addBTreeNode","setLayer","AnimatedCircle","objectLabel","radius","thickness","getHeadPointerAttachPos","xVec","yVec","sqrt","ctx","globalAlpha","arc","PI","lineWidth","font","strList","measureText","centerWidth","textWidth","startingXForHighlight","leftStr","highlightStr","rightStr","UndoDeleteCircle","nodeLabel","addCircleObject","AnimatedCircularlyLinkedList","wth","hgt","linkPer","linkPercent","labelPosX","labelPosY","nullPointer","currentHeightDif","maxHeightDiff","np","getClosestCardinalPoint","wdth","resetTextPosition","hght","UndoDeleteLinkedList","linkPositionEnd","vertical","numlab","linkper","labColors","addLinkedListObject","AnimatedDoublyLinkedList","prevNullPointer","nextNullPointer","closest","UndoDeleteDoublyLinkedList","lnp","rnp","addDoublyLinkedListObject","setPrevNull","setNextNull","AnimatedLabel","center","initialWidth","centering","strokeText","UndoDeleteLabel","centered","hli","labCentered","dirty","addLabelObject","AnimatedLinkedList","verticalOrientation","linkPosEnd","posEnd","vert","verticalOrentation","linkAtEnd","AnimatedRectangle","xJust","yJust","xJustify","yJustify","UndoDeleteRectangle","highlight","lay","addRectangleObject","AnimatedSkipList","UndoDeleteSkipList","addSkipListObject","HighlightCircle","UndoDeleteHighlightCircle","circleColor","addHighlightCircleObject","Line","n1","n2","cv","d","weight","anchorIndex","arrowHeight","arrowWidth","Node1","Node2","Dirty","LINE_maxHeightDiff","n","UndoConnect","pensize","fromPos","getTailPointerAttachPos","toPos","deltaX","deltaY","midX","midY","controlX","controlY","quadraticCurveTo","midLen","sign","drawArrow","createConnection","isDirected","anch","connect","connectEdge","disconnect","ObjectManager","canvasRef","Nodes","Edges","BackEdges","activeLayers","getContext","framenum","statusReport","clearRect","draw","pulseHighlight","shown","layers","resetLayers","objectColor","oldAlpha","getAlpha","nextEdge","getHighlight","getHighlightIndex","objectIDfrom","objectIDto","createUndoDisconnect","undoStack","identifier","len2","ObjectID","OldObject","getTextWidth","connectionPoint","fromObj","toObj","getNull","getLeftNull","getRightNull","setColor","alignTop","alignLeft","alignRight","getAlignRightPos","getAlignLeftPos","alignBottom","oldHighlight","newLabel","newX","newY","swapped","reorderSibling","node1","node2","replaceChild","insertBefore","swapControlDiv","setCookie","getCookie","cookieName","cookies","cookie","unescape","expireDays","exdate","Date","setDate","getDate","ANIMATION_SPEED_DEFAULT","addControlToAnimationBar","animBarRef","callback","AnimationManager","objectManager","animatedObjects","animationPaused","awaitingStep","currentlyAnimating","AnimationSteps","currentAnimation","previousAnimationSteps","currFrame","animationBlockLength","currentBlock","doingUndo","undoAnimationStepIndices","undoAnimationStepIndicesStack","paused","canvas","skipBackButton","skipBack","stepBackButton","stepBack","playPauseBackButton","doPlayPause","stepForwardButton","step","skipForwardButton","speed","slider","Slider","defaultValue","onChange","setSpeed","controlBar","ReactDOM","render","align","swappedControls","widthEntry","changeSize","heightEntry","sizeButton","swapButton","animStarted","animEnded","animWaiting","anumUndoUnavailable","percent","pausedValue","newSpeed","uppercase","clr","fireEvent","undoBlock","stopTimer","update","foundBreak","anyAnimations","nextCommand","parseColor","parseFloat","parseBool","getNodeX","getNodeY","otherId","newXY","newHighlight","undoConnect","oldText","removedEdges","deleteIncident","concat","getObject","createUndoDelete","oldAplpha","oldHeight","addCircularlyLinkedListObject","oldNull","oldWidth","oldElem","oldX","oldY","startNextBlock","startTimer","undoLastBlock","keepUndoing","finishUndoBlock","clearAllObjects","runFast","undoInitialStep","animateNext","addUndoAnimation","lerp","timer","setTimeout","timeout","setPaused","clearInterval","AlgoScreen","props","React","createRef","algoName","pathname","state","examplesEnabled","setState","animManag","currentAlg","onClick","toggleExamples","ref","Component","AboutContent","href","Home","buttons","entries","idx","disp","key","exact","App","basename","process","component","navigator","serviceWorker","ready","then","registration","unregister"],"mappings":"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Y,IACrBA,EAAY,GACZvsC,SAASusC,EAAY,IACrBvsC,SAASusC,EAAY,IACrB,IACA,EACA,UACA,WAGEA,EAAY96C,OAAS,IACxBiB,KAAKs2C,gBAAgBnR,gBACpB73B,SAASusC,EAAY,IACrBvsC,SAASusC,EAAY,IACrBvsC,SAASusC,EAAY,KAEtBL,EAAUp6C,KAAK,IAAIqiC,GAAWn0B,SAASusC,EAAY,YAE9C,GAAqC,+BAAjCA,EAAY,GAAGnmC,cACE,IAAvBmmC,EAAY96C,OACfiB,KAAKs2C,gBAAgByE,8BACpBztC,SAASusC,EAAY,IACrBA,EAAY,GACZvsC,SAASusC,EAAY,IACrBvsC,SAASusC,EAAY,IACrBE,WAAWF,EAAY,IACvBvsC,SAASusC,EAAY,IACrB,UACA,WAGD75C,KAAKs2C,gBAAgByE,8BACpBztC,SAASusC,EAAY,IACrBA,EAAY,GACZvsC,SAASusC,EAAY,IACrBvsC,SAASusC,EAAY,IACrB,IACA,EACA,UACA,WAGEA,EAAY96C,OAAS,IACxBiB,KAAKs2C,gBAAgBnR,gBACpB73B,SAASusC,EAAY,IACrBvsC,SAASusC,EAAY,IACrBvsC,SAASusC,EAAY,KAEtBL,EAAUp6C,KAAK,IAAIqiC,GAAWn0B,SAASusC,EAAY,YAE9C,GAAqC,mBAAjCA,EAAY,GAAGnmC,cACE,IAAvBmmC,EAAY96C,SACfiB,KAAKs2C,gBAAgB/G,kBACpBjiC,SAASusC,EAAY,IACrBA,EAAY,GACZvsC,SAASusC,EAAY,IACrBvsC,SAASusC,EAAY,IACrB,UACA,UACA,WAGD75C,KAAKs2C,gBAAgBnR,gBACpB73B,SAASusC,EAAY,IACrBvsC,SAASusC,EAAY,IACrBvsC,SAASusC,EAAY,KAEtBL,EAAUp6C,KAAK,IAAIqiC,GAAWn0B,SAASusC,EAAY,YAE9C,GAAqC,YAAjCA,EAAY,GAAGnmC,cAA6B,CACtD,IAAMsnC,EAAUh7C,KAAKs2C,gBAAgBtC,QAAQ1mC,SAASusC,EAAY,KAClE75C,KAAKs2C,gBAAgBhT,QACpBh2B,SAASusC,EAAY,IACrB75C,KAAKg6C,UAAUH,EAAY,KAE5BL,EAAUp6C,KAAK,IAAI+jC,GAAY71B,SAASusC,EAAY,IAAKmB,SACnD,GAAqC,gBAAjCnB,EAAY,GAAGnmC,cAAiC,CAC1D,IAAMsnC,EAAUh7C,KAAKs2C,gBAAgBrC,YAAY3mC,SAASusC,EAAY,KACtE75C,KAAKs2C,gBAAgB9I,YACpBlgC,SAASusC,EAAY,IACrB75C,KAAKg6C,UAAUH,EAAY,KAE5BL,EAAUp6C,KAAK,IAAImkC,GAAgBj2B,SAASusC,EAAY,IAAKmB,SACvD,GAAqC,gBAAjCnB,EAAY,GAAGnmC,cAAiC,CAC1D,IAAMsnC,EAAUh7C,KAAKs2C,gBAAgBpC,aAAa5mC,SAASusC,EAAY,KACvE75C,KAAKs2C,gBAAgB7I,YACpBngC,SAASusC,EAAY,IACrB75C,KAAKg6C,UAAUH,EAAY,KAE5BL,EAAUp6C,KAAK,IAAIqkC,GAAgBn2B,SAASusC,EAAY,IAAKmB,SACvD,GAAqC,iBAAjCnB,EAAY,GAAGnmC,cACzB,GAAImmC,EAAY96C,OAAS,EAAG,CAC3B,IAAM8lC,EAAW7kC,KAAKs2C,gBAAgB3T,aACrCr1B,SAASusC,EAAY,IACrBvsC,SAASusC,EAAY,KAEtB75C,KAAKs2C,gBAAgBxT,aACpBx1B,SAASusC,EAAY,IACrB75C,KAAK85C,WAAWD,EAAY,IAC5BvsC,SAASusC,EAAY,KAEtBL,EAAUp6C,KACT,IAAIilC,GACH/2B,SAASusC,EAAY,IACrBhV,EACAv3B,SAASusC,EAAY,UAGjB,CACN,IAAMhV,EAAW7kC,KAAKs2C,gBAAgB3T,aAAar1B,SAASusC,EAAY,IAAK,GAC7E75C,KAAKs2C,gBAAgBxT,aACpBx1B,SAASusC,EAAY,IACrB75C,KAAK85C,WAAWD,EAAY,IAC5B,GAEDL,EAAUp6C,KAAK,IAAIilC,GAAiB/2B,SAASusC,EAAY,IAAKhV,EAAU,SAEnE,GAAqC,oBAAjCgV,EAAY,GAAGnmC,cACzB1T,KAAKs2C,gBAAgBvM,aACpBz8B,SAASusC,EAAY,IACrBE,WAAWF,EAAY,IACvBE,WAAWF,EAAY,IACvBvsC,SAASusC,EAAY,IACrB75C,KAAK85C,WAAWD,EAAY,IAC5B75C,KAAK85C,WAAWD,EAAY,KAE7B75C,KAAKs2C,gBAAgBnR,gBACpB73B,SAASusC,EAAY,IACrBvsC,SAASusC,EAAY,IACrBvsC,SAASusC,EAAY,KAEtBL,EAAUp6C,KAAK,IAAIqiC,GAAWn0B,SAASusC,EAAY,WAC7C,GAAqC,aAAjCA,EAAY,GAAGnmC,cAA8B,CACvD,IAAM5I,EAAKwC,SAASusC,EAAY,IAChC75C,KAAKs2C,gBAAgBrU,SAASn3B,EAAIwC,SAASusC,EAAY,KACvD,IAAMoB,EAAWj7C,KAAKs2C,gBAAgB1P,SAAS97B,GAC/C0uC,EAAUp6C,KAAK,IAAI4iC,GAAal3B,EAAImwC,SAC9B,GAAqC,mBAAjCpB,EAAY,GAAGnmC,cAAoC,CAC7D,IAAMwnC,EAAUl7C,KAAKs2C,gBAAgBqE,UAAUrtC,SAASusC,EAAY,KACpEL,EAAUp6C,KAAK,IAAI8iC,GAAmBgZ,EAAS5tC,SAASusC,EAAY,MACpE75C,KAAKs2C,gBAAgB1T,eACpBt1B,SAASusC,EAAY,IACrBvsC,SAASusC,EAAY,UAEhB,GAAqC,gBAAjCA,EAAY,GAAGnmC,cAAiC,CAC1D,IAAM5I,EAAKwC,SAASusC,EAAY,IAC1BsB,EAAOn7C,KAAKs2C,gBAAgB2D,SAASnvC,GACrCswC,EAAOp7C,KAAKs2C,gBAAgB4D,SAASpvC,GAC3C0uC,EAAUp6C,KAAK,IAAI8lC,GAAgBp6B,EAAIqwC,EAAMC,IAC7Cp7C,KAAKs2C,gBAAgBnR,gBACpBr6B,EACAwC,SAASusC,EAAY,IACrBvsC,SAASusC,EAAY,UAEhB,GAAqC,eAAjCA,EAAY,GAAGnmC,cAAgC,CACzD,IAAM5I,EAAKwC,SAASusC,EAAY,IAC1BsB,EAAOn7C,KAAKs2C,gBAAgB2D,SAASnvC,GAE3C0uC,EAAUp6C,KAAK,IAAI8lC,GAAgBp6B,EAAIqwC,EAAKC,OAC5Cp7C,KAAKs2C,gBAAgBhC,WAAWxpC,EAAIwC,SAASusC,EAAY,UACnD,GAAqC,cAAjCA,EAAY,GAAGnmC,cAA+B,CACxD,IAAM5I,EAAKwC,SAASusC,EAAY,IAC1BsB,EAAOn7C,KAAKs2C,gBAAgB2D,SAASnvC,GAE3C0uC,EAAUp6C,KAAK,IAAI8lC,GAAgBp6B,EAAIqwC,EAAKC,OAC5Cp7C,KAAKs2C,gBAAgBjC,UAAUvpC,EAAIwC,SAASusC,EAAY,UAClD,GAAqC,aAAjCA,EAAY,GAAGnmC,cAA8B,CACvD,IAAM5I,EAAKwC,SAASusC,EAAY,IAC1BsB,EAAOn7C,KAAKs2C,gBAAgB2D,SAASnvC,GAE3C0uC,EAAUp6C,KAAK,IAAI8lC,GAAgBp6B,EAAIqwC,EAAKC,OAC5Cp7C,KAAKs2C,gBAAgBlC,SAAStpC,EAAIwC,SAASusC,EAAY,UACjD,GAAqC,gBAAjCA,EAAY,GAAGnmC,cAAiC,CAC1D,IAAM5I,EAAKwC,SAASusC,EAAY,IAC1BsB,GAAOn7C,KAAKs2C,gBAAgB2D,SAASnvC,GAE3C0uC,EAAUp6C,KAAK,IAAI8lC,GAAgBp6B,EAAIqwC,GAAKC,OAC5Cp7C,KAAKs2C,gBAAgB7B,YAAY3pC,EAAIwC,SAASusC,EAAY,UACpD,GAAqC,sBAAjCA,EAAY,GAAGnmC,cAAuC,CAChE,IAAM5I,GAAKwC,SAASusC,EAAY,IAC1B3sC,GAAQI,SAASusC,EAAY,IAC7BprB,GAAWzuB,KAAKs2C,gBAAgBnD,kBAAkBroC,IACxD0uC,EAAUp6C,KAAK,IAAI2kC,GAAsBj5B,GAAI2jB,KAC7CzuB,KAAKs2C,gBAAgBtS,kBAAkBl5B,GAAIoC,IAK5ClN,KAAK22C,iBAAmB32C,KAAK22C,iBAAmB,EAEjD32C,KAAK62C,UAAY,IAQd+C,GAAiB55C,KAAKu2C,kBACtBqD,GAAiB55C,KAAK22C,mBAAqB32C,KAAK02C,eAAe33C,UAEjEiB,KAAK62C,UAAY72C,KAAK82C,sBAGvB92C,KAAKuzC,UAAUn0C,KAAKo6C,K,wCAKH94C,GAEjBV,KAAKy5C,YACuB,OAAxBz5C,KAAK02C,iBACR12C,KAAK42C,uBAAuBx3C,KAAKY,KAAK02C,gBACtC12C,KAAKk3C,8BAA8B93C,KAAKY,KAAKi3C,gCAE7Bx0C,IAAb/B,GAA8C,IAApBA,EAAS3B,OACtCiB,KAAK02C,eAAiB,CAAC,QAEvB12C,KAAK02C,eAAiBh2C,EAEvBV,KAAKi3C,yBAA2B,GAChCj3C,KAAK22C,iBAAmB,EACxB32C,KAAKq7C,iBACLr7C,KAAKy2C,oBAAqB,EAC1Bz2C,KAAKu5C,UAAU,mBAAoB,UAEnCv5C,KAAKs7C,e,iCAODt7C,KAAKw2C,cAAmC,OAAnBx2C,KAAKuzC,WAAgD,IAA1BvzC,KAAKuzC,UAAUx0C,QAElEiB,KAAKu5C,UAAU,mBAAoB,UAEnCv5C,KAAKy5C,YAELz5C,KAAKw2C,cAAe,EACpBx2C,KAAKu7C,gBAILv7C,KAAKy5C,YAELz5C,KAAKs7C,eAEJt7C,KAAKy2C,oBACNz2C,KAAKu2C,iBAC6B,OAAlCv2C,KAAKi3C,2BAELj3C,KAAKu5C,UAAU,mBAAoB,UACnCv5C,KAAKy2C,oBAAqB,EAC1Bz2C,KAAKu7C,gBAILv7C,KAAKy5C,YAELz5C,KAAKs7C,gB,6BAMFt7C,KAAKw2C,eACRx2C,KAAKq7C,iBACLr7C,KAAKu5C,UAAU,mBAAoB,UACnCv5C,KAAKy2C,oBAAqB,EAI1Bz2C,KAAKy5C,YAELz5C,KAAKs7C,gB,qCAMNt7C,KAAKuzC,UAAY,GACjBvzC,KAAKi3C,yBAA2B,KAChCj3C,KAAK42C,uBAAyB,GAC9B52C,KAAKk3C,8BAAgC,GACrCl3C,KAAK02C,eAAiB,KACtB12C,KAAKu5C,UAAU,2BAA4B,UAE3Cv5C,KAAKy5C,YACLz5C,KAAKs2C,gBAAgBoD,SACrB15C,KAAKs2C,gBAAgB7D,S,iCAIrB,IAAI+I,EAC+B,OAAlCx7C,KAAKi3C,0BAA8E,IAAzCj3C,KAAKi3C,yBAAyBl4C,OACzE,GAAIy8C,EAAa,CAChB,IAAI18C,EACJ,IAAKA,EAAI,EAAyB,OAAtBkB,KAAK+2C,cAAyBj4C,EAAIkB,KAAK+2C,aAAah4C,OAAQD,IAAK,CAC5E,IAAMiiC,EAAW/gC,KAAK+2C,aAAaj4C,GAAGiiC,SACtC/gC,KAAKs2C,gBAAgBnR,gBACpBpE,EACA/gC,KAAK+2C,aAAaj4C,GAAG+hC,IACrB7gC,KAAK+2C,aAAaj4C,GAAGgiC,KAMvB,IAHI9gC,KAAKg3C,WACRh3C,KAAKy7C,gBAAgBz7C,KAAKuzC,UAAU7xC,OAE9B85C,GAAa,CAEnB,IADAx7C,KAAKu7C,gBACAz8C,EAAI,EAAGA,EAAIkB,KAAK+2C,aAAah4C,OAAQD,IAAK,CAC9C,IAAMiiC,EAAW/gC,KAAK+2C,aAAaj4C,GAAGiiC,SACtC/gC,KAAKs2C,gBAAgBnR,gBACpBpE,EACA/gC,KAAK+2C,aAAaj4C,GAAG+hC,IACrB7gC,KAAK+2C,aAAaj4C,GAAGgiC,KAGvB0a,EAAcx7C,KAAKy7C,gBAAgBz7C,KAAKuzC,UAAU7xC,OAGnD1B,KAAKy5C,YACLz5C,KAAKs2C,gBAAgBoD,SACrB15C,KAAKs2C,gBAAgB7D,OACC,MAAlBzyC,KAAKuzC,WAA+C,IAA1BvzC,KAAKuzC,UAAUx0C,QAC5CiB,KAAKu5C,UAAU,2BAA4B,a,iCAM7Cv5C,KAAKoE,eACLpE,KAAKs2C,gBAAgBoF,kBACrB17C,KAAKs2C,gBAAgB7D,OAErBzyC,KAAKy5C,c,oCAIL,GAAIz5C,KAAKy2C,mBAAoB,CAE5B,IADAz2C,KAAKs2C,gBAAgBqF,SAAU,EAEN,OAAxB37C,KAAK02C,gBACL12C,KAAK22C,iBAAmB32C,KAAK02C,eAAe33C,QAC3C,CACD,IAAK,IAAID,EAAI,EAAyB,OAAtBkB,KAAK+2C,cAAyBj4C,EAAIkB,KAAK+2C,aAAah4C,OAAQD,IAAK,CAChF,IAAMiiC,EAAW/gC,KAAK+2C,aAAaj4C,GAAGiiC,SACtC/gC,KAAKs2C,gBAAgBnR,gBACpBpE,EACA/gC,KAAK+2C,aAAaj4C,GAAG+hC,IACrB7gC,KAAK+2C,aAAaj4C,GAAGgiC,KAGnB9gC,KAAKg3C,WACRh3C,KAAKy7C,gBAAgBz7C,KAAKuzC,UAAU7xC,OAErC1B,KAAKq7C,iBACL,IAAK,IAAIv8C,EAAI,EAAGA,EAAIkB,KAAK+2C,aAAah4C,OAAQD,IAAK,CAClD,IAAMiiC,EAAW/gC,KAAK+2C,aAAaj4C,GAAGiiC,SACtC/gC,KAAKs2C,gBAAgBnR,gBACpBpE,EACA/gC,KAAK+2C,aAAaj4C,GAAG+hC,IACrB7gC,KAAK+2C,aAAaj4C,GAAGgiC,MAIxB9gC,KAAKs2C,gBAAgBoD,SACrB15C,KAAKy2C,oBAAqB,EAC1Bz2C,KAAKw2C,cAAe,EACpBx2C,KAAKg3C,WAAY,EAEjBh3C,KAAKs2C,gBAAgBqF,SAAU,EAC/B37C,KAAKu5C,UAAU,iBAAkB,UAEjCv5C,KAAKy5C,YACLz5C,KAAKs2C,gBAAgBoD,SACrB15C,KAAKs2C,gBAAgB7D,U,sCAIP+G,GACf,IAAK,IAAI16C,EAAI06C,EAAUz6C,OAAS,EAAGD,GAAK,EAAGA,IAC1C06C,EAAU16C,GAAG88C,gBAAgB57C,KAAKs2C,iBAKnC,OAHAt2C,KAAKg3C,WAAY,EAG4B,IAAzCh3C,KAAKi3C,yBAAyBl4C,SACjCiB,KAAKw2C,cAAe,EACpBx2C,KAAKy2C,oBAAqB,EAC1Bz2C,KAAKi3C,yBAA2Bj3C,KAAKk3C,8BAA8Bx1C,MACnE1B,KAAK02C,eAAiB12C,KAAK42C,uBAAuBl1C,MAClD1B,KAAKu5C,UAAU,iBAAkB,UACjCv5C,KAAKu5C,UAAU,gBAAiB,UAChCv5C,KAAK+2C,aAAe,GACE,MAAlB/2C,KAAKuzC,WAA+C,IAA1BvzC,KAAKuzC,UAAUx0C,SAC5CiB,KAAKy2C,oBAAqB,EAC1Bz2C,KAAKw2C,cAAe,EACpBx2C,KAAKu5C,UAAU,2BAA4B,WAI5Cv5C,KAAKy5C,YACLz5C,KAAKs2C,gBAAgBoD,SACrB15C,KAAKs2C,gBAAgB7D,QAEd,K,sCAMR,GAA6C,IAAzCzyC,KAAKi3C,yBAAyBl4C,QAI9BiB,KAAKi3C,yBAAyBl4C,OAAS,EAAG,CAC7CiB,KAAKg3C,WAAY,EACjB,IAAI4C,GAAgB,EACpB55C,KAAK22C,iBAAmB32C,KAAKi3C,yBAAyBv1C,MACtD1B,KAAK+2C,aAAe,GACpB,IACIj4C,EADEuB,EAAOL,KAAKuzC,UAAUvzC,KAAKuzC,UAAUx0C,OAAS,GAEpD,IAAKD,EAAIuB,EAAKtB,OAAS,EAAGD,GAAK,EAAGA,IAAK,CACtC,IAAM+8C,EAAcx7C,EAAKvB,GAAGg9C,iBAAiB97C,KAAK+2C,cAClD6C,EAAgBA,GAAiBiC,EAElC77C,KAAK62C,UAAY,GAMZ+C,GAAiB55C,KAAKu2C,kBAC1Bv2C,KAAK62C,UAAY72C,KAAK82C,sBAEvB92C,KAAKy2C,oBAAqB,K,+BAInB9D,EAAOC,GACf5yC,KAAKs2C,gBAAgBtM,SAAS2I,EAAOC,GAGrC5yC,KAAKs2C,gBAAgB7D,S,mCAGTG,GACZ5yC,KAAKs2C,gBAAgBxmC,aAAa8iC,GAGlC5yC,KAAKs2C,gBAAgB7D,S,+BAIrB,GAAIzyC,KAAKy2C,mBAAoB,CAE5B,IAAI33C,EACJ,IAFAkB,KAAK62C,UAAY72C,KAAK62C,UAAY,EAE7B/3C,EAAI,EAAGA,EAAIkB,KAAK+2C,aAAah4C,OAAQD,IACzC,GACCkB,KAAK62C,YAAc72C,KAAK82C,sBACJ,IAAnB92C,KAAK62C,WAAiD,IAA9B72C,KAAK82C,qBAE9B92C,KAAKs2C,gBAAgBnR,gBACpBnlC,KAAK+2C,aAAaj4C,GAAGiiC,SACrB/gC,KAAK+2C,aAAaj4C,GAAG+hC,IACrB7gC,KAAK+2C,aAAaj4C,GAAGgiC,UAEhB,GAAI9gC,KAAK62C,UAAY72C,KAAK82C,qBAAsB,CACtD,IAAM/V,EAAW/gC,KAAK+2C,aAAaj4C,GAAGiiC,SAChCmY,EAAU,GAAKl5C,KAAK82C,qBAAuB92C,KAAK62C,WAKhDjC,EAAO50C,KAAK+7C,KACjB/7C,KAAKs2C,gBAAgB2D,SAASlZ,GAC9B/gC,KAAK+2C,aAAaj4C,GAAG+hC,IACrBqY,GAEKrE,EAAO70C,KAAK+7C,KACjB/7C,KAAKs2C,gBAAgB4D,SAASnZ,GAC9B/gC,KAAK+2C,aAAaj4C,GAAGgiC,IACrBoY,GAEDl5C,KAAKs2C,gBAAgBnR,gBAAgBpE,EAAU6T,EAAMC,GAGnD70C,KAAK62C,WAAa72C,KAAK82C,uBACtB92C,KAAKg3C,UACJh3C,KAAKy7C,gBAAgBz7C,KAAKuzC,UAAU7xC,SACvC1B,KAAKw2C,cAAe,EACpBx2C,KAAKu5C,UAAU,mBAAoB,WAInCv5C,KAAKu2C,iBACLv2C,KAAK22C,iBAAmB32C,KAAK02C,eAAe33C,QAE5CiB,KAAKw2C,cAAe,EACpBx2C,KAAKu5C,UAAU,mBAAoB,UACnCv5C,KAAK+2C,aAAe,IAEpB/2C,KAAKq7C,kBAIRr7C,KAAKs2C,gBAAgBoD,Y,oCAKtB15C,KAAK23C,kBAAkB9sC,UAAW,GACG,IAAjC7K,KAAKq3C,eAAexsC,WACvB7K,KAAKu3C,eAAe1sC,UAAW,GAEhC7K,KAAKq2C,cAAc9D,aAAa1P,QAAQ,oBACxC7iC,KAAKq2C,cAAc9D,aAAa3O,mBAAmB,a,oCAInD5jC,KAAK63C,kBAAkBhtC,UAAW,EAClC7K,KAAKq3C,eAAexsC,UAAW,EAC/B7K,KAAK23C,kBAAkB9sC,UAAW,EAClC7K,KAAKu3C,eAAe1sC,UAAW,EAC/B7K,KAAKq2C,cAAc9D,aAAa1P,QAAQ,qBACxC7iC,KAAKq2C,cAAc9D,aAAa3O,mBAAmB,a,kCAInD5jC,KAAK63C,kBAAkBhtC,UAAW,EAClC7K,KAAK23C,kBAAkB9sC,UAAW,GACG,IAAjC7K,KAAKq3C,eAAexsC,UAAsB7K,KAAKm3C,SAClDn3C,KAAKu3C,eAAe1sC,UAAW,GAEhC7K,KAAKq2C,cAAc9D,aAAa1P,QAAQ,uBACxC7iC,KAAKq2C,cAAc9D,aAAa3O,mBAAmB,a,4CAInD5jC,KAAKq3C,eAAexsC,UAAW,EAC/B7K,KAAKu3C,eAAe1sC,UAAW,I,gCAGrB,IAAD,OAGT7K,KAAKg8C,MAAQC,YAAW,kBAAM,EAAKC,YAAW,IAC9Cl8C,KAAK05C,SACL15C,KAAKq2C,cAAc5D,S,oCAInBzyC,KAAKm3C,QAAUn3C,KAAKm3C,OAChBn3C,KAAKm3C,QACRn3C,KAAKy3C,oBAAoBn5C,aAAa,QAAS,SACV,IAAjC0B,KAAKq3C,eAAexsC,WACvB7K,KAAKu3C,eAAe1sC,UAAW,IAGhC7K,KAAKy3C,oBAAoBn5C,aAAa,QAAS,SAEhD0B,KAAKm8C,UAAUn8C,KAAKm3C,U,mCAGP,IAAD,OACZn3C,KAAKg8C,MAAQC,YAAW,kBAAM,EAAKC,YAAW,M,kCAI9CE,cAAcp8C,KAAKg8C,W,GAhuCyB5W,ICtG/BiX,G,YAtFd,WAAYC,GAAQ,IAAD,sBAClB,4CAAMA,IACN,IAAMh/C,EAAWg/C,EAAMh/C,SACvB,EAAK00C,UAAYuK,KAAMC,YACvB,EAAKtG,WAAaqG,KAAMC,YACxB,IAAMC,EAAWn/C,EAASo/C,SAAS5gC,MAAM,GALvB,OAOlB,EAAK6gC,MAAQ,CACZF,SAAUA,EACVG,iBAAiB,GATA,E,8EAclB58C,KAAK68C,SAAS,CAAED,iBAAkB58C,KAAK28C,MAAMC,oB,0CAIzC1c,GAAYlgC,KAAK28C,MAAMF,YAC1Bz8C,KAAK88C,UAAY,IAAI1G,GAAiBp2C,KAAKgyC,UAAWhyC,KAAKk2C,YAE3Dl2C,KAAK+8C,WAAa,IAAIzd,GAAct/B,KAAK28C,MAAMF,UAAU,GACxDz8C,KAAK88C,UACL98C,KAAKgyC,UAAUpoB,QAAQ5Q,MACvBhZ,KAAKgyC,UAAUpoB,QAAQhhB,W,+BAKhB,IAAD,OACF6zC,EAAWz8C,KAAK28C,MAAMF,SAC5B,IAAKvc,GAAYuc,GAChB,OAAO,qCAER,IjBqFsBtc,EiBrFhBhb,EAASma,GAAcmd,GAAU,GACpCnd,GAAcmd,GAAU,GACxBnd,GAAcmd,GAAU,GAE3B,OACC,0BAAKlc,UAAU,yBACd,0BAAKz1B,GAAG,aACP,0BAAKA,GAAG,UACP,6BAAKqa,IAGN,0BAAKra,GAAG,eACP,0BAAKA,GAAG,sBACP,4BAAOA,GAAG,+BjBwEOq1B,EiBvEPsc,EjBuEerc,OAAO1pB,KAAK4pB,IAAQD,SAASF,GiBtErD,6BACCI,UAAWvgC,KAAK28C,MAAMC,gBAAkB,WAAa,GACrD9xC,GAAG,iBACHkyC,QAAS,kBAAM,EAAKC,oBAElB,OAGL,6BAAQnyC,GAAG,SAASkO,MAAM,OAAOpQ,OAAO,MAAMs0C,IAAKl9C,KAAKgyC,YAExD,0BAAKlnC,GAAG,kCACP,4BAAOA,GAAG,2BAA2BoyC,IAAKl9C,KAAKk2C,eAIjD,0BACCprC,GAAG,gBACHy1B,UAAS,eAAUvgC,KAAK28C,MAAMC,gBAAkB,QAAU,KAE1D,0BAAKrc,UAAU,iBAAiBD,GAAOmc,KAGxC,0BAAK3xC,GAAG,UACP,4BACC,mBAAC,IAAD,CAAM05B,GAAG,KAAT,+B,GA1EkB+X,KAAMY,W,SCahBC,GAnBM,WACpB,OACC,yKAEqD,IACpD,wBAAGC,KAAK,6DAAR,0CAEK,IALN,gOAQ8C,IAC7C,wBAAGA,KAAK,uDAAR,2BAEK,IAXN,mBC4CaC,GA1CF,WACZ,IAAMC,EAAUnd,OAAOod,QAAQle,IAAe3jB,KAAI,WAAe8hC,GAAS,IAAD,oBAArBtd,EAAqB,KAAfud,EAAe,KACxE,OACC,mBAAC,IAAD,CAAMlZ,GAAE,WAAMrE,GAAQwd,IAAKF,GAC1B,4BAAOld,UAAU,SAAShhC,KAAK,SAASC,MAAOk+C,EAAK,SAIvD,OACC,0BAAKnd,UAAU,aACd,0BAAKA,UAAU,UACd,uEAED,0BAAKA,UAAU,QACd,6BACC,6BACC,mBAAC,IAAD,CAAMiE,GAAG,KAAT,SAED,6BACC,mBAAC,IAAD,CAAMA,GAAG,UAAT,YAKH,0BAAKjE,UAAU,WACd,mBAAC,IAAD,KACC,mBAAC,IAAD,CAAOqd,OAAK,EAACp0B,KAAK,KAChB+zB,GAEF,mBAAC,IAAD,CAAO/zB,KAAK,UACX,mBAAC,GAAD,SAKH,0BAAK+W,UAAU,UAAf,kBACgB,wBAAG8c,KAAK,kCAAR,mBCtBJQ,GAZH,WACX,OACC,mBAAC,IAAD,CAAQC,SAAUC,wBACjB,mBAAC,IAAD,KACC,mBAAC,IAAD,CAAOH,OAAK,EAACp0B,KAAK,IAAIw0B,UAAWV,KACjC,mBAAC,IAAD,CAAO9zB,KAAK,SAASw0B,UAAWV,KAChC,mBAAC,IAAD,CAAOU,UAAW3B,QCTtBhE,KAASC,OAAO,mBAAC,GAAD,MAASz6C,SAASK,eAAe,S/D+H3C,kBAAmB+/C,WACrBA,UAAUC,cAAcC,MAAMC,MAAK,SAAAC,GACjCA,EAAaC,kB","file":"static/js/main.d9497a27.chunk.js","sourcesContent":["// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\n/* global process */\n/* eslint-disable no-console */\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\r\n//\r\n// Redistribution and use in source and binary forms, with or without modification, are\r\n// permitted provided that the following conditions are met:\r\n//\r\n// 1. Redistributions of source code must retain the above copyright notice, this list of\r\n// conditions and the following disclaimer.\r\n//\r\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\r\n// of conditions and the following disclaimer in the documentation and/or other materials\r\n// provided with the distribution.\r\n//\r\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\r\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\r\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\r\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\r\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\r\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\r\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\r\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\r\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\r\n//\r\n// The views and conclusions contained in the software and documentation are those of the\r\n// authors and should not be interpreted as representing official policies, either expressed\r\n// or implied, of the University of San Francisco\r\n\r\nexport function addLabelToAlgorithmBar(labelName, group) {\r\n\tconst element = document.createTextNode(labelName);\r\n\r\n\tif (!group) {\r\n\t\tconst tableEntry = document.createElement('td');\r\n\t\ttableEntry.appendChild(element);\r\n\r\n\t\tconst controlBar = document.getElementById('AlgorithmSpecificControls');\r\n\t\t// Append the element in page (in span)\r\n\t\tcontrolBar.appendChild(tableEntry);\r\n\t} else {\r\n\t\tgroup.appendChild(element);\r\n\t}\r\n\r\n\treturn element;\r\n}\r\n\r\nexport function addCheckboxToAlgorithmBar(boxLabel, checked, group) {\r\n\tconst element = document.createElement('input');\r\n\r\n\telement.setAttribute('type', 'checkbox');\r\n\telement.setAttribute('value', boxLabel);\r\n\tchecked && element.setAttribute('checked', 'true');\r\n\r\n\tconst label = document.createTextNode(boxLabel);\r\n\r\n\tif (!group) {\r\n\t\tconst tableEntry = document.createElement('td');\r\n\t\ttableEntry.appendChild(element);\r\n\t\ttableEntry.appendChild(label);\r\n\r\n\t\tconst controlBar = document.getElementById('AlgorithmSpecificControls');\r\n\t\tcontrolBar.appendChild(tableEntry);\r\n\t} else {\r\n\t\tconst span = document.createElement('span');\r\n\t\tspan.appendChild(element);\r\n\t\tspan.appendChild(label);\r\n\r\n\t\tgroup.appendChild(span);\r\n\t}\r\n\r\n\treturn element;\r\n}\r\n\r\nexport function addRadioButtonGroupToAlgorithmBar(buttonNames, groupName, group) {\r\n\tconst buttonList = [];\r\n\tconst newTable = document.createElement('table');\r\n\r\n\tfor (let i = 0; i < buttonNames.length; i++) {\r\n\t\tconst midLevel = document.createElement('tr');\r\n\t\tconst bottomLevel = document.createElement('td');\r\n\r\n\t\tconst button = document.createElement('input');\r\n\t\tbutton.setAttribute('type', 'radio');\r\n\t\tbutton.setAttribute('name', groupName);\r\n\t\tbutton.setAttribute('value', buttonNames[i]);\r\n\t\tbottomLevel.appendChild(button);\r\n\t\tmidLevel.appendChild(bottomLevel);\r\n\t\tconst txtNode = document.createTextNode(' ' + buttonNames[i]);\r\n\t\tbottomLevel.appendChild(txtNode);\r\n\t\tnewTable.appendChild(midLevel);\r\n\t\tbuttonList.push(button);\r\n\t}\r\n\r\n\tif (!group) {\r\n\t\tconst topLevelTableEntry = document.createElement('td');\r\n\t\ttopLevelTableEntry.appendChild(newTable);\r\n\r\n\t\tconst controlBar = document.getElementById('AlgorithmSpecificControls');\r\n\t\tcontrolBar.appendChild(topLevelTableEntry);\r\n\t} else {\r\n\t\tgroup.appendChild(newTable);\r\n\t}\r\n\r\n\treturn buttonList;\r\n}\r\n\r\nexport function addControlToAlgorithmBar(type, value, group) {\r\n\tconst element = document.createElement('input');\r\n\r\n\telement.setAttribute('type', type);\r\n\telement.setAttribute('value', value);\r\n\r\n\tif (!group) {\r\n\t\tconst tableEntry = document.createElement('td');\r\n\t\ttableEntry.appendChild(element);\r\n\r\n\t\tconst controlBar = document.getElementById('AlgorithmSpecificControls');\r\n\t\tcontrolBar.appendChild(tableEntry);\r\n\t} else {\r\n\t\tgroup.appendChild(element);\r\n\t}\r\n\r\n\treturn element;\r\n}\r\n\r\nexport function addGroupToAlgorithmBar(horizontal, parentGroup) {\r\n\tconst group = document.createElement('div');\r\n\r\n\tgroup.setAttribute('class', horizontal ? 'hgroup' : 'vgroup');\r\n\r\n\tif (!parentGroup) {\r\n\t\tconst tableEntry = document.createElement('td');\r\n\t\ttableEntry.appendChild(group);\r\n\r\n\t\tconst controlBar = document.getElementById('AlgorithmSpecificControls');\r\n\t\tcontrolBar.appendChild(tableEntry);\r\n\t} else {\r\n\t\tparentGroup.appendChild(group);\r\n\t}\r\n\r\n\treturn group;\r\n}\r\n\r\nexport default class Algorithm {\r\n\tconstructor(am, w, h) {\r\n\t\tif (am == null) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tthis.animationManager = am;\r\n\t\tam.addListener('AnimationStarted', this, this.disableUI);\r\n\t\tam.addListener('AnimationEnded', this, this.enableUI);\r\n\t\tam.addListener('AnimationUndo', this, this.undo);\r\n\t\tthis.canvasWidth = w;\r\n\t\tthis.canvasHeight = h;\r\n\r\n\t\tthis.actionHistory = [];\r\n\t\tthis.recordAnimation = true;\r\n\t\tthis.commands = [];\r\n\t}\r\n\r\n\taddCodeToCanvasBase(code, start_x, start_y, line_height, standard_color, layer) {\r\n\t\tlayer = typeof layer !== 'undefined' ? layer : 0;\r\n\t\tconst codeID = Array(code.length);\r\n\t\tlet i, j;\r\n\t\tfor (i = 0; i < code.length; i++) {\r\n\t\t\tcodeID[i] = new Array(code[i].length);\r\n\t\t\tfor (j = 0; j < code[i].length; j++) {\r\n\t\t\t\tcodeID[i][j] = this.nextIndex++;\r\n\t\t\t\tthis.cmd(\r\n\t\t\t\t\t'CreateLabel',\r\n\t\t\t\t\tcodeID[i][j],\r\n\t\t\t\t\tcode[i][j],\r\n\t\t\t\t\tstart_x,\r\n\t\t\t\t\tstart_y + i * line_height,\r\n\t\t\t\t\t0\r\n\t\t\t\t);\r\n\t\t\t\tthis.cmd('SetForegroundColor', codeID[i][j], standard_color);\r\n\t\t\t\tthis.cmd('SetLayer', codeID[i][j], layer);\r\n\t\t\t\tif (j > 0) {\r\n\t\t\t\t\tthis.cmd('AlignRight', codeID[i][j], codeID[i][j - 1]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn codeID;\r\n\t}\r\n\r\n\tsetCodeAlpha(code, newAlpha) {\r\n\t\tfor (let i = 0; i < code.length; i++) {\r\n\t\t\tfor (let j = 0; j < code[i].length; j++) {\r\n\t\t\t\tthis.cmd('SetAlpha', code[i][j], newAlpha);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tcmd() {\r\n\t\t// Helper method to create a command string from a bunch of arguments\r\n\t\tif (this.recordAnimation) {\r\n\t\t\tlet command = arguments[0];\r\n\t\t\tfor (let i = 1; i < arguments.length; i++) {\r\n\t\t\t\tcommand = command + '<;>' + String(arguments[i]);\r\n\t\t\t}\r\n\t\t\tthis.commands.push(command);\r\n\t\t}\r\n\t}\r\n\r\n\tclearHistory() {\r\n\t\tthis.actionHistory = [];\r\n\t}\r\n\r\n\tundo() {\r\n\t\t// Remove the last action (the one that we are going to undo)\r\n\t\tthis.actionHistory.pop();\r\n\t\t// Clear out our data structure.  Be sure to implement reset in\r\n\t\t// every AlgorithmAnimation subclass!\r\n\t\tthis.reset();\r\n\t\t//  Redo all actions from the beginning, throwing out the animation\r\n\t\t//  commands (the animation manager will update the animation on its own).\r\n\t\t//  Note that if you do something non-deterministic, you might cause problems!\r\n\t\t//  Be sure if you do anything non-deterministic (that is, calls to a random\r\n\t\t//  number generator) you clear out the undo stack here and in the animation\r\n\t\t//  manager.\r\n\r\n\t\t//  If this seems horribly inefficient -- it is! However, it seems to work well\r\n\t\t//  in practice, and you get undo for free for all algorithms, which is a non-trivial\r\n\t\t//  gain.\r\n\t\tconst len = this.actionHistory.length;\r\n\t\tthis.recordAnimation = false;\r\n\t\tfor (let i = 0; i < len; i++) {\r\n\t\t\tthis.actionHistory[i][0](this.actionHistory[i][1]);\r\n\t\t}\r\n\t\tthis.recordAnimation = true;\r\n\t}\r\n\r\n\timplementAction(funct, val) {\r\n\t\tconst nxt = [funct, val];\r\n\t\tthis.actionHistory.push(nxt);\r\n\t\tconst retVal = funct(val);\r\n\t\tthis.animationManager.StartNewAnimation(retVal);\r\n\t}\r\n\r\n\tnormalizeNumber(input, maxLen) {\r\n\t\tconst isAllDigits = str => !/\\D/.test(str);\r\n\t\tif (!isAllDigits(input) || input === '') {\r\n\t\t\treturn input;\r\n\t\t}\r\n\t\treturn ('OOO0000' + input).substr(-maxLen, maxLen);\r\n\t}\r\n\r\n\treturnSubmit(field, funct, maxsize, intOnly) {\r\n\t\tif (maxsize !== undefined) {\r\n\t\t\tfield.size = maxsize;\r\n\t\t}\r\n\t\treturn function(event) {\r\n\t\t\tlet keyASCII = 0;\r\n\t\t\tif (window.event) {\r\n\t\t\t\t// IE\r\n\t\t\t\tkeyASCII = event.keyCode;\r\n\t\t\t} else if (event.which) {\r\n\t\t\t\t// Netscape/Firefox/Opera\r\n\t\t\t\tkeyASCII = event.which;\r\n\t\t\t}\r\n\r\n\t\t\tif (keyASCII === 13 && funct != null) {\r\n\t\t\t\tfunct();\r\n\t\t\t} else if (\r\n\t\t\t\tkeyASCII === 190 ||\r\n\t\t\t\tkeyASCII === 59 ||\r\n\t\t\t\tkeyASCII === 173 ||\r\n\t\t\t\tkeyASCII === 189\r\n\t\t\t) {\r\n\t\t\t\treturn false;\r\n\t\t\t} else if (\r\n\t\t\t\t(maxsize !== undefined && field.value.length >= maxsize) ||\r\n\t\t\t\t(intOnly && (keyASCII < 48 || keyASCII > 57))\r\n\t\t\t) {\r\n\t\t\t\tif (!controlKey(keyASCII)) return false;\r\n\t\t\t}\r\n\t\t};\r\n\t}\r\n\r\n\t// Abstract methods - these should be implemented in the base class\r\n\r\n\t// eslint-disable-next-line no-unused-vars\r\n\tsizeChanged(newWidth, newHeight) {\r\n\t\tthrow new Error('sizeChanged should be implemented in base class');\r\n\t}\r\n\r\n\t// eslint-disable-next-line no-unused-vars\r\n\tdisableUI(event) {\r\n\t\tthrow new Error('disableUI should be implemented in base class');\r\n\t}\r\n\r\n\t// eslint-disable-next-line no-unused-vars\r\n\tenableUI(event) {\r\n\t\tthrow new Error('enableUI should be implemented in base class');\r\n\t}\r\n\r\n\treset() {\r\n\t\tthrow new Error('reset should be implemented in base class');\r\n\t}\r\n}\r\n\r\nexport function controlKey(keyASCII) {\r\n\treturn (\r\n\t\tkeyASCII === 8 ||\r\n\t\tkeyASCII === 9 ||\r\n\t\tkeyASCII === 37 ||\r\n\t\tkeyASCII === 38 ||\r\n\t\tkeyASCII === 39 ||\r\n\t\tkeyASCII === 40 ||\r\n\t\tkeyASCII === 46\r\n\t);\r\n}\r\n\r\nAlgorithm.prototype.returnSubmitFloat = function(field, funct, maxsize) {\r\n\tif (maxsize !== undefined) {\r\n\t\tfield.size = maxsize;\r\n\t}\r\n\treturn function(event) {\r\n\t\tlet keyASCII = 0;\r\n\t\tif (window.event) {\r\n\t\t\t// IE\r\n\t\t\tkeyASCII = event.keyCode;\r\n\t\t} else if (event.which) {\r\n\t\t\t// Netscape/Firefox/Opera\r\n\t\t\tkeyASCII = event.which;\r\n\t\t}\r\n\t\t// Submit on return\r\n\t\tif (keyASCII === 13) {\r\n\t\t\tfunct();\r\n\t\t}\r\n\t\t// Control keys (arrows, del, etc) are always OK\r\n\t\telse if (controlKey(keyASCII)) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t// - (minus sign) only OK at beginning of number\r\n\t\t//  (For now we will allow anywhere -- hard to see where the beginning of the\r\n\t\t//   number is ...)\r\n\t\t//else if (keyASCII == 109 && field.value.length  == 0)\r\n\t\telse if (keyASCII === 109) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t// Digis are OK if we have enough space\r\n\t\telse if (\r\n\t\t\t(maxsize !== undefined || field.value.length < maxsize) &&\r\n\t\t\tkeyASCII >= 48 &&\r\n\t\t\tkeyASCII <= 57\r\n\t\t) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t// . (Decimal point) is OK if we haven't had one yet, and there is space\r\n\t\telse if (\r\n\t\t\t(maxsize !== undefined || field.value.length < maxsize) &&\r\n\t\t\tkeyASCII === 190 &&\r\n\t\t\tfield.value.indexOf('.') === -1\r\n\t\t) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t// Nothing else is OK\r\n\t\telse {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t};\r\n};\r\n\r\nAlgorithm.prototype.addReturnSubmit = function(field, action) {\r\n\tfield.onkeydown = this.returnSubmit(field, action, 4, false);\r\n};\r\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\r\n//\r\n// Redistribution and use in source and binary forms, with or without modification, are\r\n// permitted provided that the following conditions are met:\r\n//\r\n// 1. Redistributions of source code must retain the above copyright notice, this list of\r\n// conditions and the following disclaimer.\r\n//\r\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\r\n// of conditions and the following disclaimer in the documentation and/or other materials\r\n// provided with the distribution.\r\n//\r\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\r\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\r\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\r\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\r\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\r\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\r\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\r\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\r\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\r\n//\r\n// The views and conclusions contained in the software and documentation are those of the\r\n// authors and should not be interpreted as representing official policies, either expressed\r\n// or implied, of the University of San Francisco\r\n\r\nimport Algorithm, {\r\n\taddControlToAlgorithmBar,\r\n\taddRadioButtonGroupToAlgorithmBar,\r\n} from './Algorithm.js';\r\n\r\nexport default class AVL extends Algorithm {\r\n\tconstructor(am, w, h) {\r\n\t\tsuper(am, w, h);\r\n\r\n\t\tthis.first_print_pos_y = h - 2 * AVL.PRINT_VERTICAL_GAP;\r\n\t\tthis.print_max = w - 10;\r\n\t\tthis.startingX = w / 2;\r\n\t\tthis.addControls();\r\n\t\tthis.nextIndex = 1;\r\n\t\tthis.commands = [];\r\n\t\tthis.edges = [];\r\n\t\tthis.cmd('CreateLabel', 0, '', AVL.EXPLANITORY_TEXT_X, AVL.EXPLANITORY_TEXT_Y, 0);\r\n\t\tthis.animationManager.StartNewAnimation(this.commands);\r\n\t\tthis.animationManager.skipForward();\r\n\t\tthis.animationManager.clearHistory();\r\n\t}\r\n\r\n\taddControls() {\r\n\t\tthis.controls = [];\r\n\r\n\t\tthis.insertField = addControlToAlgorithmBar('Text', '');\r\n\t\tthis.insertField.onkeydown = this.returnSubmit(\r\n\t\t\tthis.insertField,\r\n\t\t\tthis.insertCallback.bind(this),\r\n\t\t\t4\r\n\t\t);\r\n\t\tthis.controls.push(this.insertField);\r\n\r\n\t\tthis.insertButton = addControlToAlgorithmBar('Button', 'Insert');\r\n\t\tthis.insertButton.onclick = this.insertCallback.bind(this);\r\n\t\tthis.controls.push(this.insertButton);\r\n\r\n\t\tthis.deleteField = addControlToAlgorithmBar('Text', '');\r\n\t\tthis.deleteField.onkeydown = this.returnSubmit(\r\n\t\t\tthis.deleteField,\r\n\t\t\tthis.deleteCallback.bind(this),\r\n\t\t\t4\r\n\t\t);\r\n\t\tthis.controls.push(this.deleteField);\r\n\r\n\t\tthis.deleteButton = addControlToAlgorithmBar('Button', 'Delete');\r\n\t\tthis.deleteButton.onclick = this.deleteCallback.bind(this);\r\n\t\tthis.controls.push(this.deleteButton);\r\n\r\n\t\tthis.findField = addControlToAlgorithmBar('Text', '');\r\n\t\tthis.findField.onkeydown = this.returnSubmit(\r\n\t\t\tthis.findField,\r\n\t\t\tthis.findCallback.bind(this),\r\n\t\t\t4\r\n\t\t);\r\n\t\tthis.controls.push(this.findField);\r\n\r\n\t\tthis.findButton = addControlToAlgorithmBar('Button', 'Find');\r\n\t\tthis.findButton.onclick = this.findCallback.bind(this);\r\n\t\tthis.controls.push(this.findButton);\r\n\r\n\t\tthis.printButton = addControlToAlgorithmBar('Button', 'Print');\r\n\t\tthis.printButton.onclick = this.printCallback.bind(this);\r\n\t\tthis.controls.push(this.printButton);\r\n\r\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear');\r\n\t\tthis.clearButton.onclick = this.clearCallback.bind(this);\r\n\t\tthis.controls.push(this.clearButton);\r\n\r\n\t\tconst predSuccButtonList = addRadioButtonGroupToAlgorithmBar(\r\n\t\t\t['Predecessor', 'Successor'],\r\n\t\t\t'Predecessor/Successor'\r\n\t\t);\r\n\r\n\t\tthis.predButton = predSuccButtonList[0];\r\n\t\tthis.succButton = predSuccButtonList[1];\r\n\t\tthis.predButton.onclick = () => (this.predSucc = 'pred');\r\n\t\tthis.succButton.onclick = () => (this.predSucc = 'succ');\r\n\t\tthis.succButton.checked = true;\r\n\t\tthis.predSucc = 'succ';\r\n\t}\r\n\r\n\treset() {\r\n\t\tthis.nextIndex = 1;\r\n\t\tthis.treeRoot = null;\r\n\t\tthis.edges = [];\r\n\t}\r\n\r\n\tinsertCallback() {\r\n\t\tlet insertedValue = this.insertField.value;\r\n\t\t// Get text value\r\n\t\tinsertedValue = this.normalizeNumber(insertedValue, 4);\r\n\t\tif (insertedValue !== '') {\r\n\t\t\t// set text value\r\n\t\t\tthis.insertField.value = '';\r\n\t\t\tthis.implementAction(_ => this.add(_), insertedValue);\r\n\t\t}\r\n\t}\r\n\r\n\tdeleteCallback() {\r\n\t\tlet deletedValue = this.deleteField.value;\r\n\t\tif (deletedValue !== '') {\r\n\t\t\tdeletedValue = this.normalizeNumber(deletedValue, 4);\r\n\t\t\tthis.deleteField.value = '';\r\n\t\t\tthis.implementAction(_ => this.remove(_), deletedValue);\r\n\t\t}\r\n\t}\r\n\r\n\tfindCallback() {\r\n\t\tlet findValue = this.findField.value;\r\n\t\tif (findValue !== '') {\r\n\t\t\tfindValue = this.normalizeNumber(findValue, 4);\r\n\t\t\tthis.findField.value = '';\r\n\t\t\tthis.implementAction(this.findElement.bind(this), findValue);\r\n\t\t}\r\n\t}\r\n\r\n\tprintCallback() {\r\n\t\tthis.implementAction(this.printTree.bind(this), '');\r\n\t}\r\n\r\n\tclearCallback() {\r\n\t\tthis.implementAction(this.clear.bind(this), '');\r\n\t}\r\n\r\n\tsizeChanged(newWidth) {\r\n\t\tthis.startingX = newWidth / 2;\r\n\t}\r\n\r\n\tprintTree() {\r\n\t\tthis.commands = [];\r\n\r\n\t\tif (this.treeRoot != null) {\r\n\t\t\tthis.highlightID = this.nextIndex++;\r\n\t\t\tconst firstLabel = this.nextIndex;\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'CreateHighlightCircle',\r\n\t\t\t\tthis.highlightID,\r\n\t\t\t\tAVL.HIGHLIGHT_COLOR,\r\n\t\t\t\tthis.treeRoot.x,\r\n\t\t\t\tthis.treeRoot.y\r\n\t\t\t);\r\n\t\t\tthis.xPosOfNextLabel = AVL.FIRST_PRINT_POS_X;\r\n\t\t\tthis.yPosOfNextLabel = this.first_print_pos_y;\r\n\t\t\tthis.printTreeRec(this.treeRoot);\r\n\t\t\tthis.cmd('Delete', this.highlightID);\r\n\t\t\tthis.cmd('Step');\r\n\t\t\tfor (let i = firstLabel; i < this.nextIndex; i++) this.cmd('Delete', i);\r\n\t\t\tthis.nextIndex = this.highlightID; /// Reuse objects.  Not necessary.\r\n\t\t}\r\n\t\treturn this.commands;\r\n\t}\r\n\r\n\tprintTreeRec(tree) {\r\n\t\tthis.cmd('Step');\r\n\t\tif (tree.left != null) {\r\n\t\t\tthis.cmd('Move', this.highlightID, tree.left.x, tree.left.y);\r\n\t\t\tthis.printTreeRec(tree.left);\r\n\t\t\tthis.cmd('Move', this.highlightID, tree.x, tree.y);\r\n\t\t\tthis.cmd('Step');\r\n\t\t}\r\n\t\tconst nextLabelID = this.nextIndex++;\r\n\t\tthis.cmd('CreateLabel', nextLabelID, tree.data, tree.x, tree.y);\r\n\t\tthis.cmd('SetForegroundColor', nextLabelID, AVL.PRINT_COLOR);\r\n\t\tthis.cmd('Move', nextLabelID, this.xPosOfNextLabel, this.yPosOfNextLabel);\r\n\t\tthis.cmd('Step');\r\n\r\n\t\tthis.xPosOfNextLabel += AVL.PRINT_HORIZONTAL_GAP;\r\n\t\tif (this.xPosOfNextLabel > this.print_max) {\r\n\t\t\tthis.xPosOfNextLabel = AVL.FIRST_PRINT_POS_X;\r\n\t\t\tthis.yPosOfNextLabel += AVL.PRINT_VERTICAL_GAP;\r\n\t\t}\r\n\t\tif (tree.right != null) {\r\n\t\t\tthis.cmd('Move', this.highlightID, tree.right.x, tree.right.y);\r\n\t\t\tthis.printTreeRec(tree.right);\r\n\t\t\tthis.cmd('Move', this.highlightID, tree.x, tree.y);\r\n\t\t\tthis.cmd('Step');\r\n\t\t}\r\n\t\treturn;\r\n\t}\r\n\r\n\tfindElement(findValue) {\r\n\t\tthis.commands = [];\r\n\r\n\t\tthis.highlightID = this.nextIndex++;\r\n\r\n\t\tthis.doFind(this.treeRoot, findValue);\r\n\r\n\t\treturn this.commands;\r\n\t}\r\n\r\n\tdoFind(tree, value) {\r\n\t\tthis.cmd('SetText', 0, 'Searchiing for ' + value);\r\n\t\tif (tree != null) {\r\n\t\t\tthis.cmd('SetHighlight', tree.graphicID, 1);\r\n\t\t\tif (tree.data === value) {\r\n\t\t\t\tthis.cmd(\r\n\t\t\t\t\t'SetText',\r\n\t\t\t\t\t0,\r\n\t\t\t\t\t'Searching for ' + value + ' : ' + value + ' = ' + value + ' (Element found!)'\r\n\t\t\t\t);\r\n\t\t\t\tthis.cmd('Step');\r\n\t\t\t\tthis.cmd('SetText', 0, 'Found:' + value);\r\n\t\t\t\tthis.cmd('SetHighlight', tree.graphicID, 0);\r\n\t\t\t} else {\r\n\t\t\t\tif (tree.data > value) {\r\n\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t'SetText',\r\n\t\t\t\t\t\t0,\r\n\t\t\t\t\t\t'Searching for ' +\r\n\t\t\t\t\t\t\tvalue +\r\n\t\t\t\t\t\t\t' : ' +\r\n\t\t\t\t\t\t\tvalue +\r\n\t\t\t\t\t\t\t' < ' +\r\n\t\t\t\t\t\t\ttree.data +\r\n\t\t\t\t\t\t\t' (look to left subtree)'\r\n\t\t\t\t\t);\r\n\t\t\t\t\tthis.cmd('Step');\r\n\t\t\t\t\tthis.cmd('SetHighlight', tree.graphicID, 0);\r\n\t\t\t\t\tif (tree.left != null) {\r\n\t\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t\t'CreateHighlightCircle',\r\n\t\t\t\t\t\t\tthis.highlightID,\r\n\t\t\t\t\t\t\tAVL.HIGHLIGHT_COLOR,\r\n\t\t\t\t\t\t\ttree.x,\r\n\t\t\t\t\t\t\ttree.y\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t\tthis.cmd('Move', this.highlightID, tree.left.x, tree.left.y);\r\n\t\t\t\t\t\tthis.cmd('Step');\r\n\t\t\t\t\t\tthis.cmd('Delete', this.highlightID);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.doFind(tree.left, value);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t'SetText',\r\n\t\t\t\t\t\t0,\r\n\t\t\t\t\t\t' Searching for ' +\r\n\t\t\t\t\t\t\tvalue +\r\n\t\t\t\t\t\t\t' : ' +\r\n\t\t\t\t\t\t\tvalue +\r\n\t\t\t\t\t\t\t' > ' +\r\n\t\t\t\t\t\t\ttree.data +\r\n\t\t\t\t\t\t\t' (look to right subtree)'\r\n\t\t\t\t\t);\r\n\t\t\t\t\tthis.cmd('Step');\r\n\t\t\t\t\tthis.cmd('SetHighlight', tree.graphicID, 0);\r\n\t\t\t\t\tif (tree.right != null) {\r\n\t\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t\t'CreateHighlightCircle',\r\n\t\t\t\t\t\t\tthis.highlightID,\r\n\t\t\t\t\t\t\tAVL.HIGHLIGHT_COLOR,\r\n\t\t\t\t\t\t\ttree.x,\r\n\t\t\t\t\t\t\ttree.y\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t\tthis.cmd('Move', this.highlightID, tree.right.x, tree.right.y);\r\n\t\t\t\t\t\tthis.cmd('Step');\r\n\t\t\t\t\t\tthis.cmd('Delete', this.highlightID);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.doFind(tree.right, value);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'SetText',\r\n\t\t\t\t0,\r\n\t\t\t\t' Searching for ' + value + ' : < Empty Tree > (Element not found)'\r\n\t\t\t);\r\n\t\t\tthis.cmd('Step');\r\n\t\t\tthis.cmd('SetText', 0, ' Searching for ' + value + ' :  (Element not found)');\r\n\t\t}\r\n\t}\r\n\r\n\tremakeTree(curr) {\r\n\t\tif (curr == null) return;\r\n\t\tif (curr.left != null) {\r\n\t\t\tthis.cmd('Connect', curr.graphicID, curr.left.graphicID, AVL.LINK_COLOR);\r\n\t\t\tthis.remakeTree(curr.left);\r\n\t\t}\r\n\t\tif (curr.right != null) {\r\n\t\t\tthis.cmd('Connect', curr.graphicID, curr.right.graphicID, AVL.LINK_COLOR);\r\n\t\t\tthis.remakeTree(curr.right);\r\n\t\t}\r\n\t}\r\n\r\n\tadd(data) {\r\n\t\tthis.commands = [];\r\n\t\tthis.cmd('SetText', 0, ' Inserting ' + data);\r\n\t\tthis.treeRoot = this.addH(data, this.treeRoot);\r\n\t\tthis.resizeTree();\r\n\t\treturn this.commands;\r\n\t}\r\n\r\n\taddH(data, curr) {\r\n\t\tif (curr == null) {\r\n\t\t\tthis.cmd('SetText', 0, 'Null found, inserting new node');\r\n\t\t\tconst treeNodeID = this.nextIndex++;\r\n\t\t\tconst heightLabelID = this.nextIndex++;\r\n\t\t\tconst bfLabelID = this.nextIndex++;\r\n\t\t\tthis.cmd('CreateCircle', treeNodeID, data, 30, AVL.STARTING_Y);\r\n\r\n\t\t\tthis.cmd('SetForegroundColor', treeNodeID, AVL.FOREGROUND_COLOR);\r\n\t\t\tthis.cmd('SetBackgroundColor', treeNodeID, AVL.BACKGROUND_COLOR);\r\n\t\t\tthis.cmd('CreateLabel', heightLabelID, 0, 30 - 20, AVL.STARTING_Y - 20);\r\n\t\t\tthis.cmd('SetForegroundColor', heightLabelID, AVL.HEIGHT_LABEL_COLOR);\r\n\r\n\t\t\tthis.cmd('CreateLabel', bfLabelID, 0, 30 + 20, AVL.STARTING_Y - 20);\r\n\t\t\tthis.cmd('SetForegroundColor', bfLabelID, AVL.HEIGHT_LABEL_COLOR);\r\n\t\t\tthis.cmd('Step');\r\n\t\t\tthis.cmd('SetText', 0, '');\r\n\t\t\treturn new AVLNode(data, treeNodeID, heightLabelID, bfLabelID, 0, 0);\r\n\t\t}\r\n\t\tthis.cmd('SetHighlight', curr.graphicID, 1);\r\n\t\tif (data < curr.data) {\r\n\t\t\tthis.cmd('SetText', 0, `${data} < ${curr.data}. Looking at left subtree`);\r\n\t\t\tthis.cmd('Step');\r\n\t\t\tcurr.left = this.addH(data, curr.left);\r\n\t\t\tcurr.left.parent = curr;\r\n\t\t\tthis.resizeTree();\r\n\t\t\tthis.connectSmart(curr.graphicID, curr.left.graphicID);\r\n\t\t\tthis.cmd('Step');\r\n\t\t} else if (data > curr.data) {\r\n\t\t\tthis.cmd('SetText', 0, `${data} > ${curr.data}. Looking at right subtree`);\r\n\t\t\tthis.cmd('Step');\r\n\t\t\tcurr.right = this.addH(data, curr.right);\r\n\t\t\tcurr.right.parent = curr;\r\n\t\t\tthis.resizeTree();\r\n\t\t\t// this.cmd('Connect', curr.graphicID, curr.right.graphicID, AVL.LINK_COLOR);\r\n\t\t\tthis.connectSmart(curr.graphicID, curr.right.graphicID);\r\n\t\t\tthis.cmd('Step');\r\n\t\t} else {\r\n\t\t\tthis.cmd('SetText', 0, `${data} == ${curr.data}. Ignoring duplicate!`);\r\n\t\t\tthis.cmd('Step');\r\n\t\t}\r\n\t\tcurr = this.balance(curr);\r\n\t\tthis.cmd('SetHighlight', curr.graphicID, 0);\r\n\t\tthis.cmd('SetText', 0, '');\r\n\t\treturn curr;\r\n\t}\r\n\r\n\tconnectSmart(id1, id2) {\r\n\t\tif (!this.edges.some(e => e[0] === id1 && e[1] === id2)) {\r\n\t\t\tthis.cmd('Connect', id1, id2, AVL.LINK_COLOR);\r\n\t\t\tthis.edges.push([id1, id2]);\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\r\n\tbalance(curr) {\r\n\t\tcurr.updateHeightAndBF();\r\n\t\tthis.cmd('SetText', curr.heightLabelID, curr.height);\r\n\t\tthis.cmd('SetText', curr.bfLabelID, curr.bf);\r\n\t\tthis.cmd('SetText', 0, 'Adjusting height and balance factor after recursive call');\r\n\t\tthis.cmd('Step');\r\n\r\n\t\tif (curr.bf < -1) {\r\n\t\t\tthis.cmd('SetText', 0, 'Balance factor < -1');\r\n\t\t\tthis.cmd('SetTextColor', curr.bfLabelID, AVL.HIGHLIGHT_LABEL_COLOR);\r\n\t\t\tthis.cmd('Step');\r\n\t\t\tif (curr.right != null && curr.right.bf > 0) {\r\n\t\t\t\tthis.cmd('SetText', 0, 'Right child balance factor > 0');\r\n\t\t\t\tthis.cmd('SetTextColor', curr.right.bfLabelID, AVL.HIGHLIGHT_LABEL_COLOR);\r\n\t\t\t\tthis.cmd('Step');\r\n\t\t\t\tthis.cmd('SetText', 0, 'Right-left rotation');\r\n\t\t\t\tthis.cmd('Step');\r\n\t\t\t\tthis.cmd('SetTextColor', curr.right.bfLabelID, AVL.HEIGHT_LABEL_COLOR);\r\n\t\t\t\tcurr.right = this.singleRotateRight(curr.right);\r\n\t\t\t} else {\r\n\t\t\t\tif (curr.right != null) {\r\n\t\t\t\t\tthis.cmd('SetText', 0, 'Right child balance factor <= 0');\r\n\t\t\t\t\tthis.cmd('SetTextColor', curr.right.bfLabelID, AVL.HIGHLIGHT_LABEL_COLOR);\r\n\t\t\t\t\tthis.cmd('Step');\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.cmd('SetText', 0, 'No right child');\r\n\t\t\t\t\tthis.cmd('Step');\r\n\t\t\t\t}\r\n\t\t\t\tthis.cmd('SetText', 0, 'Left rotation');\r\n\t\t\t\tthis.cmd('Step');\r\n\t\t\t}\r\n\t\t\tthis.cmd('SetTextColor', curr.bfLabelID, AVL.HEIGHT_LABEL_COLOR);\r\n\t\t\tthis.cmd('SetTextColor', curr.right.bfLabelID, AVL.HEIGHT_LABEL_COLOR);\r\n\t\t\tcurr = this.singleRotateLeft(curr);\r\n\t\t} else if (curr.bf > 1) {\r\n\t\t\tthis.cmd('SetText', 0, 'Balance factor > 1');\r\n\t\t\tthis.cmd('SetTextColor', curr.bfLabelID, AVL.HIGHLIGHT_LABEL_COLOR);\r\n\t\t\tthis.cmd('Step');\r\n\t\t\tif (curr.left != null && curr.left.bf < 0) {\r\n\t\t\t\tthis.cmd('SetText', 0, 'Left child balance factor < 0');\r\n\t\t\t\tthis.cmd('SetTextColor', curr.left.bfLabelID, AVL.HIGHLIGHT_LABEL_COLOR);\r\n\t\t\t\tthis.cmd('Step');\r\n\t\t\t\tthis.cmd('SetText', 0, 'Left-right rotation');\r\n\t\t\t\tthis.cmd('Step');\r\n\t\t\t\tthis.cmd('SetTextColor', curr.left.bfLabelID, AVL.HEIGHT_LABEL_COLOR);\r\n\t\t\t\tcurr.left = this.singleRotateLeft(curr.left);\r\n\t\t\t} else {\r\n\t\t\t\tif (curr.left != null) {\r\n\t\t\t\t\tthis.cmd('SetText', 0, 'Left child balance factor >= 0');\r\n\t\t\t\t\tthis.cmd('SetTextColor', curr.left.bfLabelID, AVL.HIGHLIGHT_LABEL_COLOR);\r\n\t\t\t\t\tthis.cmd('Step');\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.cmd('SetText', 0, 'No left child');\r\n\t\t\t\t\tthis.cmd('Step');\r\n\t\t\t\t}\r\n\t\t\t\tthis.cmd('SetText', 0, 'Left rotation');\r\n\t\t\t\tthis.cmd('Step');\r\n\t\t\t\tthis.cmd('SetTextColor', curr.bfLabelID, AVL.HEIGHT_LABEL_COLOR);\r\n\t\t\t}\r\n\t\t\tthis.cmd('SetTextColor', curr.bfLabelID, AVL.HEIGHT_LABEL_COLOR);\r\n\t\t\tthis.cmd('SetTextColor', curr.left.bfLabelID, AVL.HEIGHT_LABEL_COLOR);\r\n\t\t\tcurr = this.singleRotateRight(curr);\r\n\t\t}\r\n\t\treturn curr;\r\n\t}\r\n\r\n\tsingleRotateRight(tree) {\r\n\t\tconst B = tree;\r\n\t\tconst A = tree.left;\r\n\t\tconst t2 = A.right;\r\n\r\n\t\t// this.cmd('SetText', 0, 'Single Rotate Right');\r\n\t\tthis.cmd('SetEdgeHighlight', B.graphicID, A.graphicID, 1);\r\n\t\tthis.cmd('Step');\r\n\r\n\t\tif (t2 != null) {\r\n\t\t\tthis.cmd('Disconnect', A.graphicID, t2.graphicID);\r\n\t\t\tthis.cmd('Connect', B.graphicID, t2.graphicID, AVL.LINK_COLOR);\r\n\t\t\tt2.parent = B;\r\n\t\t}\r\n\t\tthis.cmd('Disconnect', B.graphicID, A.graphicID);\r\n\t\tthis.cmd('Connect', A.graphicID, B.graphicID, AVL.LINK_COLOR);\r\n\t\tA.parent = B.parent;\r\n\t\tif (this.treeRoot === B) {\r\n\t\t\tthis.treeRoot = A;\r\n\t\t} else {\r\n\t\t\tthis.cmd('Disconnect', B.parent.graphicID, B.graphicID, AVL.LINK_COLOR);\r\n\t\t\tthis.cmd('Connect', B.parent.graphicID, A.graphicID, AVL.LINK_COLOR);\r\n\t\t\tif (B.isLeftChild()) {\r\n\t\t\t\tB.parent.left = A;\r\n\t\t\t} else {\r\n\t\t\t\tB.parent.right = A;\r\n\t\t\t}\r\n\t\t}\r\n\t\tA.right = B;\r\n\t\tB.parent = A;\r\n\t\tB.left = t2;\r\n\t\tthis.cmd('SetHighlight', A.graphicID, 0);\r\n\t\tthis.cmd('SetHighlight', B.graphicID, 0);\r\n\t\tB.updateHeightAndBF();\r\n\t\tthis.cmd('SetText', B.heightLabelID, B.height);\r\n\t\tthis.cmd('SetText', B.bfLabelID, B.bf);\r\n\t\tA.updateHeightAndBF();\r\n\t\tthis.cmd('SetText', A.heightLabelID, A.height);\r\n\t\tthis.cmd('SetText', A.bfLabelID, A.bf);\r\n\t\tthis.resizeTree();\r\n\t\treturn A;\r\n\t}\r\n\r\n\tsingleRotateLeft(tree) {\r\n\t\tconst A = tree;\r\n\t\tconst B = tree.right;\r\n\t\tconst t2 = B.left;\r\n\r\n\t\t// this.cmd('SetText', 0, 'Single Rotate Left');\r\n\t\tthis.cmd('SetEdgeHighlight', A.graphicID, B.graphicID, 1);\r\n\t\tthis.cmd('Step');\r\n\r\n\t\tif (t2 != null) {\r\n\t\t\tthis.cmd('Disconnect', B.graphicID, t2.graphicID);\r\n\t\t\tthis.cmd('Connect', A.graphicID, t2.graphicID, AVL.LINK_COLOR);\r\n\t\t\tt2.parent = A;\r\n\t\t}\r\n\t\tthis.cmd('Disconnect', A.graphicID, B.graphicID);\r\n\t\tthis.cmd('Connect', B.graphicID, A.graphicID, AVL.LINK_COLOR);\r\n\t\tB.parent = A.parent;\r\n\t\tif (this.treeRoot === A) {\r\n\t\t\tthis.treeRoot = B;\r\n\t\t} else {\r\n\t\t\tthis.cmd('Disconnect', A.parent.graphicID, A.graphicID, AVL.LINK_COLOR);\r\n\t\t\tthis.cmd('Connect', A.parent.graphicID, B.graphicID, AVL.LINK_COLOR);\r\n\r\n\t\t\tif (A.isLeftChild()) {\r\n\t\t\t\tA.parent.left = B;\r\n\t\t\t} else {\r\n\t\t\t\tA.parent.right = B;\r\n\t\t\t}\r\n\t\t}\r\n\t\tB.left = A;\r\n\t\tA.parent = B;\r\n\t\tA.right = t2;\r\n\t\tthis.cmd('SetHighlight', A.graphicID, 0);\r\n\t\tthis.cmd('SetHighlight', B.graphicID, 0);\r\n\t\tA.updateHeightAndBF();\r\n\t\tthis.cmd('SetText', A.heightLabelID, A.height);\r\n\t\tthis.cmd('SetText', A.bfLabelID, A.bf);\r\n\t\tB.updateHeightAndBF();\r\n\t\tthis.cmd('SetText', B.heightLabelID, B.height);\r\n\t\tthis.cmd('SetText', B.bfLabelID, B.bf);\r\n\r\n\t\tthis.resizeTree();\r\n\t\treturn B;\r\n\t}\r\n\r\n\tgetHeight(tree) {\r\n\t\tif (tree == null) {\r\n\t\t\treturn -1;\r\n\t\t}\r\n\t\treturn tree.height;\r\n\t}\r\n\r\n\tresetHeight(tree) {\r\n\t\tif (tree != null) {\r\n\t\t\tconst newHeight = Math.max(this.getHeight(tree.left), this.getHeight(tree.right)) + 1;\r\n\t\t\tif (tree.height !== newHeight) {\r\n\t\t\t\ttree.height = Math.max(this.getHeight(tree.left), this.getHeight(tree.right)) + 1;\r\n\t\t\t\tthis.cmd('SetText', tree.heightLabelID, newHeight);\r\n\t\t\t\t//\t\t\tthis.cmd(\"SetText\",tree.heightLabelID, newHeight);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tdeleteNode(curr) {\r\n\t\tthis.cmd('Delete', curr.graphicID);\r\n\t\tthis.cmd('Delete', curr.heightLabelID);\r\n\t\tthis.cmd('Delete', curr.bfLabelID);\r\n\t}\r\n\r\n\tremove(data) {\r\n\t\tthis.commands = [];\r\n\r\n\t\tthis.cmd('SetText', 0, `Deleting ${data}`);\r\n\t\tthis.cmd('Step');\r\n\t\tthis.cmd('SetText', 0, ' ');\r\n\r\n\t\tthis.highlightID = this.nextIndex++;\r\n\t\tthis.treeRoot = this.removeH(this.treeRoot, data);\r\n\t\tthis.resizeTree();\r\n\t\tthis.cmd('SetText', 0, '');\r\n\t\treturn this.commands;\r\n\t}\r\n\r\n\tremoveH(curr, data) {\r\n\t\tif (curr == null) {\r\n\t\t\tthis.cmd('SetText', 0, `${data} not found in the tree`);\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tthis.cmd('SetHighlight', curr.graphicID, 1);\r\n\t\tif (data < curr.data) {\r\n\t\t\tthis.cmd('SetText', 0, `${data} < ${curr.data}. Looking left`);\r\n\t\t\tthis.cmd('Step');\r\n\t\t\tcurr.left = this.removeH(curr.left, data);\r\n\t\t\tif (curr.left != null) {\r\n\t\t\t\tcurr.left.parent = curr;\r\n\t\t\t\tthis.connectSmart(curr.graphicID, curr.left.graphicID);\r\n\t\t\t\tthis.resizeTree();\r\n\t\t\t}\r\n\t\t} else if (data > curr.data) {\r\n\t\t\tthis.cmd('SetText', 0, `${data} > ${curr.data}. Looking right`);\r\n\t\t\tthis.cmd('Step');\r\n\t\t\tcurr.right = this.removeH(curr.right, data);\r\n\t\t\tif (curr.right != null) {\r\n\t\t\t\tcurr.right.parent = curr;\r\n\t\t\t\tthis.connectSmart(curr.graphicID, curr.right.graphicID);\r\n\t\t\t\tthis.resizeTree();\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tif (curr.left == null && curr.right == null) {\r\n\t\t\t\tthis.cmd('SetText', 0, 'Element to delete is a leaf node');\r\n\t\t\t\tthis.cmd('Step');\r\n\t\t\t\tthis.deleteNode(curr);\r\n\t\t\t\treturn null;\r\n\t\t\t} else if (curr.left == null) {\r\n\t\t\t\tthis.cmd('SetText', 0, `One-child case, replace with right child`);\r\n\t\t\t\tthis.cmd('Step');\r\n\t\t\t\tthis.deleteNode(curr);\r\n\t\t\t\treturn curr.right;\r\n\t\t\t} else if (curr.right == null) {\r\n\t\t\t\tthis.cmd('SetText', 0, `One-child case, replace with left child`);\r\n\t\t\t\tthis.cmd('Step');\r\n\t\t\t\tthis.deleteNode(curr);\r\n\t\t\t\treturn curr.left;\r\n\t\t\t} else {\r\n\t\t\t\tconst dummy = [];\r\n\t\t\t\tif (this.predSucc === 'succ') {\r\n\t\t\t\t\tthis.cmd('SetText', 0, `Two-child case, replace data with successor`);\r\n\t\t\t\t\tthis.cmd('Step');\r\n\t\t\t\t\tcurr.right = this.removeSucc(curr.right, dummy);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.cmd('SetText', 0, `Two-child case, replace data with predecessor`);\r\n\t\t\t\t\tthis.cmd('Step');\r\n\t\t\t\t\tcurr.left = this.removePred(curr.left, dummy);\r\n\t\t\t\t}\r\n\t\t\t\tcurr.data = dummy[0];\r\n\t\t\t\tthis.cmd('SetText', curr.graphicID, curr.data);\r\n\t\t\t}\r\n\t\t}\r\n\t\tcurr = this.balance(curr);\r\n\t\tthis.cmd('SetHighlight', curr.graphicID, 0);\r\n\t\tthis.cmd('SetText', 0, '');\r\n\t\treturn curr;\r\n\t}\r\n\r\n\tremoveSucc(curr, dummy) {\r\n\t\tthis.cmd('SetHighlight', curr.graphicID, 1, '#0000ff');\r\n\t\tthis.cmd('Step');\r\n\t\tif (curr.left == null) {\r\n\t\t\tthis.cmd('SetText', 0, 'No left child, replace with right child');\r\n\t\t\tthis.cmd('Step');\r\n\t\t\tdummy.push(curr.data);\r\n\t\t\tthis.deleteNode(curr);\r\n\t\t\treturn curr.right;\r\n\t\t}\r\n\t\tthis.cmd('SetText', 0, 'Left child exists, look left');\r\n\t\tthis.cmd('Step');\r\n\t\tcurr.left = this.removeSucc(curr.left, dummy);\r\n\t\tif (curr.left != null) {\r\n\t\t\tcurr.left.parent = curr;\r\n\t\t\tthis.connectSmart(curr.graphicID, curr.left.graphicID);\r\n\t\t\tthis.resizeTree();\r\n\t\t}\r\n\t\tcurr = this.balance(curr);\r\n\t\tthis.cmd('SetHighlight', curr.graphicID, 0);\r\n\t\tthis.cmd('SetText', 0, '');\r\n\t\treturn curr;\r\n\t}\r\n\r\n\tremovePred(curr, dummy) {\r\n\t\tthis.cmd('SetHighlight', curr.graphicID, 1, '#0000ff');\r\n\t\tthis.cmd('Step');\r\n\t\tif (curr.right == null) {\r\n\t\t\tthis.cmd('SetText', 0, 'No right child, replace with right child');\r\n\t\t\tthis.cmd('Step');\r\n\t\t\tdummy.push(curr.data);\r\n\t\t\tthis.deleteNode(curr);\r\n\t\t\treturn curr.left;\r\n\t\t}\r\n\t\tthis.cmd('SetText', 0, 'Right child exists, look right');\r\n\t\tthis.cmd('Step');\r\n\t\tcurr.right = this.removePred(curr.right, dummy);\r\n\t\tif (curr.right != null) {\r\n\t\t\tcurr.right.parent = curr;\r\n\t\t\tthis.connectSmart(curr.graphicID, curr.right.graphicID);\r\n\t\t\tthis.resizeTree();\r\n\t\t}\r\n\t\tcurr = this.balance(curr);\r\n\t\tthis.cmd('SetHighlight', curr.graphicID, 0);\r\n\t\tthis.cmd('SetText', 0, '');\r\n\t\treturn curr;\r\n\t}\r\n\r\n\tresizeTree() {\r\n\t\tif (this.treeRoot == null) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tlet startingPoint = this.startingX;\r\n\t\tthis.resizeWidths(this.treeRoot);\r\n\t\tif (this.treeRoot != null) {\r\n\t\t\tif (this.treeRoot.leftWidth > startingPoint) {\r\n\t\t\t\tstartingPoint = this.treeRoot.leftWidth;\r\n\t\t\t} else if (this.treeRoot.rightWidth > startingPoint) {\r\n\t\t\t\tstartingPoint = Math.max(\r\n\t\t\t\t\tthis.treeRoot.leftWidth,\r\n\t\t\t\t\t2 * startingPoint - this.treeRoot.rightWidth\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t\tthis.setNewPositions(this.treeRoot, startingPoint, AVL.STARTING_Y, 0);\r\n\t\t\tthis.animateNewPositions(this.treeRoot);\r\n\t\t\tthis.cmd('Step');\r\n\t\t}\r\n\t}\r\n\r\n\tsetNewPositions(tree, xPosition, yPosition, side) {\r\n\t\tif (tree != null) {\r\n\t\t\ttree.y = yPosition;\r\n\t\t\tif (side === -1) {\r\n\t\t\t\txPosition = xPosition - tree.rightWidth;\r\n\t\t\t\ttree.heightLabelX = xPosition - 20;\r\n\t\t\t\ttree.bfLabelX = xPosition + 20;\r\n\t\t\t} else if (side === 1) {\r\n\t\t\t\txPosition = xPosition + tree.leftWidth;\r\n\t\t\t\ttree.heightLabelX = xPosition - 20;\r\n\t\t\t\ttree.bfLabelX = xPosition + 20;\r\n\t\t\t} else {\r\n\t\t\t\ttree.heightLabelX = xPosition - 20;\r\n\t\t\t\ttree.bfLabelX = xPosition + 20;\r\n\t\t\t}\r\n\t\t\ttree.x = xPosition;\r\n\t\t\ttree.heightLabelY = tree.y - 20;\r\n\t\t\ttree.bfLabelY = tree.y - 20;\r\n\t\t\tthis.setNewPositions(tree.left, xPosition, yPosition + AVL.HEIGHT_DELTA, -1);\r\n\t\t\tthis.setNewPositions(tree.right, xPosition, yPosition + AVL.HEIGHT_DELTA, 1);\r\n\t\t}\r\n\t}\r\n\r\n\tanimateNewPositions(tree) {\r\n\t\tif (tree != null) {\r\n\t\t\tthis.cmd('Move', tree.graphicID, tree.x, tree.y);\r\n\t\t\tthis.cmd('Move', tree.heightLabelID, tree.heightLabelX, tree.heightLabelY);\r\n\t\t\tthis.cmd('Move', tree.bfLabelID, tree.bfLabelX, tree.bfLabelY);\r\n\t\t\tthis.animateNewPositions(tree.left);\r\n\t\t\tthis.animateNewPositions(tree.right);\r\n\t\t}\r\n\t}\r\n\r\n\tresizeWidths(tree) {\r\n\t\tif (tree == null) {\r\n\t\t\treturn 0;\r\n\t\t}\r\n\t\ttree.leftWidth = Math.max(this.resizeWidths(tree.left), AVL.WIDTH_DELTA / 2);\r\n\t\ttree.rightWidth = Math.max(this.resizeWidths(tree.right), AVL.WIDTH_DELTA / 2);\r\n\t\treturn tree.leftWidth + tree.rightWidth;\r\n\t}\r\n\r\n\tclear() {\r\n\t\tthis.commands = [];\r\n\t\tthis.recClear(this.treeRoot);\r\n\t\tthis.treeRoot = null;\r\n\t\treturn this.commands;\r\n\t}\r\n\r\n\trecClear(curr) {\r\n\t\tif (curr != null) {\r\n\t\t\tthis.cmd('Delete', curr.graphicID);\r\n\t\t\tthis.cmd('Delete', curr.heightLabelID);\r\n\t\t\tthis.cmd('Delete', curr.bfLabelID);\r\n\t\t\tthis.recClear(curr.left);\r\n\t\t\tthis.recClear(curr.right);\r\n\t\t}\r\n\t}\r\n\r\n\tdisableUI() {\r\n\t\tfor (let i = 0; i < this.controls.length; i++) {\r\n\t\t\tthis.controls[i].disabled = true;\r\n\t\t}\r\n\t}\r\n\r\n\tenableUI() {\r\n\t\tfor (let i = 0; i < this.controls.length; i++) {\r\n\t\t\tthis.controls[i].disabled = false;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nclass AVLNode {\r\n\tconstructor(val, id, hid, bfid, initialX, initialY) {\r\n\t\tthis.data = val;\r\n\t\tthis.x = initialX;\r\n\t\tthis.y = initialY;\r\n\t\tthis.heightLabelID = hid;\r\n\t\tthis.bfLabelID = bfid;\r\n\t\tthis.height = 0;\r\n\t\tthis.bf = 0;\r\n\r\n\t\tthis.graphicID = id;\r\n\t\tthis.left = null;\r\n\t\tthis.right = null;\r\n\t\tthis.parent = null;\r\n\t}\r\n\r\n\tupdateHeightAndBF() {\r\n\t\tconst h = node => (node == null ? -1 : node.height);\r\n\t\tconst l = h(this.left);\r\n\t\tconst r = h(this.right);\r\n\t\tthis.height = Math.max(l, r) + 1;\r\n\t\tthis.bf = l - r;\r\n\t}\r\n\r\n\tisLeftChild() {\r\n\t\tif (this.parent == null) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\treturn this.parent.left === this;\r\n\t}\r\n}\r\n\r\n// Various constants\r\n\r\nAVL.HIGHLIGHT_LABEL_COLOR = '#FF0000';\r\nAVL.HIGHLIGHT_LINK_COLOR = '#FF0000';\r\n\r\nAVL.HIGHLIGHT_COLOR = '#007700';\r\nAVL.HEIGHT_LABEL_COLOR = '#007700';\r\n\r\nAVL.LINK_COLOR = '#00B000';\r\nAVL.HIGHLIGHT_CIRCLE_COLOR = '#007700';\r\nAVL.FOREGROUND_COLOR = '0x007700';\r\nAVL.BACKGROUND_COLOR = '#DDFFDD';\r\nAVL.PRINT_COLOR = AVL.FOREGROUND_COLOR;\r\n\r\nAVL.WIDTH_DELTA = 50;\r\nAVL.HEIGHT_DELTA = 50;\r\nAVL.STARTING_Y = 50;\r\n\r\nAVL.FIRST_PRINT_POS_X = 50;\r\nAVL.PRINT_VERTICAL_GAP = 20;\r\nAVL.PRINT_HORIZONTAL_GAP = 50;\r\nAVL.EXPLANITORY_TEXT_X = 10;\r\nAVL.EXPLANITORY_TEXT_Y = 10;\r\n","/* eslint-disable lines-between-class-members */\r\n// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\r\n//\r\n// Redistribution and use in source and binary forms, with or without modification, are\r\n// permitted provided that the following conditions are met:\r\n//\r\n// 1. Redistributions of source code must retain the above copyright notice, this list of\r\n// conditions and the following disclaimer.\r\n//\r\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\r\n// of conditions and the following disclaimer in the documentation and/or other materials\r\n// provided with the distribution.\r\n//\r\n// THIS SOFTWARE IS PROVIDED BY David Galles ``AS IS'' AND ANY EXPRESS OR IMPLIED\r\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\r\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\r\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\r\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\r\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\r\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\r\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\r\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\r\n//\r\n// The views and conclusions contained in the software and documentation are those of the\r\n// authors and should not be interpreted as representing official policies, either expressed\r\n// or implied, of the University of San Francisco\r\n\r\nimport Algorithm, { addControlToAlgorithmBar, addLabelToAlgorithmBar } from './Algorithm';\r\n\r\nconst ARRAY_START_X = 100;\r\nconst ARRAY_START_Y = 200;\r\nconst ARRAY_ELEM_WIDTH = 50;\r\nconst ARRAY_ELEM_HEIGHT = 50;\r\n\r\nconst ARRRAY_ELEMS_PER_LINE = 15;\r\nconst ARRAY_LINE_SPACING = 130;\r\n\r\n// const TOP_POS_X = 180;\r\n// const TOP_POS_Y = 100;\r\n// const TOP_LABEL_X = 130;\r\n// const TOP_LABEL_Y =  100;\r\n\r\nconst PUSH_LABEL_X = 50;\r\nconst PUSH_LABEL_Y = 30;\r\nconst PUSH_ELEMENT_X = 120;\r\nconst PUSH_ELEMENT_Y = 30;\r\n\r\nconst SIZE = 10;\r\n\r\nexport default class ArrayList extends Algorithm {\r\n\tconstructor(am, w, h) {\r\n\t\tsuper(am, w, h);\r\n\t\tthis.addControls();\r\n\r\n\t\t// Useful for memory management\r\n\t\tthis.nextIndex = 0;\r\n\r\n\t\t// TODO:  Add any code necessary to set up your own algorithm.  Initialize data\r\n\t\t// structures, etc.\r\n\t\tthis.setup();\r\n\t}\r\n\r\n\taddControls() {\r\n\t\tthis.controls = [];\r\n\r\n\t\taddLabelToAlgorithmBar('Value');\r\n\r\n\t\t// Add's value text field\r\n\t\tthis.addValueField = addControlToAlgorithmBar('Text', '');\r\n\t\tthis.addValueField.onkeydown = this.returnSubmit(\r\n\t\t\tthis.addValueField,\r\n\t\t\t() => this.addIndexCallback(),\r\n\t\t\t4,\r\n\t\t\ttrue\r\n\t\t);\r\n\t\tthis.controls.push(this.addValueField);\r\n\r\n\t\taddLabelToAlgorithmBar('at index');\r\n\r\n\t\t// Add's index text field\r\n\t\tthis.addIndexField = addControlToAlgorithmBar('Text', '');\r\n\t\tthis.addIndexField.onkeydown = this.returnSubmit(\r\n\t\t\tthis.addIndexField,\r\n\t\t\t() => this.addIndexCallback(),\r\n\t\t\t4,\r\n\t\t\ttrue\r\n\t\t);\r\n\t\tthis.controls.push(this.addIndexField);\r\n\r\n\t\t// Add at index button\r\n\t\tthis.addIndexButton = addControlToAlgorithmBar('Button', 'Add at Index');\r\n\t\tthis.addIndexButton.onclick = this.addIndexCallback.bind(this);\r\n\t\tthis.controls.push(this.addIndexButton);\r\n\r\n\t\taddLabelToAlgorithmBar('or');\r\n\r\n\t\t// Add to front button\r\n\t\tthis.addFrontButton = addControlToAlgorithmBar('Button', 'Add to Front');\r\n\t\tthis.addFrontButton.onclick = this.addFrontCallback.bind(this);\r\n\t\tthis.controls.push(this.addFrontButton);\r\n\r\n\t\t// Add to back button\r\n\t\tthis.addBackButton = addControlToAlgorithmBar('Button', 'Add to Back');\r\n\t\tthis.addBackButton.onclick = () => this.addBackCallback();\r\n\t\tthis.controls.push(this.addBackButton);\r\n\r\n\t\t// Remove's index text field\r\n\t\tthis.removeField = addControlToAlgorithmBar('Text', '');\r\n\t\tthis.removeField.onkeydown = this.returnSubmit(\r\n\t\t\tthis.removeField,\r\n\t\t\t() => this.removeIndexCallback(),\r\n\t\t\t4,\r\n\t\t\ttrue\r\n\t\t);\r\n\t\tthis.controls.push(this.removeField);\r\n\r\n\t\t// Remove from index button\r\n\t\tthis.removeIndexButton = addControlToAlgorithmBar('Button', 'Remove from Index');\r\n\t\tthis.removeIndexButton.onclick = () => this.removeIndexCallback();\r\n\t\tthis.controls.push(this.removeIndexButton);\r\n\r\n\t\taddLabelToAlgorithmBar('or');\r\n\r\n\t\t// Remove from front button\r\n\t\tthis.removeFrontButton = addControlToAlgorithmBar('Button', 'Remove from Front');\r\n\t\tthis.removeFrontButton.onclick = () => this.removeFrontCallback();\r\n\t\tthis.controls.push(this.removeFrontButton);\r\n\r\n\t\t// Remove from back button\r\n\t\tthis.removeBackButton = addControlToAlgorithmBar('Button', 'Remove from Back');\r\n\t\tthis.removeBackButton.onclick = () => this.removeBackCallback();\r\n\t\tthis.controls.push(this.removeBackButton);\r\n\r\n\t\t// Get's index text field\r\n\t\t// this.getField = addControlToAlgorithmBar(\"Text\", \"\");\r\n\t\t// this.getField.onkeydown = this.returnSubmit(this.getField, () => this.getCallback(), 4, true);\r\n\t\t// this.controls.push(this.getField);\r\n\r\n\t\t// Get button\r\n\t\t// this.getButton = addControlToAlgorithmBar(\"Button\", \"Get\");\r\n\t\t// this.getButton.onclick = () => this.getCallback();\r\n\t\t// this.controls.push(this.getButton);\r\n\r\n\t\t// Clear button\r\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear');\r\n\t\tthis.clearButton.onclick = () => this.clearCallback();\r\n\t\tthis.controls.push(this.clearButton);\r\n\t}\r\n\tsetup() {\r\n\t\tthis.arrayData = new Array(SIZE);\r\n\t\tthis.arrayID = new Array(SIZE);\r\n\t\tthis.arrayLabelID = new Array(SIZE);\r\n\t\tfor (let i = 0; i < SIZE; i++) {\r\n\t\t\tthis.arrayData[i] = 0;\r\n\t\t\tthis.arrayID[i] = this.nextIndex++;\r\n\t\t\tthis.arrayLabelID[i] = this.nextIndex++;\r\n\t\t}\r\n\r\n\t\tthis.size = 0;\r\n\t\tthis.commands = [];\r\n\r\n\t\tfor (let i = 0; i < SIZE; i++) {\r\n\t\t\tconst xpos = (i % ARRRAY_ELEMS_PER_LINE) * ARRAY_ELEM_WIDTH + ARRAY_START_X;\r\n\t\t\tconst ypos = Math.floor(i / ARRRAY_ELEMS_PER_LINE) * ARRAY_LINE_SPACING + ARRAY_START_Y;\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'CreateRectangle',\r\n\t\t\t\tthis.arrayID[i],\r\n\t\t\t\t'',\r\n\t\t\t\tARRAY_ELEM_WIDTH,\r\n\t\t\t\tARRAY_ELEM_HEIGHT,\r\n\t\t\t\txpos,\r\n\t\t\t\typos\r\n\t\t\t);\r\n\t\t\tthis.cmd('CreateLabel', this.arrayLabelID[i], i, xpos, ypos + ARRAY_ELEM_HEIGHT);\r\n\t\t\tthis.cmd('SetForegroundColor', this.arrayLabelID[i], '#0000FF');\r\n\t\t}\r\n\r\n\t\tthis.highlight1ID = this.nextIndex++;\r\n\t\tthis.highlight2ID = this.nextIndex++;\r\n\r\n\t\tthis.animationManager.StartNewAnimation(this.commands);\r\n\t\tthis.animationManager.skipForward();\r\n\t\tthis.animationManager.clearHistory();\r\n\t}\r\n\treset() {\r\n\t\t// Reset all of your data structures to *exactly* the state they have immediately after the init\r\n\t\t// function is called.  This method is called whenever an \"undo\" is performed.  Your data\r\n\t\t// structures are completely cleaned, and then all of the actions *up to but not including* the\r\n\t\t// last action are then redone.  If you implement all of your actions through the \"implementAction\"\r\n\t\t// method below, then all of this work is done for you in the Animation \"superclass\"\r\n\r\n\t\t// Reset the (very simple) memory manager\r\n\t\tthis.nextIndex = 0;\r\n\t\tthis.size = 0;\r\n\t\tfor (let i = 0; i < SIZE; i++) {\r\n\t\t\tthis.arrayData[i] = 0;\r\n\t\t\tthis.arrayID[i] = this.nextIndex++;\r\n\t\t\tthis.arrayLabelID[i] = this.nextIndex++;\r\n\t\t}\r\n\t}\r\n\taddIndexCallback() {\r\n\t\tif (\r\n\t\t\tthis.addValueField.value !== '' &&\r\n\t\t\tthis.addIndexField.value !== '' &&\r\n\t\t\tthis.size < SIZE\r\n\t\t) {\r\n\t\t\tconst addVal = this.addValueField.value;\r\n\t\t\tconst index = this.addIndexField.value;\r\n\t\t\tif (index >= 0 && index <= this.size) {\r\n\t\t\t\tthis.addValueField.value = '';\r\n\t\t\t\tthis.addIndexField.value = '';\r\n\t\t\t\tthis.implementAction(_ => this.add(_), addVal + ',' + index);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\taddFrontCallback() {\r\n\t\tif (this.addValueField.value !== '' && this.size < SIZE) {\r\n\t\t\tconst addVal = this.addValueField.value;\r\n\t\t\tthis.addValueField.value = '';\r\n\t\t\tthis.implementAction(_ => this.add(_), addVal + ',' + 0);\r\n\t\t}\r\n\t}\r\n\taddBackCallback() {\r\n\t\tif (this.addValueField.value !== '' && this.size < SIZE) {\r\n\t\t\tconst addVal = this.addValueField.value;\r\n\t\t\tthis.addValueField.value = '';\r\n\t\t\tthis.implementAction(_ => this.add(_), addVal + ',' + this.size);\r\n\t\t}\r\n\t}\r\n\r\n\tremoveIndexCallback() {\r\n\t\tif (this.removeField.value !== '') {\r\n\t\t\tconst index = this.removeField.value;\r\n\t\t\tif (index >= 0 && index < this.size) {\r\n\t\t\t\tthis.removeField.value = '';\r\n\t\t\t\tthis.implementAction(_ => this.remove(_), index);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tremoveFrontCallback() {\r\n\t\tif (this.size > 0) {\r\n\t\t\tthis.implementAction(_ => this.remove(_), 0);\r\n\t\t}\r\n\t}\r\n\r\n\tremoveBackCallback() {\r\n\t\tif (this.size > 0) {\r\n\t\t\tthis.implementAction(_ => this.remove(_), this.size - 1);\r\n\t\t}\r\n\t}\r\n\r\n\tclearCallback() {\r\n\t\tthis.implementAction(() => this.clear(), '');\r\n\t}\r\n\r\n\tclear() {\r\n\t\tthis.commands = [];\r\n\t\tthis.clearAll();\r\n\t\treturn this.commands;\r\n\t}\r\n\r\n\tadd(params) {\r\n\t\tthis.commands = [];\r\n\r\n\t\tconst elemToAdd = parseInt(params.split(',')[0]);\r\n\t\tconst index = parseInt(params.split(',')[1]);\r\n\t\tconst labPushID = this.nextIndex++;\r\n\t\tconst labPushValID = this.nextIndex++;\r\n\r\n\t\tfor (let i = this.size - 1; i >= index; i--) {\r\n\t\t\tthis.arrayData[i + 1] = this.arrayData[i];\r\n\t\t}\r\n\t\tthis.arrayData[index] = elemToAdd;\r\n\r\n\t\tthis.cmd('CreateLabel', labPushID, 'Adding Value: ', PUSH_LABEL_X, PUSH_LABEL_Y);\r\n\t\tthis.cmd('CreateLabel', labPushValID, elemToAdd, PUSH_ELEMENT_X, PUSH_ELEMENT_Y);\r\n\t\tthis.cmd('Step');\r\n\r\n\t\tfor (let i = this.size - 1; i >= index; i--) {\r\n\t\t\tconst xpos = (i % ARRRAY_ELEMS_PER_LINE) * ARRAY_ELEM_WIDTH + ARRAY_START_X;\r\n\t\t\tconst ypos = Math.floor(i / ARRRAY_ELEMS_PER_LINE) * ARRAY_LINE_SPACING + ARRAY_START_Y;\r\n\t\t\tconst presentID = this.nextIndex + i;\r\n\t\t\tthis.cmd('CreateLabel', presentID, this.arrayData[i + 1], xpos, ypos);\r\n\t\t\tthis.cmd('Settext', this.arrayID[i], '');\r\n\t\t\tthis.cmd('Move', presentID, xpos + ARRAY_ELEM_WIDTH, ypos);\r\n\t\t}\r\n\t\tthis.cmd('Step');\r\n\r\n\t\tfor (let i = this.size - 1; i >= index; i--) {\r\n\t\t\tconst presentID = this.nextIndex + i;\r\n\t\t\tthis.cmd('Settext', this.arrayID[i + 1], this.arrayData[i + 1]);\r\n\t\t\tthis.cmd('Delete', presentID);\r\n\t\t}\r\n\t\tthis.cmd('Step');\r\n\r\n\t\tthis.nextIndex += this.size - index;\r\n\r\n\t\tthis.cmd(\r\n\t\t\t'CreateHighlightCircle',\r\n\t\t\tthis.highlight1ID,\r\n\t\t\t'#0000FF',\r\n\t\t\tPUSH_ELEMENT_X,\r\n\t\t\tPUSH_ELEMENT_Y\r\n\t\t);\r\n\t\tthis.cmd('Step');\r\n\r\n\t\tconst xpos = (parseInt(index) % ARRRAY_ELEMS_PER_LINE) * ARRAY_ELEM_WIDTH + ARRAY_START_X;\r\n\t\tconst ypos =\r\n\t\t\tMath.floor(parseInt(index) / ARRRAY_ELEMS_PER_LINE) * ARRAY_LINE_SPACING +\r\n\t\t\tARRAY_START_Y;\r\n\r\n\t\tthis.cmd('Move', this.highlight1ID, xpos, ypos);\r\n\t\tthis.cmd('Move', labPushValID, xpos, ypos);\r\n\t\tthis.cmd('Step');\r\n\r\n\t\tthis.cmd('Settext', this.arrayID[index], elemToAdd);\r\n\t\tthis.cmd('Delete', labPushValID);\r\n\t\tthis.cmd('Delete', this.highlight1ID);\r\n\t\tthis.cmd('Step');\r\n\r\n\t\tthis.cmd('Delete', labPushID);\r\n\t\tthis.cmd('Step');\r\n\r\n\t\tthis.size = this.size + 1;\r\n\t\treturn this.commands;\r\n\t}\r\n\r\n\tremove(index) {\r\n\t\tthis.commands = [];\r\n\r\n\t\tindex = parseInt(index);\r\n\t\tconst labPopValID = this.nextIndex++;\r\n\r\n\t\tconst xpos = (index % ARRRAY_ELEMS_PER_LINE) * ARRAY_ELEM_WIDTH + ARRAY_START_X;\r\n\t\tconst ypos = Math.floor(index / ARRRAY_ELEMS_PER_LINE) * ARRAY_LINE_SPACING + ARRAY_START_Y;\r\n\r\n\t\tthis.cmd('CreateHighlightCircle', this.highlight1ID, '#0000FF', xpos, ypos);\r\n\t\tthis.cmd('CreateLabel', labPopValID, this.arrayData[index], xpos, ypos);\r\n\t\tthis.cmd('Settext', this.arrayID[index], '');\r\n\t\tthis.cmd('Move', this.highlight1ID, xpos, ypos - 100);\r\n\t\tthis.cmd('Move', labPopValID, xpos, ypos - 100);\r\n\t\tthis.cmd('Step');\r\n\r\n\t\tthis.cmd('Delete', labPopValID);\r\n\t\tthis.cmd('Delete', this.highlight1ID);\r\n\t\tthis.cmd('Step');\r\n\r\n\t\tfor (let i = index + 1; i < this.size; i++) {\r\n\t\t\tconst xpos = (i % ARRRAY_ELEMS_PER_LINE) * ARRAY_ELEM_WIDTH + ARRAY_START_X;\r\n\t\t\tconst ypos = Math.floor(i / ARRRAY_ELEMS_PER_LINE) * ARRAY_LINE_SPACING + ARRAY_START_Y;\r\n\t\t\tconst presentID = this.nextIndex + i;\r\n\t\t\tthis.cmd('CreateLabel', presentID, this.arrayData[i], xpos, ypos);\r\n\t\t\tthis.cmd('Settext', this.arrayID[i], '');\r\n\t\t\tthis.cmd('Move', presentID, xpos - ARRAY_ELEM_WIDTH, ypos);\r\n\t\t}\r\n\t\tthis.cmd('Step');\r\n\r\n\t\tfor (let i = index + 1; i < this.size; i++) {\r\n\t\t\tconst presentID = this.nextIndex + i;\r\n\t\t\tthis.cmd('Settext', this.arrayID[i - 1], this.arrayData[i]);\r\n\t\t\tthis.cmd('Delete', presentID);\r\n\t\t}\r\n\t\tthis.cmd('Step');\r\n\r\n\t\tfor (let i = index; i < this.size; i++) {\r\n\t\t\tthis.arrayData[i] = this.arrayData[i + 1];\r\n\t\t}\r\n\r\n\t\tthis.size = this.size - 1;\r\n\t\treturn this.commands;\r\n\t}\r\n\r\n\tclearAll() {\r\n\t\tthis.commands = [];\r\n\t\tfor (let i = 0; i < this.size; i++) {\r\n\t\t\tthis.cmd('SetText', this.arrayID[i], '');\r\n\t\t}\r\n\t\tthis.size = 0;\r\n\t\treturn this.commands;\r\n\t}\r\n\r\n\t// Called by our superclass when we get an animation started event -- need to wait for the\r\n\t// event to finish before we start doing anything\r\n\tdisableUI() {\r\n\t\tfor (let i = 0; i < this.controls.length; i++) {\r\n\t\t\tthis.controls[i].disabled = true;\r\n\t\t}\r\n\t}\r\n\r\n\t// Called by our superclass when we get an animation completed event -- we can\r\n\t/// now interact again.\r\n\tenableUI() {\r\n\t\tfor (let i = 0; i < this.controls.length; i++) {\r\n\t\t\tthis.controls[i].disabled = false;\r\n\t\t}\r\n\t}\r\n}","const LARGE_ALLOWED = [[false, true, true, false, true, false, false, true, false, false, false, false, false, false, true, false, false, false],\r\n\t\t\t\t\t\t\t\t\t[true, false, true, false, true, true,  false, false, false, false, false, false, false, false, false, false, false, false],\r\n\t\t\t\t\t\t\t\t\t[true, true, false, true,  false, true, true,  false, false, false, false, false, false, false, false, false, false, false],\r\n\t\t\t\t\t\t\t\t\t[false, false, true, false, false,false, true, false, false, false, true, false, false,  false, false, false, false, true],\r\n\t\t\t\t\t\t\t\t\t[true, true, false, false,  false, true, false, true, true, false, false, false, false, false, false, false,  false,  false],\r\n\t\t\t\t\t\t\t\t\t[false, true, true, false, true, false, true,   false, true, true, false, false, false, false, false, false,  false,  false],\r\n\t\t\t\t\t\t\t\t\t[false, false, true, true, false, true, false, false, false, true, true, false, false, false, false, false,  false,  false],\r\n\t\t\t\t\t\t\t\t\t[true, false, false, false, true, false, false, false, true, false, false, true, false, false, true, false, false, false],\r\n\t\t\t\t\t\t\t\t\t[false, false, false, false, true, true, false, true, false, true, false, true, true, false,   false, false, false, false],\r\n\t\t\t\t\t\t\t\t\t[false, false, false, false, false, true, true, false, true, false, true, false, true, true,  false,  false, false, false],\r\n\t\t\t\t\t\t\t\t\t[false, false, false, true, false,  false, true, false, false, true, false, false, false, true, false, false, false, true],\r\n\t\t\t\t\t\t\t\t\t[false, false, false, false, false, false, false, true, true, false, false, false, true, false, true, true, false, false],\r\n\t\t\t\t\t\t\t\t\t[false, false, false, false, false, false, false, false, true, true, false, true, false, true, false, true, true, false],\r\n\t\t\t\t\t\t\t\t\t[false, false, false, false, false, false, false, false, false, true, true, false, true, false, false, false, true, true],\r\n\t\t\t\t\t\t\t\t\t[false, false, false, false, false, false, false, true, false, false, false, true, false, false, false, true, false, false],\r\n\t\t\t\t\t\t\t\t\t[false, false, false, false, false, false, false, false, false, false, false, true, true, false, true, false, true, true],\r\n\t\t\t\t\t\t\t\t\t[false, false, false, false, false, false, false, false, false, false, false, false, true, true, false, true, false, true],\r\n\t\t\t\t\t\t\t\t\t[false, false, false, false, false, false, false, false, false, false, true, false, false, true, false, true, true, false]];\r\n\r\nconst LARGE_CURVE  = [[0, 0, -0.4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.25, 0, 0, 0],\r\n\t\t\t\t\t\t\t\t[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\r\n\t\t\t\t\t\t\t\t[0.4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\r\n\t\t\t\t\t\t\t\t[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -0.25],\r\n\t\t\t\t\t\t\t\t[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\r\n\t\t\t\t\t\t\t\t[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\r\n\t\t\t\t\t\t\t\t[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\r\n\t\t\t\t\t\t\t\t[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\r\n\t\t\t\t\t\t\t\t[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\r\n\t\t\t\t\t\t\t\t[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\r\n\t\t\t\t\t\t\t\t[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\r\n\t\t\t\t\t\t\t\t[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\r\n\t\t\t\t\t\t\t\t[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\r\n\t\t\t\t\t\t\t\t[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\r\n\t\t\t\t\t\t\t\t[-0.25, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\r\n\t\t\t\t\t\t\t\t[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.4],\r\n\t\t\t\t\t\t\t\t[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\r\n\t\t\t\t\t\t\t\t[0, 0, 0, 0.25, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -0.4, 0, 0]]\r\n\r\n\r\n\r\nconst LARGE_X_POS_LOGICAL = [600, 700, 800, 900,\r\n\t\t\t\t\t\t\t\t\t\t650, 750, 850,\r\n\t\t\t\t\t\t\t\t\t\t600, 700, 800, 900,\r\n\t\t\t\t\t\t\t\t\t\t650, 750, 850,\r\n\t\t\t\t\t\t\t\t\t\t600, 700, 800, 900];\r\n\r\n\r\nconst LARGE_Y_POS_LOGICAL = [50, 50, 50, 50,\r\n\t\t\t\t\t\t\t\t\t\t150, 150, 150,\r\n\t\t\t\t\t\t\t\t\t\t250, 250, 250, 250,\r\n\t\t\t\t\t\t\t\t\t\t350, 350, 350,\r\n\t\t\t\t\t\t\t\t\t\t450,  450, 450, 450];\r\n\r\n\r\nconst SMALL_ALLLOWED = [[false, true,  true,  true,  true,  false, false, false],\r\n\t\t\t\t\t\t\t\t\t[true,  false, true,  true,  false, true,  true,  false],\r\n\t\t\t\t\t\t\t\t\t[true,  true,  false, false, true,  true,  true,  false],\r\n\t\t\t\t\t\t\t\t\t[true,  true,  false, false, false, true,  false, true],\r\n\t\t\t\t\t\t\t\t\t[true,  false, true,  false, false,  false, true,  true],\r\n\t\t\t\t\t\t\t\t\t[false, true,  true,  true,  false, false, true,  true],\r\n\t\t\t\t\t\t\t\t\t[false, true,  true,  false, true,  true,  false, true],\r\n\t\t\t\t\t\t\t\t\t[false, false, false, true,  true,  true,  true,  false]];\r\n\r\nconst SMALL_CURVE = [[0, 0.001, 0, 0.5, -0.5, 0, 0, 0],\r\n\t\t\t\t\t\t\t\t[0, 0, 0, 0.001, 0, 0.001, -0.2, 0],\r\n\t\t\t\t\t\t\t\t[0, 0.001, 0, 0, 0, 0.2, 0, 0],\r\n\t\t\t\t\t\t\t\t[-0.5, 0, 0, 0, 0, 0.001, 0, 0.5],\r\n\t\t\t\t\t\t\t\t[0.5, 0, 0, 0, 0, 0, 0, -0.5],\r\n\t\t\t\t\t\t\t\t[0, 0, -0.2, 0, 0, 0, 0.001, 0.001],\r\n\t\t\t\t\t\t\t\t[0, 0.2, 0, 0, 0, 0, 0, 0],\r\n                                [0, 0, 0, -0.5, 0.5, 0, 0, 0]];\r\n                                \r\n                                \r\nconst SMALL_X_POS_LOGICAL = [800, 725, 875, 650, 950, 725, 875, 800];\r\nconst SMALL_Y_POS_LOGICAL = [25, 125, 125, 225, 225, 325, 325, 425];\r\n\r\nexport { LARGE_ALLOWED, LARGE_CURVE, LARGE_X_POS_LOGICAL, LARGE_Y_POS_LOGICAL, SMALL_X_POS_LOGICAL, SMALL_Y_POS_LOGICAL, SMALL_ALLLOWED, SMALL_CURVE };","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\r\n//\r\n// Redistribution and use in source and binary forms, with or without modification, are\r\n// permitted provided that the following conditions are met:\r\n//\r\n// 1. Redistributions of source code must retain the above copyright notice, this list of\r\n// conditions and the following disclaimer.\r\n//\r\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\r\n// of conditions and the following disclaimer in the documentation and/or other materials\r\n// provided with the distribution.\r\n//\r\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\r\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\r\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\r\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\r\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\r\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\r\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\r\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\r\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\r\n//\r\n// The views and conclusions contained in the software and documentation are those of the\r\n// authors and should not be interpreted as representing official policies, either expressed\r\n// or implied, of the University of San Francisco\r\n\r\n// TODO:  UNDO (all the way) is BROKEN.  Redo reset ...\r\n\r\nimport Algorithm, {\r\n\taddControlToAlgorithmBar,\r\n\taddRadioButtonGroupToAlgorithmBar,\r\n} from './Algorithm.js';\r\nimport {\r\n\tLARGE_ALLOWED,\r\n\tLARGE_CURVE,\r\n\tLARGE_X_POS_LOGICAL,\r\n\tLARGE_Y_POS_LOGICAL,\r\n\tSMALL_ALLLOWED,\r\n\tSMALL_CURVE,\r\n\tSMALL_X_POS_LOGICAL,\r\n\tSMALL_Y_POS_LOGICAL,\r\n} from './util/GraphUtil.js';\r\n\r\nconst SMALL_ADJ_MATRIX_X_START = 700;\r\nconst SMALL_ADJ_MATRIX_Y_START = 40;\r\nconst SMALL_ADJ_MATRIX_WIDTH = 30;\r\nconst SMALL_ADJ_MATRIX_HEIGHT = 30;\r\n\r\nconst SMALL_ADJ_LIST_X_START = 600;\r\nconst SMALL_ADJ_LIST_Y_START = 30;\r\n\r\nconst SMALL_ADJ_LIST_ELEM_WIDTH = 50;\r\nconst SMALL_ADJ_LIST_ELEM_HEIGHT = 30;\r\n\r\nconst SMALL_ADJ_LIST_HEIGHT = 36;\r\nconst SMALL_ADJ_LIST_WIDTH = 36;\r\n\r\nconst SMALL_ADJ_LIST_SPACING = 10;\r\n\r\nconst LARGE_ADJ_MATRIX_X_START = 575;\r\nconst LARGE_ADJ_MATRIX_Y_START = 30;\r\nconst LARGE_ADJ_MATRIX_WIDTH = 23;\r\nconst LARGE_ADJ_MATRIX_HEIGHT = 23;\r\n\r\nconst LARGE_ADJ_LIST_X_START = 600;\r\nconst LARGE_ADJ_LIST_Y_START = 30;\r\n\r\nconst LARGE_ADJ_LIST_ELEM_WIDTH = 50;\r\nconst LARGE_ADJ_LIST_ELEM_HEIGHT = 26;\r\n\r\nconst LARGE_ADJ_LIST_HEIGHT = 30;\r\nconst LARGE_ADJ_LIST_WIDTH = 30;\r\n\r\nconst LARGE_ADJ_LIST_SPACING = 10;\r\n\r\nexport const VERTEX_INDEX_COLOR = '#0000FF';\r\nexport const EDGE_COLOR = '#000000';\r\n\r\nexport const SMALL_SIZE = 8;\r\nexport const LARGE_SIZE = 18;\r\n\r\nexport default class Graph extends Algorithm {\r\n\tconstructor(am, w, h, dir, dag) {\r\n\t\tsuper(am, w, h);\r\n\t\tdir = dir === undefined ? true : dir;\r\n\t\tdag = dag === undefined ? false : dag;\r\n\r\n\t\t// Graph.superclass.init.call(this, am, w, h);\r\n\t\tthis.nextIndex = 0;\r\n\r\n\t\tthis.currentLayer = 1;\r\n\t\tthis.isDAG = dag;\r\n\t\tthis.directed = dir;\r\n\t\tthis.currentLayer = 1;\r\n\t\tthis.addControls();\r\n\r\n\t\tthis.setup_small();\r\n\t}\r\n\r\n\taddControls(addDirection) {\r\n\t\tif (addDirection == null) {\r\n\t\t\taddDirection = true;\r\n\t\t}\r\n\t\tthis.newGraphButton = addControlToAlgorithmBar('Button', 'New Graph');\r\n\t\tthis.newGraphButton.onclick = this.newGraphCallback.bind(this);\r\n\r\n\t\tif (addDirection) {\r\n\t\t\tconst radioButtonList = addRadioButtonGroupToAlgorithmBar(\r\n\t\t\t\t['Directed Graph', 'Undirected Graph'],\r\n\t\t\t\t'GraphType'\r\n\t\t\t);\r\n\t\t\tthis.directedGraphButton = radioButtonList[0];\r\n\t\t\tthis.directedGraphButton.onclick = this.directedGraphCallback.bind(this, true);\r\n\t\t\tthis.undirectedGraphButton = radioButtonList[1];\r\n\t\t\tthis.undirectedGraphButton.onclick = this.directedGraphCallback.bind(this, false);\r\n\t\t\tthis.directedGraphButton.checked = this.directed;\r\n\t\t\tthis.undirectedGraphButton.checked = !this.directed;\r\n\t\t}\r\n\r\n\t\tlet radioButtonList = addRadioButtonGroupToAlgorithmBar(\r\n\t\t\t['Small Graph', 'Large Graph'],\r\n\t\t\t'GraphSize'\r\n\t\t);\r\n\t\tthis.smallGraphButton = radioButtonList[0];\r\n\t\tthis.smallGraphButton.onclick = this.smallGraphCallback.bind(this);\r\n\t\tthis.largeGraphButton = radioButtonList[1];\r\n\t\tthis.largeGraphButton.onclick = this.largeGraphCallback.bind(this);\r\n\t\tthis.smallGraphButton.checked = true;\r\n\r\n\t\tradioButtonList = addRadioButtonGroupToAlgorithmBar(\r\n\t\t\t[\r\n\t\t\t\t'Logical Representation',\r\n\t\t\t\t'Adjacency List Representation',\r\n\t\t\t\t'Adjacency Matrix Representation',\r\n\t\t\t],\r\n\t\t\t'GraphRepresentation'\r\n\t\t);\r\n\t\tthis.logicalButton = radioButtonList[0];\r\n\t\tthis.logicalButton.onclick = this.graphRepChangedCallback.bind(this, 1);\r\n\t\tthis.adjacencyListButton = radioButtonList[1];\r\n\t\tthis.adjacencyListButton.onclick = this.graphRepChangedCallback.bind(this, 2);\r\n\t\tthis.adjacencyMatrixButton = radioButtonList[2];\r\n\t\tthis.adjacencyMatrixButton.onclick = this.graphRepChangedCallback.bind(this, 3);\r\n\t\tthis.logicalButton.checked = true;\r\n\t}\r\n\r\n\tdirectedGraphCallback(newDirected) {\r\n\t\tif (newDirected !== this.directed) {\r\n\t\t\tthis.directed = newDirected;\r\n\t\t\tthis.animationManager.resetAll();\r\n\t\t\tthis.setup();\r\n\t\t}\r\n\t}\r\n\r\n\tsmallGraphCallback() {\r\n\t\tif (this.size !== SMALL_SIZE) {\r\n\t\t\tthis.animationManager.resetAll();\r\n\t\t\tthis.setup_small();\r\n\t\t}\r\n\t}\r\n\r\n\tlargeGraphCallback() {\r\n\t\tif (this.size !== LARGE_SIZE) {\r\n\t\t\tthis.animationManager.resetAll();\r\n\t\t\tthis.setup_large();\r\n\t\t}\r\n\t}\r\n\r\n\tnewGraphCallback() {\r\n\t\tthis.animationManager.resetAll();\r\n\t\tthis.setup();\r\n\t}\r\n\r\n\tgraphRepChangedCallback(newLayer) {\r\n\t\tthis.animationManager.setAllLayers([0, newLayer]);\r\n\t\tthis.currentLayer = newLayer;\r\n\t}\r\n\r\n\trecolorGraph() {\r\n\t\tfor (let i = 0; i < this.size; i++) {\r\n\t\t\tfor (let j = 0; j < this.size; j++) {\r\n\t\t\t\tif (this.adj_matrix[i][j] >= 0) {\r\n\t\t\t\t\tthis.setEdgeColor(i, j, EDGE_COLOR);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\thighlightEdge(i, j, highlightVal) {\r\n\t\tthis.cmd('SetHighlight', this.adj_list_edges[i][j], highlightVal);\r\n\t\tthis.cmd('SetHighlight', this.adj_matrixID[i][j], highlightVal);\r\n\t\tthis.cmd('SetEdgeHighlight', this.circleID[i], this.circleID[j], highlightVal);\r\n\t\tif (!this.directed) {\r\n\t\t\tthis.cmd('SetEdgeHighlight', this.circleID[j], this.circleID[i], highlightVal);\r\n\t\t}\r\n\t}\r\n\r\n\tsetEdgeColor(i, j, color) {\r\n\t\tthis.cmd('SetForegroundColor', this.adj_list_edges[i][j], color);\r\n\t\tthis.cmd('SetTextColor', this.adj_matrixID[i][j], color);\r\n\t\tthis.cmd('SetEdgeColor', this.circleID[i], this.circleID[j], color);\r\n\t\tif (!this.directed) {\r\n\t\t\tthis.cmd('SetEdgeColor', this.circleID[j], this.circleID[i], color);\r\n\t\t}\r\n\t}\r\n\r\n\tclearEdges() {\r\n\t\tfor (let i = 0; i < this.size; i++) {\r\n\t\t\tfor (let j = 0; j < this.size; j++) {\r\n\t\t\t\tif (this.adj_matrix[i][j] >= 0) {\r\n\t\t\t\t\tthis.cmd('Disconnect', this.circleID[i], this.circleID[j]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\trebuildEdges() {\r\n\t\tthis.clearEdges();\r\n\t\tthis.buildEdges();\r\n\t}\r\n\r\n\tbuildEdges() {\r\n\t\tfor (let i = 0; i < this.size; i++) {\r\n\t\t\tfor (let j = 0; j < this.size; j++) {\r\n\t\t\t\tif (this.adj_matrix[i][j] >= 0) {\r\n\t\t\t\t\tconst edgeLabel = this.showEdgeCosts ? String(this.adj_matrix[i][j]) : '';\r\n\t\t\t\t\tif (this.directed) {\r\n\t\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t\t'Connect',\r\n\t\t\t\t\t\t\tthis.circleID[i],\r\n\t\t\t\t\t\t\tthis.circleID[j],\r\n\t\t\t\t\t\t\tEDGE_COLOR,\r\n\t\t\t\t\t\t\tthis.adjustCurveForDirectedEdges(\r\n\t\t\t\t\t\t\t\tthis.curve[i][j],\r\n\t\t\t\t\t\t\t\tthis.adj_matrix[j][i] >= 0\r\n\t\t\t\t\t\t\t),\r\n\t\t\t\t\t\t\t1,\r\n\t\t\t\t\t\t\tedgeLabel\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t} else if (i < j) {\r\n\t\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t\t'Connect',\r\n\t\t\t\t\t\t\tthis.circleID[i],\r\n\t\t\t\t\t\t\tthis.circleID[j],\r\n\t\t\t\t\t\t\tEDGE_COLOR,\r\n\t\t\t\t\t\t\tthis.curve[i][j],\r\n\t\t\t\t\t\t\t0,\r\n\t\t\t\t\t\t\tedgeLabel\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tsetup_small() {\r\n\t\tthis.allowed = SMALL_ALLLOWED;\r\n\t\tthis.curve = SMALL_CURVE;\r\n\t\tthis.x_pos_logical = SMALL_X_POS_LOGICAL;\r\n\t\tthis.y_pos_logical = SMALL_Y_POS_LOGICAL;\r\n\t\tthis.adj_matrix_x_start = SMALL_ADJ_MATRIX_X_START;\r\n\t\tthis.adj_matrix_y_start = SMALL_ADJ_MATRIX_Y_START;\r\n\t\tthis.adj_matrix_width = SMALL_ADJ_MATRIX_WIDTH;\r\n\t\tthis.adj_matrix_height = SMALL_ADJ_MATRIX_HEIGHT;\r\n\t\tthis.adj_list_x_start = SMALL_ADJ_LIST_X_START;\r\n\t\tthis.adj_list_y_start = SMALL_ADJ_LIST_Y_START;\r\n\t\tthis.adj_list_elem_width = SMALL_ADJ_LIST_ELEM_WIDTH;\r\n\t\tthis.adj_list_elem_height = SMALL_ADJ_LIST_ELEM_HEIGHT;\r\n\t\tthis.adj_list_height = SMALL_ADJ_LIST_HEIGHT;\r\n\t\tthis.adj_list_width = SMALL_ADJ_LIST_WIDTH;\r\n\t\tthis.adj_list_spacing = SMALL_ADJ_LIST_SPACING;\r\n\t\tthis.size = SMALL_SIZE;\r\n\t\tthis.setup();\r\n\t}\r\n\r\n\tsetup_large() {\r\n\t\tthis.allowed = LARGE_ALLOWED;\r\n\t\tthis.curve = LARGE_CURVE;\r\n\t\tthis.x_pos_logical = LARGE_X_POS_LOGICAL;\r\n\t\tthis.y_pos_logical = LARGE_Y_POS_LOGICAL;\r\n\t\tthis.adj_matrix_x_start = LARGE_ADJ_MATRIX_X_START;\r\n\t\tthis.adj_matrix_y_start = LARGE_ADJ_MATRIX_Y_START;\r\n\t\tthis.adj_matrix_width = LARGE_ADJ_MATRIX_WIDTH;\r\n\t\tthis.adj_matrix_height = LARGE_ADJ_MATRIX_HEIGHT;\r\n\t\tthis.adj_list_x_start = LARGE_ADJ_LIST_X_START;\r\n\t\tthis.adj_list_y_start = LARGE_ADJ_LIST_Y_START;\r\n\t\tthis.adj_list_elem_width = LARGE_ADJ_LIST_ELEM_WIDTH;\r\n\t\tthis.adj_list_elem_height = LARGE_ADJ_LIST_ELEM_HEIGHT;\r\n\t\tthis.adj_list_height = LARGE_ADJ_LIST_HEIGHT;\r\n\t\tthis.adj_list_width = LARGE_ADJ_LIST_WIDTH;\r\n\t\tthis.adj_list_spacing = LARGE_ADJ_LIST_SPACING;\r\n\t\tthis.size = LARGE_SIZE;\r\n\t\tthis.setup();\r\n\t}\r\n\r\n\tadjustCurveForDirectedEdges(curve, bidirectional) {\r\n\t\tif (!bidirectional || Math.abs(curve) > 0.01) {\r\n\t\t\treturn curve;\r\n\t\t} else {\r\n\t\t\treturn 0.1;\r\n\t\t}\r\n\t}\r\n\r\n\tsetup() {\r\n\t\tthis.commands = [];\r\n\t\tthis.circleID = new Array(this.size);\r\n\t\tfor (let i = 0; i < this.size; i++) {\r\n\t\t\tthis.circleID[i] = this.nextIndex++;\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'CreateCircle',\r\n\t\t\t\tthis.circleID[i],\r\n\t\t\t\tString.fromCharCode(65 + i),\r\n\t\t\t\tthis.x_pos_logical[i],\r\n\t\t\t\tthis.y_pos_logical[i]\r\n\t\t\t);\r\n\t\t\tthis.cmd('SetTextColor', this.circleID[i], VERTEX_INDEX_COLOR, 0);\r\n\r\n\t\t\tthis.cmd('SetLayer', this.circleID[i], 1);\r\n\t\t}\r\n\r\n\t\tthis.adj_matrix = new Array(this.size);\r\n\t\tthis.adj_matrixID = new Array(this.size);\r\n\t\tfor (let i = 0; i < this.size; i++) {\r\n\t\t\tthis.adj_matrix[i] = new Array(this.size);\r\n\t\t\tthis.adj_matrixID[i] = new Array(this.size);\r\n\t\t}\r\n\r\n\t\tlet edgePercent;\r\n\t\tif (this.size === SMALL_SIZE) {\r\n\t\t\tif (this.directed) {\r\n\t\t\t\tedgePercent = 0.4;\r\n\t\t\t} else {\r\n\t\t\t\tedgePercent = 0.5;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tif (this.directed) {\r\n\t\t\t\tedgePercent = 0.35;\r\n\t\t\t} else {\r\n\t\t\t\tedgePercent = 0.6;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (this.directed) {\r\n\t\t\tfor (let i = 0; i < this.size; i++) {\r\n\t\t\t\tfor (let j = 0; j < this.size; j++) {\r\n\t\t\t\t\tthis.adj_matrixID[i][j] = this.nextIndex++;\r\n\t\t\t\t\tif (\r\n\t\t\t\t\t\tthis.allowed[i][j] &&\r\n\t\t\t\t\t\tMath.random() <= edgePercent &&\r\n\t\t\t\t\t\t(i < j ||\r\n\t\t\t\t\t\t\tMath.abs(this.curve[i][j]) < 0.01 ||\r\n\t\t\t\t\t\t\tthis.adj_matrixID[j][i] === -1) &&\r\n\t\t\t\t\t\t(!this.isDAG || i < j)\r\n\t\t\t\t\t) {\r\n\t\t\t\t\t\tif (this.showEdgeCosts) {\r\n\t\t\t\t\t\t\tthis.adj_matrix[i][j] = Math.floor(Math.random() * 9) + 1;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tthis.adj_matrix[i][j] = 1;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.adj_matrix[i][j] = -1;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.buildEdges();\r\n\t\t} else {\r\n\t\t\tfor (let i = 0; i < this.size; i++) {\r\n\t\t\t\tfor (let j = i + 1; j < this.size; j++) {\r\n\t\t\t\t\tthis.adj_matrixID[i][j] = this.nextIndex++;\r\n\t\t\t\t\tthis.adj_matrixID[j][i] = this.nextIndex++;\r\n\r\n\t\t\t\t\tif (this.allowed[i][j] && Math.random() <= edgePercent) {\r\n\t\t\t\t\t\tif (this.showEdgeCosts) {\r\n\t\t\t\t\t\t\tthis.adj_matrix[i][j] = Math.floor(Math.random() * 9) + 1;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tthis.adj_matrix[i][j] = 1;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tthis.adj_matrix[j][i] = this.adj_matrix[i][j];\r\n\t\t\t\t\t\tlet edgeLabel;\r\n\t\t\t\t\t\tif (this.showEdgeCosts) {\r\n\t\t\t\t\t\t\tedgeLabel = String(this.adj_matrix[i][j]);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tedgeLabel = '';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t\t'Connect',\r\n\t\t\t\t\t\t\tthis.circleID[i],\r\n\t\t\t\t\t\t\tthis.circleID[j],\r\n\t\t\t\t\t\t\tEDGE_COLOR,\r\n\t\t\t\t\t\t\tthis.curve[i][j],\r\n\t\t\t\t\t\t\t0,\r\n\t\t\t\t\t\t\tedgeLabel\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.adj_matrix[i][j] = -1;\r\n\t\t\t\t\t\tthis.adj_matrix[j][i] = -1;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tthis.buildEdges();\r\n\r\n\t\t\tfor (let i = 0; i < this.size; i++) {\r\n\t\t\t\tthis.adj_matrix[i][i] = -1;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// Create Adj List\r\n\r\n\t\tthis.buildAdjList();\r\n\r\n\t\t// Create Adj Matrix\r\n\r\n\t\tthis.buildAdjMatrix();\r\n\r\n\t\tthis.animationManager.setAllLayers([0, this.currentLayer]);\r\n\t\tthis.animationManager.StartNewAnimation(this.commands);\r\n\t\tthis.animationManager.skipForward();\r\n\t\tthis.animationManager.clearHistory();\r\n\t\tthis.clearHistory();\r\n\t}\r\n\r\n\tresetAll() {}\r\n\r\n\tbuildAdjMatrix() {\r\n\t\tthis.adj_matrix_index_x = new Array(this.size);\r\n\t\tthis.adj_matrix_index_y = new Array(this.size);\r\n\t\tfor (let i = 0; i < this.size; i++) {\r\n\t\t\tthis.adj_matrix_index_x[i] = this.nextIndex++;\r\n\t\t\tthis.adj_matrix_index_y[i] = this.nextIndex++;\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'CreateLabel',\r\n\t\t\t\tthis.adj_matrix_index_x[i],\r\n\t\t\t\ti,\r\n\t\t\t\tthis.adj_matrix_x_start + i * this.adj_matrix_width,\r\n\t\t\t\tthis.adj_matrix_y_start - this.adj_matrix_height\r\n\t\t\t);\r\n\t\t\tthis.cmd('SetForegroundColor', this.adj_matrix_index_x[i], VERTEX_INDEX_COLOR);\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'CreateLabel',\r\n\t\t\t\tthis.adj_matrix_index_y[i],\r\n\t\t\t\ti,\r\n\t\t\t\tthis.adj_matrix_x_start - this.adj_matrix_width,\r\n\t\t\t\tthis.adj_matrix_y_start + i * this.adj_matrix_height\r\n\t\t\t);\r\n\t\t\tthis.cmd('SetForegroundColor', this.adj_matrix_index_y[i], VERTEX_INDEX_COLOR);\r\n\t\t\tthis.cmd('SetLayer', this.adj_matrix_index_x[i], 3);\r\n\t\t\tthis.cmd('SetLayer', this.adj_matrix_index_y[i], 3);\r\n\r\n\t\t\tfor (let j = 0; j < this.size; j++) {\r\n\t\t\t\tthis.adj_matrixID[i][j] = this.nextIndex++;\r\n\t\t\t\tlet lab;\r\n\t\t\t\tif (this.adj_matrix[i][j] < 0) {\r\n\t\t\t\t\tlab = '';\r\n\t\t\t\t} else {\r\n\t\t\t\t\tlab = String(this.adj_matrix[i][j]);\r\n\t\t\t\t}\r\n\t\t\t\tthis.cmd(\r\n\t\t\t\t\t'CreateRectangle',\r\n\t\t\t\t\tthis.adj_matrixID[i][j],\r\n\t\t\t\t\tlab,\r\n\t\t\t\t\tthis.adj_matrix_width,\r\n\t\t\t\t\tthis.adj_matrix_height,\r\n\t\t\t\t\tthis.adj_matrix_x_start + j * this.adj_matrix_width,\r\n\t\t\t\t\tthis.adj_matrix_y_start + i * this.adj_matrix_height\r\n\t\t\t\t);\r\n\t\t\t\tthis.cmd('SetLayer', this.adj_matrixID[i][j], 3);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tremoveAdjList() {\r\n\t\tfor (let i = 0; i < this.size; i++) {\r\n\t\t\tthis.cmd('Delete', this.adj_list_list[i], 'RAL1');\r\n\t\t\tthis.cmd('Delete', this.adj_list_index[i], 'RAL2');\r\n\t\t\tfor (let j = 0; j < this.size; j++) {\r\n\t\t\t\tif (this.adj_matrix[i][j] > 0) {\r\n\t\t\t\t\tthis.cmd('Delete', this.adj_list_edges[i][j], 'RAL3');\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tbuildAdjList() {\r\n\t\tthis.adj_list_index = new Array(this.size);\r\n\t\tthis.adj_list_list = new Array(this.size);\r\n\t\tthis.adj_list_edges = new Array(this.size);\r\n\r\n\t\tfor (let i = 0; i < this.size; i++) {\r\n\t\t\tthis.adj_list_index[i] = this.nextIndex++;\r\n\t\t\tthis.adj_list_edges[i] = new Array(this.size);\r\n\t\t\tthis.adj_list_index[i] = this.nextIndex++;\r\n\t\t\tthis.adj_list_list[i] = this.nextIndex++;\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'CreateRectangle',\r\n\t\t\t\tthis.adj_list_list[i],\r\n\t\t\t\t'',\r\n\t\t\t\tthis.adj_list_width,\r\n\t\t\t\tthis.adj_list_height,\r\n\t\t\t\tthis.adj_list_x_start,\r\n\t\t\t\tthis.adj_list_y_start + i * this.adj_list_height\r\n\t\t\t);\r\n\t\t\tthis.cmd('SetLayer', this.adj_list_list[i], 2);\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'CreateLabel',\r\n\t\t\t\tthis.adj_list_index[i],\r\n\t\t\t\ti,\r\n\t\t\t\tthis.adj_list_x_start - this.adj_list_width,\r\n\t\t\t\tthis.adj_list_y_start + i * this.adj_list_height\r\n\t\t\t);\r\n\t\t\tthis.cmd('SetForegroundColor', this.adj_list_index[i], VERTEX_INDEX_COLOR);\r\n\t\t\tthis.cmd('SetLayer', this.adj_list_index[i], 2);\r\n\t\t\tlet lastElem = this.adj_list_list[i];\r\n\t\t\tlet nextXPos = this.adj_list_x_start + this.adj_list_width + this.adj_list_spacing;\r\n\t\t\tlet hasEdges = false;\r\n\t\t\tfor (let j = 0; j < this.size; j++) {\r\n\t\t\t\tif (this.adj_matrix[i][j] > 0) {\r\n\t\t\t\t\thasEdges = true;\r\n\t\t\t\t\tthis.adj_list_edges[i][j] = this.nextIndex++;\r\n\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t'CreateLinkedList',\r\n\t\t\t\t\t\tthis.adj_list_edges[i][j],\r\n\t\t\t\t\t\tj,\r\n\t\t\t\t\t\tthis.adj_list_elem_width,\r\n\t\t\t\t\t\tthis.adj_list_elem_height,\r\n\t\t\t\t\t\tnextXPos,\r\n\t\t\t\t\t\tthis.adj_list_y_start + i * this.adj_list_height,\r\n\t\t\t\t\t\t0.25,\r\n\t\t\t\t\t\t0,\r\n\t\t\t\t\t\t1,\r\n\t\t\t\t\t\t2\r\n\t\t\t\t\t);\r\n\t\t\t\t\tthis.cmd('SetNull', this.adj_list_edges[i][j], 1);\r\n\t\t\t\t\tthis.cmd('SetText', this.adj_list_edges[i][j], this.adj_matrix[i][j], 1);\r\n\t\t\t\t\tthis.cmd('SetTextColor', this.adj_list_edges[i][j], VERTEX_INDEX_COLOR, 0);\r\n\t\t\t\t\tthis.cmd('SetLayer', this.adj_list_edges[i][j], 2);\r\n\r\n\t\t\t\t\tnextXPos = nextXPos + this.adj_list_elem_width + this.adj_list_spacing;\r\n\t\t\t\t\tthis.cmd('Connect', lastElem, this.adj_list_edges[i][j]);\r\n\t\t\t\t\tthis.cmd('SetNull', lastElem, 0);\r\n\t\t\t\t\tlastElem = this.adj_list_edges[i][j];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (!hasEdges) {\r\n\t\t\t\tthis.cmd('SetNull', this.adj_list_list[i], 1);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t// NEED TO OVERRIDE IN PARENT\r\n\treset() {\r\n\t\t// Throw an error?\r\n\t}\r\n\r\n\tdisableUI() {\r\n\t\tthis.newGraphButton.disabled = true;\r\n\t\tif (this.directedGraphButton != null)\r\n\t\t\tthis.directedGraphButton.disabled = true;\r\n\t\tif (this.undirectedGraphButton != null)\r\n\t\t\tthis.undirectedGraphButton.disabled = true;\r\n\t\tthis.smallGraphButton.disabled = true;\r\n\t\tthis.largeGraphButton.disabled = true;\r\n\t}\r\n\r\n\tenableUI() {\r\n\t\tthis.newGraphButton.disabled = false;\r\n\t\tif (this.directedGraphButton != null)\r\n\t\t\tthis.directedGraphButton.disabled = false;\r\n\t\tif (this.undirectedGraphButton != null)\r\n\t\t\tthis.undirectedGraphButton.disabled = false;\r\n\t\tthis.smallGraphButton.disabled = false;\r\n\t\tthis.largeGraphButton.disabled = false;\r\n\t}\r\n}\r\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\r\n//\r\n// Redistribution and use in source and binary forms, with or without modification, are\r\n// permitted provided that the following conditions are met:\r\n//\r\n// 1. Redistributions of source code must retain the above copyright notice, this list of\r\n// conditions and the following disclaimer.\r\n//\r\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\r\n// of conditions and the following disclaimer in the documentation and/or other materials\r\n// provided with the distribution.\r\n//\r\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\r\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\r\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\r\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\r\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\r\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\r\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\r\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\r\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\r\n//\r\n// The views and conclusions contained in the software and documentation are those of the\r\n// authors and should not be interpreted as representing official policies, either expressed\r\n// or implied, of the University of San Francisco\r\n\r\nimport Graph, { VERTEX_INDEX_COLOR } from './Graph.js';\r\nimport { addControlToAlgorithmBar, addLabelToAlgorithmBar } from './Algorithm.js';\r\n\r\nconst AUX_ARRAY_WIDTH = 25;\r\nconst AUX_ARRAY_HEIGHT = 25;\r\nconst AUX_ARRAY_START_Y = 50;\r\n\r\nconst VISITED_START_X = 475;\r\nconst PARENT_START_X = 400;\r\n\r\nconst HIGHLIGHT_CIRCLE_COLOR = '#000000';\r\nconst BFS_TREE_COLOR = '#0000FF';\r\nconst BFS_QUEUE_HEAD_COLOR = '#0000FF';\r\n\r\nconst QUEUE_START_X = 30;\r\nconst QUEUE_START_Y = 50;\r\nconst QUEUE_SPACING = 30;\r\n\r\nexport default class BFS extends Graph {\r\n\tconstructor(am, w, h) {\r\n\t\tsuper(am, w, h); // TODO:  add no edge label flag to this?\r\n\r\n\t\tthis.showEdgeCosts = false;\r\n\t}\r\n\r\n\taddControls() {\r\n\t\taddLabelToAlgorithmBar('Start Vertex: ');\r\n\t\tthis.startField = addControlToAlgorithmBar('Text', '');\r\n\t\tthis.startField.onkeydown = this.returnSubmit(\r\n\t\t\tthis.startField,\r\n\t\t\tthis.startCallback.bind(this),\r\n\t\t\t1,\r\n\t\t\tfalse\r\n\t\t);\r\n\t\tthis.startField.size = 2;\r\n\t\tthis.startButton = addControlToAlgorithmBar('Button', 'Run BFS');\r\n\t\tthis.startButton.onclick = this.startCallback.bind(this);\r\n\t\t// BFS.superclass.addControls.call(this);\r\n\t\tsuper.addControls();\r\n\t}\r\n\r\n\tsetup() {\r\n\t\tsuper.setup();\r\n\t\tthis.messageID = [];\r\n\t\tthis.commands = [];\r\n\t\tthis.visitedID = new Array(this.size);\r\n\t\tthis.visitedIndexID = new Array(this.size);\r\n\t\tthis.parentID = new Array(this.size);\r\n\t\tthis.parentIndexID = new Array(this.size);\r\n\r\n\t\tfor (let i = 0; i < this.size; i++) {\r\n\t\t\tthis.visitedID[i] = this.nextIndex++;\r\n\t\t\tthis.visitedIndexID[i] = this.nextIndex++;\r\n\t\t\tthis.parentID[i] = this.nextIndex++;\r\n\t\t\tthis.parentIndexID[i] = this.nextIndex++;\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'CreateRectangle',\r\n\t\t\t\tthis.visitedID[i],\r\n\t\t\t\t'F',\r\n\t\t\t\tAUX_ARRAY_WIDTH,\r\n\t\t\t\tAUX_ARRAY_HEIGHT,\r\n\t\t\t\tVISITED_START_X,\r\n\t\t\t\tAUX_ARRAY_START_Y + i * AUX_ARRAY_HEIGHT\r\n\t\t\t);\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'CreateLabel',\r\n\t\t\t\tthis.visitedIndexID[i],\r\n\t\t\t\tString.fromCharCode(65 + i),\r\n\t\t\t\tVISITED_START_X - AUX_ARRAY_WIDTH,\r\n\t\t\t\tAUX_ARRAY_START_Y + i * AUX_ARRAY_HEIGHT\r\n\t\t\t);\r\n\t\t\tthis.cmd('SetForegroundColor', this.visitedIndexID[i], VERTEX_INDEX_COLOR);\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'CreateRectangle',\r\n\t\t\t\tthis.parentID[i],\r\n\t\t\t\t'',\r\n\t\t\t\tAUX_ARRAY_WIDTH,\r\n\t\t\t\tAUX_ARRAY_HEIGHT,\r\n\t\t\t\tPARENT_START_X,\r\n\t\t\t\tAUX_ARRAY_START_Y + i * AUX_ARRAY_HEIGHT\r\n\t\t\t);\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'CreateLabel',\r\n\t\t\t\tthis.parentIndexID[i],\r\n\t\t\t\tString.fromCharCode(65 + i),\r\n\t\t\t\tPARENT_START_X - AUX_ARRAY_WIDTH,\r\n\t\t\t\tAUX_ARRAY_START_Y + i * AUX_ARRAY_HEIGHT\r\n\t\t\t);\r\n\t\t\tthis.cmd('SetForegroundColor', this.parentIndexID[i], VERTEX_INDEX_COLOR);\r\n\t\t}\r\n\t\tthis.cmd(\r\n\t\t\t'CreateLabel',\r\n\t\t\tthis.nextIndex++,\r\n\t\t\t'Parent',\r\n\t\t\tPARENT_START_X - AUX_ARRAY_WIDTH,\r\n\t\t\tAUX_ARRAY_START_Y - AUX_ARRAY_HEIGHT * 1.5,\r\n\t\t\t0\r\n\t\t);\r\n\t\tthis.cmd(\r\n\t\t\t'CreateLabel',\r\n\t\t\tthis.nextIndex++,\r\n\t\t\t'Visited',\r\n\t\t\tVISITED_START_X - AUX_ARRAY_WIDTH,\r\n\t\t\tAUX_ARRAY_START_Y - AUX_ARRAY_HEIGHT * 1.5,\r\n\t\t\t0\r\n\t\t);\r\n\t\tthis.cmd(\r\n\t\t\t'CreateLabel',\r\n\t\t\tthis.nextIndex++,\r\n\t\t\t'BFS Queue',\r\n\t\t\tQUEUE_START_X,\r\n\t\t\tQUEUE_START_Y - 30,\r\n\t\t\t0\r\n\t\t);\r\n\t\tthis.animationManager.setAllLayers([0, this.currentLayer]);\r\n\t\tthis.animationManager.StartNewAnimation(this.commands);\r\n\t\tthis.animationManager.skipForward();\r\n\t\tthis.animationManager.clearHistory();\r\n\t\tthis.highlightCircleL = this.nextIndex++;\r\n\t\tthis.highlightCircleAL = this.nextIndex++;\r\n\t\tthis.highlightCircleAM = this.nextIndex++;\r\n\t}\r\n\r\n\tstartCallback() {\r\n\t\tlet startvalue;\r\n\r\n\t\tif (this.startField.value !== '') {\r\n\t\t\tstartvalue = this.startField.value;\r\n\t\t\tthis.startField.value = '';\r\n\t\t\tstartvalue = startvalue.toUpperCase().charCodeAt(0) - 65;\r\n\t\t\tif (startvalue < this.size) this.implementAction(this.doBFS.bind(this), startvalue);\r\n\t\t}\r\n\t}\r\n\r\n\tdoBFS(startVetex) {\r\n\t\tthis.visited = new Array(this.size);\r\n\t\tthis.commands = [];\r\n\t\tthis.queue = new Array(this.size);\r\n\t\tlet head = 0;\r\n\t\tlet tail = 0;\r\n\t\tconst queueID = new Array(this.size);\r\n\t\tlet queueSize = 0;\r\n\r\n\t\tif (this.messageID != null) {\r\n\t\t\tfor (let i = 0; i < this.messageID.length; i++) {\r\n\t\t\t\tthis.cmd('Delete', this.messageID[i]);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis.rebuildEdges();\r\n\t\tthis.messageID = [];\r\n\t\tfor (let i = 0; i < this.size; i++) {\r\n\t\t\tthis.cmd('SetText', this.visitedID[i], 'F');\r\n\t\t\tthis.cmd('SetText', this.parentID[i], '');\r\n\t\t\tthis.visited[i] = false;\r\n\t\t\tqueueID[i] = this.nextIndex++;\r\n\t\t}\r\n\t\tlet vertex = startVetex;\r\n\t\tthis.visited[vertex] = true;\r\n\t\tthis.queue[tail] = vertex;\r\n\t\tthis.cmd(\r\n\t\t\t'CreateLabel',\r\n\t\t\tqueueID[tail],\r\n\t\t\tString.fromCharCode(65 + vertex),\r\n\t\t\tQUEUE_START_X + queueSize * QUEUE_SPACING,\r\n\t\t\tQUEUE_START_Y\r\n\t\t);\r\n\t\tqueueSize = queueSize + 1;\r\n\t\ttail = (tail + 1) % this.size;\r\n\r\n\t\twhile (queueSize > 0) {\r\n\t\t\tvertex = this.queue[head];\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'CreateHighlightCircle',\r\n\t\t\t\tthis.highlightCircleL,\r\n\t\t\t\tHIGHLIGHT_CIRCLE_COLOR,\r\n\t\t\t\tthis.x_pos_logical[vertex],\r\n\t\t\t\tthis.y_pos_logical[vertex]\r\n\t\t\t);\r\n\t\t\tthis.cmd('SetLayer', this.highlightCircleL, 1);\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'CreateHighlightCircle',\r\n\t\t\t\tthis.highlightCircleAL,\r\n\t\t\t\tHIGHLIGHT_CIRCLE_COLOR,\r\n\t\t\t\tthis.adj_list_x_start - this.adj_list_width,\r\n\t\t\t\tthis.adj_list_y_start + vertex * this.adj_list_height\r\n\t\t\t);\r\n\t\t\tthis.cmd('SetLayer', this.highlightCircleAL, 2);\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'CreateHighlightCircle',\r\n\t\t\t\tthis.highlightCircleAM,\r\n\t\t\t\tHIGHLIGHT_CIRCLE_COLOR,\r\n\t\t\t\tthis.adj_matrix_x_start - this.adj_matrix_width,\r\n\t\t\t\tthis.adj_matrix_y_start + vertex * this.adj_matrix_height\r\n\t\t\t);\r\n\t\t\tthis.cmd('SetLayer', this.highlightCircleAM, 3);\r\n\r\n\t\t\tthis.cmd('SetTextColor', queueID[head], BFS_QUEUE_HEAD_COLOR);\r\n\r\n\t\t\tfor (let neighbor = 0; neighbor < this.size; neighbor++) {\r\n\t\t\t\tif (this.adj_matrix[vertex][neighbor] > 0) {\r\n\t\t\t\t\tthis.highlightEdge(vertex, neighbor, 1);\r\n\t\t\t\t\tthis.cmd('SetHighlight', this.visitedID[neighbor], 1);\r\n\t\t\t\t\tthis.cmd('Step');\r\n\t\t\t\t\tif (!this.visited[neighbor]) {\r\n\t\t\t\t\t\tthis.visited[neighbor] = true;\r\n\t\t\t\t\t\tthis.cmd('SetText', this.visitedID[neighbor], 'T');\r\n\t\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t\t'SetText',\r\n\t\t\t\t\t\t\tthis.parentID[neighbor],\r\n\t\t\t\t\t\t\tString.fromCharCode(65 + vertex)\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t\tthis.highlightEdge(vertex, neighbor, 0);\r\n\t\t\t\t\t\tthis.cmd('Disconnect', this.circleID[vertex], this.circleID[neighbor]);\r\n\t\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t\t'Connect',\r\n\t\t\t\t\t\t\tthis.circleID[vertex],\r\n\t\t\t\t\t\t\tthis.circleID[neighbor],\r\n\t\t\t\t\t\t\tBFS_TREE_COLOR,\r\n\t\t\t\t\t\t\tthis.curve[vertex][neighbor],\r\n\t\t\t\t\t\t\t1,\r\n\t\t\t\t\t\t\t''\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t\tthis.queue[tail] = neighbor;\r\n\t\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t\t'CreateLabel',\r\n\t\t\t\t\t\t\tqueueID[tail],\r\n\t\t\t\t\t\t\tString.fromCharCode(65 + neighbor),\r\n\t\t\t\t\t\t\tQUEUE_START_X + queueSize * QUEUE_SPACING,\r\n\t\t\t\t\t\t\tQUEUE_START_Y\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t\ttail = (tail + 1) % this.size;\r\n\t\t\t\t\t\tqueueSize = queueSize + 1;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.highlightEdge(vertex, neighbor, 0);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.cmd('SetHighlight', this.visitedID[neighbor], 0);\r\n\t\t\t\t\tthis.cmd('Step');\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.cmd('Delete', queueID[head]);\r\n\t\t\thead = (head + 1) % this.size;\r\n\t\t\tqueueSize = queueSize - 1;\r\n\t\t\tfor (let i = 0; i < queueSize; i++) {\r\n\t\t\t\tconst nextQueueIndex = (i + head) % this.size;\r\n\t\t\t\tthis.cmd(\r\n\t\t\t\t\t'Move',\r\n\t\t\t\t\tqueueID[nextQueueIndex],\r\n\t\t\t\t\tQUEUE_START_X + i * QUEUE_SPACING,\r\n\t\t\t\t\tQUEUE_START_Y\r\n\t\t\t\t);\r\n\t\t\t}\r\n\r\n\t\t\tthis.cmd('Delete', this.highlightCircleL);\r\n\t\t\tthis.cmd('Delete', this.highlightCircleAM);\r\n\t\t\tthis.cmd('Delete', this.highlightCircleAL);\r\n\t\t}\r\n\r\n\t\treturn this.commands;\r\n\t}\r\n\r\n\t// NEED TO OVERRIDE IN PARENT\r\n\treset() {\r\n\t\t// Throw an error?\r\n\t}\r\n\r\n\tenableUI(event) {\r\n\t\tthis.startField.disabled = false;\r\n\t\tthis.startButton.disabled = false;\r\n\r\n\t\t// BFS.superclass.enableUI.call(this,event);\r\n\t\tsuper.enableUI(event);\r\n\t}\r\n\r\n\tdisableUI(event) {\r\n\t\tthis.startField.disabled = true;\r\n\t\tthis.startButton.disabled = true;\r\n\r\n\t\tsuper.disableUI(event);\r\n\t\t// BFS.superclass.disableUI.call(this, event);\r\n\t}\r\n}\r\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\r\n//\r\n// Redistribution and use in source and binary forms, with or without modification, are\r\n// permitted provided that the following conditions are met:\r\n//\r\n// 1. Redistributions of source code must retain the above copyright notice, this list of\r\n// conditions and the following disclaimer.\r\n//\r\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\r\n// of conditions and the following disclaimer in the documentation and/or other materials\r\n// provided with the distribution.\r\n//\r\n// THIS SOFTWARE IS PROVIDED BY David Galles ``AS IS'' AND ANY EXPRESS OR IMPLIED\r\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\r\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\r\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\r\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\r\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\r\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\r\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\r\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\r\n//\r\n// The views and conclusions contained in the software and documentation are those of the\r\n// authors and should not be interpreted as representing official policies, either expressed\r\n// or implied, of the University of San Francisco\r\n\r\n// Constants.\r\n\r\nimport Algorithm, { addControlToAlgorithmBar } from './Algorithm.js';\r\n\r\nconst LINK_COLOR = '#007700';\r\nconst HIGHLIGHT_CIRCLE_COLOR = '#007700';\r\nconst FOREGROUND_COLOR = '#007700';\r\nconst BACKGROUND_COLOR = '#EEFFEE';\r\nconst PRINT_COLOR = FOREGROUND_COLOR;\r\n\r\nconst WIDTH_DELTA = 50;\r\nconst HEIGHT_DELTA = 50;\r\nconst STARTING_Y = 50;\r\n\r\nconst FIRST_PRINT_POS_X = 50;\r\nconst PRINT_VERTICAL_GAP = 20;\r\nconst PRINT_HORIZONTAL_GAP = 50;\r\n\r\nexport default class BST extends Algorithm {\r\n\tconstructor(am, w, h) {\r\n\t\tsuper(am, w, h);\r\n\t\tthis.startingX = w / 2;\r\n\t\tthis.first_print_pos_y = h - 2 * PRINT_VERTICAL_GAP;\r\n\t\tthis.print_max = w - 10;\r\n\r\n\t\tthis.addControls();\r\n\t\tthis.nextIndex = 0;\r\n\t\tthis.commands = [];\r\n\t\tthis.cmd('CreateLabel', 0, '', 20, 10, 0);\r\n\t\tthis.nextIndex = 1;\r\n\t\tthis.animationManager.StartNewAnimation(this.commands);\r\n\t\tthis.animationManager.skipForward();\r\n\t\tthis.animationManager.clearHistory();\r\n\t}\r\n\r\n\taddControls() {\r\n\t\tthis.controls = [];\r\n\r\n\t\tthis.insertField = addControlToAlgorithmBar('Text', '');\r\n\t\tthis.insertField.onkeydown = this.returnSubmit(\r\n\t\t\tthis.insertField,\r\n\t\t\tthis.insertCallback.bind(this),\r\n\t\t\t4\r\n\t\t);\r\n\t\tthis.controls.push(this.insertField);\r\n\r\n\t\tthis.insertButton = addControlToAlgorithmBar('Button', 'Insert');\r\n\t\tthis.insertButton.onclick = this.insertCallback.bind(this);\r\n\t\tthis.controls.push(this.insertButton);\r\n\r\n\t\tthis.deleteField = addControlToAlgorithmBar('Text', '');\r\n\t\tthis.deleteField.onkeydown = this.returnSubmit(\r\n\t\t\tthis.deleteField,\r\n\t\t\tthis.deleteCallback.bind(this),\r\n\t\t\t4\r\n\t\t);\r\n\t\tthis.controls.push(this.deleteField);\r\n\r\n\t\tthis.deleteButton = addControlToAlgorithmBar('Button', 'Delete');\r\n\t\tthis.deleteButton.onclick = this.deleteCallback.bind(this);\r\n\t\tthis.controls.push(this.deleteButton);\r\n\r\n\t\tthis.findField = addControlToAlgorithmBar('Text', '');\r\n\t\tthis.findField.onkeydown = this.returnSubmit(\r\n\t\t\tthis.findField,\r\n\t\t\tthis.findCallback.bind(this),\r\n\t\t\t4\r\n\t\t);\r\n\t\tthis.controls.push(this.findField);\r\n\r\n\t\tthis.findButton = addControlToAlgorithmBar('Button', 'Find');\r\n\t\tthis.findButton.onclick = this.findCallback.bind(this);\r\n\t\tthis.controls.push(this.findButton);\r\n\r\n\t\tthis.printButton = addControlToAlgorithmBar('Button', 'Print');\r\n\t\tthis.printButton.onclick = this.printCallback.bind(this);\r\n\t\tthis.controls.push(this.printButton);\r\n\r\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear');\r\n\t\tthis.clearButton.onclick = this.clearCallback.bind(this);\r\n\t\tthis.controls.push(this.clearButton);\r\n\t}\r\n\r\n\treset() {\r\n\t\tthis.nextIndex = 1;\r\n\t\tthis.treeRoot = null;\r\n\t}\r\n\r\n\tinsertCallback() {\r\n\t\tlet insertedValue = this.insertField.value;\r\n\t\t// Get text value\r\n\t\tinsertedValue = this.normalizeNumber(insertedValue, 4);\r\n\t\tif (insertedValue !== '') {\r\n\t\t\t// set text value\r\n\t\t\tthis.insertField.value = '';\r\n\t\t\tthis.implementAction(this.insertElement.bind(this), insertedValue);\r\n\t\t}\r\n\t}\r\n\r\n\tdeleteCallback() {\r\n\t\tlet deletedValue = this.deleteField.value;\r\n\t\tif (deletedValue !== '') {\r\n\t\t\tdeletedValue = this.normalizeNumber(deletedValue, 4);\r\n\t\t\tthis.deleteField.value = '';\r\n\t\t\tthis.implementAction(this.deleteElement.bind(this), deletedValue);\r\n\t\t}\r\n\t}\r\n\r\n\tprintCallback() {\r\n\t\tthis.implementAction(this.printTree.bind(this), '');\r\n\t}\r\n\r\n\tclearCallback() {\r\n\t\tthis.implementAction(this.clear.bind(this), '');\r\n\t}\r\n\r\n\tprintTree() {\r\n\t\tthis.commands = [];\r\n\r\n\t\tif (this.treeRoot != null) {\r\n\t\t\tthis.highlightID = this.nextIndex++;\r\n\t\t\tconst firstLabel = this.nextIndex;\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'CreateHighlightCircle',\r\n\t\t\t\tthis.highlightID,\r\n\t\t\t\tHIGHLIGHT_CIRCLE_COLOR,\r\n\t\t\t\tthis.treeRoot.x,\r\n\t\t\t\tthis.treeRoot.y\r\n\t\t\t);\r\n\t\t\tthis.xPosOfNextLabel = FIRST_PRINT_POS_X;\r\n\t\t\tthis.yPosOfNextLabel = this.first_print_pos_y;\r\n\t\t\tthis.printTreeRec(this.treeRoot);\r\n\t\t\tthis.cmd('Delete', this.highlightID);\r\n\t\t\tthis.cmd('Step');\r\n\r\n\t\t\tfor (let i = firstLabel; i < this.nextIndex; i++) {\r\n\t\t\t\tthis.cmd('Delete', i);\r\n\t\t\t}\r\n\t\t\tthis.nextIndex = this.highlightID; /// Reuse objects.  Not necessary.\r\n\t\t}\r\n\t\treturn this.commands;\r\n\t}\r\n\r\n\tprintTreeRec(tree) {\r\n\t\tthis.cmd('Step');\r\n\t\tif (tree.left != null) {\r\n\t\t\tthis.cmd('Move', this.highlightID, tree.left.x, tree.left.y);\r\n\t\t\tthis.printTreeRec(tree.left);\r\n\t\t\tthis.cmd('Move', this.highlightID, tree.x, tree.y);\r\n\t\t\tthis.cmd('Step');\r\n\t\t}\r\n\t\tconst nextLabelID = this.nextIndex++;\r\n\t\tthis.cmd('CreateLabel', nextLabelID, tree.data, tree.x, tree.y);\r\n\t\tthis.cmd('SetForegroundColor', nextLabelID, PRINT_COLOR);\r\n\t\tthis.cmd('Move', nextLabelID, this.xPosOfNextLabel, this.yPosOfNextLabel);\r\n\t\tthis.cmd('Step');\r\n\r\n\t\tthis.xPosOfNextLabel += PRINT_HORIZONTAL_GAP;\r\n\t\tif (this.xPosOfNextLabel > this.print_max) {\r\n\t\t\tthis.xPosOfNextLabel = FIRST_PRINT_POS_X;\r\n\t\t\tthis.yPosOfNextLabel += PRINT_VERTICAL_GAP;\r\n\t\t}\r\n\t\tif (tree.right != null) {\r\n\t\t\tthis.cmd('Move', this.highlightID, tree.right.x, tree.right.y);\r\n\t\t\tthis.printTreeRec(tree.right);\r\n\t\t\tthis.cmd('Move', this.highlightID, tree.x, tree.y);\r\n\t\t\tthis.cmd('Step');\r\n\t\t}\r\n\t\treturn;\r\n\t}\r\n\r\n\tfindCallback() {\r\n\t\tconst findValue = this.normalizeNumber(this.findField.value, 4);\r\n\t\tthis.findField.value = '';\r\n\t\tthis.implementAction(this.findElement.bind(this), findValue);\r\n\t}\r\n\r\n\tfindElement(findValue) {\r\n\t\tthis.commands = [];\r\n\r\n\t\tthis.highlightID = this.nextIndex++;\r\n\r\n\t\tthis.doFind(this.treeRoot, findValue);\r\n\r\n\t\treturn this.commands;\r\n\t}\r\n\r\n\tdoFind(tree, value) {\r\n\t\tthis.cmd('SetText', 0, 'Searching for ' + value);\r\n\t\tif (tree != null) {\r\n\t\t\tthis.cmd('SetHighlight', tree.graphicID, 1);\r\n\t\t\tif (tree.data === value) {\r\n\t\t\t\tthis.cmd(\r\n\t\t\t\t\t'SetText',\r\n\t\t\t\t\t0,\r\n\t\t\t\t\t'Searching for ' + value + ' : ' + value + ' = ' + value + ' (Element found!)'\r\n\t\t\t\t);\r\n\t\t\t\tthis.cmd('Step');\r\n\t\t\t\tthis.cmd('SetText', 0, 'Found:' + value);\r\n\t\t\t\tthis.cmd('SetHighlight', tree.graphicID, 0);\r\n\t\t\t} else {\r\n\t\t\t\tif (tree.data > value) {\r\n\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t'SetText',\r\n\t\t\t\t\t\t0,\r\n\t\t\t\t\t\t'Searching for ' +\r\n\t\t\t\t\t\t\tvalue +\r\n\t\t\t\t\t\t\t' : ' +\r\n\t\t\t\t\t\t\tvalue +\r\n\t\t\t\t\t\t\t' < ' +\r\n\t\t\t\t\t\t\ttree.data +\r\n\t\t\t\t\t\t\t' (look to left subtree)'\r\n\t\t\t\t\t);\r\n\t\t\t\t\tthis.cmd('Step');\r\n\t\t\t\t\tthis.cmd('SetHighlight', tree.graphicID, 0);\r\n\t\t\t\t\tif (tree.left != null) {\r\n\t\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t\t'CreateHighlightCircle',\r\n\t\t\t\t\t\t\tthis.highlightID,\r\n\t\t\t\t\t\t\tHIGHLIGHT_CIRCLE_COLOR,\r\n\t\t\t\t\t\t\ttree.x,\r\n\t\t\t\t\t\t\ttree.y\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t\tthis.cmd('Move', this.highlightID, tree.left.x, tree.left.y);\r\n\t\t\t\t\t\tthis.cmd('Step');\r\n\t\t\t\t\t\tthis.cmd('Delete', this.highlightID);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.doFind(tree.left, value);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t'SetText',\r\n\t\t\t\t\t\t0,\r\n\t\t\t\t\t\t'Searching for ' +\r\n\t\t\t\t\t\t\tvalue +\r\n\t\t\t\t\t\t\t' : ' +\r\n\t\t\t\t\t\t\tvalue +\r\n\t\t\t\t\t\t\t' > ' +\r\n\t\t\t\t\t\t\ttree.data +\r\n\t\t\t\t\t\t\t' (look to right subtree)'\r\n\t\t\t\t\t);\r\n\t\t\t\t\tthis.cmd('Step');\r\n\t\t\t\t\tthis.cmd('SetHighlight', tree.graphicID, 0);\r\n\t\t\t\t\tif (tree.right != null) {\r\n\t\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t\t'CreateHighlightCircle',\r\n\t\t\t\t\t\t\tthis.highlightID,\r\n\t\t\t\t\t\t\tHIGHLIGHT_CIRCLE_COLOR,\r\n\t\t\t\t\t\t\ttree.x,\r\n\t\t\t\t\t\t\ttree.y\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t\tthis.cmd('Move', this.highlightID, tree.right.x, tree.right.y);\r\n\t\t\t\t\t\tthis.cmd('Step');\r\n\t\t\t\t\t\tthis.cmd('Delete', this.highlightID);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.doFind(tree.right, value);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'SetText',\r\n\t\t\t\t0,\r\n\t\t\t\t'Searching for ' + value + ' : < Empty Tree > (Element not found)'\r\n\t\t\t);\r\n\t\t\tthis.cmd('Step');\r\n\t\t\tthis.cmd('SetText', 0, 'Searching for ' + value + ' :  (Element not found)');\r\n\t\t}\r\n\t}\r\n\r\n\tinsertElement(insertedValue) {\r\n\t\tthis.commands = [];\r\n\t\tthis.cmd('SetText', 0, 'Inserting ' + insertedValue);\r\n\t\tthis.highlightID = this.nextIndex++;\r\n\r\n\t\tif (this.treeRoot == null) {\r\n\t\t\tthis.cmd('CreateCircle', this.nextIndex, insertedValue, this.startingX, STARTING_Y);\r\n\t\t\tthis.cmd('SetForegroundColor', this.nextIndex, FOREGROUND_COLOR);\r\n\t\t\tthis.cmd('SetBackgroundColor', this.nextIndex, BACKGROUND_COLOR);\r\n\t\t\tthis.cmd('Step');\r\n\t\t\tthis.treeRoot = new BSTNode(insertedValue, this.nextIndex, this.startingX, STARTING_Y);\r\n\t\t\tthis.nextIndex += 1;\r\n\t\t} else {\r\n\t\t\tthis.cmd('CreateCircle', this.nextIndex, insertedValue, 100, 100);\r\n\t\t\tthis.cmd('SetForegroundColor', this.nextIndex, FOREGROUND_COLOR);\r\n\t\t\tthis.cmd('SetBackgroundColor', this.nextIndex, BACKGROUND_COLOR);\r\n\t\t\tthis.cmd('Step');\r\n\t\t\tconst insertElem = new BSTNode(insertedValue, this.nextIndex, 100, 100);\r\n\r\n\t\t\tthis.nextIndex += 1;\r\n\t\t\tthis.cmd('SetHighlight', insertElem.graphicID, 1);\r\n\t\t\tthis.insert(insertElem, this.treeRoot);\r\n\t\t\tthis.resizeTree();\r\n\t\t}\r\n\t\tthis.cmd('SetText', 0, '');\r\n\t\treturn this.commands;\r\n\t}\r\n\r\n\tinsert(elem, tree) {\r\n\t\tlet foundDuplicate = false;\r\n\t\tthis.cmd('SetHighlight', tree.graphicID, 1);\r\n\t\tthis.cmd('SetHighlight', elem.graphicID, 1);\r\n\r\n\t\tif (elem.data < tree.data) {\r\n\t\t\tthis.cmd('SetText', 0, elem.data + ' < ' + tree.data + '.  Looking at left subtree');\r\n\t\t} else if (elem.data > tree.data) {\r\n\t\t\tthis.cmd('SetText', 0, elem.data + ' > ' + tree.data + '.  Looking at right subtree');\r\n\t\t} else {\r\n\t\t\tthis.cmd('SetText', 0, elem.data + ' = ' + tree.data + '. Ignoring duplicate');\r\n\t\t\tfoundDuplicate = true;\r\n\t\t}\r\n\t\tthis.cmd('Step');\r\n\t\tthis.cmd('SetHighlight', tree.graphicID, 0);\r\n\t\tthis.cmd('SetHighlight', elem.graphicID, 0);\r\n\r\n\t\tif (foundDuplicate) {\r\n\t\t\tthis.cmd('Delete', elem.graphicID, 0);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (elem.data < tree.data) {\r\n\t\t\tif (tree.left == null) {\r\n\t\t\t\tthis.cmd('SetText', 0, 'Found null tree, inserting element');\r\n\r\n\t\t\t\tthis.cmd('SetHighlight', elem.graphicID, 0);\r\n\t\t\t\ttree.left = elem;\r\n\t\t\t\telem.parent = tree;\r\n\t\t\t\tthis.cmd('Connect', tree.graphicID, elem.graphicID, LINK_COLOR);\r\n\t\t\t} else {\r\n\t\t\t\tthis.cmd(\r\n\t\t\t\t\t'CreateHighlightCircle',\r\n\t\t\t\t\tthis.highlightID,\r\n\t\t\t\t\tHIGHLIGHT_CIRCLE_COLOR,\r\n\t\t\t\t\ttree.x,\r\n\t\t\t\t\ttree.y\r\n\t\t\t\t);\r\n\t\t\t\tthis.cmd('Move', this.highlightID, tree.left.x, tree.left.y);\r\n\t\t\t\tthis.cmd('Step');\r\n\t\t\t\tthis.cmd('Delete', this.highlightID);\r\n\t\t\t\tthis.insert(elem, tree.left);\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tif (tree.right == null) {\r\n\t\t\t\tthis.cmd('SetText', 0, 'Found null tree, inserting element');\r\n\t\t\t\tthis.cmd('SetHighlight', elem.graphicID, 0);\r\n\t\t\t\ttree.right = elem;\r\n\t\t\t\telem.parent = tree;\r\n\t\t\t\tthis.cmd('Connect', tree.graphicID, elem.graphicID, LINK_COLOR);\r\n\t\t\t\telem.x = tree.x + WIDTH_DELTA / 2;\r\n\t\t\t\telem.y = tree.y + HEIGHT_DELTA;\r\n\t\t\t\tthis.cmd('Move', elem.graphicID, elem.x, elem.y);\r\n\t\t\t} else {\r\n\t\t\t\tthis.cmd(\r\n\t\t\t\t\t'CreateHighlightCircle',\r\n\t\t\t\t\tthis.highlightID,\r\n\t\t\t\t\tHIGHLIGHT_CIRCLE_COLOR,\r\n\t\t\t\t\ttree.x,\r\n\t\t\t\t\ttree.y\r\n\t\t\t\t);\r\n\t\t\t\tthis.cmd('Move', this.highlightID, tree.right.x, tree.right.y);\r\n\t\t\t\tthis.cmd('Step');\r\n\t\t\t\tthis.cmd('Delete', this.highlightID);\r\n\t\t\t\tthis.insert(elem, tree.right);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tdeleteElement(deletedValue) {\r\n\t\tthis.commands = [];\r\n\t\tthis.cmd('SetText', 0, 'Deleting ' + deletedValue);\r\n\t\tthis.cmd('Step');\r\n\t\tthis.cmd('SetText', 0, '');\r\n\t\tthis.highlightID = this.nextIndex++;\r\n\t\tthis.treeDelete(this.treeRoot, deletedValue);\r\n\t\tthis.cmd('SetText', 0, '');\r\n\t\t// Do delete\r\n\t\treturn this.commands;\r\n\t}\r\n\r\n\ttreeDelete(tree, valueToDelete) {\r\n\t\tlet leftchild = false;\r\n\t\tif (tree != null) {\r\n\t\t\tif (tree.parent != null) {\r\n\t\t\t\tleftchild = tree.parent.left === tree;\r\n\t\t\t}\r\n\t\t\tthis.cmd('SetHighlight', tree.graphicID, 1);\r\n\t\t\tif (valueToDelete < tree.data) {\r\n\t\t\t\tthis.cmd(\r\n\t\t\t\t\t'SetText',\r\n\t\t\t\t\t0,\r\n\t\t\t\t\tvalueToDelete + ' < ' + tree.data + '.  Looking at left subtree'\r\n\t\t\t\t);\r\n\t\t\t} else if (valueToDelete > tree.data) {\r\n\t\t\t\tthis.cmd(\r\n\t\t\t\t\t'SetText',\r\n\t\t\t\t\t0,\r\n\t\t\t\t\tvalueToDelete + ' > ' + tree.data + '.  Looking at right subtree'\r\n\t\t\t\t);\r\n\t\t\t} else {\r\n\t\t\t\tthis.cmd(\r\n\t\t\t\t\t'SetText',\r\n\t\t\t\t\t0,\r\n\t\t\t\t\tvalueToDelete + ' == ' + tree.data + '.  Found node to delete'\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t\tthis.cmd('Step');\r\n\t\t\tthis.cmd('SetHighlight', tree.graphicID, 0);\r\n\r\n\t\t\tif (valueToDelete === tree.data) {\r\n\t\t\t\tif (tree.left == null && tree.right == null) {\r\n\t\t\t\t\tthis.cmd('SetText', 0, 'Node to delete is a leaf.  Delete it.');\r\n\t\t\t\t\tthis.cmd('Delete', tree.graphicID);\r\n\t\t\t\t\tif (leftchild && tree.parent != null) {\r\n\t\t\t\t\t\ttree.parent.left = null;\r\n\t\t\t\t\t} else if (tree.parent != null) {\r\n\t\t\t\t\t\ttree.parent.right = null;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.treeRoot = null;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.resizeTree();\r\n\t\t\t\t\tthis.cmd('Step');\r\n\t\t\t\t} else if (tree.left == null) {\r\n\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t'SetText',\r\n\t\t\t\t\t\t0,\r\n\t\t\t\t\t\t'Node to delete has no left child.  \\nSet parent of deleted node to right child of deleted node.'\r\n\t\t\t\t\t);\r\n\t\t\t\t\tif (tree.parent != null) {\r\n\t\t\t\t\t\tthis.cmd('Disconnect', tree.parent.graphicID, tree.graphicID);\r\n\t\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t\t'Connect',\r\n\t\t\t\t\t\t\ttree.parent.graphicID,\r\n\t\t\t\t\t\t\ttree.right.graphicID,\r\n\t\t\t\t\t\t\tLINK_COLOR\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t\tthis.cmd('Step');\r\n\t\t\t\t\t\tthis.cmd('Delete', tree.graphicID);\r\n\t\t\t\t\t\tif (leftchild) {\r\n\t\t\t\t\t\t\ttree.parent.left = tree.right;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\ttree.parent.right = tree.right;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\ttree.right.parent = tree.parent;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.cmd('Delete', tree.graphicID);\r\n\t\t\t\t\t\tthis.treeRoot = tree.right;\r\n\t\t\t\t\t\tthis.treeRoot.parent = null;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.resizeTree();\r\n\t\t\t\t} else if (tree.right == null) {\r\n\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t'SetText',\r\n\t\t\t\t\t\t0,\r\n\t\t\t\t\t\t'Node to delete has no right child.  \\nSet parent of deleted node to left child of deleted node.'\r\n\t\t\t\t\t);\r\n\t\t\t\t\tif (tree.parent != null) {\r\n\t\t\t\t\t\tthis.cmd('Disconnect', tree.parent.graphicID, tree.graphicID);\r\n\t\t\t\t\t\tthis.cmd('Connect', tree.parent.graphicID, tree.left.graphicID, LINK_COLOR);\r\n\t\t\t\t\t\tthis.cmd('Step');\r\n\t\t\t\t\t\tthis.cmd('Delete', tree.graphicID);\r\n\t\t\t\t\t\tif (leftchild) {\r\n\t\t\t\t\t\t\ttree.parent.left = tree.left;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\ttree.parent.right = tree.left;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\ttree.left.parent = tree.parent;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.cmd('Delete', tree.graphicID);\r\n\t\t\t\t\t\tthis.treeRoot = tree.left;\r\n\t\t\t\t\t\tthis.treeRoot.parent = null;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.resizeTree();\r\n\t\t\t\t} // tree.left != null && tree.right != null\r\n\t\t\t\telse {\r\n\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t'SetText',\r\n\t\t\t\t\t\t0,\r\n\t\t\t\t\t\t'Node to delete has two childern.  \\nFind largest node in left subtree.'\r\n\t\t\t\t\t);\r\n\r\n\t\t\t\t\tthis.highlightID = this.nextIndex;\r\n\t\t\t\t\tthis.nextIndex += 1;\r\n\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t'CreateHighlightCircle',\r\n\t\t\t\t\t\tthis.highlightID,\r\n\t\t\t\t\t\tHIGHLIGHT_CIRCLE_COLOR,\r\n\t\t\t\t\t\ttree.x,\r\n\t\t\t\t\t\ttree.y\r\n\t\t\t\t\t);\r\n\t\t\t\t\tlet tmp = tree;\r\n\t\t\t\t\ttmp = tree.left;\r\n\t\t\t\t\tthis.cmd('Move', this.highlightID, tmp.x, tmp.y);\r\n\t\t\t\t\tthis.cmd('Step');\r\n\t\t\t\t\twhile (tmp.right != null) {\r\n\t\t\t\t\t\ttmp = tmp.right;\r\n\t\t\t\t\t\tthis.cmd('Move', this.highlightID, tmp.x, tmp.y);\r\n\t\t\t\t\t\tthis.cmd('Step');\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.cmd('SetText', tree.graphicID, ' ');\r\n\t\t\t\t\tconst labelID = this.nextIndex;\r\n\t\t\t\t\tthis.nextIndex += 1;\r\n\t\t\t\t\tthis.cmd('CreateLabel', labelID, tmp.data, tmp.x, tmp.y);\r\n\t\t\t\t\ttree.data = tmp.data;\r\n\t\t\t\t\tthis.cmd('Move', labelID, tree.x, tree.y);\r\n\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t'SetText',\r\n\t\t\t\t\t\t0,\r\n\t\t\t\t\t\t'Copy largest value of left subtree into node to delete.'\r\n\t\t\t\t\t);\r\n\r\n\t\t\t\t\tthis.cmd('Step');\r\n\t\t\t\t\tthis.cmd('SetHighlight', tree.graphicID, 0);\r\n\t\t\t\t\tthis.cmd('Delete', labelID);\r\n\t\t\t\t\tthis.cmd('SetText', tree.graphicID, tree.data);\r\n\t\t\t\t\tthis.cmd('Delete', this.highlightID);\r\n\t\t\t\t\tthis.cmd('SetText', 0, 'Remove node whose value we copied.');\r\n\r\n\t\t\t\t\tif (tmp.left == null) {\r\n\t\t\t\t\t\tif (tmp.parent !== tree) {\r\n\t\t\t\t\t\t\ttmp.parent.right = null;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\ttree.left = null;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tthis.cmd('Delete', tmp.graphicID);\r\n\t\t\t\t\t\tthis.resizeTree();\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.cmd('Disconnect', tmp.parent.graphicID, tmp.graphicID);\r\n\t\t\t\t\t\tthis.cmd('Connect', tmp.parent.graphicID, tmp.left.graphicID, LINK_COLOR);\r\n\t\t\t\t\t\tthis.cmd('Step');\r\n\t\t\t\t\t\tthis.cmd('Delete', tmp.graphicID);\r\n\t\t\t\t\t\tif (tmp.parent !== tree) {\r\n\t\t\t\t\t\t\ttmp.parent.right = tmp.left;\r\n\t\t\t\t\t\t\ttmp.left.parent = tmp.parent;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\ttree.left = tmp.left;\r\n\t\t\t\t\t\t\ttmp.left.parent = tree;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tthis.resizeTree();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t} else if (valueToDelete < tree.data) {\r\n\t\t\t\tif (tree.left != null) {\r\n\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t'CreateHighlightCircle',\r\n\t\t\t\t\t\tthis.highlightID,\r\n\t\t\t\t\t\tHIGHLIGHT_CIRCLE_COLOR,\r\n\t\t\t\t\t\ttree.x,\r\n\t\t\t\t\t\ttree.y\r\n\t\t\t\t\t);\r\n\t\t\t\t\tthis.cmd('Move', this.highlightID, tree.left.x, tree.left.y);\r\n\t\t\t\t\tthis.cmd('Step');\r\n\t\t\t\t\tthis.cmd('Delete', this.highlightID);\r\n\t\t\t\t}\r\n\t\t\t\tthis.treeDelete(tree.left, valueToDelete);\r\n\t\t\t} else {\r\n\t\t\t\tif (tree.right != null) {\r\n\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t'CreateHighlightCircle',\r\n\t\t\t\t\t\tthis.highlightID,\r\n\t\t\t\t\t\tHIGHLIGHT_CIRCLE_COLOR,\r\n\t\t\t\t\t\ttree.x,\r\n\t\t\t\t\t\ttree.y\r\n\t\t\t\t\t);\r\n\t\t\t\t\tthis.cmd('Move', this.highlightID, tree.right.x, tree.right.y);\r\n\t\t\t\t\tthis.cmd('Step');\r\n\t\t\t\t\tthis.cmd('Delete', this.highlightID);\r\n\t\t\t\t}\r\n\t\t\t\tthis.treeDelete(tree.right, valueToDelete);\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tthis.cmd('SetText', 0, 'Elemet ' + valueToDelete + ' not found, could not delete');\r\n\t\t}\r\n\t}\r\n\r\n\tresizeTree() {\r\n\t\tlet startingPoint = this.startingX;\r\n\t\tthis.resizeWidths(this.treeRoot);\r\n\t\tif (this.treeRoot != null) {\r\n\t\t\tif (this.treeRoot.leftWidth > startingPoint) {\r\n\t\t\t\tstartingPoint = this.treeRoot.leftWidth;\r\n\t\t\t} else if (this.treeRoot.rightWidth > startingPoint) {\r\n\t\t\t\tstartingPoint = Math.max(\r\n\t\t\t\t\tthis.treeRoot.leftWidth,\r\n\t\t\t\t\t2 * startingPoint - this.treeRoot.rightWidth\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t\tthis.setNewPositions(this.treeRoot, startingPoint, STARTING_Y, 0);\r\n\t\t\tthis.animateNewPositions(this.treeRoot);\r\n\t\t\tthis.cmd('Step');\r\n\t\t}\r\n\t}\r\n\r\n\tsetNewPositions(tree, xPosition, yPosition, side) {\r\n\t\tif (tree != null) {\r\n\t\t\ttree.y = yPosition;\r\n\t\t\tif (side === -1) {\r\n\t\t\t\txPosition = xPosition - tree.rightWidth;\r\n\t\t\t} else if (side === 1) {\r\n\t\t\t\txPosition = xPosition + tree.leftWidth;\r\n\t\t\t}\r\n\t\t\ttree.x = xPosition;\r\n\t\t\tthis.setNewPositions(tree.left, xPosition, yPosition + HEIGHT_DELTA, -1);\r\n\t\t\tthis.setNewPositions(tree.right, xPosition, yPosition + HEIGHT_DELTA, 1);\r\n\t\t}\r\n\t}\r\n\r\n\tanimateNewPositions(tree) {\r\n\t\tif (tree != null) {\r\n\t\t\tthis.cmd('Move', tree.graphicID, tree.x, tree.y);\r\n\t\t\tthis.animateNewPositions(tree.left);\r\n\t\t\tthis.animateNewPositions(tree.right);\r\n\t\t}\r\n\t}\r\n\r\n\tresizeWidths(tree) {\r\n\t\tif (tree == null) {\r\n\t\t\treturn 0;\r\n\t\t}\r\n\t\ttree.leftWidth = Math.max(this.resizeWidths(tree.left), WIDTH_DELTA / 2);\r\n\t\ttree.rightWidth = Math.max(this.resizeWidths(tree.right), WIDTH_DELTA / 2);\r\n\t\treturn tree.leftWidth + tree.rightWidth;\r\n\t}\r\n\r\n\tclear() {\r\n\t\tthis.commands = [];\r\n\t\tthis.recClear(this.treeRoot);\r\n\t\tthis.treeRoot = null;\r\n\t\treturn this.commands;\r\n\t}\r\n\r\n\trecClear(curr) {\r\n\t\tif (curr != null) {\r\n\t\t\tthis.cmd('Delete', curr.graphicID);\r\n\t\t\tthis.recClear(curr.left);\r\n\t\t\tthis.recClear(curr.right);\r\n\t\t}\r\n\t}\r\n\r\n\tdisableUI() {\r\n\t\tfor (let i = 0; i < this.controls.length; i++) {\r\n\t\t\tthis.controls[i].disabled = true;\r\n\t\t}\r\n\t}\r\n\r\n\tenableUI() {\r\n\t\tfor (let i = 0; i < this.controls.length; i++) {\r\n\t\t\tthis.controls[i].disabled = false;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction BSTNode(val, id, initialX, initialY) {\r\n\tthis.data = val;\r\n\tthis.x = initialX;\r\n\tthis.y = initialY;\r\n\tthis.graphicID = id;\r\n\tthis.left = null;\r\n\tthis.right = null;\r\n\tthis.parent = null;\r\n}\r\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\r\n//\r\n// Redistribution and use in source and binary forms, with or without modification, are\r\n// permitted provided that the following conditions are met:\r\n//\r\n// 1. Redistributions of source code must retain the above copyright notice, this list of\r\n// conditions and the following disclaimer.\r\n//\r\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\r\n// of conditions and the following disclaimer in the documentation and/or other materials\r\n// provided with the distribution.\r\n//\r\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\r\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\r\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\r\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\r\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\r\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\r\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\r\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\r\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\r\n//\r\n// The views and conclusions contained in the software and documentation are those of the\r\n// authors and should not be interpreted as representing official policies, either expressed\r\n// or implied, of the University of San Francisco\r\n\r\nimport Algorithm, { addControlToAlgorithmBar } from './Algorithm.js';\r\n\r\nconst FIRST_PRINT_POS_X = 50;\r\nconst PRINT_VERTICAL_GAP = 20;\r\nconst PRINT_MAX = 990;\r\nconst PRINT_HORIZONTAL_GAP = 50;\r\n\r\nconst MIN_MAX_DEGREE = 4;\r\n// const MAX_MAX_DEGREE = 7;\r\n\r\nconst HEIGHT_DELTA = 50;\r\nconst NODE_SPACING = 3;\r\nconst STARTING_Y = 30;\r\nconst WIDTH_PER_ELEM = 40;\r\nconst NODE_HEIGHT = 20;\r\n\r\nconst MESSAGE_X = 5;\r\nconst MESSAGE_Y = 10;\r\n\r\n// const LINK_COLOR = \"#007700\";\r\n// const HIGHLIGHT_CIRCLE_COLOR = \"#007700\";\r\nconst FOREGROUND_COLOR = '#007700';\r\nconst BACKGROUND_COLOR = '#EEFFEE';\r\nconst PRINT_COLOR = FOREGROUND_COLOR;\r\n\r\nexport default class BTree extends Algorithm {\r\n\tconstructor(am, w, h) {\r\n\t\tsuper(am, w, h);\r\n\t\tthis.nextIndex = 0;\r\n\r\n\t\tthis.starting_x = w / 2;\r\n\r\n\t\tthis.preemptiveSplit = false;\r\n\r\n\t\tthis.addControls();\r\n\r\n\t\tthis.max_keys = 3;\r\n\t\tthis.min_keys = 1;\r\n\t\tthis.split_index = 1;\r\n\r\n\t\tthis.max_degree = 4;\r\n\r\n\t\tthis.messageID = this.nextIndex++;\r\n\t\tthis.cmd('CreateLabel', this.messageID, '', MESSAGE_X, MESSAGE_Y, 0);\r\n\t\tthis.moveLabel1ID = this.nextIndex++;\r\n\t\tthis.moveLabel2ID = this.nextIndex++;\r\n\r\n\t\tthis.animationManager.StartNewAnimation(this.commands);\r\n\t\tthis.animationManager.skipForward();\r\n\t\tthis.animationManager.clearHistory();\r\n\t\tthis.commands = [];\r\n\r\n\t\tthis.first_print_pos_y = h - 3 * PRINT_VERTICAL_GAP;\r\n\r\n\t\tthis.xPosOfNextLabel = 100;\r\n\t\tthis.yPosOfNextLabel = 200;\r\n\t}\r\n\r\n\taddControls() {\r\n\t\tthis.controls = [];\r\n\r\n\t\tthis.insertField = addControlToAlgorithmBar('Text', '');\r\n\t\tthis.insertField.onkeydown = this.returnSubmit(\r\n\t\t\tthis.insertField,\r\n\t\t\tthis.insertCallback.bind(this),\r\n\t\t\t4\r\n\t\t);\r\n\t\tthis.controls.push(this.insertField);\r\n\r\n\t\tthis.insertButton = addControlToAlgorithmBar('Button', 'Insert');\r\n\t\tthis.insertButton.onclick = this.insertCallback.bind(this);\r\n\t\tthis.controls.push(this.insertButton);\r\n\r\n\t\tthis.deleteField = addControlToAlgorithmBar('Text', '');\r\n\t\tthis.deleteField.onkeydown = this.returnSubmit(\r\n\t\t\tthis.deleteField,\r\n\t\t\tthis.deleteCallback.bind(this),\r\n\t\t\t4\r\n\t\t);\r\n\t\tthis.controls.push(this.deleteField);\r\n\r\n\t\tthis.deleteButton = addControlToAlgorithmBar('Button', 'Delete');\r\n\t\tthis.deleteButton.onclick = this.deleteCallback.bind(this);\r\n\t\tthis.controls.push(this.deleteButton);\r\n\r\n\t\tthis.findField = addControlToAlgorithmBar('Text', '');\r\n\t\tthis.findField.onkeydown = this.returnSubmit(\r\n\t\t\tthis.findField,\r\n\t\t\tthis.findCallback.bind(this),\r\n\t\t\t4\r\n\t\t);\r\n\t\tthis.controls.push(this.findField);\r\n\r\n\t\tthis.findButton = addControlToAlgorithmBar('Button', 'Find');\r\n\t\tthis.findButton.onclick = this.findCallback.bind(this);\r\n\t\tthis.controls.push(this.findButton);\r\n\r\n\t\tthis.printButton = addControlToAlgorithmBar('Button', 'Print');\r\n\t\tthis.printButton.onclick = this.printCallback.bind(this);\r\n\t\tthis.controls.push(this.printButton);\r\n\r\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear');\r\n\t\tthis.clearButton.onclick = this.clearCallback.bind(this);\r\n\t\tthis.controls.push(this.clearButton);\r\n\r\n\t\t// var i;\r\n\t\t// radioButtonNames = [];\r\n\t\t// for (i = MIN_MAX_DEGREE; i <= MAX_MAX_DEGREE; i++)\r\n\t\t// {\r\n\t\t// \tradioButtonNames.push(\"Max. Degree = \" + String(i));\r\n\t\t// }\r\n\t\t//\r\n\t\t// this.maxDegreeRadioButtons = addRadioButtonGroupToAlgorithmBar(radioButtonNames, \"MaxDegree\");\r\n\t\t//\r\n\t\t// this.maxDegreeRadioButtons[0].checked = true;\r\n\t\t// for(i = 0; i < this.maxDegreeRadioButtons.length; i++)\r\n\t\t// {\r\n\t\t// \tthis.maxDegreeRadioButtons[i].onclick = this.maxDegreeChangedHandler.bind(this,i+MIN_MAX_DEGREE);\r\n\t\t// }\r\n\r\n\t\t// this.premptiveSplitBox = addCheckboxToAlgorithmBar(\"Preemtive Split / Merge (Even max degree only)\");\r\n\t\t// this.premptiveSplitBox.onclick = this.premtiveSplitCallback.bind(this);\r\n\r\n\t\t// Other buttons ...\r\n\t}\r\n\r\n\treset() {\r\n\t\tthis.nextIndex = 3;\r\n\t\tthis.max_degree = 4;\r\n\t\tthis.max_keys = 3;\r\n\t\tthis.min_keys = 1;\r\n\t\tthis.split_index = 1;\r\n\t\t// NOTE: The order of these last two this.commands matters!\r\n\t\tthis.treeRoot = null;\r\n\t\tthis.ignoreInputs = true;\r\n\t\t// maxDegreeButtonArray[this.max_degree].selected = true;\r\n\t\tthis.ignoreInputs = false;\r\n\t}\r\n\r\n\tenableUI() {\r\n\t\tlet i;\r\n\t\tfor (i = 0; i < this.controls.length; i++) {\r\n\t\t\tthis.controls[i].disabled = false;\r\n\t\t}\r\n\r\n\t\t// TODO  Only enable even maxdegree if preemptive merge is on\r\n\r\n\t\t// if (this.preemptiveSplit)\r\n\t\t// {\r\n\t\t// \tvar initialEven = MIN_MAX_DEGREE % 2;\r\n\t\t// \tvar i;\r\n\t\t// \tfor (i = initialEven; i <= MAX_MAX_DEGREE - MIN_MAX_DEGREE; i+= 2)\r\n\t\t// \t{\r\n\t\t// \t\tthis.maxDegreeRadioButtons[i].disabled = false;\r\n\t\t// \t}\r\n\t\t// }\r\n\t\t// else\r\n\t\t// {\r\n\t\t// \tfor (i = 0; i < this.maxDegreeRadioButtons.length; i++)\r\n\t\t// \t{\r\n\t\t// \t\tthis.maxDegreeRadioButtons[i].disabled = false;\r\n\t\t// \t}\r\n\t\t// }\r\n\r\n\t\t// if (this.max_degree % 2 == 0)\r\n\t\t// {\r\n\t\t// \tthis.premptiveSplitBox.disabled = false;\r\n\t\t// }\r\n\t}\r\n\r\n\tdisableUI() {\r\n\t\tfor (let i = 0; i < this.controls.length; i++) {\r\n\t\t\tthis.controls[i].disabled = true;\r\n\t\t}\r\n\r\n\t\t// for (i = 0; i < this.maxDegreeRadioButtons.length; i++)\r\n\t\t// {\r\n\t\t// \tthis.maxDegreeRadioButtons[i].disabled = true;\r\n\t\t// }\r\n\r\n\t\t// this.premptiveSplitBox.disabled = true;\r\n\t}\r\n\r\n\t//TODO:  Fix me!\r\n\tmaxDegreeChangedHandler(newMaxDegree) {\r\n\t\tif (this.max_degree !== newMaxDegree) {\r\n\t\t\tthis.implementAction(this.changeDegree.bind(this), newMaxDegree);\r\n\t\t\tthis.animationManager.skipForward();\r\n\t\t\tthis.animationManager.clearHistory();\r\n\t\t}\r\n\t}\r\n\r\n\tinsertCallback() {\r\n\t\tconst insertedValue = this.normalizeNumber(this.insertField.value, 4);\r\n\t\tif (insertedValue !== '') {\r\n\t\t\tthis.insertField.value = '';\r\n\t\t\tthis.implementAction(this.insertElement.bind(this), insertedValue);\r\n\t\t}\r\n\t}\r\n\r\n\tdeleteCallback() {\r\n\t\tlet deletedValue = this.deleteField.value;\r\n\t\tif (deletedValue !== '') {\r\n\t\t\tdeletedValue = this.normalizeNumber(this.deleteField.value, 4);\r\n\t\t\tthis.deleteField.value = '';\r\n\t\t\tthis.implementAction(this.deleteElement.bind(this), deletedValue);\r\n\t\t}\r\n\t}\r\n\r\n\tclearCallback() {\r\n\t\tthis.implementAction(this.clearTree.bind(this), '');\r\n\t}\r\n\r\n\tpremtiveSplitCallback() {\r\n\t\tif (this.preemptiveSplit !== this.premptiveSplitBox.checked) {\r\n\t\t\tthis.implementAction(\r\n\t\t\t\tthis.changePreemtiveSplit.bind(this),\r\n\t\t\t\tthis.premptiveSplitBox.checked\r\n\t\t\t);\r\n\t\t}\r\n\t}\r\n\r\n\tchangePreemtiveSplit(newValue) {\r\n\t\tthis.commands = [];\r\n\t\tthis.cmd('Step');\r\n\t\tthis.preemptiveSplit = newValue;\r\n\t\tif (this.premptiveSplitBox.checked !== this.preemptiveSplit) {\r\n\t\t\tthis.premptiveSplitBox.checked = this.preemptiveSplit;\r\n\t\t}\r\n\t\treturn this.commands;\r\n\t}\r\n\r\n\tprintCallback() {\r\n\t\tthis.implementAction(this.printTree.bind(this), '');\r\n\t}\r\n\r\n\tprintTree() {\r\n\t\tthis.commands = [];\r\n\t\tthis.cmd('SetText', this.messageID, 'Printing tree');\r\n\t\tconst firstLabel = this.nextIndex;\r\n\r\n\t\tthis.xPosOfNextLabel = FIRST_PRINT_POS_X;\r\n\t\tthis.yPosOfNextLabel = this.first_print_pos_y;\r\n\r\n\t\tthis.printTreeRec(this.treeRoot);\r\n\t\tthis.cmd('Step');\r\n\t\tfor (let i = firstLabel; i < this.nextIndex; i++) {\r\n\t\t\tthis.cmd('Delete', i);\r\n\t\t}\r\n\t\tthis.nextIndex = firstLabel;\r\n\t\tthis.cmd('SetText', this.messageID, '');\r\n\t\treturn this.commands;\r\n\t}\r\n\r\n\tprintTreeRec(tree) {\r\n\t\tthis.cmd('SetHighlight', tree.graphicID, 1);\r\n\t\tlet nextLabelID;\r\n\t\tif (tree.isLeaf) {\r\n\t\t\tfor (let i = 0; i < tree.numKeys; i++) {\r\n\t\t\t\tnextLabelID = this.nextIndex++;\r\n\t\t\t\tthis.cmd('CreateLabel', nextLabelID, tree.keys[i], this.getLabelX(tree, i), tree.y);\r\n\t\t\t\tthis.cmd('SetForegroundColor', nextLabelID, PRINT_COLOR);\r\n\t\t\t\tthis.cmd('Move', nextLabelID, this.xPosOfNextLabel, this.yPosOfNextLabel);\r\n\t\t\t\tthis.cmd('Step');\r\n\t\t\t\tthis.xPosOfNextLabel += PRINT_HORIZONTAL_GAP;\r\n\t\t\t\tif (this.xPosOfNextLabel > PRINT_MAX) {\r\n\t\t\t\t\tthis.xPosOfNextLabel = FIRST_PRINT_POS_X;\r\n\t\t\t\t\tthis.yPosOfNextLabel += PRINT_VERTICAL_GAP;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.cmd('SetHighlight', tree.graphicID, 0);\r\n\t\t} else {\r\n\t\t\tthis.cmd('SetEdgeHighlight', tree.graphicID, tree.children[0].graphicID, 1);\r\n\t\t\tthis.cmd('Step');\r\n\t\t\tthis.cmd('SetHighlight', tree.graphicID, 0);\r\n\t\t\tthis.cmd('SetEdgeHighlight', tree.graphicID, tree.children[0].graphicID, 0);\r\n\t\t\tthis.printTreeRec(tree.children[0]);\r\n\t\t\tfor (let i = 0; i < tree.numKeys; i++) {\r\n\t\t\t\tthis.cmd('SetHighlight', tree.graphicID, 1);\r\n\t\t\t\tnextLabelID = this.nextIndex++;\r\n\t\t\t\tthis.cmd('CreateLabel', nextLabelID, tree.keys[i], this.getLabelX(tree, i), tree.y);\r\n\t\t\t\tthis.cmd('SetForegroundColor', nextLabelID, PRINT_COLOR);\r\n\t\t\t\tthis.cmd('Move', nextLabelID, this.xPosOfNextLabel, this.yPosOfNextLabel);\r\n\t\t\t\tthis.cmd('Step');\r\n\t\t\t\tthis.xPosOfNextLabel += PRINT_HORIZONTAL_GAP;\r\n\t\t\t\tif (this.xPosOfNextLabel > PRINT_MAX) {\r\n\t\t\t\t\tthis.xPosOfNextLabel = FIRST_PRINT_POS_X;\r\n\t\t\t\t\tthis.yPosOfNextLabel += PRINT_VERTICAL_GAP;\r\n\t\t\t\t}\r\n\t\t\t\tthis.cmd('SetEdgeHighlight', tree.graphicID, tree.children[i + 1].graphicID, 1);\r\n\t\t\t\tthis.cmd('Step');\r\n\t\t\t\tthis.cmd('SetHighlight', tree.graphicID, 0);\r\n\t\t\t\tthis.cmd('SetEdgeHighlight', tree.graphicID, tree.children[i + 1].graphicID, 0);\r\n\t\t\t\tthis.printTreeRec(tree.children[i + 1]);\r\n\t\t\t}\r\n\t\t\tthis.cmd('SetHighlight', tree.graphicID, 1);\r\n\t\t\tthis.cmd('Step');\r\n\t\t\tthis.cmd('SetHighlight', tree.graphicID, 0);\r\n\t\t}\r\n\t}\r\n\r\n\tclearTree() {\r\n\t\tthis.commands = [];\r\n\t\tthis.deleteTree(this.treeRoot);\r\n\t\tthis.treeRoot = null;\r\n\t\tthis.nextIndex = 3;\r\n\t\treturn this.commands;\r\n\t}\r\n\r\n\tdeleteTree(tree) {\r\n\t\tif (tree != null) {\r\n\t\t\tif (!tree.isLeaf) {\r\n\t\t\t\tfor (let i = 0; i <= tree.numKeys; i++) {\r\n\t\t\t\t\tthis.cmd('Disconnect', tree.graphicID, tree.children[i].graphicID);\r\n\t\t\t\t\tthis.deleteTree(tree.children[i]);\r\n\t\t\t\t\t// tree.children[i] = null;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.cmd('Delete', tree.graphicID);\r\n\t\t}\r\n\t}\r\n\r\n\tchangeDegree(degree) {\r\n\t\tthis.commands = [];\r\n\t\tthis.deleteTree(this.treeRoot);\r\n\t\tthis.treeRoot = null;\r\n\t\tthis.nextIndex = 3;\r\n\t\tconst newDegree = degree;\r\n\t\tthis.ignoreInputs = true;\r\n\t\t//TODO:  Check me!\r\n\t\tthis.maxDegreeRadioButtons[newDegree - MIN_MAX_DEGREE].checked = true;\r\n\r\n\t\tthis.ignoreInputs = false;\r\n\t\tthis.max_degree = newDegree;\r\n\t\tthis.max_keys = newDegree - 1;\r\n\t\tthis.min_keys = Math.floor((newDegree + 1) / 2) - 1;\r\n\t\tthis.split_index = Math.floor((newDegree - 1) / 2);\r\n\t\tif (this.commands.length === 0) {\r\n\t\t\tthis.cmd('Step');\r\n\t\t}\r\n\t\tif (newDegree % 2 !== 0 && this.preemptiveSplit) {\r\n\t\t\tthis.preemptiveSplit = false;\r\n\t\t\tthis.premptiveSplitBox.checked = false;\r\n\t\t}\r\n\t\treturn this.commands;\r\n\t}\r\n\r\n\tfindCallback() {\r\n\t\tconst findValue = this.normalizeNumber(this.findField.value, 4);\r\n\t\tthis.findField.value = '';\r\n\t\tthis.implementAction(this.findElement.bind(this), findValue);\r\n\t}\r\n\r\n\tfindElement(findValue) {\r\n\t\tthis.commands = [];\r\n\r\n\t\tthis.cmd('SetText', this.messageID, 'Finding ' + findValue);\r\n\t\tthis.findInTree(this.treeRoot, findValue);\r\n\r\n\t\treturn this.commands;\r\n\t}\r\n\r\n\tfindInTree(tree, val) {\r\n\t\tif (tree != null) {\r\n\t\t\tthis.cmd('SetHighlight', tree.graphicID, 1);\r\n\t\t\tthis.cmd('Step');\r\n\t\t\tlet i;\r\n\t\t\tfor (i = 0; i < tree.numKeys && tree.keys[i] < val; i++);\r\n\t\t\tif (i === tree.numKeys) {\r\n\t\t\t\tif (!tree.isLeaf) {\r\n\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t'SetEdgeHighlight',\r\n\t\t\t\t\t\ttree.graphicID,\r\n\t\t\t\t\t\ttree.children[tree.numKeys].graphicID,\r\n\t\t\t\t\t\t1\r\n\t\t\t\t\t);\r\n\t\t\t\t\tthis.cmd('Step');\r\n\t\t\t\t\tthis.cmd('SetHighlight', tree.graphicID, 0);\r\n\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t'SetEdgeHighlight',\r\n\t\t\t\t\t\ttree.graphicID,\r\n\t\t\t\t\t\ttree.children[tree.numKeys].graphicID,\r\n\t\t\t\t\t\t0\r\n\t\t\t\t\t);\r\n\t\t\t\t\tthis.findInTree(tree.children[tree.numKeys], val);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.cmd('SetHighlight', tree.graphicID, 0);\r\n\t\t\t\t\tthis.cmd('SetText', this.messageID, 'Element ' + val + ' is not in the tree');\r\n\t\t\t\t}\r\n\t\t\t} else if (tree.keys[i] > val) {\r\n\t\t\t\tif (!tree.isLeaf) {\r\n\t\t\t\t\tthis.cmd('SetEdgeHighlight', tree.graphicID, tree.children[i].graphicID, 1);\r\n\t\t\t\t\tthis.cmd('Step');\r\n\t\t\t\t\tthis.cmd('SetHighlight', tree.graphicID, 0);\r\n\t\t\t\t\tthis.cmd('SetEdgeHighlight', tree.graphicID, tree.children[i].graphicID, 0);\r\n\t\t\t\t\tthis.findInTree(tree.children[i], val);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.cmd('SetHighlight', tree.graphicID, 0);\r\n\t\t\t\t\tthis.cmd('SetText', this.messageID, 'Element ' + val + ' is not in the tree');\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tthis.cmd('SetTextColor', tree.graphicID, '#FF0000', i);\r\n\t\t\t\tthis.cmd('SetText', this.messageID, 'Element ' + val + ' found');\r\n\t\t\t\tthis.cmd('Step');\r\n\t\t\t\tthis.cmd('SetTextColor', tree.graphicID, FOREGROUND_COLOR, i);\r\n\t\t\t\tthis.cmd('SetHighlight', tree.graphicID, 0);\r\n\r\n\t\t\t\tthis.cmd('Step');\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tthis.cmd('SetText', this.messageID, 'Element ' + val + ' is not in the tree');\r\n\t\t}\r\n\t}\r\n\r\n\tinsertElement(insertedValue) {\r\n\t\tthis.commands = [];\r\n\r\n\t\tthis.cmd('SetText', this.messageID, 'Inserting ' + insertedValue);\r\n\t\tthis.cmd('Step');\r\n\r\n\t\tif (this.treeRoot == null) {\r\n\t\t\tthis.treeRoot = new BTreeNode(this.nextIndex++, this.starting_x, STARTING_Y);\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'CreateBTreeNode',\r\n\t\t\t\tthis.treeRoot.graphicID,\r\n\t\t\t\tWIDTH_PER_ELEM,\r\n\t\t\t\tNODE_HEIGHT,\r\n\t\t\t\t1,\r\n\t\t\t\tthis.starting_x,\r\n\t\t\t\tSTARTING_Y,\r\n\t\t\t\tBACKGROUND_COLOR,\r\n\t\t\t\tFOREGROUND_COLOR\r\n\t\t\t);\r\n\t\t\tthis.treeRoot.keys[0] = insertedValue;\r\n\t\t\tthis.cmd('SetText', this.treeRoot.graphicID, insertedValue, 0);\r\n\t\t} else {\r\n\t\t\tif (this.preemptiveSplit) {\r\n\t\t\t\tif (this.treeRoot.numKeys === this.max_keys) {\r\n\t\t\t\t\tthis.split(this.treeRoot);\r\n\t\t\t\t\tthis.resizeTree();\r\n\t\t\t\t\tthis.cmd('Step');\r\n\t\t\t\t}\r\n\t\t\t\tthis.insertNotFull(this.treeRoot, insertedValue);\r\n\t\t\t} else {\r\n\t\t\t\tthis.insert(this.treeRoot, insertedValue);\r\n\t\t\t}\r\n\t\t\tif (!this.treeRoot.isLeaf) {\r\n\t\t\t\tthis.resizeTree();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis.cmd('SetText', this.messageID, '');\r\n\r\n\t\treturn this.commands;\r\n\t}\r\n\r\n\tinsertNotFull(tree, insertValue) {\r\n\t\tthis.cmd('SetHighlight', tree.graphicID, 1);\r\n\t\tthis.cmd('Step');\r\n\t\tif (tree.isLeaf) {\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'SetText',\r\n\t\t\t\tthis.messageID,\r\n\t\t\t\t'Inserting ' + insertValue + '.  Inserting into a leaf'\r\n\t\t\t);\r\n\t\t\ttree.numKeys++;\r\n\t\t\tthis.cmd('SetNumElements', tree.graphicID, tree.numKeys);\r\n\t\t\tlet insertIndex = tree.numKeys - 1;\r\n\t\t\twhile (insertIndex > 0 && tree.keys[insertIndex - 1] > insertValue) {\r\n\t\t\t\ttree.keys[insertIndex] = tree.keys[insertIndex - 1];\r\n\t\t\t\tthis.cmd('SetText', tree.graphicID, tree.keys[insertIndex], insertIndex);\r\n\t\t\t\tinsertIndex--;\r\n\t\t\t}\r\n\t\t\ttree.keys[insertIndex] = insertValue;\r\n\t\t\tthis.cmd('SetText', tree.graphicID, tree.keys[insertIndex], insertIndex);\r\n\t\t\tthis.cmd('SetHighlight', tree.graphicID, 0);\r\n\t\t\tthis.resizeTree();\r\n\t\t} else {\r\n\t\t\tlet findIndex = 0;\r\n\t\t\twhile (findIndex < tree.numKeys && tree.keys[findIndex] < insertValue) {\r\n\t\t\t\tfindIndex++;\r\n\t\t\t}\r\n\t\t\tthis.cmd('SetEdgeHighlight', tree.graphicID, tree.children[findIndex].graphicID, 1);\r\n\t\t\tthis.cmd('Step');\r\n\t\t\tthis.cmd('SetEdgeHighlight', tree.graphicID, tree.children[findIndex].graphicID, 0);\r\n\t\t\tthis.cmd('SetHighlight', tree.graphicID, 0);\r\n\t\t\tif (tree.children[findIndex].numKeys === this.max_keys) {\r\n\t\t\t\tconst newTree = this.split(tree.children[findIndex]);\r\n\t\t\t\tthis.resizeTree();\r\n\t\t\t\tthis.cmd('Step');\r\n\t\t\t\tthis.insertNotFull(newTree, insertValue);\r\n\t\t\t} else {\r\n\t\t\t\tthis.insertNotFull(tree.children[findIndex], insertValue);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tinsert(tree, insertValue) {\r\n\t\tthis.cmd('SetHighlight', tree.graphicID, 1);\r\n\t\tthis.cmd('Step');\r\n\t\tif (tree.isLeaf) {\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'SetText',\r\n\t\t\t\tthis.messageID,\r\n\t\t\t\t'Inserting ' + insertValue + '.  Inserting into a leaf'\r\n\t\t\t);\r\n\t\t\ttree.numKeys++;\r\n\t\t\tthis.cmd('SetNumElements', tree.graphicID, tree.numKeys);\r\n\t\t\tlet insertIndex = tree.numKeys - 1;\r\n\t\t\twhile (insertIndex > 0 && tree.keys[insertIndex - 1] > insertValue) {\r\n\t\t\t\ttree.keys[insertIndex] = tree.keys[insertIndex - 1];\r\n\t\t\t\tthis.cmd('SetText', tree.graphicID, tree.keys[insertIndex], insertIndex);\r\n\t\t\t\tinsertIndex--;\r\n\t\t\t}\r\n\t\t\ttree.keys[insertIndex] = insertValue;\r\n\t\t\tthis.cmd('SetText', tree.graphicID, tree.keys[insertIndex], insertIndex);\r\n\t\t\tthis.cmd('SetHighlight', tree.graphicID, 0);\r\n\t\t\tthis.resizeTree();\r\n\t\t\tthis.insertRepair(tree);\r\n\t\t} else {\r\n\t\t\tlet findIndex = 0;\r\n\t\t\twhile (findIndex < tree.numKeys && tree.keys[findIndex] < insertValue) {\r\n\t\t\t\tfindIndex++;\r\n\t\t\t}\r\n\t\t\tthis.cmd('SetEdgeHighlight', tree.graphicID, tree.children[findIndex].graphicID, 1);\r\n\t\t\tthis.cmd('Step');\r\n\t\t\tthis.cmd('SetEdgeHighlight', tree.graphicID, tree.children[findIndex].graphicID, 0);\r\n\t\t\tthis.cmd('SetHighlight', tree.graphicID, 0);\r\n\t\t\tthis.insert(tree.children[findIndex], insertValue);\r\n\t\t}\r\n\t}\r\n\r\n\tinsertRepair(tree) {\r\n\t\tif (tree.numKeys <= this.max_keys) {\r\n\t\t\treturn;\r\n\t\t} else if (tree.parent == null) {\r\n\t\t\tthis.treeRoot = this.split(tree);\r\n\t\t\treturn;\r\n\t\t} else {\r\n\t\t\tconst newNode = this.split(tree);\r\n\t\t\tthis.insertRepair(newNode);\r\n\t\t}\r\n\t}\r\n\r\n\tsplit(tree) {\r\n\t\tthis.cmd('SetText', this.messageID, 'Node now contains too many keys.  Splittig ...');\r\n\t\tthis.cmd('SetHighlight', tree.graphicID, 1);\r\n\t\tthis.cmd('Step');\r\n\t\tthis.cmd('SetHighlight', tree.graphicID, 0);\r\n\t\tconst rightNode = new BTreeNode(this.nextIndex++, tree.x + 100, tree.y);\r\n\t\trightNode.numKeys = tree.numKeys - this.split_index - 1;\r\n\t\tconst risingNode = tree.keys[this.split_index];\r\n\t\tlet currentParent;\r\n\t\tlet parentIndex;\r\n\t\tif (tree.parent != null) {\r\n\t\t\tcurrentParent = tree.parent;\r\n\t\t\tfor (\r\n\t\t\t\tparentIndex = 0;\r\n\t\t\t\tparentIndex < currentParent.numKeys + 1 &&\r\n\t\t\t\tcurrentParent.children[parentIndex] !== tree;\r\n\t\t\t\tparentIndex++\r\n\t\t\t);\r\n\t\t\tif (parentIndex === currentParent.numKeys + 1) {\r\n\t\t\t\tthrow new Error(\"Couldn't find which child we were!\");\r\n\t\t\t}\r\n\t\t\tthis.cmd('SetNumElements', currentParent.graphicID, currentParent.numKeys + 1);\r\n\t\t\tfor (let i = currentParent.numKeys; i > parentIndex; i--) {\r\n\t\t\t\tcurrentParent.children[i + 1] = currentParent.children[i];\r\n\t\t\t\tthis.cmd(\r\n\t\t\t\t\t'Disconnect',\r\n\t\t\t\t\tcurrentParent.graphicID,\r\n\t\t\t\t\tcurrentParent.children[i].graphicID\r\n\t\t\t\t);\r\n\t\t\t\tthis.cmd(\r\n\t\t\t\t\t'Connect',\r\n\t\t\t\t\tcurrentParent.graphicID,\r\n\t\t\t\t\tcurrentParent.children[i].graphicID,\r\n\t\t\t\t\tFOREGROUND_COLOR,\r\n\t\t\t\t\t0, // Curve\r\n\t\t\t\t\t0, // Directed\r\n\t\t\t\t\t'', // Label\r\n\t\t\t\t\ti + 1\r\n\t\t\t\t);\r\n\r\n\t\t\t\tcurrentParent.keys[i] = currentParent.keys[i - 1];\r\n\t\t\t\tthis.cmd('SetText', currentParent.graphicID, currentParent.keys[i], i);\r\n\t\t\t}\r\n\t\t\tcurrentParent.numKeys++;\r\n\t\t\tcurrentParent.keys[parentIndex] = risingNode;\r\n\t\t\tthis.cmd('SetText', currentParent.graphicID, '', parentIndex);\r\n\t\t\tthis.moveLabel1ID = this.nextIndex++;\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'CreateLabel',\r\n\t\t\t\tthis.moveLabel1ID,\r\n\t\t\t\trisingNode,\r\n\t\t\t\tthis.getLabelX(tree, this.split_index),\r\n\t\t\t\ttree.y\r\n\t\t\t);\r\n\t\t\tthis.cmd('SetForegroundColor', this.moveLabel1ID, FOREGROUND_COLOR);\r\n\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'Move',\r\n\t\t\t\tthis.moveLabel1ID,\r\n\t\t\t\tthis.getLabelX(currentParent, parentIndex),\r\n\t\t\t\tcurrentParent.y\r\n\t\t\t);\r\n\r\n\t\t\tcurrentParent.children[parentIndex + 1] = rightNode;\r\n\t\t\trightNode.parent = currentParent;\r\n\t\t}\r\n\r\n\t\tthis.cmd(\r\n\t\t\t'CreateBTreeNode',\r\n\t\t\trightNode.graphicID,\r\n\t\t\tWIDTH_PER_ELEM,\r\n\t\t\tNODE_HEIGHT,\r\n\t\t\ttree.numKeys - this.split_index - 1,\r\n\t\t\ttree.x,\r\n\t\t\ttree.y,\r\n\t\t\tBACKGROUND_COLOR,\r\n\t\t\tFOREGROUND_COLOR\r\n\t\t);\r\n\r\n\t\tfor (let i = this.split_index + 1; i < tree.numKeys + 1; i++) {\r\n\t\t\trightNode.children[i - this.split_index - 1] = tree.children[i];\r\n\t\t\tif (tree.children[i] != null) {\r\n\t\t\t\trightNode.isLeaf = false;\r\n\t\t\t\tthis.cmd('Disconnect', tree.graphicID, tree.children[i].graphicID);\r\n\r\n\t\t\t\tthis.cmd(\r\n\t\t\t\t\t'Connect',\r\n\t\t\t\t\trightNode.graphicID,\r\n\t\t\t\t\trightNode.children[i - this.split_index - 1].graphicID,\r\n\t\t\t\t\tFOREGROUND_COLOR,\r\n\t\t\t\t\t0, // Curve\r\n\t\t\t\t\t0, // Directed\r\n\t\t\t\t\t'', // Label\r\n\t\t\t\t\ti - this.split_index - 1\r\n\t\t\t\t);\r\n\t\t\t\tif (tree.children[i] != null) {\r\n\t\t\t\t\ttree.children[i].parent = rightNode;\r\n\t\t\t\t}\r\n\t\t\t\ttree.children[i] = null;\r\n\t\t\t}\r\n\t\t}\r\n\t\tfor (let i = this.split_index + 1; i < tree.numKeys; i++) {\r\n\t\t\trightNode.keys[i - this.split_index - 1] = tree.keys[i];\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'SetText',\r\n\t\t\t\trightNode.graphicID,\r\n\t\t\t\trightNode.keys[i - this.split_index - 1],\r\n\t\t\t\ti - this.split_index - 1\r\n\t\t\t);\r\n\t\t}\r\n\t\tconst leftNode = tree;\r\n\t\tleftNode.numKeys = this.split_index;\r\n\t\t// TO MAKE UNDO WORK -- CAN REMOVE LATER VV\r\n\t\tfor (let i = this.split_index; i < tree.numKeys; i++) {\r\n\t\t\tthis.cmd('SetText', tree.graphicID, '', i);\r\n\t\t}\r\n\t\t// TO MAKE UNDO WORK -- CAN REMOVE LATER ^^\r\n\t\tthis.cmd('SetNumElements', tree.graphicID, this.split_index);\r\n\r\n\t\tif (tree.parent != null) {\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'Connect',\r\n\t\t\t\tcurrentParent.graphicID,\r\n\t\t\t\trightNode.graphicID,\r\n\t\t\t\tFOREGROUND_COLOR,\r\n\t\t\t\t0, // Curve\r\n\t\t\t\t0, // Directed\r\n\t\t\t\t'', // Label\r\n\t\t\t\tparentIndex + 1\r\n\t\t\t);\r\n\t\t\tthis.resizeTree();\r\n\t\t\tthis.cmd('Step');\r\n\t\t\tthis.cmd('Delete', this.moveLabel1ID);\r\n\t\t\tthis.cmd('SetText', currentParent.graphicID, risingNode, parentIndex);\r\n\t\t\treturn tree.parent;\r\n\t\t} //\t\t\tif (tree.parent == null)\r\n\t\telse {\r\n\t\t\tthis.treeRoot = new BTreeNode(this.nextIndex++, this.starting_x, STARTING_Y);\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'CreateBTreeNode',\r\n\t\t\t\tthis.treeRoot.graphicID,\r\n\t\t\t\tWIDTH_PER_ELEM,\r\n\t\t\t\tNODE_HEIGHT,\r\n\t\t\t\t1,\r\n\t\t\t\tthis.starting_x,\r\n\t\t\t\tSTARTING_Y,\r\n\t\t\t\tBACKGROUND_COLOR,\r\n\t\t\t\tFOREGROUND_COLOR\r\n\t\t\t);\r\n\t\t\tthis.treeRoot.keys[0] = risingNode;\r\n\t\t\tthis.cmd('SetText', this.treeRoot.graphicID, risingNode, 0);\r\n\t\t\tthis.treeRoot.children[0] = leftNode;\r\n\t\t\tthis.treeRoot.children[1] = rightNode;\r\n\t\t\tleftNode.parent = this.treeRoot;\r\n\t\t\trightNode.parent = this.treeRoot;\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'Connect',\r\n\t\t\t\tthis.treeRoot.graphicID,\r\n\t\t\t\tleftNode.graphicID,\r\n\t\t\t\tFOREGROUND_COLOR,\r\n\t\t\t\t0, // Curve\r\n\t\t\t\t0, // Directed\r\n\t\t\t\t'', // Label\r\n\t\t\t\t0\r\n\t\t\t); // Connection Point\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'Connect',\r\n\t\t\t\tthis.treeRoot.graphicID,\r\n\t\t\t\trightNode.graphicID,\r\n\t\t\t\tFOREGROUND_COLOR,\r\n\t\t\t\t0, // Curve\r\n\t\t\t\t0, // Directed\r\n\t\t\t\t'', // Label\r\n\t\t\t\t1\r\n\t\t\t); // Connection Point\r\n\t\t\tthis.treeRoot.isLeaf = false;\r\n\t\t\treturn this.treeRoot;\r\n\t\t}\r\n\t}\r\n\r\n\tdeleteElement(deletedValue) {\r\n\t\tthis.commands = [];\r\n\t\tthis.cmd('SetText', 0, 'Deleting ' + deletedValue);\r\n\t\tthis.cmd('Step');\r\n\t\tthis.cmd('SetText', 0, '');\r\n\t\tthis.highlightID = this.nextIndex++;\r\n\t\tthis.cmd('SetText', 0, '');\r\n\t\tif (this.preemptiveSplit) {\r\n\t\t\tthis.doDeleteNotEmpty(this.treeRoot, deletedValue);\r\n\t\t} else {\r\n\t\t\tthis.doDelete(this.treeRoot, deletedValue);\r\n\t\t}\r\n\t\tif (this.treeRoot.numKeys === 0) {\r\n\t\t\tthis.cmd('Step');\r\n\t\t\tthis.cmd('Delete', this.treeRoot.graphicID);\r\n\t\t\tthis.treeRoot = this.treeRoot.children[0];\r\n\t\t\tthis.treeRoot.parent = null;\r\n\t\t\tthis.resizeTree();\r\n\t\t}\r\n\t\treturn this.commands;\r\n\t}\r\n\r\n\tdoDeleteNotEmpty(tree, val) {\r\n\t\tif (tree != null) {\r\n\t\t\tlet nextNode;\r\n\t\t\tthis.cmd('SetHighlight', tree.graphicID, 1);\r\n\t\t\tthis.cmd('Step');\r\n\t\t\tlet i;\r\n\t\t\tfor (i = 0; i < tree.numKeys && tree.keys[i] < val; i++);\r\n\t\t\tif (i === tree.numKeys) {\r\n\t\t\t\tif (!tree.isLeaf) {\r\n\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t'SetEdgeHighlight',\r\n\t\t\t\t\t\ttree.graphicID,\r\n\t\t\t\t\t\ttree.children[tree.numKeys].graphicID,\r\n\t\t\t\t\t\t1\r\n\t\t\t\t\t);\r\n\t\t\t\t\tthis.cmd('Step');\r\n\t\t\t\t\tthis.cmd('SetHighlight', tree.graphicID, 0);\r\n\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t'SetEdgeHighlight',\r\n\t\t\t\t\t\ttree.graphicID,\r\n\t\t\t\t\t\ttree.children[tree.numKeys].graphicID,\r\n\t\t\t\t\t\t0\r\n\t\t\t\t\t);\r\n\r\n\t\t\t\t\tif (tree.children[tree.numKeys].numKeys === this.min_keys) {\r\n\t\t\t\t\t\tif (tree.children[tree.numKeys - 1].numKeys > this.min_keys) {\r\n\t\t\t\t\t\t\tnextNode = this.stealFromLeft(\r\n\t\t\t\t\t\t\t\ttree.children[tree.numKeys],\r\n\t\t\t\t\t\t\t\ttree.numKeys\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\tthis.doDeleteNotEmpty(nextNode, val);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tnextNode = this.mergeRight(tree.children[tree.numKeys - 1]);\r\n\t\t\t\t\t\t\tthis.doDeleteNotEmpty(nextNode, val);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.doDeleteNotEmpty(tree.children[tree.numKeys], val);\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.cmd('SetHighlight', tree.graphicID, 0);\r\n\t\t\t\t}\r\n\t\t\t} else if (tree.keys[i] > val) {\r\n\t\t\t\tif (!tree.isLeaf) {\r\n\t\t\t\t\tthis.cmd('SetEdgeHighlight', tree.graphicID, tree.children[i].graphicID, 1);\r\n\t\t\t\t\tthis.cmd('Step');\r\n\t\t\t\t\tthis.cmd('SetHighlight', tree.graphicID, 0);\r\n\t\t\t\t\tthis.cmd('SetEdgeHighlight', tree.graphicID, tree.children[i].graphicID, 0);\r\n\r\n\t\t\t\t\tif (tree.children[i].numKeys > this.min_keys) {\r\n\t\t\t\t\t\tthis.doDeleteNotEmpty(tree.children[i], val);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tif (tree.children[i + 1].numKeys > this.min_keys) {\r\n\t\t\t\t\t\t\tnextNode = this.stealFromRight(tree.children[i], i);\r\n\t\t\t\t\t\t\tthis.doDeleteNotEmpty(nextNode, val);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tnextNode = this.mergeRight(tree.children[i]);\r\n\t\t\t\t\t\t\tthis.doDeleteNotEmpty(nextNode, val);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.cmd('SetHighlight', tree.graphicID, 0);\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tthis.cmd('SetTextColor', tree.graphicID, 'FF0000', i);\r\n\t\t\t\tthis.cmd('Step');\r\n\t\t\t\tif (tree.isLeaf) {\r\n\t\t\t\t\tthis.cmd('SetTextColor', tree.graphicID, FOREGROUND_COLOR, i);\r\n\t\t\t\t\tfor (let j = i; j < tree.numKeys - 1; j++) {\r\n\t\t\t\t\t\ttree.keys[j] = tree.keys[j + 1];\r\n\t\t\t\t\t\tthis.cmd('SetText', tree.graphicID, tree.keys[j], j);\r\n\t\t\t\t\t}\r\n\t\t\t\t\ttree.numKeys--;\r\n\t\t\t\t\tthis.cmd('SetText', tree.graphicID, '', tree.numKeys);\r\n\t\t\t\t\tthis.cmd('SetNumElements', tree.graphicID, tree.numKeys);\r\n\t\t\t\t\tthis.cmd('SetHighlight', tree.graphicID, 0);\r\n\t\t\t\t\tthis.resizeTree();\r\n\t\t\t\t\tthis.cmd('SetText', this.messageID, '');\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t'SetText',\r\n\t\t\t\t\t\tthis.messageID,\r\n\t\t\t\t\t\t'Checking to see if tree to left of element to delete \\nhas an extra key'\r\n\t\t\t\t\t);\r\n\t\t\t\t\tthis.cmd('SetEdgeHighlight', tree.graphicID, tree.children[i].graphicID, 1);\r\n\r\n\t\t\t\t\tthis.cmd('Step');\r\n\t\t\t\t\tthis.cmd('SetEdgeHighlight', tree.graphicID, tree.children[i].graphicID, 0);\r\n\t\t\t\t\tlet maxNode = tree.children[i];\r\n\r\n\t\t\t\t\tif (tree.children[i].numKeys === this.min_keys) {\r\n\t\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t\t'SetText',\r\n\t\t\t\t\t\t\tthis.messageID,\r\n\t\t\t\t\t\t\t'Tree to left of element to delete does not have an extra key.  \\nLooking to the right ...'\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t\t'SetEdgeHighlight',\r\n\t\t\t\t\t\t\ttree.graphicID,\r\n\t\t\t\t\t\t\ttree.children[i + 1].graphicID,\r\n\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t\tthis.cmd('Step');\r\n\t\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t\t'SetEdgeHighlight',\r\n\t\t\t\t\t\t\ttree.graphicID,\r\n\t\t\t\t\t\t\ttree.children[i + 1].graphicID,\r\n\t\t\t\t\t\t\t0\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t\t// Trees to left and right of node to delete don't have enough keys\r\n\t\t\t\t\t\t//   Do a merge, and then recursively delete the element\r\n\t\t\t\t\t\tif (tree.children[i + 1].numKeys === this.min_keys) {\r\n\t\t\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t\t\t'SetText',\r\n\t\t\t\t\t\t\t\tthis.messageID,\r\n\t\t\t\t\t\t\t\t'Neither subtree has extra nodes.  Mergeing around the key to delete, \\nand recursively deleting ...'\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\tthis.cmd('Step');\r\n\t\t\t\t\t\t\tthis.cmd('SetTextColor', tree.graphicID, FOREGROUND_COLOR, i);\r\n\t\t\t\t\t\t\tnextNode = this.mergeRight(tree.children[i]);\r\n\t\t\t\t\t\t\tthis.doDeleteNotEmpty(nextNode, val);\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t\t\t'SetText',\r\n\t\t\t\t\t\t\t\tthis.messageID,\r\n\t\t\t\t\t\t\t\t'Tree to right of element to delete does have an extra key. \\nFinding the smallest key in that subtree ...'\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\tthis.cmd('Step');\r\n\r\n\t\t\t\t\t\t\tlet minNode = tree.children[i + 1];\r\n\t\t\t\t\t\t\twhile (!minNode.isLeaf) {\r\n\t\t\t\t\t\t\t\tthis.cmd('SetHighlight', minNode.graphicID, 1);\r\n\t\t\t\t\t\t\t\tthis.cmd('Step');\r\n\t\t\t\t\t\t\t\tthis.cmd('SetHighlight', minNode.graphicID, 0);\r\n\t\t\t\t\t\t\t\tif (minNode.children[0].numKeys === this.min_keys) {\r\n\t\t\t\t\t\t\t\t\tif (minNode.children[1].numKeys === this.min_keys) {\r\n\t\t\t\t\t\t\t\t\t\tminNode = this.mergeRight(minNode.children[0]);\r\n\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\tminNode = this.stealFromRight(minNode.children[0], 0);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\tminNode = minNode.children[0];\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tthis.cmd('SetHighlight', minNode.graphicID, 1);\r\n\t\t\t\t\t\t\ttree.keys[i] = minNode.keys[0];\r\n\t\t\t\t\t\t\tthis.cmd('SetTextColor', tree.graphicID, FOREGROUND_COLOR, i);\r\n\t\t\t\t\t\t\tthis.cmd('SetText', tree.graphicID, '', i);\r\n\t\t\t\t\t\t\tthis.cmd('SetText', minNode.graphicID, '', 0);\r\n\r\n\t\t\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t\t\t'CreateLabel',\r\n\t\t\t\t\t\t\t\tthis.moveLabel1ID,\r\n\t\t\t\t\t\t\t\tminNode.keys[0],\r\n\t\t\t\t\t\t\t\tthis.getLabelX(minNode, 0),\r\n\t\t\t\t\t\t\t\tminNode.y\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\tthis.cmd('Move', this.moveLabel1ID, this.getLabelX(tree, i), tree.y);\r\n\t\t\t\t\t\t\tthis.cmd('Step');\r\n\t\t\t\t\t\t\tthis.cmd('Delete', this.moveLabel1ID);\r\n\t\t\t\t\t\t\tthis.cmd('SetText', tree.graphicID, tree.keys[i], i);\r\n\t\t\t\t\t\t\tfor (i = 1; i < minNode.numKeys; i++) {\r\n\t\t\t\t\t\t\t\tminNode.keys[i - 1] = minNode.keys[i];\r\n\t\t\t\t\t\t\t\tthis.cmd('SetText', minNode.graphicID, minNode.keys[i - 1], i - 1);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tthis.cmd('SetText', minNode.graphicID, '', minNode.numKeys - 1);\r\n\r\n\t\t\t\t\t\t\tminNode.numKeys--;\r\n\t\t\t\t\t\t\tthis.cmd('SetHighlight', minNode.graphicID, 0);\r\n\t\t\t\t\t\t\tthis.cmd('SetHighlight', tree.graphicID, 0);\r\n\r\n\t\t\t\t\t\t\tthis.cmd('SetNumElements', minNode.graphicID, minNode.numKeys);\r\n\t\t\t\t\t\t\tthis.resizeTree();\r\n\t\t\t\t\t\t\tthis.cmd('SetText', this.messageID, '');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t\t'SetText',\r\n\t\t\t\t\t\t\tthis.messageID,\r\n\t\t\t\t\t\t\t'Tree to left of element to delete does have \\nan extra key. Finding the largest key in that subtree ...'\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t\tthis.cmd('Step');\r\n\t\t\t\t\t\twhile (!maxNode.isLeaf) {\r\n\t\t\t\t\t\t\tthis.cmd('SetHighlight', maxNode.graphicID, 1);\r\n\t\t\t\t\t\t\tthis.cmd('Step');\r\n\t\t\t\t\t\t\tthis.cmd('SetHighlight', maxNode.graphicID, 0);\r\n\t\t\t\t\t\t\tif (maxNode.children[maxNode.numKeys].numKeys === this.min_keys) {\r\n\t\t\t\t\t\t\t\tif (maxNode.children[maxNode.numKeys - 1] > this.min_keys) {\r\n\t\t\t\t\t\t\t\t\tmaxNode = this.stealFromLeft(\r\n\t\t\t\t\t\t\t\t\t\tmaxNode.children[maxNode.numKeys],\r\n\t\t\t\t\t\t\t\t\t\tmaxNode.numKeys\r\n\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tmaxNode = this.mergeRight(maxNode.children[maxNode.numKeys - 1]);\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tmaxNode = maxNode.children[maxNode.numKeys];\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tthis.cmd('SetHighlight', maxNode.graphicID, 1);\r\n\t\t\t\t\t\ttree.keys[i] = maxNode.keys[maxNode.numKeys - 1];\r\n\t\t\t\t\t\tthis.cmd('SetTextColor', tree.graphicID, FOREGROUND_COLOR, i);\r\n\t\t\t\t\t\tthis.cmd('SetText', tree.graphicID, '', i);\r\n\t\t\t\t\t\tthis.cmd('SetText', maxNode.graphicID, '', maxNode.numKeys - 1);\r\n\t\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t\t'CreateLabel',\r\n\t\t\t\t\t\t\tthis.moveLabel1ID,\r\n\t\t\t\t\t\t\ttree.keys[i],\r\n\t\t\t\t\t\t\tthis.getLabelX(maxNode, maxNode.numKeys - 1),\r\n\t\t\t\t\t\t\tmaxNode.y\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t\tthis.cmd('Move', this.moveLabel1ID, this.getLabelX(tree, i), tree.y);\r\n\t\t\t\t\t\tthis.cmd('Step');\r\n\t\t\t\t\t\tthis.cmd('Delete', this.moveLabel1ID);\r\n\t\t\t\t\t\tthis.cmd('SetText', tree.graphicID, tree.keys[i], i);\r\n\t\t\t\t\t\tmaxNode.numKeys--;\r\n\t\t\t\t\t\tthis.cmd('SetHighlight', maxNode.graphicID, 0);\r\n\t\t\t\t\t\tthis.cmd('SetHighlight', tree.graphicID, 0);\r\n\r\n\t\t\t\t\t\tthis.cmd('SetNumElements', maxNode.graphicID, maxNode.numKeys);\r\n\t\t\t\t\t\tthis.resizeTree();\r\n\t\t\t\t\t\tthis.cmd('SetText', this.messageID, '');\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tdoDelete(tree, val) {\r\n\t\tif (tree != null) {\r\n\t\t\tthis.cmd('SetHighlight', tree.graphicID, 1);\r\n\t\t\tthis.cmd('Step');\r\n\t\t\tlet i;\r\n\t\t\tfor (i = 0; i < tree.numKeys && tree.keys[i] < val; i++);\r\n\t\t\tif (i === tree.numKeys) {\r\n\t\t\t\tif (!tree.isLeaf) {\r\n\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t'SetEdgeHighlight',\r\n\t\t\t\t\t\ttree.graphicID,\r\n\t\t\t\t\t\ttree.children[tree.numKeys].graphicID,\r\n\t\t\t\t\t\t1\r\n\t\t\t\t\t);\r\n\t\t\t\t\tthis.cmd('Step');\r\n\t\t\t\t\tthis.cmd('SetHighlight', tree.graphicID, 0);\r\n\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t'SetEdgeHighlight',\r\n\t\t\t\t\t\ttree.graphicID,\r\n\t\t\t\t\t\ttree.children[tree.numKeys].graphicID,\r\n\t\t\t\t\t\t0\r\n\t\t\t\t\t);\r\n\t\t\t\t\tthis.doDelete(tree.children[tree.numKeys], val);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.cmd('SetHighlight', tree.graphicID, 0);\r\n\t\t\t\t}\r\n\t\t\t} else if (tree.keys[i] > val) {\r\n\t\t\t\tif (!tree.isLeaf) {\r\n\t\t\t\t\tthis.cmd('SetEdgeHighlight', tree.graphicID, tree.children[i].graphicID, 1);\r\n\t\t\t\t\tthis.cmd('Step');\r\n\t\t\t\t\tthis.cmd('SetHighlight', tree.graphicID, 0);\r\n\t\t\t\t\tthis.cmd('SetEdgeHighlight', tree.graphicID, tree.children[i].graphicID, 0);\r\n\t\t\t\t\tthis.doDelete(tree.children[i], val);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.cmd('SetHighlight', tree.graphicID, 0);\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tthis.cmd('SetTextColor', tree.graphicID, '#FF0000', i);\r\n\t\t\t\tthis.cmd('Step');\r\n\t\t\t\tif (tree.isLeaf) {\r\n\t\t\t\t\tthis.cmd('SetTextColor', tree.graphicID, FOREGROUND_COLOR, i);\r\n\t\t\t\t\tfor (let j = i; j < tree.numKeys - 1; j++) {\r\n\t\t\t\t\t\ttree.keys[j] = tree.keys[j + 1];\r\n\t\t\t\t\t\tthis.cmd('SetText', tree.graphicID, tree.keys[j], j);\r\n\t\t\t\t\t}\r\n\t\t\t\t\ttree.numKeys--;\r\n\t\t\t\t\tthis.cmd('SetText', tree.graphicID, '', tree.numKeys);\r\n\t\t\t\t\tthis.cmd('SetNumElements', tree.graphicID, tree.numKeys);\r\n\t\t\t\t\tthis.cmd('SetHighlight', tree.graphicID, 0);\r\n\t\t\t\t\tthis.repairAfterDelete(tree);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tlet maxNode = tree.children[i];\r\n\t\t\t\t\twhile (!maxNode.isLeaf) {\r\n\t\t\t\t\t\tthis.cmd('SetHighlight', maxNode.graphicID, 1);\r\n\t\t\t\t\t\tthis.cmd('Step');\r\n\t\t\t\t\t\tthis.cmd('SetHighlight', maxNode.graphicID, 0);\r\n\t\t\t\t\t\tmaxNode = maxNode.children[maxNode.numKeys];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.cmd('SetHighlight', maxNode.graphicID, 1);\r\n\t\t\t\t\ttree.keys[i] = maxNode.keys[maxNode.numKeys - 1];\r\n\t\t\t\t\tthis.cmd('SetTextColor', tree.graphicID, FOREGROUND_COLOR, i);\r\n\t\t\t\t\tthis.cmd('SetText', tree.graphicID, '', i);\r\n\t\t\t\t\tthis.cmd('SetText', maxNode.graphicID, '', maxNode.numKeys - 1);\r\n\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t'CreateLabel',\r\n\t\t\t\t\t\tthis.moveLabel1ID,\r\n\t\t\t\t\t\ttree.keys[i],\r\n\t\t\t\t\t\tthis.getLabelX(maxNode, maxNode.numKeys - 1),\r\n\t\t\t\t\t\tmaxNode.y\r\n\t\t\t\t\t);\r\n\t\t\t\t\tthis.cmd('Move', this.moveLabel1ID, this.getLabelX(tree, i), tree.y);\r\n\t\t\t\t\tthis.cmd('Step');\r\n\t\t\t\t\tthis.cmd('Delete', this.moveLabel1ID);\r\n\t\t\t\t\tthis.cmd('SetText', tree.graphicID, tree.keys[i], i);\r\n\t\t\t\t\tmaxNode.numKeys--;\r\n\t\t\t\t\tthis.cmd('SetHighlight', maxNode.graphicID, 0);\r\n\t\t\t\t\tthis.cmd('SetHighlight', tree.graphicID, 0);\r\n\r\n\t\t\t\t\tthis.cmd('SetNumElements', maxNode.graphicID, maxNode.numKeys);\r\n\t\t\t\t\tthis.repairAfterDelete(maxNode);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tmergeRight(tree) {\r\n\t\tthis.cmd('SetText', this.messageID, 'Merging node');\r\n\r\n\t\tconst parentNode = tree.parent;\r\n\t\tlet parentIndex = 0;\r\n\t\tfor (parentIndex = 0; parentNode.children[parentIndex] !== tree; parentIndex++);\r\n\t\tconst rightSib = parentNode.children[parentIndex + 1];\r\n\t\tthis.cmd('SetHighlight', tree.graphicID, 1);\r\n\t\tthis.cmd('SetHighlight', parentNode.graphicID, 1);\r\n\t\tthis.cmd('SetHighlight', rightSib.graphicID, 1);\r\n\r\n\t\tthis.cmd('Step');\r\n\t\tthis.cmd('SetNumElements', tree.graphicID, tree.numKeys + rightSib.numKeys + 1);\r\n\t\ttree.x = (tree.x + rightSib.x) / 2;\r\n\t\tthis.cmd('SetPosition', tree.graphicID, tree.x, tree.y);\r\n\r\n\t\ttree.keys[tree.numKeys] = parentNode.keys[parentIndex];\r\n\t\tconst fromParentIndex = tree.numKeys;\r\n\t\t//this.cmd(\"SetText\", tree.graphicID, tree.keys[tree.numKeys], tree.numKeys);\r\n\t\tthis.cmd('SetText', tree.graphicID, '', tree.numKeys);\r\n\t\tthis.cmd(\r\n\t\t\t'CreateLabel',\r\n\t\t\tthis.moveLabel1ID,\r\n\t\t\tparentNode.keys[parentIndex],\r\n\t\t\tthis.getLabelX(parentNode, parentIndex),\r\n\t\t\tparentNode.y\r\n\t\t);\r\n\r\n\t\tfor (let i = 0; i < rightSib.numKeys; i++) {\r\n\t\t\ttree.keys[tree.numKeys + 1 + i] = rightSib.keys[i];\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'SetText',\r\n\t\t\t\ttree.graphicID,\r\n\t\t\t\ttree.keys[tree.numKeys + 1 + i],\r\n\t\t\t\ttree.numKeys + 1 + i\r\n\t\t\t);\r\n\t\t\tthis.cmd('SetText', rightSib.graphicID, '', i);\r\n\t\t}\r\n\t\tif (!tree.isLeaf) {\r\n\t\t\tfor (let i = 0; i <= rightSib.numKeys; i++) {\r\n\t\t\t\tthis.cmd('Disconnect', rightSib.graphicID, rightSib.children[i].graphicID);\r\n\t\t\t\ttree.children[tree.numKeys + 1 + i] = rightSib.children[i];\r\n\t\t\t\ttree.children[tree.numKeys + 1 + i].parent = tree;\r\n\t\t\t\tthis.cmd(\r\n\t\t\t\t\t'Connect',\r\n\t\t\t\t\ttree.graphicID,\r\n\t\t\t\t\ttree.children[tree.numKeys + 1 + i].graphicID,\r\n\t\t\t\t\tFOREGROUND_COLOR,\r\n\t\t\t\t\t0, // Curve\r\n\t\t\t\t\t0, // Directed\r\n\t\t\t\t\t'', // Label\r\n\t\t\t\t\ttree.numKeys + 1 + i\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.cmd('Disconnect', parentNode.graphicID, rightSib.graphicID);\r\n\t\tfor (let i = parentIndex + 1; i < parentNode.numKeys; i++) {\r\n\t\t\tthis.cmd('Disconnect', parentNode.graphicID, parentNode.children[i + 1].graphicID);\r\n\t\t\tparentNode.children[i] = parentNode.children[i + 1];\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'Connect',\r\n\t\t\t\tparentNode.graphicID,\r\n\t\t\t\tparentNode.children[i].graphicID,\r\n\t\t\t\tFOREGROUND_COLOR,\r\n\t\t\t\t0, // Curve\r\n\t\t\t\t0, // Directed\r\n\t\t\t\t'', // Label\r\n\t\t\t\ti\r\n\t\t\t);\r\n\t\t\tparentNode.keys[i - 1] = parentNode.keys[i];\r\n\t\t\tthis.cmd('SetText', parentNode.graphicID, parentNode.keys[i - 1], i - 1);\r\n\t\t}\r\n\t\tthis.cmd('SetText', parentNode.graphicID, '', parentNode.numKeys - 1);\r\n\t\tparentNode.numKeys--;\r\n\t\tthis.cmd('SetNumElements', parentNode.graphicID, parentNode.numKeys);\r\n\t\tthis.cmd('SetHighlight', tree.graphicID, 0);\r\n\t\tthis.cmd('SetHighlight', parentNode.graphicID, 0);\r\n\t\t//\tthis.cmd(\"SetHighlight\", rightSib.graphicID, 0);\r\n\r\n\t\t//\tthis.cmd(\"Step\");\r\n\t\tthis.cmd('Delete', rightSib.graphicID);\r\n\t\ttree.numKeys = tree.numKeys + rightSib.numKeys + 1;\r\n\t\tthis.cmd('Move', this.moveLabel1ID, this.getLabelX(tree, fromParentIndex), tree.y);\r\n\r\n\t\tthis.cmd('Step');\r\n\t\t// resizeTree();\r\n\t\tthis.cmd('Delete', this.moveLabel1ID);\r\n\t\tthis.cmd('SetText', tree.graphicID, tree.keys[fromParentIndex], fromParentIndex);\r\n\r\n\t\tthis.cmd('SetText', this.messageID, '');\r\n\t\treturn tree;\r\n\t}\r\n\r\n\tstealFromRight(tree, parentIndex) {\r\n\t\t// Steal from right sibling\r\n\t\tconst parentNode = tree.parent;\r\n\r\n\t\tthis.cmd('SetNumElements', tree.graphicID, tree.numKeys + 1);\r\n\r\n\t\tthis.cmd('SetText', this.messageID, 'Stealing from right sibling');\r\n\r\n\t\tconst rightSib = parentNode.children[parentIndex + 1];\r\n\t\ttree.numKeys++;\r\n\r\n\t\tthis.cmd('SetNumElements', tree.graphicID, tree.numKeys);\r\n\r\n\t\tthis.cmd('SetText', tree.graphicID, '', tree.numKeys - 1);\r\n\t\tthis.cmd('SetText', parentNode.graphicID, '', parentIndex);\r\n\t\tthis.cmd('SetText', rightSib.graphicID, '', 0);\r\n\r\n\t\tconst tmpLabel1 = this.nextIndex++;\r\n\t\tconst tmpLabel2 = this.nextIndex++;\r\n\r\n\t\tthis.cmd(\r\n\t\t\t'CreateLabel',\r\n\t\t\ttmpLabel1,\r\n\t\t\trightSib.keys[0],\r\n\t\t\tthis.getLabelX(rightSib, 0),\r\n\t\t\trightSib.y\r\n\t\t);\r\n\t\tthis.cmd(\r\n\t\t\t'CreateLabel',\r\n\t\t\ttmpLabel2,\r\n\t\t\tparentNode.keys[parentIndex],\r\n\t\t\tthis.getLabelX(parentNode, parentIndex),\r\n\t\t\tparentNode.y\r\n\t\t);\r\n\t\tthis.cmd('SetForegroundColor', tmpLabel1, FOREGROUND_COLOR);\r\n\t\tthis.cmd('SetForegroundColor', tmpLabel2, FOREGROUND_COLOR);\r\n\r\n\t\tthis.cmd('Move', tmpLabel1, this.getLabelX(parentNode, parentIndex), parentNode.y);\r\n\t\tthis.cmd('Move', tmpLabel2, this.getLabelX(tree, tree.numKeys - 1), tree.y);\r\n\r\n\t\tthis.cmd('Step');\r\n\t\tthis.cmd('Delete', tmpLabel1);\r\n\t\tthis.cmd('Delete', tmpLabel2);\r\n\t\ttree.keys[tree.numKeys - 1] = parentNode.keys[parentIndex];\r\n\t\tparentNode.keys[parentIndex] = rightSib.keys[0];\r\n\r\n\t\tthis.cmd('SetText', tree.graphicID, tree.keys[tree.numKeys - 1], tree.numKeys - 1);\r\n\t\tthis.cmd('SetText', parentNode.graphicID, parentNode.keys[parentIndex], parentIndex);\r\n\t\tif (!tree.isLeaf) {\r\n\t\t\ttree.children[tree.numKeys] = rightSib.children[0];\r\n\t\t\ttree.children[tree.numKeys].parent = tree;\r\n\t\t\tthis.cmd('Disconnect', rightSib.graphicID, rightSib.children[0].graphicID);\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'Connect',\r\n\t\t\t\ttree.graphicID,\r\n\t\t\t\ttree.children[tree.numKeys].graphicID,\r\n\t\t\t\tFOREGROUND_COLOR,\r\n\t\t\t\t0, // Curve\r\n\t\t\t\t0, // Directed\r\n\t\t\t\t'', // Label\r\n\t\t\t\ttree.numKeys\r\n\t\t\t);\r\n\t\t\t// TODO::CHECKME!\r\n\r\n\t\t\tfor (let i = 1; i < rightSib.numKeys + 1; i++) {\r\n\t\t\t\tthis.cmd('Disconnect', rightSib.graphicID, rightSib.children[i].graphicID);\r\n\t\t\t\trightSib.children[i - 1] = rightSib.children[i];\r\n\t\t\t\tthis.cmd(\r\n\t\t\t\t\t'Connect',\r\n\t\t\t\t\trightSib.graphicID,\r\n\t\t\t\t\trightSib.children[i - 1].graphicID,\r\n\t\t\t\t\tFOREGROUND_COLOR,\r\n\t\t\t\t\t0, // Curve\r\n\t\t\t\t\t0, // Directed\r\n\t\t\t\t\t'', // Label\r\n\t\t\t\t\ti - 1\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t}\r\n\t\tfor (let i = 1; i < rightSib.numKeys; i++) {\r\n\t\t\trightSib.keys[i - 1] = rightSib.keys[i];\r\n\t\t\tthis.cmd('SetText', rightSib.graphicID, rightSib.keys[i - 1], i - 1);\r\n\t\t}\r\n\t\tthis.cmd('SetText', rightSib.graphicID, '', rightSib.numKeys - 1);\r\n\t\trightSib.numKeys--;\r\n\t\tthis.cmd('SetNumElements', rightSib.graphicID, rightSib.numKeys);\r\n\t\tthis.resizeTree();\r\n\t\tthis.cmd('SetText', this.messageID, '');\r\n\t\treturn tree;\r\n\t}\r\n\r\n\tstealFromLeft(tree, parentIndex) {\r\n\t\tconst parentNode = tree.parent;\r\n\t\t// Steal from left sibling\r\n\t\ttree.numKeys++;\r\n\t\tthis.cmd('SetNumElements', tree.graphicID, tree.numKeys);\r\n\t\tthis.cmd('SetText', this.messageID, 'Node has too few keys.  Stealing from left sibling.');\r\n\r\n\t\tfor (let i = tree.numKeys - 1; i > 0; i--) {\r\n\t\t\ttree.keys[i] = tree.keys[i - 1];\r\n\t\t\tthis.cmd('SetText', tree.graphicID, tree.keys[i], i);\r\n\t\t}\r\n\t\tconst leftSib = parentNode.children[parentIndex - 1];\r\n\r\n\t\tthis.cmd('SetText', tree.graphicID, '', 0);\r\n\t\tthis.cmd('SetText', parentNode.graphicID, '', parentIndex - 1);\r\n\t\tthis.cmd('SetText', leftSib.graphicID, '', leftSib.numKeys - 1);\r\n\r\n\t\tconst tmpLabel1 = this.nextIndex++;\r\n\t\tconst tmpLabel2 = this.nextIndex++;\r\n\r\n\t\tthis.cmd(\r\n\t\t\t'CreateLabel',\r\n\t\t\ttmpLabel1,\r\n\t\t\tleftSib.keys[leftSib.numKeys - 1],\r\n\t\t\tthis.getLabelX(leftSib, leftSib.numKeys - 1),\r\n\t\t\tleftSib.y\r\n\t\t);\r\n\t\tthis.cmd(\r\n\t\t\t'CreateLabel',\r\n\t\t\ttmpLabel2,\r\n\t\t\tparentNode.keys[parentIndex - 1],\r\n\t\t\tthis.getLabelX(parentNode, parentIndex - 1),\r\n\t\t\tparentNode.y\r\n\t\t);\r\n\t\tthis.cmd('SetForegroundColor', tmpLabel1, FOREGROUND_COLOR);\r\n\t\tthis.cmd('SetForegroundColor', tmpLabel2, FOREGROUND_COLOR);\r\n\r\n\t\tthis.cmd('Move', tmpLabel1, this.getLabelX(parentNode, parentIndex - 1), parentNode.y);\r\n\t\tthis.cmd('Move', tmpLabel2, this.getLabelX(tree, 0), tree.y);\r\n\r\n\t\tthis.cmd('Step');\r\n\t\tthis.cmd('Delete', tmpLabel1);\r\n\t\tthis.cmd('Delete', tmpLabel2);\r\n\r\n\t\tif (!tree.isLeaf) {\r\n\t\t\tfor (let i = tree.numKeys; i > 0; i--) {\r\n\t\t\t\tthis.cmd('Disconnect', tree.graphicID, tree.children[i - 1].graphicID);\r\n\t\t\t\ttree.children[i] = tree.children[i - 1];\r\n\t\t\t\tthis.cmd(\r\n\t\t\t\t\t'Connect',\r\n\t\t\t\t\ttree.graphicID,\r\n\t\t\t\t\ttree.children[i].graphicID,\r\n\t\t\t\t\tFOREGROUND_COLOR,\r\n\t\t\t\t\t0, // Curve\r\n\t\t\t\t\t0, // Directed\r\n\t\t\t\t\t'', // Label\r\n\t\t\t\t\ti\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t\ttree.children[0] = leftSib.children[leftSib.numKeys];\r\n\t\t\tthis.cmd('Disconnect', leftSib.graphicID, leftSib.children[leftSib.numKeys].graphicID);\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'Connect',\r\n\t\t\t\ttree.graphicID,\r\n\t\t\t\ttree.children[0].graphicID,\r\n\t\t\t\tFOREGROUND_COLOR,\r\n\t\t\t\t0, // Curve\r\n\t\t\t\t0, // Directed\r\n\t\t\t\t'', // Label\r\n\t\t\t\t0\r\n\t\t\t);\r\n\t\t\tleftSib.children[leftSib.numKeys] = null;\r\n\t\t\ttree.children[0].parent = tree;\r\n\t\t}\r\n\r\n\t\ttree.keys[0] = parentNode.keys[parentIndex - 1];\r\n\t\tthis.cmd('SetText', tree.graphicID, tree.keys[0], 0);\r\n\t\tparentNode.keys[parentIndex - 1] = leftSib.keys[leftSib.numKeys - 1];\r\n\t\tthis.cmd(\r\n\t\t\t'SetText',\r\n\t\t\tparentNode.graphicID,\r\n\t\t\tparentNode.keys[parentIndex - 1],\r\n\t\t\tparentIndex - 1\r\n\t\t);\r\n\t\tthis.cmd('SetText', leftSib.graphicID, '', leftSib.numKeys - 1);\r\n\r\n\t\tleftSib.numKeys--;\r\n\t\tthis.cmd('SetNumElements', leftSib.graphicID, leftSib.numKeys);\r\n\t\tthis.resizeTree();\r\n\t\tthis.cmd('SetText', this.messageID, '');\r\n\t\treturn tree;\r\n\t}\r\n\r\n\trepairAfterDelete(tree) {\r\n\t\tif (tree.numKeys < this.min_keys) {\r\n\t\t\tif (tree.parent == null) {\r\n\t\t\t\tif (tree.numKeys === 0) {\r\n\t\t\t\t\tthis.cmd('Step');\r\n\t\t\t\t\tthis.cmd('Delete', tree.graphicID);\r\n\t\t\t\t\tthis.treeRoot = tree.children[0];\r\n\t\t\t\t\tif (this.treeRoot != null) this.treeRoot.parent = null;\r\n\t\t\t\t\tthis.resizeTree();\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tconst parentNode = tree.parent;\r\n\t\t\t\tlet parentIndex;\r\n\t\t\t\tlet nextNode;\r\n\t\t\t\tfor (parentIndex = 0; parentNode.children[parentIndex] !== tree; parentIndex++);\r\n\t\t\t\tif (\r\n\t\t\t\t\tparentIndex > 0 &&\r\n\t\t\t\t\tparentNode.children[parentIndex - 1].numKeys > this.min_keys\r\n\t\t\t\t) {\r\n\t\t\t\t\tthis.stealFromLeft(tree, parentIndex);\r\n\t\t\t\t} else if (\r\n\t\t\t\t\tparentIndex < parentNode.numKeys &&\r\n\t\t\t\t\tparentNode.children[parentIndex + 1].numKeys > this.min_keys\r\n\t\t\t\t) {\r\n\t\t\t\t\tthis.stealFromRight(tree, parentIndex);\r\n\t\t\t\t} else if (parentIndex === 0) {\r\n\t\t\t\t\t// Merge with right sibling\r\n\t\t\t\t\tnextNode = this.mergeRight(tree);\r\n\t\t\t\t\tthis.repairAfterDelete(nextNode.parent);\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// Merge with left sibling\r\n\t\t\t\t\tnextNode = this.mergeRight(parentNode.children[parentIndex - 1]);\r\n\t\t\t\t\tthis.repairAfterDelete(nextNode.parent);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tgetLabelX(tree, index) {\r\n\t\treturn (\r\n\t\t\ttree.x -\r\n\t\t\t(WIDTH_PER_ELEM * tree.numKeys) / 2 +\r\n\t\t\tWIDTH_PER_ELEM / 2 +\r\n\t\t\tindex * WIDTH_PER_ELEM\r\n\t\t);\r\n\t}\r\n\r\n\tresizeTree() {\r\n\t\tthis.resizeWidths(this.treeRoot);\r\n\t\tthis.setNewPositions(this.treeRoot, this.starting_x, STARTING_Y);\r\n\t\tthis.animateNewPositions(this.treeRoot);\r\n\t}\r\n\r\n\tsetNewPositions(tree, xPosition, yPosition) {\r\n\t\tif (tree != null) {\r\n\t\t\ttree.y = yPosition;\r\n\t\t\ttree.x = xPosition;\r\n\t\t\tif (!tree.isLeaf) {\r\n\t\t\t\tconst leftEdge = xPosition - tree.width / 2;\r\n\t\t\t\tlet priorWidth = 0;\r\n\t\t\t\tfor (let i = 0; i < tree.numKeys + 1; i++) {\r\n\t\t\t\t\tthis.setNewPositions(\r\n\t\t\t\t\t\ttree.children[i],\r\n\t\t\t\t\t\tleftEdge + priorWidth + tree.widths[i] / 2,\r\n\t\t\t\t\t\tyPosition + HEIGHT_DELTA\r\n\t\t\t\t\t);\r\n\t\t\t\t\tpriorWidth += tree.widths[i];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tanimateNewPositions(tree) {\r\n\t\tif (tree == null) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tlet i;\r\n\t\tfor (i = 0; i < tree.numKeys + 1; i++) {\r\n\t\t\tthis.animateNewPositions(tree.children[i]);\r\n\t\t}\r\n\t\tthis.cmd('Move', tree.graphicID, tree.x, tree.y);\r\n\t}\r\n\r\n\tresizeWidths(tree) {\r\n\t\tif (tree == null) {\r\n\t\t\treturn 0;\r\n\t\t}\r\n\t\tif (tree.isLeaf) {\r\n\t\t\tfor (let i = 0; i < tree.numKeys + 1; i++) {\r\n\t\t\t\ttree.widths[i] = 0;\r\n\t\t\t}\r\n\t\t\ttree.width = tree.numKeys * WIDTH_PER_ELEM + NODE_SPACING;\r\n\t\t\treturn tree.width;\r\n\t\t} else {\r\n\t\t\tlet treeWidth = 0;\r\n\t\t\tfor (let i = 0; i < tree.numKeys + 1; i++) {\r\n\t\t\t\ttree.widths[i] = this.resizeWidths(tree.children[i]);\r\n\t\t\t\ttreeWidth = treeWidth + tree.widths[i];\r\n\t\t\t}\r\n\t\t\ttreeWidth = Math.max(treeWidth, tree.numKeys * WIDTH_PER_ELEM + NODE_SPACING);\r\n\t\t\ttree.width = treeWidth;\r\n\t\t\treturn treeWidth;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction BTreeNode(id, initialX, initialY) {\r\n\tthis.widths = [];\r\n\tthis.keys = [];\r\n\tthis.children = [];\r\n\tthis.x = initialX;\r\n\tthis.y = initialY;\r\n\tthis.graphicID = id;\r\n\tthis.numKeys = 1;\r\n\tthis.isLeaf = true;\r\n\tthis.parent = null;\r\n\r\n\tthis.leftWidth = 0;\r\n\tthis.rightWidth = 0;\r\n}\r\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\r\n//\r\n// Redistribution and use in source and binary forms, with or without modification, are\r\n// permitted provided that the following conditions are met:\r\n//\r\n// 1. Redistributions of source code must retain the above copyright notice, this list of\r\n// conditions and the following disclaimer.\r\n//\r\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\r\n// of conditions and the following disclaimer in the documentation and/or other materials\r\n// provided with the distribution.\r\n//\r\n// THIS SOFTWARE IS PROVIDED BY David Galles ``AS IS'' AND ANY EXPRESS OR IMPLIED\r\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\r\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\r\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\r\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\r\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\r\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\r\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\r\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\r\n//\r\n// The views and conclusions contained in the software and documentation are those of the\r\n// authors and should not be interpreted as representing official policies, either expressed\r\n// or implied, of the University of San Francisco\r\n\r\nimport Algorithm, { addControlToAlgorithmBar, addLabelToAlgorithmBar } from './Algorithm.js';\r\n\r\nconst ARRAY_START_X = 100;\r\nconst ARRAY_START_Y = 30;\r\n\r\nconst MAX_LENGTH = 22;\r\n\r\nconst PATTERN_START_Y = 100;\r\n\r\nconst LAST_TABLE_START_Y = 200;\r\n\r\nexport default class BoyerMoore extends Algorithm {\r\n\tconstructor(am, w, h) {\r\n\t\tsuper(am, w, h);\r\n\r\n\t\tthis.addControls();\r\n\r\n\t\t// Useful for memory management\r\n\t\tthis.nextIndex = 0;\r\n\r\n\t\t// TODO:  Add any code necessary to set up your own algorithm.  Initialize data\r\n\t\t// structures, etc.\r\n\t\tthis.setup();\r\n\t}\r\n\r\n\taddControls() {\r\n\t\tthis.controls = [];\r\n\r\n\t\taddLabelToAlgorithmBar('Text');\r\n\r\n\t\t// Text text field\r\n\t\tthis.textField = addControlToAlgorithmBar('Text', '');\r\n\t\tthis.textField.onkeydown = this.returnSubmit(\r\n\t\t\tthis.textField,\r\n\t\t\tthis.findCallback.bind(this),\r\n\t\t\tMAX_LENGTH,\r\n\t\t\tfalse\r\n\t\t);\r\n\t\tthis.controls.push(this.textField);\r\n\r\n\t\taddLabelToAlgorithmBar('Pattern');\r\n\r\n\t\t// Pattern text field\r\n\t\tthis.patternField = addControlToAlgorithmBar('Text', '');\r\n\t\tthis.patternField.onkeydown = this.returnSubmit(\r\n\t\t\tthis.patternField,\r\n\t\t\tthis.findCallback.bind(this),\r\n\t\t\tMAX_LENGTH,\r\n\t\t\tfalse\r\n\t\t);\r\n\t\tthis.controls.push(this.patternField);\r\n\r\n\t\t// Find button\r\n\t\tthis.findButton = addControlToAlgorithmBar('Button', 'Find');\r\n\t\tthis.findButton.onclick = this.findCallback.bind(this);\r\n\t\tthis.controls.push(this.findButton);\r\n\r\n\t\t// Clear button\r\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear');\r\n\t\tthis.clearButton.onclick = this.clearCallback.bind(this);\r\n\t\tthis.controls.push(this.clearButton);\r\n\t}\r\n\r\n\tsetup() {\r\n\t\tthis.textRowID = [];\r\n\t\tthis.comparisonMatrixID = [];\r\n\t\tthis.patternTableLableID = this.nextIndex++;\r\n\t\tthis.patternTableCharacterID = [];\r\n\t\tthis.patternTableIndexID = [];\r\n\t\tthis.lastTableLabelID = this.nextIndex++;\r\n\t\tthis.lastTableCharacterID = [];\r\n\t\tthis.lastTableValueID = [];\r\n\t}\r\n\r\n\treset() {\r\n\t\t// Reset all of your data structures to *exactly* the state they have immediately after the init\r\n\t\t// function is called.  This method is called whenever an \"undo\" is performed.  Your data\r\n\t\t// structures are completely cleaned, and then all of the actions *up to but not including* the\r\n\t\t// last action are then redone.  If you implement all of your actions through the \"implementAction\"\r\n\t\t// method below, then all of this work is done for you in the Animation \"superclass\"\r\n\r\n\t\t// Reset the (very simple) memory manager\r\n\t\tthis.nextIndex = 0;\r\n\t}\r\n\r\n\tfindCallback() {\r\n\t\tif (\r\n\t\t\tthis.textField.value !== '' &&\r\n\t\t\tthis.patternField.value !== '' &&\r\n\t\t\tthis.textField.value.length >= this.patternField.value.length\r\n\t\t) {\r\n\t\t\tthis.implementAction(this.clear.bind(this), '');\r\n\t\t\tconst text = this.textField.value;\r\n\t\t\tconst pattern = this.patternField.value;\r\n\t\t\tthis.textField.value = '';\r\n\t\t\tthis.patternField.value = '';\r\n\t\t\tthis.implementAction(this.find.bind(this), text + ',' + pattern);\r\n\t\t}\r\n\t}\r\n\r\n\tclearCallback() {\r\n\t\tthis.implementAction(this.clear.bind(this), '');\r\n\t}\r\n\r\n\tfind(params) {\r\n\t\tthis.commands = [];\r\n\r\n\t\tconst text = params.split(',')[0];\r\n\t\tconst pattern = params.split(',')[1];\r\n\r\n\t\tthis.textRowID = new Array(text.length);\r\n\t\tthis.comparisonMatrixID = new Array(text.length);\r\n\t\tfor (let i = 0; i < text.length; i++) {\r\n\t\t\tthis.comparisonMatrixID[i] = new Array(text.length);\r\n\t\t}\r\n\r\n\t\tif (text.length <= 14) {\r\n\t\t\tthis.cellSize = 30;\r\n\t\t} else if (text.length <= 17) {\r\n\t\t\tthis.cellSize = 25;\r\n\t\t} else {\r\n\t\t\tthis.cellSize = 20;\r\n\t\t}\r\n\r\n\t\tfor (let i = 0; i < text.length; i++) {\r\n\t\t\tconst xpos = i * this.cellSize + ARRAY_START_X;\r\n\t\t\tconst ypos = ARRAY_START_Y;\r\n\t\t\tthis.textRowID[i] = this.nextIndex;\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'CreateRectangle',\r\n\t\t\t\tthis.nextIndex,\r\n\t\t\t\ttext.charAt(i),\r\n\t\t\t\tthis.cellSize,\r\n\t\t\t\tthis.cellSize,\r\n\t\t\t\txpos,\r\n\t\t\t\typos\r\n\t\t\t);\r\n\t\t\tthis.cmd('SetBackgroundColor', this.nextIndex++, '#D3D3D3');\r\n\t\t}\r\n\r\n\t\tlet xpos;\r\n\t\tlet ypos;\r\n\t\tfor (let row = 0; row < text.length; row++) {\r\n\t\t\tfor (let col = 0; col < text.length; col++) {\r\n\t\t\t\txpos = col * this.cellSize + ARRAY_START_X;\r\n\t\t\t\typos = (row + 1) * this.cellSize + ARRAY_START_Y;\r\n\t\t\t\tthis.comparisonMatrixID[row][col] = this.nextIndex;\r\n\t\t\t\tthis.cmd(\r\n\t\t\t\t\t'CreateRectangle',\r\n\t\t\t\t\tthis.nextIndex++,\r\n\t\t\t\t\t'',\r\n\t\t\t\t\tthis.cellSize,\r\n\t\t\t\t\tthis.cellSize,\r\n\t\t\t\t\txpos,\r\n\t\t\t\t\typos\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tconst lastTable = this.buildLastTable(text.length, pattern);\r\n\r\n\t\tconst iPointerID = this.nextIndex++;\r\n\t\tconst jPointerID = this.nextIndex++;\r\n\t\tthis.cmd(\r\n\t\t\t'CreateHighlightCircle',\r\n\t\t\tiPointerID,\r\n\t\t\t'#0000FF',\r\n\t\t\tARRAY_START_X + (pattern.length - 1) * this.cellSize,\r\n\t\t\tARRAY_START_Y,\r\n\t\t\tthis.cellSize / 2\r\n\t\t);\r\n\t\tthis.cmd(\r\n\t\t\t'CreateHighlightCircle',\r\n\t\t\tjPointerID,\r\n\t\t\t'#0000FF',\r\n\t\t\tARRAY_START_X + (pattern.length - 1) * this.cellSize,\r\n\t\t\tARRAY_START_Y + this.cellSize,\r\n\t\t\tthis.cellSize / 2\r\n\t\t);\r\n\r\n\t\tlet i = 0;\r\n\t\tlet j = pattern.length - 1;\r\n\t\tlet row = 0;\r\n\t\twhile (i <= text.length - pattern.length) {\r\n\t\t\tfor (let k = i; k < i + pattern.length; k++) {\r\n\t\t\t\tthis.cmd(\r\n\t\t\t\t\t'SetText',\r\n\t\t\t\t\tthis.comparisonMatrixID[row][k],\r\n\t\t\t\t\tpattern.charAt(k - i),\r\n\t\t\t\t\txpos,\r\n\t\t\t\t\typos\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t\tthis.cmd('Step');\r\n\t\t\twhile (j >= 0 && pattern.charAt(j) === text.charAt(i + j)) {\r\n\t\t\t\tthis.cmd('SetBackgroundColor', this.comparisonMatrixID[row][i + j], '#2ECC71');\r\n\t\t\t\tj--;\r\n\t\t\t\tthis.cmd('Step');\r\n\t\t\t\tif (j >= 0) {\r\n\t\t\t\t\tconst xpos = (i + j) * this.cellSize + ARRAY_START_X;\r\n\t\t\t\t\tthis.cmd('Move', iPointerID, xpos, ARRAY_START_Y);\r\n\t\t\t\t\tconst ypos = (row + 1) * this.cellSize + ARRAY_START_Y;\r\n\t\t\t\t\tthis.cmd('Move', jPointerID, xpos, ypos);\r\n\t\t\t\t\tthis.cmd('Step');\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (j === -1) {\r\n\t\t\t\ti++;\r\n\t\t\t} else {\r\n\t\t\t\tthis.cmd('SetBackgroundColor', this.comparisonMatrixID[row][i + j], '#E74C3C');\r\n\t\t\t\tlet shift;\r\n\t\t\t\tif (text.charAt(i + j) in lastTable) {\r\n\t\t\t\t\tshift = lastTable[text.charAt(i + j)];\r\n\t\t\t\t} else {\r\n\t\t\t\t\tshift = -1;\r\n\t\t\t\t}\r\n\t\t\t\tif (shift < j) {\r\n\t\t\t\t\ti += j - shift;\r\n\t\t\t\t} else {\r\n\t\t\t\t\ti++;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tj = pattern.length - 1;\r\n\t\t\trow++;\r\n\t\t\tif (i <= text.length - pattern.length) {\r\n\t\t\t\tconst xpos = (i + j) * this.cellSize + ARRAY_START_X;\r\n\t\t\t\tthis.cmd('Move', iPointerID, xpos, ARRAY_START_Y);\r\n\t\t\t\tconst ypos = (row + 1) * this.cellSize + ARRAY_START_Y;\r\n\t\t\t\tthis.cmd('Move', jPointerID, xpos, ypos);\r\n\t\t\t\tthis.cmd('Step');\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis.cmd('Delete', iPointerID);\r\n\t\tthis.cmd('Delete', jPointerID);\r\n\t\treturn this.commands;\r\n\t}\r\n\r\n\tbuildLastTable(textLength, pattern) {\r\n\t\t// Display labels\r\n\t\tconst labelsX = ARRAY_START_X + textLength * this.cellSize + 10;\r\n\t\tthis.cmd('CreateLabel', this.patternTableLableID, 'Pattern:', labelsX, PATTERN_START_Y, 0);\r\n\t\tthis.cmd(\r\n\t\t\t'CreateLabel',\r\n\t\t\tthis.lastTableLabelID,\r\n\t\t\t'Last occurence table:',\r\n\t\t\tlabelsX,\r\n\t\t\tLAST_TABLE_START_Y,\r\n\t\t\t0\r\n\t\t);\r\n\r\n\t\t// Display pattern table\r\n\t\tlet patternTableStartX = ARRAY_START_X + textLength * this.cellSize + 80;\r\n\t\tthis.patternTableCharacterID = new Array(pattern.length);\r\n\t\tthis.patternTableIndexID = new Array(pattern.length);\r\n\t\tfor (let i = 0; i < pattern.length; i++) {\r\n\t\t\tconst xpos = patternTableStartX + i * this.cellSize;\r\n\t\t\tthis.patternTableCharacterID[i] = this.nextIndex;\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'CreateRectangle',\r\n\t\t\t\tthis.nextIndex++,\r\n\t\t\t\tpattern.charAt(i),\r\n\t\t\t\tthis.cellSize,\r\n\t\t\t\tthis.cellSize,\r\n\t\t\t\txpos,\r\n\t\t\t\tPATTERN_START_Y\r\n\t\t\t);\r\n\t\t\tthis.patternTableIndexID[i] = this.nextIndex;\r\n\t\t\tthis.cmd('CreateLabel', this.nextIndex++, i, xpos, PATTERN_START_Y + this.cellSize);\r\n\t\t}\r\n\r\n\t\t// Create empty last occurence table\r\n\t\tconst characters = {}; // This is a HashMap (JavaScript is weird...)\r\n\t\tfor (let i = 0; i < pattern.length; i++) {\r\n\t\t\tcharacters[pattern.charAt(i)] = null;\r\n\t\t}\r\n\r\n\t\t// Display empty last occurence table\r\n\t\tthis.lastTableCharacterID = [];\r\n\t\tthis.lastTableValueID = [];\r\n\t\tpatternTableStartX = ARRAY_START_X + textLength * this.cellSize + 140;\r\n\t\tlet j = 0;\r\n\t\tfor (const character in characters) {\r\n\t\t\tconst xpos = patternTableStartX + j * this.cellSize;\r\n\t\t\tthis.lastTableCharacterID.push(this.nextIndex);\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'CreateRectangle',\r\n\t\t\t\tthis.nextIndex,\r\n\t\t\t\tcharacter,\r\n\t\t\t\tthis.cellSize,\r\n\t\t\t\tthis.cellSize,\r\n\t\t\t\txpos,\r\n\t\t\t\tLAST_TABLE_START_Y\r\n\t\t\t);\r\n\t\t\tthis.cmd('SetBackgroundColor', this.nextIndex++, '#D3D3D3');\r\n\t\t\tcharacters[character] = this.nextIndex;\r\n\t\t\tthis.lastTableValueID.push(this.nextIndex);\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'CreateRectangle',\r\n\t\t\t\tthis.nextIndex++,\r\n\t\t\t\t'',\r\n\t\t\t\tthis.cellSize,\r\n\t\t\t\tthis.cellSize,\r\n\t\t\t\txpos,\r\n\t\t\t\tLAST_TABLE_START_Y + this.cellSize\r\n\t\t\t);\r\n\t\t\tj++;\r\n\t\t}\r\n\t\t// Display \"*\" entry\r\n\t\tconst xpos = patternTableStartX + j * this.cellSize;\r\n\t\tthis.lastTableCharacterID.push(this.nextIndex);\r\n\t\tthis.cmd(\r\n\t\t\t'CreateRectangle',\r\n\t\t\tthis.nextIndex,\r\n\t\t\t'*',\r\n\t\t\tthis.cellSize,\r\n\t\t\tthis.cellSize,\r\n\t\t\txpos,\r\n\t\t\tLAST_TABLE_START_Y\r\n\t\t);\r\n\t\tthis.cmd('SetBackgroundColor', this.nextIndex++, '#D3D3D3');\r\n\t\tthis.lastTableValueID.push(this.nextIndex);\r\n\t\tthis.cmd(\r\n\t\t\t'CreateRectangle',\r\n\t\t\tthis.nextIndex++,\r\n\t\t\t'-1',\r\n\t\t\tthis.cellSize,\r\n\t\t\tthis.cellSize,\r\n\t\t\txpos,\r\n\t\t\tLAST_TABLE_START_Y + this.cellSize\r\n\t\t);\r\n\r\n\t\t// Fill out last occurence table\r\n\t\tconst lastTable = {};\r\n\t\tfor (let i = 0; i < pattern.length; i++) {\r\n\t\t\tlastTable[pattern.charAt(i)] = i;\r\n\t\t\tthis.cmd('SetText', characters[pattern.charAt(i)], i);\r\n\t\t}\r\n\t\treturn lastTable;\r\n\t}\r\n\r\n\tclear() {\r\n\t\tthis.commands = [];\r\n\t\tfor (let i = 0; i < this.textRowID.length; i++) {\r\n\t\t\tthis.cmd('Delete', this.textRowID[i]);\r\n\t\t}\r\n\t\tthis.textRowID = [];\r\n\t\tfor (let i = 0; i < this.comparisonMatrixID.length; i++) {\r\n\t\t\tfor (let j = 0; j < this.comparisonMatrixID.length; j++) {\r\n\t\t\t\tthis.cmd('Delete', this.comparisonMatrixID[i][j]);\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.comparisonMatrixID = [];\r\n\t\tif (this.patternTableCharacterID.length !== 0) {\r\n\t\t\tthis.cmd('Delete', this.patternTableLableID);\r\n\t\t}\r\n\t\tfor (let i = 0; i < this.patternTableCharacterID.length; i++) {\r\n\t\t\tthis.cmd('Delete', this.patternTableCharacterID[i]);\r\n\t\t\tthis.cmd('Delete', this.patternTableIndexID[i]);\r\n\t\t}\r\n\t\tthis.patternTableCharacterID = [];\r\n\t\tthis.patternTableIndexID = [];\r\n\t\tif (this.lastTableCharacterID.length !== 0) {\r\n\t\t\tthis.cmd('Delete', this.lastTableLabelID);\r\n\t\t}\r\n\t\tfor (let i = 0; i < this.lastTableCharacterID.length; i++) {\r\n\t\t\tthis.cmd('Delete', this.lastTableCharacterID[i]);\r\n\t\t\tthis.cmd('Delete', this.lastTableValueID[i]);\r\n\t\t}\r\n\t\tthis.lastTableCharacterID = [];\r\n\t\tthis.lastTableValueID = [];\r\n\t\treturn this.commands;\r\n\t}\r\n\r\n\t// Called by our superclass when we get an animation started event -- need to wait for the\r\n\t// event to finish before we start doing anything\r\n\tdisableUI() {\r\n\t\tfor (let i = 0; i < this.controls.length; i++) {\r\n\t\t\tthis.controls[i].disabled = true;\r\n\t\t}\r\n\t}\r\n\r\n\t// Called by our superclass when we get an animation completed event -- we can\r\n\t/// now interact again.\r\n\tenableUI() {\r\n\t\tfor (let i = 0; i < this.controls.length; i++) {\r\n\t\t\tthis.controls[i].disabled = false;\r\n\t\t}\r\n\t}\r\n}\r\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\r\n//\r\n// Redistribution and use in source and binary forms, with or without modification, are\r\n// permitted provided that the following conditions are met:\r\n//\r\n// 1. Redistributions of source code must retain the above copyright notice, this list of\r\n// conditions and the following disclaimer.\r\n//\r\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\r\n// of conditions and the following disclaimer in the documentation and/or other materials\r\n// provided with the distribution.\r\n//\r\n// THIS SOFTWARE IS PROVIDED BY David Galles ``AS IS'' AND ANY EXPRESS OR IMPLIED\r\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\r\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\r\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\r\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\r\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\r\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\r\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\r\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\r\n//\r\n// The views and conclusions contained in the software and documentation are those of the\r\n// authors and should not be interpreted as representing official policies, either expressed\r\n// or implied, of the University of San Francisco\r\n\r\nimport Algorithm, { addControlToAlgorithmBar, addLabelToAlgorithmBar } from './Algorithm.js';\r\n\r\nconst ARRAY_START_X = 100;\r\nconst ARRAY_START_Y = 30;\r\n\r\nconst MAX_LENGTH = 22;\r\n\r\nexport default class BruteForce extends Algorithm {\r\n\tconstructor(am, w, h) {\r\n\t\tsuper(am, w, h);\r\n\r\n\t\tthis.addControls();\r\n\r\n\t\t// Useful for memory management\r\n\t\tthis.nextIndex = 0;\r\n\r\n\t\t// TODO:  Add any code necessary to set up your own algorithm.  Initialize data\r\n\t\t// structures, etc.\r\n\t\tthis.setup();\r\n\t}\r\n\r\n\taddControls() {\r\n\t\tthis.controls = [];\r\n\r\n\t\taddLabelToAlgorithmBar('Text');\r\n\r\n\t\t// Text text field\r\n\t\tthis.textField = addControlToAlgorithmBar('Text', '');\r\n\t\tthis.textField.onkeydown = this.returnSubmit(\r\n\t\t\tthis.textField,\r\n\t\t\tthis.findCallback.bind(this),\r\n\t\t\tMAX_LENGTH,\r\n\t\t\tfalse\r\n\t\t);\r\n\t\tthis.controls.push(this.textField);\r\n\r\n\t\taddLabelToAlgorithmBar('Pattern');\r\n\r\n\t\t// Pattern text field\r\n\t\tthis.patternField = addControlToAlgorithmBar('Text', '');\r\n\t\tthis.patternField.onkeydown = this.returnSubmit(\r\n\t\t\tthis.patternField,\r\n\t\t\tthis.findCallback.bind(this),\r\n\t\t\tMAX_LENGTH,\r\n\t\t\tfalse\r\n\t\t);\r\n\t\tthis.controls.push(this.patternField);\r\n\r\n\t\t// Find button\r\n\t\tthis.findButton = addControlToAlgorithmBar('Button', 'Find');\r\n\t\tthis.findButton.onclick = this.findCallback.bind(this);\r\n\t\tthis.controls.push(this.findButton);\r\n\r\n\t\t// Clear button\r\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear');\r\n\t\tthis.clearButton.onclick = this.clearCallback.bind(this);\r\n\t\tthis.controls.push(this.clearButton);\r\n\t}\r\n\r\n\tsetup() {\r\n\t\tthis.textRowID = [];\r\n\t\tthis.comparisonMatrixID = [];\r\n\t}\r\n\r\n\treset() {\r\n\t\t// Reset all of your data structures to *exactly* the state they have immediately after the init\r\n\t\t// function is called.  This method is called whenever an \"undo\" is performed.  Your data\r\n\t\t// structures are completely cleaned, and then all of the actions *up to but not including* the\r\n\t\t// last action are then redone.  If you implement all of your actions through the \"implementAction\"\r\n\t\t// method below, then all of this work is done for you in the Animation \"superclass\"\r\n\r\n\t\t// Reset the (very simple) memory manager\r\n\t\tthis.nextIndex = 0;\r\n\t}\r\n\r\n\tfindCallback() {\r\n\t\tif (\r\n\t\t\tthis.textField.value !== '' &&\r\n\t\t\tthis.patternField.value !== '' &&\r\n\t\t\tthis.textField.value.length >= this.patternField.value.length\r\n\t\t) {\r\n\t\t\tthis.implementAction(this.clear.bind(this), '');\r\n\t\t\tconst text = this.textField.value;\r\n\t\t\tconst pattern = this.patternField.value;\r\n\t\t\tthis.textField.value = '';\r\n\t\t\tthis.patternField.value = '';\r\n\t\t\tthis.implementAction(this.find.bind(this), text + ',' + pattern);\r\n\t\t}\r\n\t}\r\n\r\n\tclearCallback() {\r\n\t\tthis.implementAction(this.clear.bind(this), '');\r\n\t}\r\n\r\n\tfind(params) {\r\n\t\tthis.commands = [];\r\n\r\n\t\tconst text = params.split(',')[0];\r\n\t\tconst pattern = params.split(',')[1];\r\n\r\n\t\tif (text.length <= 14) {\r\n\t\t\tthis.cellSize = 30;\r\n\t\t} else if (text.length <= 17) {\r\n\t\t\tthis.cellSize = 25;\r\n\t\t} else {\r\n\t\t\tthis.cellSize = 20;\r\n\t\t}\r\n\r\n\t\tthis.textRowID = new Array(text.length);\r\n\t\tthis.comparisonMatrixID = new Array(text.length);\r\n\t\tfor (let i = 0; i < text.length; i++) {\r\n\t\t\tthis.comparisonMatrixID[i] = new Array(text.length);\r\n\t\t}\r\n\r\n\t\tlet xpos, ypos;\r\n\r\n\t\tfor (let i = 0; i < text.length; i++) {\r\n\t\t\txpos = i * this.cellSize + ARRAY_START_X;\r\n\t\t\typos = ARRAY_START_Y;\r\n\t\t\tthis.textRowID[i] = this.nextIndex;\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'CreateRectangle',\r\n\t\t\t\tthis.nextIndex,\r\n\t\t\t\ttext.charAt(i),\r\n\t\t\t\tthis.cellSize,\r\n\t\t\t\tthis.cellSize,\r\n\t\t\t\txpos,\r\n\t\t\t\typos\r\n\t\t\t);\r\n\t\t\tthis.cmd('SetBackgroundColor', this.nextIndex++, '#D3D3D3');\r\n\t\t}\r\n\r\n\t\tfor (let row = 0; row < text.length; row++) {\r\n\t\t\tfor (let col = 0; col < text.length; col++) {\r\n\t\t\t\txpos = col * this.cellSize + ARRAY_START_X;\r\n\t\t\t\typos = (row + 1) * this.cellSize + ARRAY_START_Y;\r\n\t\t\t\tthis.comparisonMatrixID[row][col] = this.nextIndex;\r\n\t\t\t\tthis.cmd(\r\n\t\t\t\t\t'CreateRectangle',\r\n\t\t\t\t\tthis.nextIndex++,\r\n\t\t\t\t\t'',\r\n\t\t\t\t\tthis.cellSize,\r\n\t\t\t\t\tthis.cellSize,\r\n\t\t\t\t\txpos,\r\n\t\t\t\t\typos\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tconst iPointerID = this.nextIndex++;\r\n\t\tconst jPointerID = this.nextIndex++;\r\n\t\tthis.cmd(\r\n\t\t\t'CreateHighlightCircle',\r\n\t\t\tiPointerID,\r\n\t\t\t'#0000FF',\r\n\t\t\tARRAY_START_X,\r\n\t\t\tARRAY_START_Y,\r\n\t\t\tthis.cellSize / 2\r\n\t\t);\r\n\t\tthis.cmd(\r\n\t\t\t'CreateHighlightCircle',\r\n\t\t\tjPointerID,\r\n\t\t\t'#0000FF',\r\n\t\t\tARRAY_START_X,\r\n\t\t\tARRAY_START_Y + this.cellSize,\r\n\t\t\tthis.cellSize / 2\r\n\t\t);\r\n\r\n\t\tlet i = 0;\r\n\t\tlet j = 0;\r\n\t\tlet row = 0;\r\n\t\twhile (i <= text.length - pattern.length) {\r\n\t\t\tfor (let k = i; k < i + pattern.length; k++) {\r\n\t\t\t\tthis.cmd(\r\n\t\t\t\t\t'SetText',\r\n\t\t\t\t\tthis.comparisonMatrixID[row][k],\r\n\t\t\t\t\tpattern.charAt(k - i),\r\n\t\t\t\t\txpos,\r\n\t\t\t\t\typos\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t\tthis.cmd('Step');\r\n\t\t\twhile (j < pattern.length && pattern.charAt(j) === text.charAt(i + j)) {\r\n\t\t\t\tthis.cmd('SetBackgroundColor', this.comparisonMatrixID[row][i + j], '#2ECC71');\r\n\t\t\t\tj++;\r\n\t\t\t\tthis.cmd('Step');\r\n\t\t\t\tif (j !== pattern.length) {\r\n\t\t\t\t\tconst xpos = (i + j) * this.cellSize + ARRAY_START_X;\r\n\t\t\t\t\tthis.cmd('Move', iPointerID, xpos, ARRAY_START_Y);\r\n\t\t\t\t\tconst ypos = (row + 1) * this.cellSize + ARRAY_START_Y;\r\n\t\t\t\t\tthis.cmd('Move', jPointerID, xpos, ypos);\r\n\t\t\t\t\tthis.cmd('Step');\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (j !== pattern.length) {\r\n\t\t\t\tthis.cmd('SetBackgroundColor', this.comparisonMatrixID[row][i + j], '#E74C3C');\r\n\t\t\t}\r\n\t\t\ti++;\r\n\t\t\tj = 0;\r\n\t\t\trow++;\r\n\t\t\tif (i <= text.length - pattern.length) {\r\n\t\t\t\tconst xpos = (i + j) * this.cellSize + ARRAY_START_X;\r\n\t\t\t\tthis.cmd('Move', iPointerID, xpos, ARRAY_START_Y);\r\n\t\t\t\tconst ypos = (row + 1) * this.cellSize + ARRAY_START_Y;\r\n\t\t\t\tthis.cmd('Move', jPointerID, xpos, ypos);\r\n\t\t\t\tthis.cmd('Step');\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis.cmd('Delete', iPointerID);\r\n\t\tthis.cmd('Delete', jPointerID);\r\n\t\treturn this.commands;\r\n\t}\r\n\r\n\tclear() {\r\n\t\tthis.commands = [];\r\n\t\tfor (let i = 0; i < this.textRowID.length; i++) {\r\n\t\t\tthis.cmd('Delete', this.textRowID[i]);\r\n\t\t}\r\n\t\tthis.textRowID = [];\r\n\t\tfor (let i = 0; i < this.comparisonMatrixID.length; i++) {\r\n\t\t\tfor (let j = 0; j < this.comparisonMatrixID.length; j++) {\r\n\t\t\t\tthis.cmd('Delete', this.comparisonMatrixID[i][j]);\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.comparisonMatrixID = [];\r\n\t\treturn this.commands;\r\n\t}\r\n\r\n\t// Called by our superclass when we get an animation started event -- need to wait for the\r\n\t// event to finish before we start doing anything\r\n\tdisableUI() {\r\n\t\tfor (let i = 0; i < this.controls.length; i++) {\r\n\t\t\tthis.controls[i].disabled = true;\r\n\t\t}\r\n\t}\r\n\r\n\t// Called by our superclass when we get an animation completed event -- we can\r\n\t/// now interact again.\r\n\tenableUI() {\r\n\t\tfor (let i = 0; i < this.controls.length; i++) {\r\n\t\t\tthis.controls[i].disabled = false;\r\n\t\t}\r\n\t}\r\n}\r\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\r\n//\r\n// Redistribution and use in source and binary forms, with or without modification, are\r\n// permitted provided that the following conditions are met:\r\n//\r\n// 1. Redistributions of source code must retain the above copyright notice, this list of\r\n// conditions and the following disclaimer.\r\n//\r\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\r\n// of conditions and the following disclaimer in the documentation and/or other materials\r\n// provided with the distribution.\r\n//\r\n// THIS SOFTWARE IS PROVIDED BY David Galles ``AS IS'' AND ANY EXPRESS OR IMPLIED\r\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\r\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\r\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\r\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\r\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\r\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\r\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\r\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\r\n//\r\n// The views and conclusions contained in the software and documentation are those of the\r\n// authors and should not be interpreted as representing official policies, either expressed\r\n// or implied, of the University of San Francisco\r\n\r\nimport Algorithm, {\r\n\taddCheckboxToAlgorithmBar,\r\n\taddControlToAlgorithmBar,\r\n\taddLabelToAlgorithmBar,\r\n} from './Algorithm.js';\r\n\r\nconst ARRAY_START_X = 100;\r\nconst ARRAY_START_Y = 200;\r\nconst ARRAY_ELEM_WIDTH = 50;\r\nconst ARRAY_ELEM_HEIGHT = 50;\r\n\r\n// const ARRRAY_ELEMS_PER_LINE = 15;\r\n// const ARRAY_LINE_SPACING = 130;\r\n\r\nlet lastSwapEnabled = true;\r\n\r\nexport default class BubbleSort extends Algorithm {\r\n\tconstructor(am, w, h) {\r\n\t\tsuper(am, w, h);\r\n\r\n\t\tthis.addControls();\r\n\r\n\t\t// Useful for memory management\r\n\t\tthis.nextIndex = 0;\r\n\r\n\t\t// TODO:  Add any code necessary to set up your own algorithm.  Initialize data\r\n\t\t// structures, etc.\r\n\t\tthis.setup();\r\n\t}\r\n\r\n\taddControls() {\r\n\t\tthis.controls = [];\r\n\r\n\t\taddLabelToAlgorithmBar('Comma separated list (e.g. \"3,1,2\", max 18 elements)');\r\n\r\n\t\t// List text field\r\n\t\tthis.listField = addControlToAlgorithmBar('Text', '');\r\n\t\tthis.listField.onkeydown = this.returnSubmit(\r\n\t\t\tthis.listField,\r\n\t\t\tthis.sortCallback.bind(this),\r\n\t\t\t60,\r\n\t\t\tfalse\r\n\t\t);\r\n\t\tthis.controls.push(this.listField);\r\n\r\n\t\t// Sort button\r\n\t\tthis.findButton = addControlToAlgorithmBar('Button', 'Sort');\r\n\t\tthis.findButton.onclick = this.sortCallback.bind(this);\r\n\t\tthis.controls.push(this.findButton);\r\n\r\n\t\t// Clear button\r\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear');\r\n\t\tthis.clearButton.onclick = this.clearCallback.bind(this);\r\n\t\tthis.controls.push(this.clearButton);\r\n\r\n\t\t// Last swap optimization toggle\r\n\t\tthis.lastSwapCheckbox = addCheckboxToAlgorithmBar('Enable last swap optimization', true);\r\n\t\tthis.lastSwapCheckbox.onclick = this.toggleLastSwap.bind(this);\r\n\t\tthis.controls.push(this.lastSwapCheckbox);\r\n\t}\r\n\r\n\tsetup() {\r\n\t\tthis.arrayData = [];\r\n\t\tthis.arrayID = [];\r\n\t\tthis.displayData = [];\r\n\t\tthis.iPointerID = this.nextIndex++;\r\n\t\tthis.jPointerID = this.nextIndex++;\r\n\t}\r\n\r\n\treset() {\r\n\t\t// Reset all of your data structures to *exactly* the state they have immediately after the init\r\n\t\t// function is called.  This method is called whenever an \"undo\" is performed.  Your data\r\n\t\t// structures are completely cleaned, and then all of the actions *up to but not including* the\r\n\t\t// last action are then redone.  If you implement all of your actions through the \"implementAction\"\r\n\t\t// method below, then all of this work is done for you in the Animation \"superexport default class\"\r\n\r\n\t\t// Reset the (very simple) memory manager\r\n\t\tthis.nextIndex = 0;\r\n\t}\r\n\r\n\tsortCallback() {\r\n\t\tif (this.listField.value !== '') {\r\n\t\t\tthis.implementAction(this.clear.bind(this), '');\r\n\t\t\tconst list = this.listField.value;\r\n\t\t\tthis.listField.value = '';\r\n\t\t\tthis.implementAction(this.sort.bind(this), list);\r\n\t\t}\r\n\t}\r\n\r\n\tclearCallback() {\r\n\t\tthis.implementAction(this.clear.bind(this), '');\r\n\t}\r\n\r\n\ttoggleLastSwap() {\r\n\t\tlastSwapEnabled = !lastSwapEnabled;\r\n\t}\r\n\r\n\tclear() {\r\n\t\tthis.commands = [];\r\n\t\tfor (let i = 0; i < this.arrayID.length; i++) {\r\n\t\t\tthis.cmd('Delete', this.arrayID[i]);\r\n\t\t}\r\n\t\tthis.arrayData = [];\r\n\t\tthis.arrayID = [];\r\n\t\tthis.displayData = [];\r\n\t\treturn this.commands;\r\n\t}\r\n\r\n\tsort(params) {\r\n\t\tthis.commands = [];\r\n\r\n\t\tthis.arrayID = [];\r\n\t\tthis.arrayData = params\r\n\t\t\t.split(',')\r\n\t\t\t.map(Number)\r\n\t\t\t.filter(x => x)\r\n\t\t\t.slice(0, 18);\r\n\t\tconst length = this.arrayData.length;\r\n\t\tconst elemCounts = new Map();\r\n\t\tconst letterMap = new Map();\r\n\r\n\t\tfor (let i = 0; i < length; i++) {\r\n\t\t\tconst count = elemCounts.has(this.arrayData[i]) ? elemCounts.get(this.arrayData[i]) : 0;\r\n\t\t\tif (count > 0) {\r\n\t\t\t\tletterMap.set(this.arrayData[i], 'A');\r\n\t\t\t}\r\n\t\t\telemCounts.set(this.arrayData[i], count + 1);\r\n\t\t}\r\n\r\n\t\tfor (let i = 0; i < length; i++) {\r\n\t\t\tthis.arrayID[i] = this.nextIndex++;\r\n\t\t\tconst xpos = i * ARRAY_ELEM_WIDTH + ARRAY_START_X;\r\n\t\t\tconst ypos = ARRAY_START_Y;\r\n\r\n\t\t\tlet displayData = this.arrayData[i].toString();\r\n\t\t\tif (letterMap.has(this.arrayData[i])) {\r\n\t\t\t\tconst currChar = letterMap.get(this.arrayData[i]);\r\n\t\t\t\tdisplayData += currChar;\r\n\t\t\t\tletterMap.set(this.arrayData[i], String.fromCharCode(currChar.charCodeAt(0) + 1));\r\n\t\t\t}\r\n\t\t\tthis.displayData[i] = displayData;\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'CreateRectangle',\r\n\t\t\t\tthis.arrayID[i],\r\n\t\t\t\tdisplayData,\r\n\t\t\t\tARRAY_ELEM_WIDTH,\r\n\t\t\t\tARRAY_ELEM_HEIGHT,\r\n\t\t\t\txpos,\r\n\t\t\t\typos\r\n\t\t\t);\r\n\t\t}\r\n\t\tthis.cmd('CreateHighlightCircle', this.iPointerID, '#0000FF', ARRAY_START_X, ARRAY_START_Y);\r\n\t\tthis.cmd('SetHighlight', this.iPointerID, 1);\r\n\t\tthis.cmd(\r\n\t\t\t'CreateHighlightCircle',\r\n\t\t\tthis.jPointerID,\r\n\t\t\t'#0000FF',\r\n\t\t\tARRAY_START_X + ARRAY_ELEM_WIDTH,\r\n\t\t\tARRAY_START_Y\r\n\t\t);\r\n\t\tthis.cmd('SetHighlight', this.jPointerID, 1);\r\n\t\tthis.cmd('Step');\r\n\r\n\t\tlet sorted = true;\r\n\t\tlet end = this.arrayData.length - 1;\r\n\t\tlet lastSwapped = 0;\r\n\t\tdo {\r\n\t\t\tsorted = true;\r\n\t\t\tfor (let i = 0; i < end; i++) {\r\n\t\t\t\tthis.movePointers(i, i + 1);\r\n\t\t\t\tif (this.arrayData[i] > this.arrayData[i + 1]) {\r\n\t\t\t\t\tthis.swap(i, i + 1);\r\n\t\t\t\t\tsorted = false;\r\n\t\t\t\t\tlastSwapped = i;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (lastSwapEnabled) {\r\n\t\t\t\tend = lastSwapped;\r\n\t\t\t} else {\r\n\t\t\t\tend--;\r\n\t\t\t}\r\n\t\t\tif (!sorted) {\r\n\t\t\t\tfor (let i = end + 1; i < this.arrayData.length; i++) {\r\n\t\t\t\t\tthis.cmd('SetBackgroundColor', this.arrayID[i], '#2ECC71');\r\n\t\t\t\t}\r\n\t\t\t\tthis.cmd('Step');\r\n\t\t\t}\r\n\t\t} while (!sorted);\r\n\r\n\t\tthis.cmd('Delete', this.iPointerID);\r\n\t\tthis.cmd('Delete', this.jPointerID);\r\n\t\tthis.cmd('Step');\r\n\r\n\t\tfor (let i = 0; i < this.arrayData.length; i++) {\r\n\t\t\tthis.cmd('SetBackgroundColor', this.arrayID[i], '#2ECC71');\r\n\t\t}\r\n\t\tthis.cmd('Step');\r\n\r\n\t\treturn this.commands;\r\n\t}\r\n\r\n\tmovePointers(i, j) {\r\n\t\tconst iXPos = i * ARRAY_ELEM_WIDTH + ARRAY_START_X;\r\n\t\tthis.cmd('Move', this.iPointerID, iXPos, ARRAY_START_Y);\r\n\t\tconst jXPos = j * ARRAY_ELEM_WIDTH + ARRAY_START_X;\r\n\t\tthis.cmd('Move', this.jPointerID, jXPos, ARRAY_START_Y);\r\n\t\tthis.cmd('Step');\r\n\t}\r\n\r\n\tswap(i, j) {\r\n\t\t// Change pointer colors to red\r\n\t\tthis.cmd('SetForegroundColor', this.iPointerID, '#FF0000');\r\n\t\tthis.cmd('SetForegroundColor', this.jPointerID, '#FF0000');\r\n\t\t// Create temporary labels and remove text in array\r\n\t\tconst iLabelID = this.nextIndex++;\r\n\t\tconst iXPos = i * ARRAY_ELEM_WIDTH + ARRAY_START_X;\r\n\t\tthis.cmd('CreateLabel', iLabelID, this.displayData[i], iXPos, ARRAY_START_Y);\r\n\t\tconst jLabelID = this.nextIndex++;\r\n\t\tconst jXPos = j * ARRAY_ELEM_WIDTH + ARRAY_START_X;\r\n\t\tthis.cmd('CreateLabel', jLabelID, this.displayData[j], jXPos, ARRAY_START_Y);\r\n\t\tthis.cmd('Settext', this.arrayID[i], '');\r\n\t\tthis.cmd('Settext', this.arrayID[j], '');\r\n\t\t// Move labels\r\n\t\tthis.cmd('Move', iLabelID, jXPos, ARRAY_START_Y);\r\n\t\tthis.cmd('Move', jLabelID, iXPos, ARRAY_START_Y);\r\n\t\tthis.cmd('Step');\r\n\t\t// Set text in array and delete temporary labels\r\n\t\tthis.cmd('Settext', this.arrayID[i], this.displayData[j]);\r\n\t\tthis.cmd('Settext', this.arrayID[j], this.displayData[i]);\r\n\t\tthis.cmd('Delete', iLabelID);\r\n\t\tthis.cmd('Delete', jLabelID);\r\n\t\t// Swap data in backend array\r\n\t\tlet temp = this.arrayData[i];\r\n\t\tthis.arrayData[i] = this.arrayData[j];\r\n\t\tthis.arrayData[j] = temp;\r\n\t\t// Swap data in display array\r\n\t\ttemp = this.displayData[i];\r\n\t\tthis.displayData[i] = this.displayData[j];\r\n\t\tthis.displayData[j] = temp;\r\n\t\t// Reset pointer colors back to blue\r\n\t\tthis.cmd('SetForegroundColor', this.iPointerID, '#0000FF');\r\n\t\tthis.cmd('SetForegroundColor', this.jPointerID, '#0000FF');\r\n\t\tthis.cmd('Step');\r\n\t}\r\n\r\n\t// Called by our superexport default class when we get an animation started event -- need to wait for the\r\n\t// event to finish before we start doing anything\r\n\tdisableUI() {\r\n\t\tfor (let i = 0; i < this.controls.length; i++) {\r\n\t\t\tthis.controls[i].disabled = true;\r\n\t\t}\r\n\t}\r\n\r\n\t// Called by our superexport default class when we get an animation completed event -- we can\r\n\t/// now interact again.\r\n\tenableUI() {\r\n\t\tfor (let i = 0; i < this.controls.length; i++) {\r\n\t\t\tthis.controls[i].disabled = false;\r\n\t\t}\r\n\t}\r\n}\r\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\r\n//\r\n// Redistribution and use in source and binary forms, with or without modification, are\r\n// permitted provided that the following conditions are met:\r\n//\r\n// 1. Redistributions of source code must retain the above copyright notice, this list of\r\n// conditions and the following disclaimer.\r\n//\r\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\r\n// of conditions and the following disclaimer in the documentation and/or other materials\r\n// provided with the distribution.\r\n//\r\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\r\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\r\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\r\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\r\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\r\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\r\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\r\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\r\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\r\n//\r\n// The views and conclusions contained in the software and documentation are those of the\r\n// authors and should not be interpreted as representing official policies, either expressed\r\n// or implied, of the University of San Francisco\r\n\r\nimport Algorithm, {\r\n\taddControlToAlgorithmBar,\r\n\taddRadioButtonGroupToAlgorithmBar,\r\n} from './Algorithm.js';\r\n\r\nconst MAX_HASH_LENGTH = 10;\r\n\r\nconst HASH_NUMBER_START_X = 200;\r\nconst HASH_X_DIFF = 7;\r\nconst HASH_NUMBER_START_Y = 10;\r\nconst HASH_ADD_START_Y = 30;\r\nconst HASH_INPUT_START_X = 60;\r\nconst HASH_INPUT_X_DIFF = 7;\r\nconst HASH_INPUT_START_Y = 45;\r\nconst HASH_ADD_LINE_Y = 42;\r\nconst HASH_RESULT_Y = 50;\r\nconst ELF_HASH_SHIFT = 10;\r\n\r\nconst HASH_LABEL_X = 300;\r\nconst HASH_LABEL_Y = 30;\r\nconst HASH_LABEL_DELTA_X = 50;\r\n\r\nconst HIGHLIGHT_COLOR = '#0000FF';\r\n\r\nexport default class Hash extends Algorithm {\r\n\tconstructor(am, w, h) {\r\n\t\tsuper(am, w, h);\r\n\t\tthis.addControls();\r\n\t\tthis.nextIndex = 0;\r\n\t\tthis.hashingIntegers = true;\r\n\t}\r\n\r\n\taddControls() {\r\n\t\tthis.insertField = addControlToAlgorithmBar('Text', '');\r\n\t\tthis.insertField.size = MAX_HASH_LENGTH;\r\n\t\tthis.insertField.onkeydown = this.returnSubmit(\r\n\t\t\tthis.insertField,\r\n\t\t\tthis.insertCallback.bind(this),\r\n\t\t\tMAX_HASH_LENGTH,\r\n\t\t\ttrue\r\n\t\t);\r\n\t\tthis.insertButton = addControlToAlgorithmBar('Button', 'Insert');\r\n\t\tthis.insertButton.onclick = this.insertCallback.bind(this);\r\n\r\n\t\tthis.deleteField = addControlToAlgorithmBar('Text', '');\r\n\t\tthis.deleteField.size = MAX_HASH_LENGTH;\r\n\t\tthis.deleteField.onkeydown = this.returnSubmit(\r\n\t\t\tthis.insertField,\r\n\t\t\tthis.deleteCallback.bind(this),\r\n\t\t\tMAX_HASH_LENGTH,\r\n\t\t\ttrue\r\n\t\t);\r\n\t\tthis.deleteButton = addControlToAlgorithmBar('Button', 'Delete');\r\n\t\tthis.deleteButton.onclick = this.deleteCallback.bind(this);\r\n\r\n\t\tthis.findField = addControlToAlgorithmBar('Text', '');\r\n\t\tthis.findField.size = MAX_HASH_LENGTH;\r\n\t\tthis.findField.onkeydown = this.returnSubmit(\r\n\t\t\tthis.insertField,\r\n\t\t\tthis.findCallback.bind(this),\r\n\t\t\tMAX_HASH_LENGTH,\r\n\t\t\ttrue\r\n\t\t);\r\n\t\tthis.findButton = addControlToAlgorithmBar('Button', 'Find');\r\n\t\tthis.findButton.onclick = this.findCallback.bind(this);\r\n\r\n\t\tconst radioButtonList = addRadioButtonGroupToAlgorithmBar(\r\n\t\t\t['Hash Integer', 'Hash Strings'],\r\n\t\t\t'HashType'\r\n\t\t);\r\n\t\tthis.hashIntegerButton = radioButtonList[0];\r\n\t\tthis.hashIntegerButton.onclick = this.changeHashTypeCallback.bind(this, true);\r\n\t\t//  this.hashIntegerButton.onclick = this.hashIntegerCallback.bind(this);\r\n\t\tthis.hashStringButton = radioButtonList[1];\r\n\t\tthis.hashStringButton.onclick = this.changeHashTypeCallback.bind(this, false);\r\n\r\n\t\t//\tthis.hashStringButton.onclick = this.hashStringCallback.bind(this);\r\n\t\tthis.hashIntegerButton.checked = true;\r\n\t}\r\n\r\n\t// Do this extra level of wrapping to get undo to work properly.\r\n\t// (also, so that we only implement the action if we are changing the\r\n\t// radio button)\r\n\tchangeHashTypeCallback(newHashingIntegers) {\r\n\t\tif (this.hashingIntegers !== newHashingIntegers) {\r\n\t\t\tthis.implementAction(this.changeHashType.bind(this), newHashingIntegers);\r\n\t\t}\r\n\t}\r\n\r\n\tchangeHashType(newHashingIntegerValue) {\r\n\t\tthis.hashingIntegers = newHashingIntegerValue;\r\n\t\tif (this.hashingIntegers) {\r\n\t\t\tthis.hashIntegerButton.checked = true;\r\n\t\t\tthis.insertField.onkeydown = this.returnSubmit(\r\n\t\t\t\tthis.insertField,\r\n\t\t\t\tthis.insertCallback.bind(this),\r\n\t\t\t\tMAX_HASH_LENGTH,\r\n\t\t\t\ttrue\r\n\t\t\t);\r\n\t\t\tthis.deleteField.onkeydown = this.returnSubmit(\r\n\t\t\t\tthis.insertField,\r\n\t\t\t\tthis.deleteCallback.bind(this),\r\n\t\t\t\tMAX_HASH_LENGTH,\r\n\t\t\t\ttrue\r\n\t\t\t);\r\n\t\t\tthis.findField.onkeydown = this.returnSubmit(\r\n\t\t\t\tthis.insertField,\r\n\t\t\t\tthis.findCallback.bind(this),\r\n\t\t\t\tMAX_HASH_LENGTH,\r\n\t\t\t\ttrue\r\n\t\t\t);\r\n\t\t} else {\r\n\t\t\tthis.hashStringButton.checked = true;\r\n\t\t\tthis.insertField.onkeydown = this.returnSubmit(\r\n\t\t\t\tthis.insertField,\r\n\t\t\t\tthis.insertCallback.bind(this),\r\n\t\t\t\tMAX_HASH_LENGTH,\r\n\t\t\t\tfalse\r\n\t\t\t);\r\n\t\t\tthis.deleteField.onkeydown = this.returnSubmit(\r\n\t\t\t\tthis.insertField,\r\n\t\t\t\tthis.deleteCallback.bind(this),\r\n\t\t\t\tMAX_HASH_LENGTH,\r\n\t\t\t\tfalse\r\n\t\t\t);\r\n\t\t\tthis.findField.onkeydown = this.returnSubmit(\r\n\t\t\t\tthis.insertField,\r\n\t\t\t\tthis.findCallback.bind(this),\r\n\t\t\t\tMAX_HASH_LENGTH,\r\n\t\t\t\tfalse\r\n\t\t\t);\r\n\t\t}\r\n\t\treturn this.resetAll();\r\n\t}\r\n\r\n\tdoHash(input) {\r\n\t\tif (this.hashingIntegers) {\r\n\t\t\tconst labelID1 = this.nextIndex++;\r\n\t\t\tconst labelID2 = this.nextIndex++;\r\n\t\t\tconst highlightID = this.nextIndex++;\r\n\t\t\tconst index = parseInt(input) % this.table_size;\r\n\t\t\tthis.currHash = parseInt(input);\r\n\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'CreateLabel',\r\n\t\t\t\tlabelID1,\r\n\t\t\t\tinput + ' % ' + String(this.table_size) + ' = ',\r\n\t\t\t\tHASH_LABEL_X,\r\n\t\t\t\tHASH_LABEL_Y\r\n\t\t\t);\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'CreateLabel',\r\n\t\t\t\tlabelID2,\r\n\t\t\t\tindex,\r\n\t\t\t\tHASH_LABEL_X + HASH_LABEL_DELTA_X,\r\n\t\t\t\tHASH_LABEL_Y\r\n\t\t\t);\r\n\t\t\tthis.cmd('Step');\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'CreateHighlightCircle',\r\n\t\t\t\thighlightID,\r\n\t\t\t\tHIGHLIGHT_COLOR,\r\n\t\t\t\tHASH_LABEL_X + HASH_LABEL_DELTA_X,\r\n\t\t\t\tHASH_LABEL_Y\r\n\t\t\t);\r\n\t\t\tthis.cmd('Move', highlightID, this.indexXPos[index], this.indexYPos[index]);\r\n\t\t\tthis.cmd('Step');\r\n\t\t\tthis.cmd('Delete', labelID1);\r\n\t\t\tthis.cmd('Delete', labelID2);\r\n\t\t\tthis.cmd('Delete', highlightID);\r\n\t\t\tthis.nextIndex -= 3;\r\n\r\n\t\t\treturn index;\r\n\t\t} else {\r\n\t\t\t// const oldnextIndex = this.nextIndex;\r\n\t\t\tconst label1 = this.nextIndex++;\r\n\t\t\tthis.cmd('CreateLabel', label1, 'Hashing:', 10, 45, 0);\r\n\t\t\tconst wordToHashID = new Array(input.length);\r\n\t\t\tconst wordToHash = new Array(input.length);\r\n\t\t\tfor (let i = 0; i < input.length; i++) {\r\n\t\t\t\twordToHashID[i] = this.nextIndex++;\r\n\t\t\t\twordToHash[i] = input.charAt(i);\r\n\t\t\t\tthis.cmd(\r\n\t\t\t\t\t'CreateLabel',\r\n\t\t\t\t\twordToHashID[i],\r\n\t\t\t\t\twordToHash[i],\r\n\t\t\t\t\tHASH_INPUT_START_X + i * HASH_INPUT_X_DIFF,\r\n\t\t\t\t\tHASH_INPUT_START_Y,\r\n\t\t\t\t\t0\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t\tconst digits = new Array(32);\r\n\t\t\tconst hashValue = new Array(32);\r\n\t\t\tconst nextByte = new Array(8);\r\n\t\t\tconst nextByteID = new Array(8);\r\n\t\t\tconst resultDigits = new Array(32);\r\n\t\t\tconst floatingDigits = new Array(4);\r\n\t\t\tconst floatingVals = new Array(4);\r\n\r\n\t\t\tconst operatorID = this.nextIndex++;\r\n\t\t\tconst barID = this.nextIndex++;\r\n\t\t\tfor (let i = 0; i < 32; i++) {\r\n\t\t\t\thashValue[i] = 0;\r\n\t\t\t\tdigits[i] = this.nextIndex++;\r\n\t\t\t\tresultDigits[i] = this.nextIndex++;\r\n\t\t\t}\r\n\t\t\tfor (let i = 0; i < 8; i++) {\r\n\t\t\t\tnextByteID[i] = this.nextIndex++;\r\n\t\t\t}\r\n\t\t\tfor (let i = 0; i < 4; i++) {\r\n\t\t\t\tfloatingDigits[i] = this.nextIndex++;\r\n\t\t\t}\r\n\t\t\tthis.cmd('Step');\r\n\t\t\tfor (let i = wordToHash.length - 1; i >= 0; i--) {\r\n\t\t\t\tfor (let j = 0; j < 32; j++) {\r\n\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t'CreateLabel',\r\n\t\t\t\t\t\tdigits[j],\r\n\t\t\t\t\t\thashValue[j],\r\n\t\t\t\t\t\tHASH_NUMBER_START_X + j * HASH_X_DIFF,\r\n\t\t\t\t\t\tHASH_NUMBER_START_Y,\r\n\t\t\t\t\t\t0\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\t\t\t\tthis.cmd('Delete', wordToHashID[i]);\r\n\t\t\t\tlet nextChar = wordToHash[i].charCodeAt(0);\r\n\t\t\t\tfor (let j = 7; j >= 0; j--) {\r\n\t\t\t\t\tnextByte[j] = nextChar % 2;\r\n\t\t\t\t\tnextChar = Math.floor(nextChar / 2);\r\n\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t'CreateLabel',\r\n\t\t\t\t\t\tnextByteID[j],\r\n\t\t\t\t\t\tnextByte[j],\r\n\t\t\t\t\t\tHASH_INPUT_START_X + i * HASH_INPUT_X_DIFF,\r\n\t\t\t\t\t\tHASH_INPUT_START_Y,\r\n\t\t\t\t\t\t0\r\n\t\t\t\t\t);\r\n\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t'Move',\r\n\t\t\t\t\t\tnextByteID[j],\r\n\t\t\t\t\t\tHASH_NUMBER_START_X + (j + 24) * HASH_X_DIFF,\r\n\t\t\t\t\t\tHASH_ADD_START_Y\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\t\t\t\tthis.cmd('Step');\r\n\t\t\t\tthis.cmd(\r\n\t\t\t\t\t'CreateRectangle',\r\n\t\t\t\t\tbarID,\r\n\t\t\t\t\t'',\r\n\t\t\t\t\t32 * HASH_X_DIFF,\r\n\t\t\t\t\t0,\r\n\t\t\t\t\tHASH_NUMBER_START_X,\r\n\t\t\t\t\tHASH_ADD_LINE_Y,\r\n\t\t\t\t\t'left',\r\n\t\t\t\t\t'bottom'\r\n\t\t\t\t);\r\n\t\t\t\tthis.cmd('CreateLabel', operatorID, '+', HASH_NUMBER_START_X, HASH_ADD_START_Y, 0);\r\n\t\t\t\tthis.cmd('Step');\r\n\r\n\t\t\t\tlet carry = 0;\r\n\t\t\t\tfor (let j = 7; j >= 0; j--) {\r\n\t\t\t\t\thashValue[j + 24] = hashValue[j + 24] + nextByte[j] + carry;\r\n\t\t\t\t\tif (hashValue[j + 24] > 1) {\r\n\t\t\t\t\t\thashValue[j + 24] = hashValue[j + 24] - 2;\r\n\t\t\t\t\t\tcarry = 1;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tcarry = 0;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tfor (let j = 23; j >= 0; j--) {\r\n\t\t\t\t\thashValue[j] = hashValue[j] + carry;\r\n\t\t\t\t\tif (hashValue[j] > 1) {\r\n\t\t\t\t\t\thashValue[j] = hashValue[j] - 2;\r\n\t\t\t\t\t\tcarry = 1;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tcarry = 0;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tfor (let j = 0; j < 32; j++) {\r\n\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t'CreateLabel',\r\n\t\t\t\t\t\tresultDigits[j],\r\n\t\t\t\t\t\thashValue[j],\r\n\t\t\t\t\t\tHASH_NUMBER_START_X + j * HASH_X_DIFF,\r\n\t\t\t\t\t\tHASH_RESULT_Y,\r\n\t\t\t\t\t\t0\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.cmd('Step');\r\n\t\t\t\tfor (let j = 0; j < 8; j++) {\r\n\t\t\t\t\tthis.cmd('Delete', nextByteID[j]);\r\n\t\t\t\t}\r\n\t\t\t\tthis.cmd('Delete', barID);\r\n\t\t\t\tthis.cmd('Delete', operatorID);\r\n\t\t\t\tfor (let j = 0; j < 32; j++) {\r\n\t\t\t\t\tthis.cmd('Delete', digits[j]);\r\n\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t'Move',\r\n\t\t\t\t\t\tresultDigits[j],\r\n\t\t\t\t\t\tHASH_NUMBER_START_X + j * HASH_X_DIFF,\r\n\t\t\t\t\t\tHASH_NUMBER_START_Y\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\t\t\t\tthis.cmd('Step');\r\n\t\t\t\tif (i > 0) {\r\n\t\t\t\t\tfor (let j = 0; j < 32; j++) {\r\n\t\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t\t'Move',\r\n\t\t\t\t\t\t\tresultDigits[j],\r\n\t\t\t\t\t\t\tHASH_NUMBER_START_X + (j - 4) * HASH_X_DIFF,\r\n\t\t\t\t\t\t\tHASH_NUMBER_START_Y\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.cmd('Step');\r\n\t\t\t\t\tfor (let j = 0; j < 28; j++) {\r\n\t\t\t\t\t\tfloatingVals[j] = hashValue[j];\r\n\t\t\t\t\t\thashValue[j] = hashValue[j + 4];\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tfor (let j = 0; j < 4; j++) {\r\n\t\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t\t'Move',\r\n\t\t\t\t\t\t\tresultDigits[j],\r\n\t\t\t\t\t\t\tHASH_NUMBER_START_X + (j + ELF_HASH_SHIFT) * HASH_X_DIFF,\r\n\t\t\t\t\t\t\tHASH_ADD_START_Y\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t\thashValue[j + 28] = 0;\r\n\t\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t\t'CreateLabel',\r\n\t\t\t\t\t\t\tfloatingDigits[j],\r\n\t\t\t\t\t\t\t0,\r\n\t\t\t\t\t\t\tHASH_NUMBER_START_X + (j + 28) * HASH_X_DIFF,\r\n\t\t\t\t\t\t\tHASH_NUMBER_START_Y,\r\n\t\t\t\t\t\t\t0\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t\tif (floatingVals[j]) {\r\n\t\t\t\t\t\t\thashValue[j + ELF_HASH_SHIFT] = 1 - hashValue[j + ELF_HASH_SHIFT];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t'CreateRectangle',\r\n\t\t\t\t\t\tbarID,\r\n\t\t\t\t\t\t'',\r\n\t\t\t\t\t\t32 * HASH_X_DIFF,\r\n\t\t\t\t\t\t0,\r\n\t\t\t\t\t\tHASH_NUMBER_START_X,\r\n\t\t\t\t\t\tHASH_ADD_LINE_Y,\r\n\t\t\t\t\t\t'left',\r\n\t\t\t\t\t\t'bottom'\r\n\t\t\t\t\t);\r\n\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t'CreateLabel',\r\n\t\t\t\t\t\toperatorID,\r\n\t\t\t\t\t\t'XOR',\r\n\t\t\t\t\t\tHASH_NUMBER_START_X,\r\n\t\t\t\t\t\tHASH_ADD_START_Y,\r\n\t\t\t\t\t\t0\r\n\t\t\t\t\t);\r\n\t\t\t\t\tthis.cmd('Step');\r\n\t\t\t\t\tfor (let j = 0; j < 32; j++) {\r\n\t\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t\t'CreateLabel',\r\n\t\t\t\t\t\t\tdigits[j],\r\n\t\t\t\t\t\t\thashValue[j],\r\n\t\t\t\t\t\t\tHASH_NUMBER_START_X + j * HASH_X_DIFF,\r\n\t\t\t\t\t\t\tHASH_RESULT_Y,\r\n\t\t\t\t\t\t\t0\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.cmd('Step');\r\n\r\n\t\t\t\t\tthis.cmd('Delete', operatorID);\r\n\t\t\t\t\tthis.cmd('Delete', barID);\r\n\t\t\t\t\tfor (let j = 0; j < 32; j++) {\r\n\t\t\t\t\t\tthis.cmd('Delete', resultDigits[j]);\r\n\t\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t\t'Move',\r\n\t\t\t\t\t\t\tdigits[j],\r\n\t\t\t\t\t\t\tHASH_NUMBER_START_X + j * HASH_X_DIFF,\r\n\t\t\t\t\t\t\tHASH_NUMBER_START_Y\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfor (let j = 0; j < 4; j++) {\r\n\t\t\t\t\t\tthis.cmd('Delete', floatingDigits[j]);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.cmd('Step');\r\n\t\t\t\t\tfor (let j = 0; j < 32; j++) {\r\n\t\t\t\t\t\tthis.cmd('Delete', digits[j]);\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tfor (let j = 0; j < 32; j++) {\r\n\t\t\t\t\t\tthis.cmd('Delete', resultDigits[j]);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.cmd('Delete', label1);\r\n\t\t\tfor (let j = 0; j < 32; j++) {\r\n\t\t\t\tthis.cmd(\r\n\t\t\t\t\t'CreateLabel',\r\n\t\t\t\t\tdigits[j],\r\n\t\t\t\t\thashValue[j],\r\n\t\t\t\t\tHASH_NUMBER_START_X + j * HASH_X_DIFF,\r\n\t\t\t\t\tHASH_NUMBER_START_Y,\r\n\t\t\t\t\t0\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t\tthis.currHash = 0;\r\n\t\t\tfor (let j = 0; j < 32; j++) {\r\n\t\t\t\tthis.currHash = this.currHash * 2 + hashValue[j];\r\n\t\t\t}\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'CreateLabel',\r\n\t\t\t\tlabel1,\r\n\t\t\t\t' = ' + String(this.currHash),\r\n\t\t\t\tHASH_NUMBER_START_X + 32 * HASH_X_DIFF,\r\n\t\t\t\tHASH_NUMBER_START_Y,\r\n\t\t\t\t0\r\n\t\t\t);\r\n\t\t\tthis.cmd('Step');\r\n\t\t\tfor (let j = 0; j < 32; j++) {\r\n\t\t\t\tthis.cmd('Delete', digits[j]);\r\n\t\t\t}\r\n\r\n\t\t\tconst label2 = this.nextIndex++;\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'SetText',\r\n\t\t\t\tlabel1,\r\n\t\t\t\tString(this.currHash) + ' % ' + String(this.table_size) + ' = '\r\n\t\t\t);\r\n\t\t\tconst index = this.currHash % this.table_size;\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'CreateLabel',\r\n\t\t\t\tlabel2,\r\n\t\t\t\tindex,\r\n\t\t\t\tHASH_NUMBER_START_X + 32 * HASH_X_DIFF + 105,\r\n\t\t\t\tHASH_NUMBER_START_Y,\r\n\t\t\t\t0\r\n\t\t\t);\r\n\t\t\tthis.cmd('Step');\r\n\t\t\tconst highlightID = this.nextIndex++;\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'CreateHighlightCircle',\r\n\t\t\t\thighlightID,\r\n\t\t\t\tHIGHLIGHT_COLOR,\r\n\t\t\t\tHASH_NUMBER_START_X + 30 * HASH_X_DIFF + 120,\r\n\t\t\t\tHASH_NUMBER_START_Y + 15\r\n\t\t\t);\r\n\t\t\tthis.cmd('Move', highlightID, this.indexXPos[index], this.indexYPos[index]);\r\n\t\t\tthis.cmd('Step');\r\n\t\t\tthis.cmd('Delete', highlightID);\r\n\t\t\tthis.cmd('Delete', label1);\r\n\t\t\tthis.cmd('Delete', label2);\r\n\t\t\t//this.nextIndex = oldnextIndex;\r\n\r\n\t\t\treturn index;\r\n\t\t}\r\n\t}\r\n\r\n\tresetAll() {\r\n\t\tthis.insertField.value = '';\r\n\t\tthis.deleteField.value = '';\r\n\t\tthis.findField.value = '';\r\n\t\treturn [];\r\n\t}\r\n\r\n\tinsertCallback() {\r\n\t\tconst insertedValue = this.insertField.value;\r\n\t\tif (insertedValue !== '') {\r\n\t\t\tthis.insertField.value = '';\r\n\t\t\tthis.implementAction(this.insertElement.bind(this), insertedValue);\r\n\t\t}\r\n\t}\r\n\r\n\tdeleteCallback() {\r\n\t\tconst deletedValue = this.deleteField.value;\r\n\t\tif (deletedValue !== '') {\r\n\t\t\tthis.deleteField.value = '';\r\n\t\t\tthis.implementAction(this.deleteElement.bind(this), deletedValue);\r\n\t\t}\r\n\t}\r\n\r\n\tfindCallback() {\r\n\t\tconst findValue = this.findField.value;\r\n\t\tif (findValue !== '') {\r\n\t\t\tthis.findField.value = '';\r\n\t\t\tthis.implementAction(this.findElement.bind(this), findValue);\r\n\t\t}\r\n\t}\r\n\r\n\tinsertElement() {}\r\n\r\n\tdeleteElement() {}\r\n\r\n\tfindElement() {}\r\n\r\n\t// NEED TO OVERRIDE IN PARENT\r\n\treset() {\r\n\t\tthis.hashIntegerButton.checked = true;\r\n\t}\r\n\r\n\tdisableUI() {\r\n\t\tthis.insertField.disabled = true;\r\n\t\tthis.insertButton.disabled = true;\r\n\t\tthis.deleteField.disabled = true;\r\n\t\tthis.deleteButton.disabled = true;\r\n\t\tthis.findField.disabled = true;\r\n\t\tthis.findButton.disabled = true;\r\n\t}\r\n\r\n\tenableUI() {\r\n\t\tthis.insertField.disabled = false;\r\n\t\tthis.insertButton.disabled = false;\r\n\t\tthis.deleteField.disabled = false;\r\n\t\tthis.deleteButton.disabled = false;\r\n\t\tthis.findField.disabled = false;\r\n\t\tthis.findButton.disabled = false;\r\n\t}\r\n}\r\n\r\n/* no init, this is only a base export default class! \r\nvar currentAlg;\r\nfunction init()\r\n{\r\n\tvar animManag = new AnimationManager();;\r\n\tcurrentAlg = new Hash(animManag, canvas.width, canvas.height);\r\n}\r\n*/\r\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\r\n//\r\n// Redistribution and use in source and binary forms, with or without modification, are\r\n// permitted provided that the following conditions are met:\r\n//\r\n// 1. Redistributions of source code must retain the above copyright notice, this list of\r\n// conditions and the following disclaimer.\r\n//\r\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\r\n// of conditions and the following disclaimer in the documentation and/or other materials\r\n// provided with the distribution.\r\n//\r\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\r\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\r\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\r\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\r\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\r\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\r\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\r\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\r\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\r\n//\r\n// The views and conclusions contained in the software and documentation are those of the\r\n// authors and should not be interpreted as representing official policies, either expressed\r\n// or implied, of the University of San Francisco\r\n\r\nimport Hash from './Hash.js';\r\nimport { addRadioButtonGroupToAlgorithmBar } from './Algorithm.js';\r\n\r\nconst ARRAY_ELEM_WIDTH = 90;\r\nconst ARRAY_ELEM_HEIGHT = 30;\r\nconst ARRAY_ELEM_START_X = 50;\r\nconst ARRAY_ELEM_START_Y = 100;\r\nconst ARRAY_VERTICAL_SEPARATION = 100;\r\n\r\nconst CLOSED_HASH_TABLE_SIZE = 29;\r\n\r\n// const ARRAY_Y_POS = 350;\r\n\r\nconst INDEX_COLOR = '#0000FF';\r\n\r\n// const MAX_DATA_VALUE = 999;\r\n\r\n// const HASH_TABLE_SIZE = 13;\r\n\r\nexport default class ClosedHash extends Hash {\r\n\tconstructor(am, w, h) {\r\n\t\tsuper(am, w, h);\r\n\t\tthis.elements_per_row = Math.floor(w / ARRAY_ELEM_WIDTH);\r\n\r\n\t\t//Change me!\r\n\t\tthis.nextIndex = 0;\r\n\t\t//this.POINTER_ARRAY_ELEM_Y = h - POINTER_ARRAY_ELEM_WIDTH;\r\n\t\tthis.setup();\r\n\t}\r\n\r\n\taddControls() {\r\n\t\tsuper.addControls();\r\n\t\tconst radioButtonList = addRadioButtonGroupToAlgorithmBar(\r\n\t\t\t[\r\n\t\t\t\t'Linear Probing: f(i) = i',\r\n\t\t\t\t'Quadratic Probing: f(i) = i * i',\r\n\t\t\t\t'Double Hashing: f(i) = i * hash2(elem)',\r\n\t\t\t],\r\n\t\t\t'CollisionStrategy'\r\n\t\t);\r\n\t\tthis.linearProblingButton = radioButtonList[0];\r\n\t\tthis.linearProblingButton.onclick = this.linearProbeCallback.bind(this);\r\n\t\tthis.quadraticProbingButton = radioButtonList[1];\r\n\t\tthis.quadraticProbingButton.onclick = this.quadraticProbeCallback.bind(this);\r\n\t\tthis.doubleHashingButton = radioButtonList[2];\r\n\t\tthis.doubleHashingButton.onclick = this.doubleHashingCallback.bind(this);\r\n\r\n\t\tthis.linearProblingButton.checked = true;\r\n\t\tthis.currentHashingTypeButtonState = this.linearProblingButton;\r\n\r\n\t\t// Add new controls\r\n\t}\r\n\r\n\tchangeProbeType(newProbingType) {\r\n\t\tif (newProbingType === this.linearProblingButton) {\r\n\t\t\tthis.linearProblingButton.checked = true;\r\n\t\t\tthis.currentHashingTypeButtonState = this.linearProblingButton;\r\n\t\t\tfor (let i = 0; i < this.table_size; i++) {\r\n\t\t\t\tthis.skipDist[i] = i;\r\n\t\t\t}\r\n\t\t} else if (newProbingType === this.quadraticProbingButton) {\r\n\t\t\tthis.quadraticProbingButton.checked = true;\r\n\t\t\tthis.currentHashingTypeButtonState = this.quadraticProbingButton;\r\n\r\n\t\t\tfor (let i = 0; i < this.table_size; i++) {\r\n\t\t\t\tthis.skipDist[i] = i * i;\r\n\t\t\t}\r\n\t\t} else if (newProbingType === this.doubleHashingButton) {\r\n\t\t\tthis.doubleHashingButton.checked = true;\r\n\t\t\tthis.currentHashingTypeButtonState = this.doubleHashingButton;\r\n\t\t}\r\n\t\tthis.commands = this.resetAll();\r\n\t\treturn this.commands;\r\n\t}\r\n\r\n\tquadraticProbeCallback() {\r\n\t\tif (this.currentHashingTypeButtonState !== this.quadraticProbingButton) {\r\n\t\t\tthis.implementAction(this.changeProbeType.bind(this), this.quadraticProbingButton);\r\n\t\t}\r\n\t}\r\n\r\n\tdoubleHashingCallback() {\r\n\t\tif (this.currentHashingTypeButtonState !== this.doubleHashingButton) {\r\n\t\t\tthis.implementAction(this.changeProbeType.bind(this), this.doubleHashingButton);\r\n\t\t}\r\n\t}\r\n\r\n\tlinearProbeCallback() {\r\n\t\tif (this.currentHashingTypeButtonState !== this.linearProblingButton) {\r\n\t\t\tthis.implementAction(this.changeProbeType.bind(this), this.linearProblingButton);\r\n\t\t}\r\n\t}\r\n\r\n\tinsertElement(elem) {\r\n\t\tthis.commands = [];\r\n\t\tthis.cmd('SetText', this.ExplainLabel, 'Inserting element: ' + String(elem));\r\n\t\tlet index = this.doHash(elem);\r\n\r\n\t\tindex = this.getEmptyIndex(index, elem);\r\n\t\tthis.cmd('SetText', this.ExplainLabel, '');\r\n\t\tif (index !== -1) {\r\n\t\t\tconst labID = this.nextIndex++;\r\n\t\t\tthis.cmd('CreateLabel', labID, elem, 20, 25);\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'Move',\r\n\t\t\t\tlabID,\r\n\t\t\t\tthis.indexXPos[index],\r\n\t\t\t\tthis.indexYPos[index] - ARRAY_ELEM_HEIGHT\r\n\t\t\t);\r\n\t\t\tthis.cmd('Step');\r\n\t\t\tthis.cmd('Delete', labID);\r\n\t\t\tthis.cmd('SetText', this.hashTableVisual[index], elem);\r\n\t\t\tthis.hashTableValues[index] = elem;\r\n\t\t\tthis.empty[index] = false;\r\n\t\t\tthis.deleted[index] = false;\r\n\t\t}\r\n\t\treturn this.commands;\r\n\t}\r\n\r\n\tresetSkipDist(elem, labelID) {\r\n\t\tconst skipVal = 7 - (this.currHash % 7);\r\n\t\tthis.cmd(\r\n\t\t\t'CreateLabel',\r\n\t\t\tlabelID,\r\n\t\t\t'hash2(' +\r\n\t\t\t\tString(elem) +\r\n\t\t\t\t') = 1 - ' +\r\n\t\t\t\tString(this.currHash) +\r\n\t\t\t\t' % 7 = ' +\r\n\t\t\t\tString(skipVal),\r\n\t\t\t20,\r\n\t\t\t45,\r\n\t\t\t0\r\n\t\t);\r\n\t\tthis.skipDist[0] = 0;\r\n\t\tfor (let i = 1; i < this.table_size; i++) {\r\n\t\t\tthis.skipDist[i] = this.skipDist[i - 1] + skipVal;\r\n\t\t}\r\n\t}\r\n\r\n\tgetEmptyIndex(index, elem) {\r\n\t\tif (this.currentHashingTypeButtonState === this.doubleHashingButton) {\r\n\t\t\tthis.resetSkipDist(elem, this.nextIndex++);\r\n\t\t}\r\n\t\tlet foundIndex = -1;\r\n\t\tfor (let i = 0; i < this.table_size; i++) {\r\n\t\t\tconst candidateIndex = (index + this.skipDist[i]) % this.table_size;\r\n\t\t\tthis.cmd('SetHighlight', this.hashTableVisual[candidateIndex], 1);\r\n\t\t\tthis.cmd('Step');\r\n\t\t\tthis.cmd('SetHighlight', this.hashTableVisual[candidateIndex], 0);\r\n\t\t\tif (this.empty[candidateIndex]) {\r\n\t\t\t\tfoundIndex = candidateIndex;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (this.currentHashingTypeButtonState === this.doubleHashingButton) {\r\n\t\t\tthis.cmd('Delete', --this.nextIndex);\r\n\t\t}\r\n\t\treturn foundIndex;\r\n\t}\r\n\r\n\tgetElemIndex(index, elem) {\r\n\t\tif (this.currentHashingTypeButtonState === this.doubleHashingButton) {\r\n\t\t\tthis.resetSkipDist(elem, this.nextIndex++);\r\n\t\t}\r\n\t\tlet foundIndex = -1;\r\n\t\tfor (let i = 0; i < this.table_size; i++) {\r\n\t\t\tconst candidateIndex = (index + this.skipDist[i]) % this.table_size;\r\n\t\t\tthis.cmd('SetHighlight', this.hashTableVisual[candidateIndex], 1);\r\n\t\t\tthis.cmd('Step');\r\n\t\t\tthis.cmd('SetHighlight', this.hashTableVisual[candidateIndex], 0);\r\n\t\t\tif (!this.empty[candidateIndex] && this.hashTableValues[candidateIndex] === elem) {\r\n\t\t\t\tfoundIndex = candidateIndex;\r\n\t\t\t\tbreak;\r\n\t\t\t} else if (this.empty[candidateIndex] && !this.deleted[candidateIndex]) {\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (this.currentHashingTypeButtonState === this.doubleHashingButton) {\r\n\t\t\tthis.cmd('Delete', --this.nextIndex);\r\n\t\t}\r\n\t\treturn foundIndex;\r\n\t}\r\n\r\n\tdeleteElement(elem) {\r\n\t\tthis.commands = [];\r\n\t\tthis.cmd('SetText', this.ExplainLabel, 'Deleting element: ' + elem);\r\n\t\tlet index = this.doHash(elem);\r\n\r\n\t\tindex = this.getElemIndex(index, elem);\r\n\r\n\t\tif (index > 0) {\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'SetText',\r\n\t\t\t\tthis.ExplainLabel,\r\n\t\t\t\t'Deleting element: ' + elem + '  Element deleted'\r\n\t\t\t);\r\n\t\t\tthis.empty[index] = true;\r\n\t\t\tthis.deleted[index] = true;\r\n\t\t\tthis.cmd('SetText', this.hashTableVisual[index], '<deleted>');\r\n\t\t} else {\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'SetText',\r\n\t\t\t\tthis.ExplainLabel,\r\n\t\t\t\t'Deleting element: ' + elem + '  Element not in table'\r\n\t\t\t);\r\n\t\t}\r\n\t\treturn this.commands;\r\n\t}\r\n\r\n\tfindElement(elem) {\r\n\t\tthis.commands = [];\r\n\r\n\t\tthis.cmd('SetText', this.ExplainLabel, 'Finding Element: ' + elem);\r\n\t\tconst index = this.doHash(elem);\r\n\r\n\t\tconst found = this.getElemIndex(index, elem) !== -1;\r\n\t\tif (found) {\r\n\t\t\tthis.cmd('SetText', this.ExplainLabel, 'Finding Element: ' + elem + '  Found!');\r\n\t\t} else {\r\n\t\t\tthis.cmd('SetText', this.ExplainLabel, 'Finding Element: ' + elem + '  Not Found!');\r\n\t\t}\r\n\t\treturn this.commands;\r\n\t}\r\n\r\n\tsetup() {\r\n\t\tthis.table_size = CLOSED_HASH_TABLE_SIZE;\r\n\t\tthis.skipDist = new Array(this.table_size);\r\n\t\tthis.hashTableVisual = new Array(this.table_size);\r\n\t\tthis.hashTableIndices = new Array(this.table_size);\r\n\t\tthis.hashTableValues = new Array(this.table_size);\r\n\r\n\t\tthis.indexXPos = new Array(this.table_size);\r\n\t\tthis.indexYPos = new Array(this.table_size);\r\n\r\n\t\tthis.empty = new Array(this.table_size);\r\n\t\tthis.deleted = new Array(this.table_size);\r\n\r\n\t\tthis.ExplainLabel = this.nextIndex++;\r\n\r\n\t\tthis.commands = [];\r\n\r\n\t\tfor (let i = 0; i < this.table_size; i++) {\r\n\t\t\tthis.skipDist[i] = i; // Start with linear probing\r\n\t\t\tlet nextID = this.nextIndex++;\r\n\t\t\tthis.empty[i] = true;\r\n\t\t\tthis.deleted[i] = false;\r\n\r\n\t\t\tconst nextXPos = ARRAY_ELEM_START_X + (i % this.elements_per_row) * ARRAY_ELEM_WIDTH;\r\n\t\t\tconst nextYPos =\r\n\t\t\t\tARRAY_ELEM_START_Y +\r\n\t\t\t\tMath.floor(i / this.elements_per_row) * ARRAY_VERTICAL_SEPARATION;\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'CreateRectangle',\r\n\t\t\t\tnextID,\r\n\t\t\t\t'',\r\n\t\t\t\tARRAY_ELEM_WIDTH,\r\n\t\t\t\tARRAY_ELEM_HEIGHT,\r\n\t\t\t\tnextXPos,\r\n\t\t\t\tnextYPos\r\n\t\t\t);\r\n\t\t\tthis.hashTableVisual[i] = nextID;\r\n\t\t\tnextID = this.nextIndex++;\r\n\t\t\tthis.hashTableIndices[i] = nextID;\r\n\t\t\tthis.indexXPos[i] = nextXPos;\r\n\t\t\tthis.indexYPos[i] = nextYPos + ARRAY_ELEM_HEIGHT;\r\n\r\n\t\t\tthis.cmd('CreateLabel', nextID, i, this.indexXPos[i], this.indexYPos[i]);\r\n\t\t\tthis.cmd('SetForegroundColor', nextID, INDEX_COLOR);\r\n\t\t}\r\n\t\tthis.cmd('CreateLabel', this.ExplainLabel, '', 10, 25, 0);\r\n\t\tthis.animationManager.StartNewAnimation(this.commands);\r\n\t\tthis.animationManager.skipForward();\r\n\t\tthis.animationManager.clearHistory();\r\n\t\tthis.resetIndex = this.nextIndex;\r\n\t}\r\n\r\n\tresetAll() {\r\n\t\tthis.commands = super.resetAll();\r\n\r\n\t\tfor (let i = 0; i < this.table_size; i++) {\r\n\t\t\tthis.empty[i] = true;\r\n\t\t\tthis.deleted[i] = false;\r\n\t\t\tthis.cmd('SetText', this.hashTableVisual[i], '');\r\n\t\t}\r\n\t\treturn this.commands;\r\n\t\t// Clear array, etc\r\n\t}\r\n\r\n\t// NEED TO OVERRIDE IN PARENT\r\n\treset() {\r\n\t\tfor (let i = 0; i < this.table_size; i++) {\r\n\t\t\tthis.empty[i] = true;\r\n\t\t\tthis.deleted[i] = false;\r\n\t\t}\r\n\t\tthis.nextIndex = this.resetIndex;\r\n\t\tsuper.reset();\r\n\t}\r\n\r\n\tresetCallback() {}\r\n\r\n\tdisableUI() {\r\n\t\tsuper.disableUI();\r\n\t\tthis.linearProblingButton.disabled = true;\r\n\t\tthis.quadraticProbingButton.disabled = true;\r\n\t\tthis.doubleHashingButton.disabled = true;\r\n\t}\r\n\r\n\tenableUI() {\r\n\t\tsuper.enableUI();\r\n\t\tthis.linearProblingButton.disabled = false;\r\n\t\tthis.quadraticProbingButton.disabled = false;\r\n\t\tthis.doubleHashingButton.disabled = false;\r\n\t}\r\n}\r\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\r\n//\r\n// Redistribution and use in source and binary forms, with or without modification, are\r\n// permitted provided that the following conditions are met:\r\n//\r\n// 1. Redistributions of source code must retain the above copyright notice, this list of\r\n// conditions and the following disclaimer.\r\n//\r\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\r\n// of conditions and the following disclaimer in the documentation and/or other materials\r\n// provided with the distribution.\r\n//\r\n// THIS SOFTWARE IS PROVIDED BY David Galles ``AS IS'' AND ANY EXPRESS OR IMPLIED\r\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\r\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\r\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\r\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\r\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\r\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\r\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\r\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\r\n//\r\n// The views and conclusions contained in the software and documentation are those of the\r\n// authors and should not be interpreted as representing official policies, either expressed\r\n// or implied, of the University of San Francisco\r\n\r\nimport Algorithm, {\r\n\taddCheckboxToAlgorithmBar,\r\n\taddControlToAlgorithmBar,\r\n\taddLabelToAlgorithmBar,\r\n} from './Algorithm.js';\r\n\r\nconst ARRAY_START_X = 100;\r\nconst ARRAY_START_Y = 200;\r\nconst ARRAY_ELEM_WIDTH = 50;\r\nconst ARRAY_ELEM_HEIGHT = 50;\r\n\r\n// const ARRRAY_ELEMS_PER_LINE = 15;\r\n// const ARRAY_LINE_SPACING = 130;\r\n\r\nlet lastSwapEnabled = true;\r\n\r\nexport default class CocktailSort extends Algorithm {\r\n\tconstructor(am, w, h) {\r\n\t\tsuper(am, w, h);\r\n\r\n\t\tthis.addControls();\r\n\r\n\t\t// Useful for memory management\r\n\t\tthis.nextIndex = 0;\r\n\r\n\t\t// TODO:  Add any code necessary to set up your own algorithm.  Initialize data\r\n\t\t// structures, etc.\r\n\t\tthis.setup();\r\n\t}\r\n\r\n\taddControls() {\r\n\t\tthis.controls = [];\r\n\r\n\t\taddLabelToAlgorithmBar('Comma separated list (e.g. \"3,1,2\", max 18 elements)');\r\n\r\n\t\t// List text field\r\n\t\tthis.listField = addControlToAlgorithmBar('Text', '');\r\n\t\tthis.listField.onkeydown = this.returnSubmit(\r\n\t\t\tthis.listField,\r\n\t\t\tthis.sortCallback.bind(this),\r\n\t\t\t60,\r\n\t\t\tfalse\r\n\t\t);\r\n\t\tthis.controls.push(this.listField);\r\n\r\n\t\t// Sort button\r\n\t\tthis.findButton = addControlToAlgorithmBar('Button', 'Sort');\r\n\t\tthis.findButton.onclick = this.sortCallback.bind(this);\r\n\t\tthis.controls.push(this.findButton);\r\n\r\n\t\t// Clear button\r\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear');\r\n\t\tthis.clearButton.onclick = this.clearCallback.bind(this);\r\n\t\tthis.controls.push(this.clearButton);\r\n\r\n\t\t// Last swap optimization toggle\r\n\t\tthis.lastSwapCheckbox = addCheckboxToAlgorithmBar('Enable last swap optimization', true);\r\n\t\tthis.lastSwapCheckbox.onclick = this.toggleLastSwap.bind(this);\r\n\t\tthis.controls.push(this.lastSwapCheckbox);\r\n\t}\r\n\r\n\tsetup() {\r\n\t\tthis.arrayData = [];\r\n\t\tthis.arrayID = [];\r\n\t\tthis.displayData = [];\r\n\t\tthis.iPointerID = this.nextIndex++;\r\n\t\tthis.jPointerID = this.nextIndex++;\r\n\t}\r\n\r\n\treset() {\r\n\t\t// Reset all of your data structures to *exactly* the state they have immediately after the init\r\n\t\t// function is called.  This method is called whenever an \"undo\" is performed.  Your data\r\n\t\t// structures are completely cleaned, and then all of the actions *up to but not including* the\r\n\t\t// last action are then redone.  If you implement all of your actions through the \"implementAction\"\r\n\t\t// method below, then all of this work is done for you in the Animation \"superexport default class\"\r\n\r\n\t\t// Reset the (very simple) memory manager\r\n\t\tthis.nextIndex = 0;\r\n\t}\r\n\r\n\tsortCallback() {\r\n\t\tif (this.listField.value !== '') {\r\n\t\t\tthis.clear();\r\n\t\t\tconst list = this.listField.value;\r\n\t\t\tthis.listField.value = '';\r\n\t\t\tthis.implementAction(this.sort.bind(this), list);\r\n\t\t}\r\n\t}\r\n\r\n\tclearCallback() {\r\n\t\tthis.implementAction(this.clear.bind(this), '');\r\n\t}\r\n\r\n\ttoggleLastSwap() {\r\n\t\tlastSwapEnabled = !lastSwapEnabled;\r\n\t}\r\n\r\n\tclear() {\r\n\t\tthis.arrayData = [];\r\n\t\tthis.commands = [];\r\n\t\tthis.displayData = [];\r\n\t\tfor (let i = 0; i < this.arrayID.length; i++) {\r\n\t\t\tthis.cmd('Delete', this.arrayID[i]);\r\n\t\t}\r\n\t\treturn this.commands;\r\n\t}\r\n\r\n\tsort(params) {\r\n\t\tthis.commands = [];\r\n\r\n\t\tthis.arrayID = [];\r\n\t\tthis.arrayData = params\r\n\t\t\t.split(',')\r\n\t\t\t.map(Number)\r\n\t\t\t.filter(x => x)\r\n\t\t\t.slice(0, 18);\r\n\t\tthis.displayData = new Array(this.arrayData.length);\r\n\t\tconst length = this.arrayData.length;\r\n\r\n\t\tconst elemCounts = new Map();\r\n\t\tconst letterMap = new Map();\r\n\r\n\t\tfor (let i = 0; i < length; i++) {\r\n\t\t\tconst count = elemCounts.has(this.arrayData[i]) ? elemCounts.get(this.arrayData[i]) : 0;\r\n\t\t\tif (count > 0) {\r\n\t\t\t\tletterMap.set(this.arrayData[i], 'A');\r\n\t\t\t}\r\n\t\t\telemCounts.set(this.arrayData[i], count + 1);\r\n\t\t}\r\n\r\n\t\tfor (let i = 0; i < length; i++) {\r\n\t\t\tthis.arrayID[i] = this.nextIndex++;\r\n\t\t\tconst xpos = i * ARRAY_ELEM_WIDTH + ARRAY_START_X;\r\n\t\t\tconst ypos = ARRAY_START_Y;\r\n\r\n\t\t\tlet displayData = this.arrayData[i].toString();\r\n\t\t\tif (letterMap.has(this.arrayData[i])) {\r\n\t\t\t\tconst currChar = letterMap.get(this.arrayData[i]);\r\n\t\t\t\tdisplayData += currChar;\r\n\t\t\t\tletterMap.set(this.arrayData[i], String.fromCharCode(currChar.charCodeAt(0) + 1));\r\n\t\t\t}\r\n\t\t\tthis.displayData[i] = displayData;\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'CreateRectangle',\r\n\t\t\t\tthis.arrayID[i],\r\n\t\t\t\tdisplayData,\r\n\t\t\t\tARRAY_ELEM_WIDTH,\r\n\t\t\t\tARRAY_ELEM_HEIGHT,\r\n\t\t\t\txpos,\r\n\t\t\t\typos\r\n\t\t\t);\r\n\t\t}\r\n\t\tthis.cmd('CreateHighlightCircle', this.iPointerID, '#0000FF', ARRAY_START_X, ARRAY_START_Y);\r\n\t\tthis.cmd('SetHighlight', this.iPointerID, 1);\r\n\t\tthis.cmd(\r\n\t\t\t'CreateHighlightCircle',\r\n\t\t\tthis.jPointerID,\r\n\t\t\t'#0000FF',\r\n\t\t\tARRAY_START_X + ARRAY_ELEM_WIDTH,\r\n\t\t\tARRAY_START_Y\r\n\t\t);\r\n\t\tthis.cmd('SetHighlight', this.jPointerID, 1);\r\n\t\tthis.cmd('Step');\r\n\r\n\t\tlet sorted = true;\r\n\t\tlet start = 0;\r\n\t\tlet end = this.arrayData.length - 1;\r\n\t\tlet lastSwapped = 0;\r\n\t\tdo {\r\n\t\t\tsorted = true;\r\n\t\t\tfor (let i = start; i < end; i++) {\r\n\t\t\t\tthis.movePointers(i, i + 1);\r\n\t\t\t\tif (this.arrayData[i] > this.arrayData[i + 1]) {\r\n\t\t\t\t\tthis.swap(i, i + 1);\r\n\t\t\t\t\tsorted = false;\r\n\t\t\t\t\tlastSwapped = i;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (lastSwapEnabled) {\r\n\t\t\t\tend = lastSwapped;\r\n\t\t\t} else {\r\n\t\t\t\tend--;\r\n\t\t\t}\r\n\t\t\tif (!sorted) {\r\n\t\t\t\tfor (let i = end + 1; i < this.arrayData.length; i++) {\r\n\t\t\t\t\tthis.cmd('SetBackgroundColor', this.arrayID[i], '#2ECC71');\r\n\t\t\t\t}\r\n\t\t\t\tthis.cmd('Step');\r\n\t\t\t}\r\n\t\t\tif (!sorted) {\r\n\t\t\t\tsorted = true;\r\n\t\t\t\tfor (let i = end; i > start; i--) {\r\n\t\t\t\t\tthis.movePointers(i - 1, i);\r\n\t\t\t\t\tif (+this.arrayData[i] < +this.arrayData[i - 1]) {\r\n\t\t\t\t\t\tthis.swap(i, i - 1);\r\n\t\t\t\t\t\tsorted = false;\r\n\t\t\t\t\t\tlastSwapped = i;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (lastSwapEnabled) {\r\n\t\t\t\t\tstart = lastSwapped;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tstart++;\r\n\t\t\t\t}\r\n\t\t\t\tif (!sorted) {\r\n\t\t\t\t\tfor (let i = start - 1; i >= 0; i--) {\r\n\t\t\t\t\t\tthis.cmd('SetBackgroundColor', this.arrayID[i], '#2ECC71');\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.cmd('Step');\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} while (!sorted);\r\n\r\n\t\tthis.cmd('Delete', this.iPointerID);\r\n\t\tthis.cmd('Delete', this.jPointerID);\r\n\t\tthis.cmd('Step');\r\n\r\n\t\tfor (let i = 0; i < this.arrayData.length; i++) {\r\n\t\t\tthis.cmd('SetBackgroundColor', this.arrayID[i], '#2ECC71');\r\n\t\t}\r\n\t\tthis.cmd('Step');\r\n\r\n\t\treturn this.commands;\r\n\t}\r\n\r\n\tmovePointers(i, j) {\r\n\t\tconst iXPos = i * ARRAY_ELEM_WIDTH + ARRAY_START_X;\r\n\t\tconst iYPos = ARRAY_START_Y;\r\n\t\tthis.cmd('Move', this.iPointerID, iXPos, iYPos);\r\n\t\tconst jXPos = j * ARRAY_ELEM_WIDTH + ARRAY_START_X;\r\n\t\tconst jYPos = ARRAY_START_Y;\r\n\t\tthis.cmd('Move', this.jPointerID, jXPos, jYPos);\r\n\t\tthis.cmd('Step');\r\n\t}\r\n\r\n\tswap(i, j) {\r\n\t\tthis.cmd('SetForegroundColor', this.iPointerID, '#FF0000');\r\n\t\tthis.cmd('SetForegroundColor', this.jPointerID, '#FF0000');\r\n\t\tconst iLabelID = this.nextIndex++;\r\n\t\tconst iXPos = i * ARRAY_ELEM_WIDTH + ARRAY_START_X;\r\n\t\tconst iYPos = ARRAY_START_Y;\r\n\t\tthis.cmd('CreateLabel', iLabelID, this.displayData[i], iXPos, iYPos);\r\n\t\tconst jLabelID = this.nextIndex++;\r\n\t\tconst jXPos = j * ARRAY_ELEM_WIDTH + ARRAY_START_X;\r\n\t\tconst jYPos = ARRAY_START_Y;\r\n\t\tthis.cmd('CreateLabel', jLabelID, this.displayData[j], jXPos, jYPos);\r\n\t\tthis.cmd('Settext', this.arrayID[i], '');\r\n\t\tthis.cmd('Settext', this.arrayID[j], '');\r\n\t\tthis.cmd('Move', iLabelID, jXPos, jYPos);\r\n\t\tthis.cmd('Move', jLabelID, iXPos, iYPos);\r\n\t\tthis.cmd('Step');\r\n\t\tthis.cmd('Settext', this.arrayID[i], this.displayData[j]);\r\n\t\tthis.cmd('Settext', this.arrayID[j], this.displayData[i]);\r\n\t\tthis.cmd('Delete', iLabelID);\r\n\t\tthis.cmd('Delete', jLabelID);\r\n\r\n\t\t// Swap actual data\r\n\t\tlet temp = this.arrayData[i];\r\n\t\tthis.arrayData[i] = this.arrayData[j];\r\n\t\tthis.arrayData[j] = temp;\r\n\r\n\t\t// Swap displayed data\r\n\t\ttemp = this.displayData[i];\r\n\t\tthis.displayData[i] = this.displayData[j];\r\n\t\tthis.displayData[j] = temp;\r\n\r\n\t\tthis.cmd('SetForegroundColor', this.iPointerID, '#0000FF');\r\n\t\tthis.cmd('SetForegroundColor', this.jPointerID, '#0000FF');\r\n\t\tthis.cmd('Step');\r\n\t}\r\n\r\n\t// Called by our superexport default class when we get an animation started event -- need to wait for the\r\n\t// event to finish before we start doing anything\r\n\tdisableUI() {\r\n\t\tfor (let i = 0; i < this.controls.length; i++) {\r\n\t\t\tthis.controls[i].disabled = true;\r\n\t\t}\r\n\t}\r\n\r\n\t// Called by our superexport default class when we get an animation completed event -- we can\r\n\t/// now interact again.\r\n\tenableUI() {\r\n\t\tfor (let i = 0; i < this.controls.length; i++) {\r\n\t\t\tthis.controls[i].disabled = false;\r\n\t\t}\r\n\t}\r\n}\r\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\r\n//\r\n// Redistribution and use in source and binary forms, with or without modification, are\r\n// permitted provided that the following conditions are met:\r\n//\r\n// 1. Redistributions of source code must retain the above copyright notice, this list of\r\n// conditions and the following disclaimer.\r\n//\r\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\r\n// of conditions and the following disclaimer in the documentation and/or other materials\r\n// provided with the distribution.\r\n//\r\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\r\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\r\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\r\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\r\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\r\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\r\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\r\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\r\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\r\n//\r\n// The views and conclusions contained in the software and documentation are those of the\r\n// authors and should not be interpreted as representing official policies, either expressed\r\n// or implied, of the University of San Francisco\r\n\r\nimport Graph, { VERTEX_INDEX_COLOR } from './Graph.js';\r\nimport { addControlToAlgorithmBar, addLabelToAlgorithmBar } from './Algorithm.js';\r\n\r\nconst AUX_ARRAY_WIDTH = 25;\r\nconst AUX_ARRAY_HEIGHT = 25;\r\nconst AUX_ARRAY_START_Y = 50;\r\n\r\nconst VISITED_START_X = 475;\r\nconst PARENT_START_X = 400;\r\n\r\nconst HIGHLIGHT_CIRCLE_COLOR = '#000000';\r\nconst DFS_TREE_COLOR = '#0000FF';\r\n\r\nexport default class DFS extends Graph {\r\n\tconstructor(am, w, h) {\r\n\t\tsuper(am, w, h);\r\n\t\tthis.showEdgeCosts = false;\r\n\t}\r\n\r\n\taddControls() {\r\n\t\taddLabelToAlgorithmBar('Start Vertex: ');\r\n\t\tthis.startField = addControlToAlgorithmBar('Text', '');\r\n\t\tthis.startField.onkeydown = this.returnSubmit(\r\n\t\t\tthis.startField,\r\n\t\t\tthis.startCallback.bind(this),\r\n\t\t\t1,\r\n\t\t\tfalse\r\n\t\t);\r\n\t\tthis.startButton = addControlToAlgorithmBar('Button', 'Run DFS');\r\n\t\tthis.startButton.onclick = this.startCallback.bind(this);\r\n\t\tsuper.addControls();\r\n\t}\r\n\r\n\tsetup() {\r\n\t\tsuper.setup();\r\n\t\tthis.messageID = [];\r\n\t\tthis.commands = [];\r\n\t\tthis.visitedID = new Array(this.size);\r\n\t\tthis.visitedIndexID = new Array(this.size);\r\n\t\tthis.parentID = new Array(this.size);\r\n\t\tthis.parentIndexID = new Array(this.size);\r\n\t\tfor (let i = 0; i < this.size; i++) {\r\n\t\t\tthis.visitedID[i] = this.nextIndex++;\r\n\t\t\tthis.visitedIndexID[i] = this.nextIndex++;\r\n\t\t\tthis.parentID[i] = this.nextIndex++;\r\n\t\t\tthis.parentIndexID[i] = this.nextIndex++;\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'CreateRectangle',\r\n\t\t\t\tthis.visitedID[i],\r\n\t\t\t\t'F',\r\n\t\t\t\tAUX_ARRAY_WIDTH,\r\n\t\t\t\tAUX_ARRAY_HEIGHT,\r\n\t\t\t\tVISITED_START_X,\r\n\t\t\t\tAUX_ARRAY_START_Y + i * AUX_ARRAY_HEIGHT\r\n\t\t\t);\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'CreateLabel',\r\n\t\t\t\tthis.visitedIndexID[i],\r\n\t\t\t\tString.fromCharCode(65 + i),\r\n\t\t\t\tVISITED_START_X - AUX_ARRAY_WIDTH,\r\n\t\t\t\tAUX_ARRAY_START_Y + i * AUX_ARRAY_HEIGHT\r\n\t\t\t);\r\n\t\t\tthis.cmd('SetForegroundColor', this.visitedIndexID[i], VERTEX_INDEX_COLOR);\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'CreateRectangle',\r\n\t\t\t\tthis.parentID[i],\r\n\t\t\t\t'',\r\n\t\t\t\tAUX_ARRAY_WIDTH,\r\n\t\t\t\tAUX_ARRAY_HEIGHT,\r\n\t\t\t\tPARENT_START_X,\r\n\t\t\t\tAUX_ARRAY_START_Y + i * AUX_ARRAY_HEIGHT\r\n\t\t\t);\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'CreateLabel',\r\n\t\t\t\tthis.parentIndexID[i],\r\n\t\t\t\tString.fromCharCode(65 + i),\r\n\t\t\t\tPARENT_START_X - AUX_ARRAY_WIDTH,\r\n\t\t\t\tAUX_ARRAY_START_Y + i * AUX_ARRAY_HEIGHT\r\n\t\t\t);\r\n\t\t\tthis.cmd('SetForegroundColor', this.parentIndexID[i], VERTEX_INDEX_COLOR);\r\n\t\t}\r\n\t\tthis.cmd(\r\n\t\t\t'CreateLabel',\r\n\t\t\tthis.nextIndex++,\r\n\t\t\t'Parent',\r\n\t\t\tPARENT_START_X - AUX_ARRAY_WIDTH,\r\n\t\t\tAUX_ARRAY_START_Y - AUX_ARRAY_HEIGHT * 1.5,\r\n\t\t\t0\r\n\t\t);\r\n\t\tthis.cmd(\r\n\t\t\t'CreateLabel',\r\n\t\t\tthis.nextIndex++,\r\n\t\t\t'Visited',\r\n\t\t\tVISITED_START_X - AUX_ARRAY_WIDTH,\r\n\t\t\tAUX_ARRAY_START_Y - AUX_ARRAY_HEIGHT * 1.5,\r\n\t\t\t0\r\n\t\t);\r\n\t\tthis.animationManager.setAllLayers([0, this.currentLayer]);\r\n\t\tthis.animationManager.StartNewAnimation(this.commands);\r\n\t\tthis.animationManager.skipForward();\r\n\t\tthis.animationManager.clearHistory();\r\n\t\tthis.highlightCircleL = this.nextIndex++;\r\n\t\tthis.highlightCircleAL = this.nextIndex++;\r\n\t\tthis.highlightCircleAM = this.nextIndex++;\r\n\t}\r\n\r\n\tstartCallback() {\r\n\t\tif (this.startField.value !== '') {\r\n\t\t\tlet startvalue = this.startField.value;\r\n\t\t\tthis.startField.value = '';\r\n\t\t\tstartvalue = startvalue.toUpperCase().charCodeAt(0) - 65;\r\n\t\t\tif (startvalue < this.size) this.implementAction(this.doDFS.bind(this), startvalue);\r\n\t\t}\r\n\t}\r\n\r\n\tdoDFS(startVertex) {\r\n\t\tthis.visited = new Array(this.size);\r\n\t\tthis.commands = [];\r\n\t\tif (this.messageID != null) {\r\n\t\t\tfor (let i = 0; i < this.messageID.length; i++) {\r\n\t\t\t\tthis.cmd('Delete', this.messageID[i]);\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.rebuildEdges();\r\n\t\tthis.messageID = [];\r\n\t\tfor (let i = 0; i < this.size; i++) {\r\n\t\t\tthis.cmd('SetText', this.visitedID[i], 'F');\r\n\t\t\tthis.cmd('SetText', this.parentID[i], '');\r\n\t\t\tthis.visited[i] = false;\r\n\t\t}\r\n\t\tconst vertex = startVertex;\r\n\t\tthis.cmd(\r\n\t\t\t'CreateHighlightCircle',\r\n\t\t\tthis.highlightCircleL,\r\n\t\t\tHIGHLIGHT_CIRCLE_COLOR,\r\n\t\t\tthis.x_pos_logical[vertex],\r\n\t\t\tthis.y_pos_logical[vertex]\r\n\t\t);\r\n\t\tthis.cmd('SetLayer', this.highlightCircleL, 1);\r\n\t\tthis.cmd(\r\n\t\t\t'CreateHighlightCircle',\r\n\t\t\tthis.highlightCircleAL,\r\n\t\t\tHIGHLIGHT_CIRCLE_COLOR,\r\n\t\t\tthis.adj_list_x_start - this.adj_list_width,\r\n\t\t\tthis.adj_list_y_start + vertex * this.adj_list_height\r\n\t\t);\r\n\t\tthis.cmd('SetLayer', this.highlightCircleAL, 2);\r\n\r\n\t\tthis.cmd(\r\n\t\t\t'CreateHighlightCircle',\r\n\t\t\tthis.highlightCircleAM,\r\n\t\t\tHIGHLIGHT_CIRCLE_COLOR,\r\n\t\t\tthis.adj_matrix_x_start - this.adj_matrix_width,\r\n\t\t\tthis.adj_matrix_y_start + vertex * this.adj_matrix_height\r\n\t\t);\r\n\t\tthis.cmd('SetLayer', this.highlightCircleAM, 3);\r\n\r\n\t\tthis.messageY = 30;\r\n\t\tthis.dfsVisit(vertex, 10);\r\n\t\tthis.cmd('Delete', this.highlightCircleL);\r\n\t\tthis.cmd('Delete', this.highlightCircleAL);\r\n\t\tthis.cmd('Delete', this.highlightCircleAM);\r\n\t\treturn this.commands;\r\n\t}\r\n\r\n\tdfsVisit(startVertex, messageX) {\r\n\t\tlet nextMessage = this.nextIndex++;\r\n\t\tthis.messageID.push(nextMessage);\r\n\r\n\t\tthis.cmd(\r\n\t\t\t'CreateLabel',\r\n\t\t\tnextMessage,\r\n\t\t\t'DFS(' + String.fromCharCode(65 + startVertex) + ')',\r\n\t\t\tmessageX,\r\n\t\t\tthis.messageY,\r\n\t\t\t0\r\n\t\t);\r\n\t\tthis.messageY = this.messageY + 20;\r\n\t\tif (!this.visited[startVertex]) {\r\n\t\t\tthis.visited[startVertex] = true;\r\n\t\t\tthis.cmd('SetText', this.visitedID[startVertex], 'T');\r\n\t\t\tthis.cmd('Step');\r\n\t\t\tfor (let neighbor = 0; neighbor < this.size; neighbor++) {\r\n\t\t\t\tif (this.adj_matrix[startVertex][neighbor] > 0) {\r\n\t\t\t\t\tthis.highlightEdge(startVertex, neighbor, 1);\r\n\t\t\t\t\tthis.cmd('SetHighlight', this.visitedID[neighbor], 1);\r\n\t\t\t\t\tif (this.visited[neighbor]) {\r\n\t\t\t\t\t\tnextMessage = this.nextIndex;\r\n\t\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t\t'CreateLabel',\r\n\t\t\t\t\t\t\tnextMessage,\r\n\t\t\t\t\t\t\t'Vertex ' + String.fromCharCode(65 + neighbor) + ' already visited.',\r\n\t\t\t\t\t\t\tmessageX,\r\n\t\t\t\t\t\t\tthis.messageY,\r\n\t\t\t\t\t\t\t0\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.cmd('Step');\r\n\t\t\t\t\tthis.highlightEdge(startVertex, neighbor, 0);\r\n\t\t\t\t\tthis.cmd('SetHighlight', this.visitedID[neighbor], 0);\r\n\t\t\t\t\tif (this.visited[neighbor]) {\r\n\t\t\t\t\t\tthis.cmd('Delete', nextMessage);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (!this.visited[neighbor]) {\r\n\t\t\t\t\t\tthis.cmd('Disconnect', this.circleID[startVertex], this.circleID[neighbor]);\r\n\t\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t\t'Connect',\r\n\t\t\t\t\t\t\tthis.circleID[startVertex],\r\n\t\t\t\t\t\t\tthis.circleID[neighbor],\r\n\t\t\t\t\t\t\tDFS_TREE_COLOR,\r\n\t\t\t\t\t\t\tthis.curve[startVertex][neighbor],\r\n\t\t\t\t\t\t\t1,\r\n\t\t\t\t\t\t\t''\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t\t'Move',\r\n\t\t\t\t\t\t\tthis.highlightCircleL,\r\n\t\t\t\t\t\t\tthis.x_pos_logical[neighbor],\r\n\t\t\t\t\t\t\tthis.y_pos_logical[neighbor]\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t\t'Move',\r\n\t\t\t\t\t\t\tthis.highlightCircleAL,\r\n\t\t\t\t\t\t\tthis.adj_list_x_start - this.adj_list_width,\r\n\t\t\t\t\t\t\tthis.adj_list_y_start + neighbor * this.adj_list_height\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t\t'Move',\r\n\t\t\t\t\t\t\tthis.highlightCircleAM,\r\n\t\t\t\t\t\t\tthis.adj_matrix_x_start - this.adj_matrix_width,\r\n\t\t\t\t\t\t\tthis.adj_matrix_y_start + neighbor * this.adj_matrix_height\r\n\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t\t'SetText',\r\n\t\t\t\t\t\t\tthis.parentID[neighbor],\r\n\t\t\t\t\t\t\tString.fromCharCode(65 + startVertex)\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t\tthis.cmd('Step');\r\n\t\t\t\t\t\tthis.dfsVisit(neighbor, messageX + 20);\r\n\t\t\t\t\t\tnextMessage = this.nextIndex;\r\n\t\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t\t'CreateLabel',\r\n\t\t\t\t\t\t\tnextMessage,\r\n\t\t\t\t\t\t\t'Returning from recursive call: DFS(' +\r\n\t\t\t\t\t\t\t\tString.fromCharCode(65 + neighbor) +\r\n\t\t\t\t\t\t\t\t')',\r\n\t\t\t\t\t\t\tmessageX + 20,\r\n\t\t\t\t\t\t\tthis.messageY,\r\n\t\t\t\t\t\t\t0\r\n\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t\t'Move',\r\n\t\t\t\t\t\t\tthis.highlightCircleAL,\r\n\t\t\t\t\t\t\tthis.adj_list_x_start - this.adj_list_width,\r\n\t\t\t\t\t\t\tthis.adj_list_y_start + startVertex * this.adj_list_height\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t\t'Move',\r\n\t\t\t\t\t\t\tthis.highlightCircleL,\r\n\t\t\t\t\t\t\tthis.x_pos_logical[startVertex],\r\n\t\t\t\t\t\t\tthis.y_pos_logical[startVertex]\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t\t'Move',\r\n\t\t\t\t\t\t\tthis.highlightCircleAM,\r\n\t\t\t\t\t\t\tthis.adj_matrix_x_start - this.adj_matrix_width,\r\n\t\t\t\t\t\t\tthis.adj_matrix_y_start + startVertex * this.adj_matrix_height\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t\tthis.cmd('Step');\r\n\t\t\t\t\t\tthis.cmd('Delete', nextMessage);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.cmd('Step');\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t// NEED TO OVERRIDE IN PARENT\r\n\treset() {\r\n\t\t// Throw an error?\r\n\t}\r\n\r\n\tenableUI(event) {\r\n\t\tthis.startField.disabled = false;\r\n\t\tthis.startButton.disabled = false;\r\n\r\n\t\tsuper.enableUI(event);\r\n\t}\r\n\r\n\tdisableUI(event) {\r\n\t\tthis.startField.disabled = true;\r\n\t\tthis.startButton.disabled = true;\r\n\r\n\t\tsuper.disableUI(event);\r\n\t}\r\n}\r\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\r\n//\r\n// Redistribution and use in source and binary forms, with or without modification, are\r\n// permitted provided that the following conditions are met:\r\n//\r\n// 1. Redistributions of source code must retain the above copyright notice, this list of\r\n// conditions and the following disclaimer.\r\n//\r\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\r\n// of conditions and the following disclaimer in the documentation and/or other materials\r\n// provided with the distribution.\r\n//\r\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\r\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\r\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\r\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\r\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\r\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\r\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\r\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\r\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\r\n//\r\n// The views and conclusions contained in the software and documentation are those of the\r\n// authors and should not be interpreted as representing official policies, either expressed\r\n// or implied, of the University of San Francisco\r\n\r\nimport Algorithm, { addControlToAlgorithmBar, addLabelToAlgorithmBar } from './Algorithm.js';\r\n\r\nexport default class DPLCS extends Algorithm {\r\n\tconstructor(am, w, h) {\r\n\t\tsuper(am, w, h);\r\n\r\n\t\tthis.nextIndex = 0;\r\n\t\tthis.addControls();\r\n\t\tthis.code = [\r\n\t\t\t['def ', 'LCS(S1, S2, x, y)', ':'],\r\n\t\t\t['     if (', '(x == -1) ', ' or ', '(y == -1)', ')'],\r\n\t\t\t['          return 0'],\r\n\t\t\t['     else if ', '(S1[x] == S2[y])'],\r\n\t\t\t['          return 1 + ', 'LCS(S1, S2, x-1, y-1)'],\r\n\t\t\t['     else'],\r\n\t\t\t['          return max(', 'LCS(S1, S2, x-1, y)', ',', 'LCS(S1, S2, x, y-1)', ')'],\r\n\t\t];\r\n\r\n\t\tthis.codeID = Array(this.code.length);\r\n\t\tlet i, j;\r\n\t\tfor (i = 0; i < this.code.length; i++) {\r\n\t\t\tthis.codeID[i] = new Array(this.code[i].length);\r\n\t\t\tfor (j = 0; j < this.code[i].length; j++) {\r\n\t\t\t\tthis.codeID[i][j] = this.nextIndex++;\r\n\t\t\t\tthis.cmd(\r\n\t\t\t\t\t'CreateLabel',\r\n\t\t\t\t\tthis.codeID[i][j],\r\n\t\t\t\t\tthis.code[i][j],\r\n\t\t\t\t\tDPLCS.CODE_START_X,\r\n\t\t\t\t\tDPLCS.CODE_START_Y + i * DPLCS.CODE_LINE_HEIGHT,\r\n\t\t\t\t\t0\r\n\t\t\t\t);\r\n\t\t\t\tthis.cmd('SetForegroundColor', this.codeID[i][j], DPLCS.CODE_STANDARD_COLOR);\r\n\t\t\t\tif (j > 0) {\r\n\t\t\t\t\tthis.cmd('AlignRight', this.codeID[i][j], this.codeID[i][j - 1]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis.animationManager.StartNewAnimation(this.commands);\r\n\t\tthis.animationManager.skipForward();\r\n\t\tthis.animationManager.clearHistory();\r\n\t\tthis.initialIndex = this.nextIndex;\r\n\t\tthis.oldIDs = [];\r\n\t\tthis.commands = [];\r\n\t}\r\n\r\n\taddControls() {\r\n\t\tthis.controls = [];\r\n\t\taddLabelToAlgorithmBar('S1:');\r\n\t\tthis.S1Field = addControlToAlgorithmBar('Text', '');\r\n\t\tthis.S1Field.onkeydown = this.returnSubmit(\r\n\t\t\tthis.S1Field,\r\n\t\t\tthis.emptyCallback.bind(this),\r\n\t\t\tDPLCS.MAX_SEQUENCE_LENGTH,\r\n\t\t\tfalse\r\n\t\t);\r\n\t\tthis.controls.push(this.S1Field);\r\n\r\n\t\taddLabelToAlgorithmBar('S2:');\r\n\t\tthis.S2Field = addControlToAlgorithmBar('Text', '');\r\n\t\tthis.S2Field.onkeydown = this.returnSubmit(\r\n\t\t\tthis.S2Field,\r\n\t\t\tthis.emptyCallback.bind(this),\r\n\t\t\tDPLCS.MAX_SEQUENCE_LENGTH,\r\n\t\t\tfalse\r\n\t\t);\r\n\t\tthis.controls.push(this.S2Field);\r\n\r\n\t\tthis.recursiveButton = addControlToAlgorithmBar('Button', 'LCS Recursive');\r\n\t\tthis.recursiveButton.onclick = this.recursiveCallback.bind(this);\r\n\t\tthis.controls.push(this.recursiveButton);\r\n\r\n\t\tthis.tableButton = addControlToAlgorithmBar('Button', 'LCS Table');\r\n\t\tthis.tableButton.onclick = this.tableCallback.bind(this);\r\n\t\tthis.controls.push(this.tableButton);\r\n\r\n\t\tthis.memoizedButton = addControlToAlgorithmBar('Button', 'LCS Memoized');\r\n\t\tthis.memoizedButton.onclick = this.memoizedCallback.bind(this);\r\n\t\tthis.controls.push(this.memoizedButton);\r\n\t}\r\n\r\n\tbuildTable(S1, S2) {\r\n\t\tconst x = S1.length;\r\n\t\tconst y = S2.length;\r\n\t\tthis.tableID = new Array(x + 1);\r\n\t\tthis.tableVals = new Array(x + 1);\r\n\t\tthis.tableXPos = new Array(x + 1);\r\n\t\tthis.tableYPos = new Array(x + 1);\r\n\r\n\t\tlet i, j;\r\n\t\t// const sequence1ID = new Array(x);\r\n\t\t// const sequence2ID = new Array(y);\r\n\r\n\t\tthis.S1TableID = new Array(x);\r\n\t\tfor (i = 0; i <= x; i++) {\r\n\t\t\tif (i > 0) {\r\n\t\t\t\tthis.S1TableID[i - 1] = this.nextIndex++;\r\n\t\t\t\tthis.cmd(\r\n\t\t\t\t\t'CreateLabel',\r\n\t\t\t\t\tthis.S1TableID[i - 1],\r\n\t\t\t\t\tS1.charAt(i - 1),\r\n\t\t\t\t\tDPLCS.TABLE_START_X + i * DPLCS.TABLE_ELEM_WIDTH,\r\n\t\t\t\t\tDPLCS.TABLE_START_Y - 2 * DPLCS.TABLE_ELEM_HEIGHT\r\n\t\t\t\t);\r\n\t\t\t\tthis.oldIDs.push(this.S1TableID[i - 1]);\r\n\t\t\t}\r\n\t\t\tconst index = this.nextIndex++;\r\n\t\t\tthis.oldIDs.push(index);\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'CreateLabel',\r\n\t\t\t\tindex,\r\n\t\t\t\ti - 1,\r\n\t\t\t\tDPLCS.TABLE_START_X + i * DPLCS.TABLE_ELEM_WIDTH,\r\n\t\t\t\tDPLCS.TABLE_START_Y - 1 * DPLCS.TABLE_ELEM_HEIGHT\r\n\t\t\t);\r\n\t\t\tthis.cmd('SetForegroundColor', index, '#0000FF');\r\n\t\t}\r\n\r\n\t\tthis.S2TableID = new Array(y);\r\n\t\tfor (i = 0; i <= y; i++) {\r\n\t\t\tif (i > 0) {\r\n\t\t\t\tthis.S2TableID[i - 1] = this.nextIndex++;\r\n\t\t\t\tthis.cmd(\r\n\t\t\t\t\t'CreateLabel',\r\n\t\t\t\t\tthis.S2TableID[i - 1],\r\n\t\t\t\t\tS2.charAt(i - 1),\r\n\t\t\t\t\tDPLCS.TABLE_START_X - 2 * DPLCS.TABLE_ELEM_WIDTH,\r\n\t\t\t\t\tDPLCS.TABLE_START_Y + i * DPLCS.TABLE_ELEM_HEIGHT\r\n\t\t\t\t);\r\n\t\t\t\tthis.oldIDs.push(this.S2TableID[i - 1]);\r\n\t\t\t}\r\n\t\t\tconst index = this.nextIndex++;\r\n\t\t\tthis.oldIDs.push(index);\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'CreateLabel',\r\n\t\t\t\tindex,\r\n\t\t\t\ti - 1,\r\n\t\t\t\tDPLCS.TABLE_START_X - 1 * DPLCS.TABLE_ELEM_WIDTH,\r\n\t\t\t\tDPLCS.TABLE_START_Y + i * DPLCS.TABLE_ELEM_HEIGHT\r\n\t\t\t);\r\n\t\t\tthis.cmd('SetForegroundColor', index, '#0000FF');\r\n\t\t}\r\n\r\n\t\tfor (i = 0; i <= x; i++) {\r\n\t\t\tthis.tableID[i] = new Array(y + 1);\r\n\t\t\tthis.tableVals[i] = new Array(y + 1);\r\n\t\t\tthis.tableXPos[i] = new Array(y + 1);\r\n\t\t\tthis.tableYPos[i] = new Array(y + 1);\r\n\r\n\t\t\tfor (j = 0; j <= y; j++) {\r\n\t\t\t\tthis.tableID[i][j] = this.nextIndex++;\r\n\t\t\t\tthis.tableVals[i][j] = -1;\r\n\t\t\t\tthis.oldIDs.push(this.tableID[i][j]);\r\n\r\n\t\t\t\tthis.tableXPos[i][j] = DPLCS.TABLE_START_X + i * DPLCS.TABLE_ELEM_WIDTH;\r\n\t\t\t\tthis.tableYPos[i][j] = DPLCS.TABLE_START_Y + j * DPLCS.TABLE_ELEM_HEIGHT;\r\n\r\n\t\t\t\tthis.cmd(\r\n\t\t\t\t\t'CreateRectangle',\r\n\t\t\t\t\tthis.tableID[i][j],\r\n\t\t\t\t\t'',\r\n\t\t\t\t\tDPLCS.TABLE_ELEM_WIDTH,\r\n\t\t\t\t\tDPLCS.TABLE_ELEM_HEIGHT,\r\n\t\t\t\t\tthis.tableXPos[i][j],\r\n\t\t\t\t\tthis.tableYPos[i][j]\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tclearOldIDs() {\r\n\t\tfor (let i = 0; i < this.oldIDs.length; i++) {\r\n\t\t\tthis.cmd('Delete', this.oldIDs[i]);\r\n\t\t}\r\n\t\tthis.oldIDs = [];\r\n\t\tthis.nextIndex = this.initialIndex;\r\n\t}\r\n\r\n\treset() {\r\n\t\tthis.oldIDs = [];\r\n\t\tthis.nextIndex = this.initialIndex;\r\n\t}\r\n\r\n\temptyCallback() {\r\n\t\tthis.implementAction(this.helpMessage.bind(this), '');\r\n\t\t// TODO:  Put up a message to push the appropriate button?\r\n\t}\r\n\r\n\trecursiveCallback() {\r\n\t\t// let fibValue;\r\n\r\n\t\tif (this.S1Field.value !== '' && this.S2Field.value !== '') {\r\n\t\t\tthis.implementAction(\r\n\t\t\t\tthis.recursiveLCS.bind(this),\r\n\t\t\t\tthis.S1Field.value + ';' + this.S2Field.value\r\n\t\t\t);\r\n\t\t} else {\r\n\t\t\tthis.implementAction(this.helpMessage.bind(this), '');\r\n\t\t}\r\n\t}\r\n\r\n\ttableCallback() {\r\n\t\t// let fibValue;\r\n\r\n\t\tif (this.S1Field.value !== '' && this.S2Field.value !== '') {\r\n\t\t\tthis.implementAction(\r\n\t\t\t\tthis.tableLCS.bind(this),\r\n\t\t\t\tthis.S1Field.value + ';' + this.S2Field.value\r\n\t\t\t);\r\n\t\t} else {\r\n\t\t\tthis.implementAction(this.helpMessage.bind(this), '');\r\n\t\t}\r\n\t}\r\n\r\n\tmemoizedCallback() {\r\n\t\t// let fibValue;\r\n\r\n\t\tif (this.S1Field.value !== '' && this.S2Field.value !== '') {\r\n\t\t\tthis.implementAction(\r\n\t\t\t\tthis.memoizedLCS.bind(this),\r\n\t\t\t\tthis.S1Field.value + ';' + this.S2Field.value\r\n\t\t\t);\r\n\t\t} else {\r\n\t\t\tthis.implementAction(this.helpMessage.bind(this), '');\r\n\t\t}\r\n\t}\r\n\r\n\thelpMessage() {\r\n\t\tthis.commands = [];\r\n\r\n\t\tthis.clearOldIDs();\r\n\r\n\t\tconst messageID = this.nextIndex++;\r\n\t\tthis.oldIDs.push(messageID);\r\n\t\tthis.cmd(\r\n\t\t\t'CreateLabel',\r\n\t\t\tmessageID,\r\n\t\t\t'Enter two sequences in the text fields.\\n' +\r\n\t\t\t\t'Then press the LCS Recursive, LCS Table, or LCS Memoized button',\r\n\t\t\tDPLCS.RECURSIVE_START_X,\r\n\t\t\tDPLCS.RECURSIVE_START_Y,\r\n\t\t\t0\r\n\t\t);\r\n\t\treturn this.commands;\r\n\t}\r\n\r\n\trecursiveLCS(value) {\r\n\t\tthis.commands = [];\r\n\r\n\t\tconst sequences = value.split(';');\r\n\r\n\t\tthis.clearOldIDs();\r\n\r\n\t\tthis.currentY = DPLCS.RECURSIVE_START_Y;\r\n\r\n\t\tconst functionCallID = this.nextIndex++;\r\n\t\tthis.oldIDs.push(functionCallID);\r\n\t\tconst final = this.LCS(\r\n\t\t\tsequences[0],\r\n\t\t\tsequences[1],\r\n\t\t\tsequences[0].length - 1,\r\n\t\t\tsequences[1].length - 1,\r\n\t\t\tDPLCS.RECURSIVE_START_X,\r\n\t\t\tfunctionCallID\r\n\t\t);\r\n\t\tthis.cmd(\r\n\t\t\t'SetText',\r\n\t\t\tfunctionCallID,\r\n\t\t\t'LCS(' +\r\n\t\t\t\tsequences[0] +\r\n\t\t\t\t', ' +\r\n\t\t\t\tsequences[1] +\r\n\t\t\t\t', ' +\r\n\t\t\t\tString(sequences[0].length - 1) +\r\n\t\t\t\t', ' +\r\n\t\t\t\tString(sequences[1].length - 1) +\r\n\t\t\t\t') = ' +\r\n\t\t\t\tString(final)\r\n\t\t);\r\n\t\treturn this.commands;\r\n\t}\r\n\r\n\tLCS(S1, S2, x, y, xPos, ID) {\r\n\t\tconst ID2 = this.nextIndex++;\r\n\t\tthis.cmd(\r\n\t\t\t'CreateLabel',\r\n\t\t\tID,\r\n\t\t\t'LCS(' + S1 + ', ' + S2 + ', ' + String(x) + ', ' + String(y) + ')',\r\n\t\t\txPos,\r\n\t\t\tthis.currentY,\r\n\t\t\t0\r\n\t\t);\r\n\t\tthis.cmd(\r\n\t\t\t'CreateLabel',\r\n\t\t\tID2,\r\n\t\t\t'        [LCS(' + S1.substring(0, x + 1) + ',' + S2.substring(0, y + 1) + ')]'\r\n\t\t);\r\n\t\tthis.cmd('SetForegroundColor', ID2, '#3333FF');\r\n\t\tthis.cmd('AlignRight', ID2, ID);\r\n\t\tthis.cmd('SetForegroundColor', this.codeID[0][1], DPLCS.CODE_HIGHLIGHT_COLOR);\r\n\t\tthis.cmd('Step');\r\n\t\tthis.cmd('SetForegroundColor', this.codeID[0][1], DPLCS.CODE_STANDARD_COLOR);\r\n\r\n\t\tif (x === -1 || y === -1) {\r\n\t\t\tif (x === -1) {\r\n\t\t\t\tthis.cmd('SetForegroundColor', this.codeID[1][1], DPLCS.CODE_HIGHLIGHT_COLOR);\r\n\t\t\t}\r\n\t\t\tif (y === -1) {\r\n\t\t\t\tthis.cmd('SetForegroundColor', this.codeID[1][3], DPLCS.CODE_HIGHLIGHT_COLOR);\r\n\t\t\t}\r\n\t\t\tthis.cmd('Step');\r\n\t\t\tif (x === -1) {\r\n\t\t\t\tthis.cmd('SetForegroundColor', this.codeID[1][1], DPLCS.CODE_STANDARD_COLOR);\r\n\t\t\t}\r\n\t\t\tif (y === -1) {\r\n\t\t\t\tthis.cmd('SetForegroundColor', this.codeID[1][3], DPLCS.CODE_STANDARD_COLOR);\r\n\t\t\t}\r\n\t\t\tthis.cmd('SetForegroundColor', this.codeID[2][0], DPLCS.CODE_HIGHLIGHT_COLOR);\r\n\t\t\tthis.cmd('SetText', ID, 0);\r\n\t\t\tthis.cmd('Delete', ID2);\r\n\t\t\tthis.cmd('Step');\r\n\t\t\tthis.cmd('SetForegroundColor', this.codeID[2][0], DPLCS.CODE_STANDARD_COLOR);\r\n\t\t\treturn 0;\r\n\t\t}\r\n\t\tthis.cmd('SetForegroundColor', this.codeID[3][1], DPLCS.CODE_HIGHLIGHT_COLOR);\r\n\t\tthis.cmd('Step');\r\n\t\tthis.cmd('SetForegroundColor', this.codeID[3][1], DPLCS.CODE_STANDARD_COLOR);\r\n\r\n\t\tif (S1.charAt(x) === S2.charAt(y)) {\r\n\t\t\tthis.cmd('SetForegroundColor', this.codeID[4][1], DPLCS.CODE_HIGHLIGHT_COLOR);\r\n\t\t\tthis.cmd('Step');\r\n\t\t\tthis.cmd('SetForegroundColor', this.codeID[4][1], DPLCS.CODE_STANDARD_COLOR);\r\n\r\n\t\t\tconst nextID = this.nextIndex++;\r\n\t\t\tthis.currentY += DPLCS.RECURSIVE_DELTA_Y;\r\n\t\t\tconst subProb = this.LCS(S1, S2, x - 1, y - 1, xPos + DPLCS.RECURSIVE_DELTA_X, nextID);\r\n\r\n\t\t\tthis.cmd('SetForegroundColor', this.codeID[4][0], DPLCS.CODE_HIGHLIGHT_COLOR);\r\n\t\t\tthis.cmd('Step');\r\n\t\t\tthis.cmd('SetForegroundColor', this.codeID[4][0], DPLCS.CODE_STANDARD_COLOR);\r\n\r\n\t\t\tthis.cmd('Delete', nextID);\r\n\t\t\tthis.cmd('SetText', ID, subProb + 1);\r\n\t\t\tthis.cmd('Delete', ID2);\r\n\t\t\tthis.cmd('step');\r\n\t\t\tthis.currentY -= DPLCS.RECURSIVE_DELTA_Y;\r\n\t\t\treturn subProb + 1;\r\n\t\t} else {\r\n\t\t\tconst firstID = this.nextIndex++;\r\n\t\t\tconst secondID = this.nextIndex++;\r\n\t\t\tthis.currentY += DPLCS.RECURSIVE_DELTA_Y;\r\n\t\t\tthis.cmd('SetForegroundColor', this.codeID[6][1], DPLCS.CODE_HIGHLIGHT_COLOR);\r\n\t\t\tthis.cmd('Step');\r\n\t\t\tthis.cmd('SetForegroundColor', this.codeID[6][1], DPLCS.CODE_STANDARD_COLOR);\r\n\r\n\t\t\tconst subProb1 = this.LCS(S1, S2, x - 1, y, xPos + DPLCS.RECURSIVE_DELTA_X, firstID);\r\n\t\t\tthis.currentY += DPLCS.RECURSIVE_DELTA_Y;\r\n\t\t\tthis.cmd('SetForegroundColor', this.codeID[6][3], DPLCS.CODE_HIGHLIGHT_COLOR);\r\n\t\t\tthis.cmd('Step');\r\n\t\t\tthis.cmd('SetForegroundColor', this.codeID[6][3], DPLCS.CODE_STANDARD_COLOR);\r\n\r\n\t\t\tconst subProb2 = this.LCS(S1, S2, x, y - 1, xPos + DPLCS.RECURSIVE_DELTA_X, secondID);\r\n\r\n\t\t\tthis.cmd('SetForegroundColor', this.codeID[6][0], DPLCS.CODE_HIGHLIGHT_COLOR);\r\n\t\t\tthis.cmd('SetForegroundColor', this.codeID[6][2], DPLCS.CODE_HIGHLIGHT_COLOR);\r\n\t\t\tthis.cmd('SetForegroundColor', this.codeID[6][4], DPLCS.CODE_HIGHLIGHT_COLOR);\r\n\t\t\tthis.cmd('Step');\r\n\t\t\tthis.cmd('SetForegroundColor', this.codeID[6][0], DPLCS.CODE_STANDARD_COLOR);\r\n\t\t\tthis.cmd('SetForegroundColor', this.codeID[6][2], DPLCS.CODE_STANDARD_COLOR);\r\n\t\t\tthis.cmd('SetForegroundColor', this.codeID[6][4], DPLCS.CODE_STANDARD_COLOR);\r\n\t\t\tthis.cmd('Delete', firstID);\r\n\t\t\tthis.cmd('Delete', secondID);\r\n\t\t\tthis.currentY -= 2 * DPLCS.RECURSIVE_DELTA_Y;\r\n\t\t\tconst best = Math.max(subProb1, subProb2);\r\n\t\t\tthis.cmd('SetText', ID, best);\r\n\t\t\tthis.cmd('Delete', ID2);\r\n\t\t\tthis.cmd('step');\r\n\t\t\treturn best;\r\n\t\t}\r\n\t}\r\n\r\n\tbuildLCSFromTable(S1, S2) {\r\n\t\tlet currX = this.tableVals.length - 1;\r\n\t\tlet currY = this.tableVals[0].length - 1;\r\n\r\n\t\tconst sequence = [];\r\n\r\n\t\tconst header = this.nextIndex++;\r\n\t\tthis.oldIDs.push(header);\r\n\t\tthis.cmd(\r\n\t\t\t'CreateLabel',\r\n\t\t\theader,\r\n\t\t\t'Sequence',\r\n\t\t\tDPLCS.SEQUENCE_START_X,\r\n\t\t\tDPLCS.SEQUENCE_START_Y - 30,\r\n\t\t\t0\r\n\t\t);\r\n\t\tthis.cmd('SetForegroundColor', header, '#003300');\r\n\r\n\t\twhile (currX > 0 && currY > 0) {\r\n\t\t\tthis.cmd('SetHighlight', this.tableID[currX][currY], 1);\r\n\t\t\tthis.cmd('Step');\r\n\t\t\tthis.cmd('SetHighlight', this.S1TableID[currX - 1], 1);\r\n\t\t\tthis.cmd('SetHighlight', this.S2TableID[currY - 1], 1);\r\n\t\t\tthis.cmd('Step');\r\n\t\t\tthis.cmd('SetHighlight', this.S1TableID[currX - 1], 0);\r\n\t\t\tthis.cmd('SetHighlight', this.S2TableID[currY - 1], 0);\r\n\t\t\tthis.cmd('SetHighlight', this.tableID[currX][currY], 0);\r\n\r\n\t\t\tif (S1.charAt(currX - 1) === S2.charAt(currY - 1)) {\r\n\t\t\t\tconst nextSequenceID = this.nextIndex++;\r\n\t\t\t\tthis.oldIDs.push(nextSequenceID);\r\n\t\t\t\tsequence.push(nextSequenceID);\r\n\t\t\t\tthis.cmd(\r\n\t\t\t\t\t'CreateLabel',\r\n\t\t\t\t\tnextSequenceID,\r\n\t\t\t\t\tS1.charAt(currX - 1),\r\n\t\t\t\t\tDPLCS.TABLE_START_X + currX * DPLCS.TABLE_ELEM_WIDTH,\r\n\t\t\t\t\tDPLCS.TABLE_START_Y - 2 * DPLCS.TABLE_ELEM_HEIGHT\r\n\t\t\t\t);\r\n\t\t\t\tthis.cmd('SetForegroundColor', nextSequenceID, '#0000FF');\r\n\r\n\t\t\t\tfor (let i = sequence.length - 1; i >= 0; i--) {\r\n\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t'Move',\r\n\t\t\t\t\t\tsequence[i],\r\n\t\t\t\t\t\tDPLCS.SEQUENCE_START_X + (sequence.length - 1 - i) * DPLCS.SEQUENCE_DELTA_X,\r\n\t\t\t\t\t\tDPLCS.SEQUENCE_START_Y\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tcurrX = currX - 1;\r\n\t\t\t\tcurrY = currY - 1;\r\n\t\t\t} else {\r\n\t\t\t\tthis.cmd('SetHighlight', this.tableID[currX - 1][currY], 1);\r\n\t\t\t\tthis.cmd('SetHighlight', this.tableID[currX][currY - 1], 1);\r\n\t\t\t\tthis.cmd('Step');\r\n\t\t\t\tthis.cmd('SetHighlight', this.tableID[currX - 1][currY], 0);\r\n\t\t\t\tthis.cmd('SetHighlight', this.tableID[currX][currY - 1], 0);\r\n\r\n\t\t\t\tif (this.tableVals[currX - 1][currY] > this.tableVals[currX][currY - 1]) {\r\n\t\t\t\t\tcurrX = currX - 1;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tcurrY = currY - 1;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\ttableLCS(value) {\r\n\t\tthis.commands = [];\r\n\t\tthis.clearOldIDs();\r\n\r\n\t\tconst sequences = value.split(';');\r\n\r\n\t\tthis.buildTable(sequences[0], sequences[1]);\r\n\r\n\t\tconst moveID = this.nextIndex++;\r\n\t\tconst x = sequences[0].length;\r\n\t\tconst y = sequences[1].length;\r\n\t\tlet i, j;\r\n\r\n\t\tfor (i = 0; i <= x; i++) {\r\n\t\t\tthis.cmd('SetText', this.tableID[i][0], '0');\r\n\t\t\tthis.tableVals[i][0] = 0;\r\n\t\t}\r\n\t\tfor (i = 0; i <= y; i++) {\r\n\t\t\tthis.cmd('SetText', this.tableID[0][i], '0');\r\n\t\t\tthis.tableVals[0][i] = 0;\r\n\t\t}\r\n\t\tthis.cmd('Step');\r\n\t\tfor (j = 0; j < y; j++) {\r\n\t\t\tfor (i = 0; i < x; i++) {\r\n\t\t\t\tthis.cmd('SetHighlight', this.tableID[i + 1][j + 1], 1);\r\n\t\t\t\tthis.cmd('SetHighlight', this.S1TableID[i], 1);\r\n\t\t\t\tthis.cmd('SetHighlight', this.S2TableID[j], 1);\r\n\t\t\t\tthis.cmd('SetForegroundColor', this.codeID[3][1], DPLCS.CODE_HIGHLIGHT_COLOR);\r\n\t\t\t\tthis.cmd('Step');\r\n\t\t\t\tthis.cmd('SetHighlight', this.S1TableID[i], 0);\r\n\t\t\t\tthis.cmd('SetHighlight', this.S2TableID[j], 0);\r\n\t\t\t\tthis.cmd('SetForegroundColor', this.codeID[3][1], DPLCS.CODE_STANDARD_COLOR);\r\n\t\t\t\tif (sequences[0].charAt(i) === sequences[1].charAt(j)) {\r\n\t\t\t\t\tthis.cmd('SetForegroundColor', this.codeID[4][0], DPLCS.CODE_HIGHLIGHT_COLOR);\r\n\t\t\t\t\tthis.cmd('SetForegroundColor', this.codeID[4][1], DPLCS.CODE_HIGHLIGHT_COLOR);\r\n\t\t\t\t\tthis.cmd('SetHighlight', this.tableID[i + 1 - 1][j + 1 - 1], 1);\r\n\t\t\t\t\tthis.cmd('Step');\r\n\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t'CreateLabel',\r\n\t\t\t\t\t\tmoveID,\r\n\t\t\t\t\t\tthis.tableVals[i][j] + 1,\r\n\t\t\t\t\t\tthis.tableXPos[i][j],\r\n\t\t\t\t\t\tthis.tableYPos[i][j]\r\n\t\t\t\t\t);\r\n\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t'Move',\r\n\t\t\t\t\t\tmoveID,\r\n\t\t\t\t\t\tthis.tableXPos[i + 1][j + 1],\r\n\t\t\t\t\t\tthis.tableYPos[i + 1][j + 1]\r\n\t\t\t\t\t);\r\n\t\t\t\t\tthis.cmd('Step');\r\n\t\t\t\t\tthis.cmd('Delete', moveID);\r\n\t\t\t\t\tthis.cmd('SetForegroundColor', this.codeID[4][0], DPLCS.CODE_STANDARD_COLOR);\r\n\t\t\t\t\tthis.cmd('SetForegroundColor', this.codeID[4][1], DPLCS.CODE_STANDARD_COLOR);\r\n\t\t\t\t\tthis.cmd('SetHighlight', this.tableID[i + 1 - 1][j + 1 - 1], 0);\r\n\t\t\t\t\tthis.tableVals[i + 1][j + 1] = this.tableVals[i][j] + 1;\r\n\t\t\t\t\tthis.cmd('SetText', this.tableID[i + 1][j + 1], this.tableVals[i + 1][j + 1]);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.cmd('SetForegroundColor', this.codeID[6][0], DPLCS.CODE_HIGHLIGHT_COLOR);\r\n\t\t\t\t\tthis.cmd('SetForegroundColor', this.codeID[6][1], DPLCS.CODE_HIGHLIGHT_COLOR);\r\n\t\t\t\t\tthis.cmd('SetForegroundColor', this.codeID[6][2], DPLCS.CODE_HIGHLIGHT_COLOR);\r\n\t\t\t\t\tthis.cmd('SetForegroundColor', this.codeID[6][3], DPLCS.CODE_HIGHLIGHT_COLOR);\r\n\t\t\t\t\tthis.cmd('SetForegroundColor', this.codeID[6][4], DPLCS.CODE_HIGHLIGHT_COLOR);\r\n\r\n\t\t\t\t\tthis.cmd('SetHighlight', this.tableID[i][j + 1], 1);\r\n\t\t\t\t\tthis.cmd('SetHighlight', this.tableID[i + 1][j], 1);\r\n\t\t\t\t\tthis.cmd('Step');\r\n\t\t\t\t\tthis.cmd('SetForegroundColor', this.codeID[6][0], DPLCS.CODE_STANDARD_COLOR);\r\n\t\t\t\t\tthis.cmd('SetForegroundColor', this.codeID[6][2], DPLCS.CODE_STANDARD_COLOR);\r\n\t\t\t\t\tthis.cmd('SetForegroundColor', this.codeID[6][4], DPLCS.CODE_STANDARD_COLOR);\r\n\r\n\t\t\t\t\tif (this.tableVals[i][j + 1] > this.tableVals[i + 1][j]) {\r\n\t\t\t\t\t\tthis.cmd('SetHighlight', this.tableID[i + 1][j], 0);\r\n\t\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t\t'SetForegroundColor',\r\n\t\t\t\t\t\t\tthis.codeID[6][3],\r\n\t\t\t\t\t\t\tDPLCS.CODE_STANDARD_COLOR\r\n\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\tthis.tableVals[i + 1][j + 1] = this.tableVals[i][j + 1];\r\n\t\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t\t'CreateLabel',\r\n\t\t\t\t\t\t\tmoveID,\r\n\t\t\t\t\t\t\tthis.tableVals[i][j + 1],\r\n\t\t\t\t\t\t\tthis.tableXPos[i][j + 1],\r\n\t\t\t\t\t\t\tthis.tableYPos[i][j + 1]\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t\t'SetForegroundColor',\r\n\t\t\t\t\t\t\tthis.codeID[6][1],\r\n\t\t\t\t\t\t\tDPLCS.CODE_STANDARD_COLOR\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t\tthis.cmd('SetHighlight', this.tableID[i][j + 1], 0);\r\n\t\t\t\t\t\tthis.tableVals[i + 1][j + 1] = this.tableVals[i + 1][j];\r\n\t\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t\t'CreateLabel',\r\n\t\t\t\t\t\t\tmoveID,\r\n\t\t\t\t\t\t\tthis.tableVals[i + 1][j],\r\n\t\t\t\t\t\t\tthis.tableXPos[i + 1][j],\r\n\t\t\t\t\t\t\tthis.tableYPos[i + 1][j]\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t'Move',\r\n\t\t\t\t\t\tmoveID,\r\n\t\t\t\t\t\tthis.tableXPos[i + 1][j + 1],\r\n\t\t\t\t\t\tthis.tableYPos[i + 1][j + 1]\r\n\t\t\t\t\t);\r\n\t\t\t\t\tthis.cmd('Step');\r\n\t\t\t\t\tthis.cmd('SetText', this.tableID[i + 1][j + 1], this.tableVals[i + 1][j + 1]);\r\n\t\t\t\t\tthis.cmd('Delete', moveID);\r\n\t\t\t\t\tif (this.tableVals[i][j + 1] > this.tableVals[i + 1][j]) {\r\n\t\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t\t'SetForegroundColor',\r\n\t\t\t\t\t\t\tthis.codeID[6][1],\r\n\t\t\t\t\t\t\tDPLCS.CODE_STANDARD_COLOR\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t\tthis.cmd('SetHighlight', this.tableID[i][j + 1], 0);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t\t'SetForegroundColor',\r\n\t\t\t\t\t\t\tthis.codeID[6][3],\r\n\t\t\t\t\t\t\tDPLCS.CODE_STANDARD_COLOR\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t\tthis.cmd('SetHighlight', this.tableID[i + 1][j], 0);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tthis.cmd('SetHighlight', this.tableID[i + 1][j + 1], 0);\r\n\t\t\t\t//this.cmd(\"Step\");\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.buildLCSFromTable(sequences[0], sequences[1]);\r\n\t\treturn this.commands;\r\n\t}\r\n\r\n\tLCSMem(S1, S2, x, y, xPos, ID) {\r\n\t\tconst ID2 = this.nextIndex++;\r\n\t\tthis.cmd(\r\n\t\t\t'CreateLabel',\r\n\t\t\tID,\r\n\t\t\t'LCS(' + S1 + ', ' + S2 + ', ' + String(x) + ', ' + String(y) + ')',\r\n\t\t\txPos,\r\n\t\t\tthis.currentY,\r\n\t\t\t0\r\n\t\t);\r\n\t\tthis.cmd(\r\n\t\t\t'CreateLabel',\r\n\t\t\tID2,\r\n\t\t\t'        [LCS(' + S1.substring(0, x + 1) + ',' + S2.substring(0, y + 1) + ')]'\r\n\t\t);\r\n\t\tthis.cmd('SetForegroundColor', ID2, '#3333FF');\r\n\t\tthis.cmd('AlignRight', ID2, ID);\r\n\t\tthis.cmd('SetForegroundColor', this.codeID[0][1], DPLCS.CODE_HIGHLIGHT_COLOR);\r\n\t\tthis.cmd('Step');\r\n\t\tthis.cmd('SetForegroundColor', this.codeID[0][1], DPLCS.CODE_STANDARD_COLOR);\r\n\r\n\t\tif (this.tableVals[x + 1][y + 1] !== -1) {\r\n\t\t\tconst movingLabel = this.nextIndex++;\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'CreateLabel',\r\n\t\t\t\tmovingLabel,\r\n\t\t\t\tthis.tableVals[x + 1][y + 1],\r\n\t\t\t\tthis.tableXPos[x + 1][y + 1],\r\n\t\t\t\tthis.tableYPos[x + 1][y + 1]\r\n\t\t\t);\r\n\t\t\tthis.cmd('Move', movingLabel, xPos, this.currentY);\r\n\t\t\tthis.cmd('SetText', ID, '');\r\n\t\t\tthis.cmd('Step');\r\n\t\t\tthis.cmd('Delete', movingLabel);\r\n\r\n\t\t\tthis.cmd('SetText', ID, this.tableVals[x + 1][y + 1]);\r\n\t\t\tthis.cmd('Delete', ID2);\r\n\t\t\tthis.cmd('Step');\r\n\t\t\treturn this.tableVals[x + 1][y + 1];\r\n\t\t}\r\n\r\n\t\tif (x === -1 || y === -1) {\r\n\t\t\tif (x === -1) {\r\n\t\t\t\tthis.cmd('SetForegroundColor', this.codeID[1][1], DPLCS.CODE_HIGHLIGHT_COLOR);\r\n\t\t\t}\r\n\t\t\tif (y === -1) {\r\n\t\t\t\tthis.cmd('SetForegroundColor', this.codeID[1][3], DPLCS.CODE_HIGHLIGHT_COLOR);\r\n\t\t\t}\r\n\t\t\tthis.cmd('Step');\r\n\t\t\tif (x === -1) {\r\n\t\t\t\tthis.cmd('SetForegroundColor', this.codeID[1][1], DPLCS.CODE_STANDARD_COLOR);\r\n\t\t\t}\r\n\t\t\tif (y === -1) {\r\n\t\t\t\tthis.cmd('SetForegroundColor', this.codeID[1][3], DPLCS.CODE_STANDARD_COLOR);\r\n\t\t\t}\r\n\t\t\tthis.cmd('SetForegroundColor', this.codeID[2][0], DPLCS.CODE_HIGHLIGHT_COLOR);\r\n\t\t\tthis.cmd('SetText', ID, 0);\r\n\t\t\tthis.cmd('Delete', ID2);\r\n\t\t\tthis.cmd('Step');\r\n\t\t\tthis.cmd('SetForegroundColor', this.codeID[2][0], DPLCS.CODE_STANDARD_COLOR);\r\n\r\n\t\t\tconst movingLabel = this.nextIndex++;\r\n\t\t\tthis.cmd('CreateLabel', movingLabel, 0, xPos, this.currentY);\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'Move',\r\n\t\t\t\tmovingLabel,\r\n\t\t\t\tthis.tableXPos[x + 1][y + 1],\r\n\t\t\t\tthis.tableYPos[x + 1][y + 1]\r\n\t\t\t);\r\n\t\t\tthis.cmd('Step');\r\n\t\t\tthis.cmd('Delete', movingLabel);\r\n\r\n\t\t\tthis.tableVals[x + 1][y + 1] = 0;\r\n\t\t\tthis.cmd('SetText', this.tableID[x + 1][y + 1], 0);\r\n\r\n\t\t\treturn 0;\r\n\t\t}\r\n\t\tthis.cmd('SetForegroundColor', this.codeID[3][1], DPLCS.CODE_HIGHLIGHT_COLOR);\r\n\t\tthis.cmd('Step');\r\n\t\tthis.cmd('SetForegroundColor', this.codeID[3][1], DPLCS.CODE_STANDARD_COLOR);\r\n\r\n\t\tif (S1.charAt(x) === S2.charAt(y)) {\r\n\t\t\tthis.cmd('SetForegroundColor', this.codeID[4][1], DPLCS.CODE_HIGHLIGHT_COLOR);\r\n\t\t\tthis.cmd('Step');\r\n\t\t\tthis.cmd('SetForegroundColor', this.codeID[4][1], DPLCS.CODE_STANDARD_COLOR);\r\n\r\n\t\t\tconst nextID = this.nextIndex++;\r\n\t\t\tthis.currentY += DPLCS.RECURSIVE_DELTA_Y;\r\n\t\t\tconst subProb = this.LCSMem(\r\n\t\t\t\tS1,\r\n\t\t\t\tS2,\r\n\t\t\t\tx - 1,\r\n\t\t\t\ty - 1,\r\n\t\t\t\txPos + DPLCS.RECURSIVE_DELTA_X,\r\n\t\t\t\tnextID\r\n\t\t\t);\r\n\r\n\t\t\tthis.cmd('SetForegroundColor', this.codeID[4][0], DPLCS.CODE_HIGHLIGHT_COLOR);\r\n\t\t\tthis.cmd('Step');\r\n\t\t\tthis.cmd('SetForegroundColor', this.codeID[4][0], DPLCS.CODE_STANDARD_COLOR);\r\n\r\n\t\t\tthis.cmd('Delete', nextID);\r\n\t\t\tthis.cmd('SetText', ID, subProb + 1);\r\n\t\t\tthis.cmd('Delete', ID2);\r\n\t\t\tthis.cmd('step');\r\n\t\t\tthis.currentY -= DPLCS.RECURSIVE_DELTA_Y;\r\n\r\n\t\t\t// TODO:  Animate moving value into table here\r\n\r\n\t\t\tconst movingLabel = this.nextIndex++;\r\n\t\t\tthis.cmd('CreateLabel', movingLabel, subProb + 1, xPos, this.currentY);\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'Move',\r\n\t\t\t\tmovingLabel,\r\n\t\t\t\tthis.tableXPos[x + 1][y + 1],\r\n\t\t\t\tthis.tableYPos[x + 1][y + 1]\r\n\t\t\t);\r\n\t\t\tthis.cmd('Step');\r\n\t\t\tthis.cmd('Delete', movingLabel);\r\n\r\n\t\t\tthis.tableVals[x + 1][y + 1] = subProb + 1;\r\n\t\t\tthis.cmd('SetText', this.tableID[x + 1][y + 1], subProb + 1);\r\n\r\n\t\t\treturn subProb + 1;\r\n\t\t} else {\r\n\t\t\tconst firstID = this.nextIndex++;\r\n\t\t\tconst secondID = this.nextIndex++;\r\n\t\t\tthis.currentY += DPLCS.RECURSIVE_DELTA_Y;\r\n\t\t\tthis.cmd('SetForegroundColor', this.codeID[6][1], DPLCS.CODE_HIGHLIGHT_COLOR);\r\n\t\t\tthis.cmd('Step');\r\n\t\t\tthis.cmd('SetForegroundColor', this.codeID[6][1], DPLCS.CODE_STANDARD_COLOR);\r\n\r\n\t\t\tconst subProb1 = this.LCSMem(S1, S2, x - 1, y, xPos + DPLCS.RECURSIVE_DELTA_X, firstID);\r\n\t\t\tthis.currentY += DPLCS.RECURSIVE_DELTA_Y;\r\n\t\t\tthis.cmd('SetForegroundColor', this.codeID[6][3], DPLCS.CODE_HIGHLIGHT_COLOR);\r\n\t\t\tthis.cmd('Step');\r\n\t\t\tthis.cmd('SetForegroundColor', this.codeID[6][3], DPLCS.CODE_STANDARD_COLOR);\r\n\r\n\t\t\tconst subProb2 = this.LCSMem(\r\n\t\t\t\tS1,\r\n\t\t\t\tS2,\r\n\t\t\t\tx,\r\n\t\t\t\ty - 1,\r\n\t\t\t\txPos + DPLCS.RECURSIVE_DELTA_X,\r\n\t\t\t\tsecondID\r\n\t\t\t);\r\n\r\n\t\t\tthis.cmd('SetForegroundColor', this.codeID[6][0], DPLCS.CODE_HIGHLIGHT_COLOR);\r\n\t\t\tthis.cmd('SetForegroundColor', this.codeID[6][2], DPLCS.CODE_HIGHLIGHT_COLOR);\r\n\t\t\tthis.cmd('SetForegroundColor', this.codeID[6][4], DPLCS.CODE_HIGHLIGHT_COLOR);\r\n\t\t\tthis.cmd('Step');\r\n\t\t\tthis.cmd('SetForegroundColor', this.codeID[6][0], DPLCS.CODE_STANDARD_COLOR);\r\n\t\t\tthis.cmd('SetForegroundColor', this.codeID[6][2], DPLCS.CODE_STANDARD_COLOR);\r\n\t\t\tthis.cmd('SetForegroundColor', this.codeID[6][4], DPLCS.CODE_STANDARD_COLOR);\r\n\t\t\tthis.cmd('Delete', firstID);\r\n\t\t\tthis.cmd('Delete', secondID);\r\n\t\t\tthis.currentY -= 2 * DPLCS.RECURSIVE_DELTA_Y;\r\n\t\t\tconst best = Math.max(subProb1, subProb2);\r\n\t\t\tthis.cmd('SetText', ID, best);\r\n\t\t\tthis.cmd('Delete', ID2);\r\n\r\n\t\t\tconst movingLabel = this.nextIndex++;\r\n\t\t\tthis.cmd('CreateLabel', movingLabel, best, xPos, this.currentY);\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'Move',\r\n\t\t\t\tmovingLabel,\r\n\t\t\t\tthis.tableXPos[x + 1][y + 1],\r\n\t\t\t\tthis.tableYPos[x + 1][y + 1]\r\n\t\t\t);\r\n\t\t\tthis.cmd('Step');\r\n\t\t\tthis.cmd('Delete', movingLabel);\r\n\r\n\t\t\t// TODO:  Animate moving value into table here\r\n\t\t\tthis.tableVals[x + 1][y + 1] = best;\r\n\t\t\tthis.cmd('SetText', this.tableID[x + 1][y + 1], best);\r\n\r\n\t\t\tthis.cmd('step');\r\n\t\t\treturn best;\r\n\t\t}\r\n\t}\r\n\r\n\tmemoizedLCS(value) {\r\n\t\tthis.commands = [];\r\n\r\n\t\tthis.clearOldIDs();\r\n\t\tconst sequences = value.split(';');\r\n\r\n\t\tthis.buildTable(sequences[0], sequences[1]);\r\n\r\n\t\tconst functionCallID = this.nextIndex++;\r\n\t\tthis.currentY = DPLCS.RECURSIVE_START_Y;\r\n\r\n\t\tthis.oldIDs.push(functionCallID);\r\n\r\n\t\tconst final = this.LCSMem(\r\n\t\t\tsequences[0],\r\n\t\t\tsequences[1],\r\n\t\t\tsequences[0].length - 1,\r\n\t\t\tsequences[1].length - 1,\r\n\t\t\tDPLCS.RECURSIVE_START_X,\r\n\t\t\tfunctionCallID\r\n\t\t);\r\n\r\n\t\tthis.cmd(\r\n\t\t\t'SetText',\r\n\t\t\tfunctionCallID,\r\n\t\t\t'LCS(' +\r\n\t\t\t\tsequences[0] +\r\n\t\t\t\t', ' +\r\n\t\t\t\tsequences[1] +\r\n\t\t\t\t', ' +\r\n\t\t\t\tString(sequences[0].length - 1) +\r\n\t\t\t\t', ' +\r\n\t\t\t\tString(sequences[1].length - 1) +\r\n\t\t\t\t') = ' +\r\n\t\t\t\tString(final)\r\n\t\t);\r\n\r\n\t\tthis.buildLCSFromTable(sequences[0], sequences[1]);\r\n\r\n\t\treturn this.commands;\r\n\t}\r\n\r\n\tenableUI() {\r\n\t\tfor (let i = 0; i < this.controls.length; i++) {\r\n\t\t\tthis.controls[i].disabled = false;\r\n\t\t}\r\n\t}\r\n\r\n\tdisableUI() {\r\n\t\tfor (let i = 0; i < this.controls.length; i++) {\r\n\t\t\tthis.controls[i].disabled = true;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nDPLCS.TABLE_ELEM_WIDTH = 40;\r\nDPLCS.TABLE_ELEM_HEIGHT = 30;\r\n\r\nDPLCS.TABLE_START_X = 500;\r\nDPLCS.TABLE_START_Y = 80;\r\n\r\nDPLCS.TABLE_DIFF_X = 100;\r\n\r\nDPLCS.CODE_START_X = 10;\r\nDPLCS.CODE_START_Y = 10;\r\nDPLCS.CODE_LINE_HEIGHT = 14;\r\n\r\nDPLCS.RECURSIVE_START_X = 20;\r\nDPLCS.RECURSIVE_START_Y = 120;\r\nDPLCS.RECURSIVE_DELTA_Y = 14;\r\nDPLCS.RECURSIVE_DELTA_X = 15;\r\nDPLCS.CODE_HIGHLIGHT_COLOR = '#FF0000';\r\nDPLCS.CODE_STANDARD_COLOR = '#000000';\r\nDPLCS.MAX_SEQUENCE_LENGTH = 15;\r\n\r\nDPLCS.TABLE_INDEX_COLOR = '#0000FF';\r\nDPLCS.CODE_RECURSIVE_1_COLOR = '#339933';\r\nDPLCS.CODE_RECURSIVE_2_COLOR = '#0099FF';\r\n\r\nDPLCS.SEQUENCE_START_X = 30;\r\nDPLCS.SEQUENCE_START_Y = 180;\r\nDPLCS.SEQUENCE_DELTA_X = 10;\r\n\r\nDPLCS.MAX_VALUE = 20;\r\n\r\nDPLCS.MESSAGE_ID = 0;\r\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\r\n//\r\n// Redistribution and use in source and binary forms, with or without modification, are\r\n// permitted provided that the following conditions are met:\r\n//\r\n// 1. Redistributions of source code must retain the above copyright notice, this list of\r\n// conditions and the following disclaimer.\r\n//\r\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\r\n// of conditions and the following disclaimer in the documentation and/or other materials\r\n// provided with the distribution.\r\n//\r\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\r\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\r\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\r\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\r\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\r\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\r\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\r\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\r\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\r\n//\r\n// The views and conclusions contained in the software and documentation are those of the\r\n// authors and should not be interpreted as representing official policies, either expressed\r\n// or implied, of the University of San Francisco\r\n\r\nimport Algorithm, { addControlToAlgorithmBar } from './Algorithm';\r\n\r\nconst ARRAY_START_X = 100;\r\nconst ARRAY_START_Y = 200;\r\nconst ARRAY_ELEM_WIDTH = 50;\r\nconst ARRAY_ELEM_HEIGHT = 50;\r\n\r\nconst ARRRAY_ELEMS_PER_LINE = 15;\r\nconst ARRAY_LINE_SPACING = 130;\r\n\r\nconst FRONT_POS_X = 180;\r\nconst FRONT_POS_Y = 100;\r\nconst FRONT_LABEL_X = 130;\r\nconst FRONT_LABEL_Y = 100;\r\n\r\nconst SIZE_POS_X = 280;\r\nconst SIZE_POS_Y = 100;\r\nconst SIZE_LABEL_X = 230;\r\nconst SIZE_LABEL_Y = 100;\r\n\r\nconst QUEUE_LABEL_X = 50;\r\nconst QUEUE_LABEL_Y = 30;\r\nconst QUEUE_ELEMENT_X = 120;\r\nconst QUEUE_ELEMENT_Y = 30;\r\n\r\nconst INDEX_COLOR = '#0000FF';\r\n\r\nconst SIZE = 15;\r\n\r\nexport default class DequeArray extends Algorithm {\r\n\tconstructor(am, w, h) {\r\n\t\tsuper(am, w, h);\r\n\t\tthis.addControls();\r\n\t\tthis.nextIndex = 0;\r\n\t\tthis.commands = [];\r\n\t\tthis.setup();\r\n\t\tthis.initialIndex = this.nextIndex;\r\n\t}\r\n\r\n\taddControls() {\r\n\t\tthis.controls = [];\r\n\t\tthis.addField = addControlToAlgorithmBar('Text', '');\r\n\t\t// this.addField.onkeydown = this.returnSubmit(this.addField,  this.addLastCallback.bind(this), 6);\r\n\t\tthis.addFirstButton = addControlToAlgorithmBar('Button', 'Add First');\r\n\t\tthis.addLastButton = addControlToAlgorithmBar('Button', 'Add Last');\r\n\t\tthis.addFirstButton.onclick = this.addFirstCallBack.bind(this);\r\n\t\tthis.addLastButton.onclick = this.addLastCallback.bind(this);\r\n\t\tthis.controls.push(this.addField);\r\n\t\tthis.controls.push(this.addFirstButton);\r\n\t\tthis.controls.push(this.addLastButton);\r\n\r\n\t\tthis.removeFirstButton = addControlToAlgorithmBar('Button', 'Remove First');\r\n\t\tthis.removeFirstButton.onclick = this.removeFirstCallback.bind(this);\r\n\t\tthis.controls.push(this.removeFirstButton);\r\n\r\n\t\tthis.removeLastButton = addControlToAlgorithmBar('Button', 'Remove Last');\r\n\t\tthis.removeLastButton.onclick = this.removeLastCallback.bind(this);\r\n\t\tthis.controls.push(this.removeLastButton);\r\n\r\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear');\r\n\t\tthis.clearButton.onclick = this.clearCallback.bind(this);\r\n\t\tthis.controls.push(this.clearButton);\r\n\t}\r\n\r\n\tenableUI() {\r\n\t\tfor (let i = 0; i < this.controls.length; i++) {\r\n\t\t\tthis.controls[i].disabled = false;\r\n\t\t}\r\n\t}\r\n\r\n\tdisableUI() {\r\n\t\tfor (let i = 0; i < this.controls.length; i++) {\r\n\t\t\tthis.controls[i].disabled = true;\r\n\t\t}\r\n\t}\r\n\r\n\tsetup() {\r\n\t\tthis.nextIndex = 0;\r\n\r\n\t\tthis.arrayID = new Array(SIZE);\r\n\t\tthis.arrayLabelID = new Array(SIZE);\r\n\t\tfor (let i = 0; i < SIZE; i++) {\r\n\t\t\tthis.arrayID[i] = this.nextIndex++;\r\n\t\t\tthis.arrayLabelID[i] = this.nextIndex++;\r\n\t\t}\r\n\t\tthis.frontID = this.nextIndex++;\r\n\t\tconst frontLabelID = this.nextIndex++;\r\n\t\tthis.sizeID = this.nextIndex++;\r\n\t\tconst sizeLabelID = this.nextIndex++;\r\n\r\n\t\tthis.arrayData = new Array(SIZE);\r\n\t\tthis.front = 0;\r\n\t\tthis.size = 0;\r\n\t\tthis.leftoverLabelID = this.nextIndex++;\r\n\r\n\t\tfor (let i = 0; i < SIZE; i++) {\r\n\t\t\tconst xpos = (i % ARRRAY_ELEMS_PER_LINE) * ARRAY_ELEM_WIDTH + ARRAY_START_X;\r\n\t\t\tconst ypos = Math.floor(i / ARRRAY_ELEMS_PER_LINE) * ARRAY_LINE_SPACING + ARRAY_START_Y;\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'CreateRectangle',\r\n\t\t\t\tthis.arrayID[i],\r\n\t\t\t\t'',\r\n\t\t\t\tARRAY_ELEM_WIDTH,\r\n\t\t\t\tARRAY_ELEM_HEIGHT,\r\n\t\t\t\txpos,\r\n\t\t\t\typos\r\n\t\t\t);\r\n\t\t\tthis.cmd('CreateLabel', this.arrayLabelID[i], i, xpos, ypos + ARRAY_ELEM_HEIGHT);\r\n\t\t\tthis.cmd('SetForegroundColor', this.arrayLabelID[i], INDEX_COLOR);\r\n\t\t}\r\n\t\tthis.cmd('CreateLabel', frontLabelID, 'Front', FRONT_LABEL_X, FRONT_LABEL_Y);\r\n\t\tthis.cmd(\r\n\t\t\t'CreateRectangle',\r\n\t\t\tthis.frontID,\r\n\t\t\t0,\r\n\t\t\tARRAY_ELEM_WIDTH,\r\n\t\t\tARRAY_ELEM_HEIGHT,\r\n\t\t\tFRONT_POS_X,\r\n\t\t\tFRONT_POS_Y\r\n\t\t);\r\n\r\n\t\tthis.cmd('CreateLabel', sizeLabelID, 'Size', SIZE_LABEL_X, SIZE_LABEL_Y);\r\n\t\tthis.cmd(\r\n\t\t\t'CreateRectangle',\r\n\t\t\tthis.sizeID,\r\n\t\t\t0,\r\n\t\t\tARRAY_ELEM_WIDTH,\r\n\t\t\tARRAY_ELEM_HEIGHT,\r\n\t\t\tSIZE_POS_X,\r\n\t\t\tSIZE_POS_Y\r\n\t\t);\r\n\r\n\t\tthis.cmd('CreateLabel', this.leftoverLabelID, '', QUEUE_LABEL_X, QUEUE_LABEL_Y, false);\r\n\r\n\t\tthis.initialIndex = this.nextIndex;\r\n\r\n\t\tthis.highlight1ID = this.nextIndex++;\r\n\t\tthis.highlight2ID = this.nextIndex++;\r\n\r\n\t\tthis.animationManager.StartNewAnimation(this.commands);\r\n\t\tthis.animationManager.skipForward();\r\n\t\tthis.animationManager.clearHistory();\r\n\t}\r\n\r\n\treset() {\r\n\t\tthis.top = 0;\r\n\t\tthis.front = 0;\r\n\t\tthis.size = 0;\r\n\t\tthis.arrayData = [];\r\n\t\tthis.nextIndex = this.initialIndex;\r\n\t}\r\n\r\n\taddLastCallback() {\r\n\t\tif ((this.size + 1) % SIZE !== this.front && this.addField.value !== '') {\r\n\t\t\tconst pushVal = this.addField.value;\r\n\t\t\tthis.addField.value = '';\r\n\t\t\tthis.implementAction(this.addLast.bind(this), pushVal);\r\n\t\t}\r\n\t}\r\n\r\n\tremoveFirstCallback() {\r\n\t\tif (this.size !== 0) {\r\n\t\t\tthis.implementAction(this.removeFirst.bind(this), '');\r\n\t\t}\r\n\t}\r\n\r\n\tremoveLastCallback() {\r\n\t\tif (this.size !== 0) {\r\n\t\t\tthis.implementAction(this.removeLast.bind(this), '');\r\n\t\t}\r\n\t}\r\n\r\n\taddFirstCallBack() {\r\n\t\tif ((this.front - 1 + SIZE) % SIZE !== this.size && this.addField.value !== '') {\r\n\t\t\tconst pushVal = this.addField.value;\r\n\t\t\tthis.addField.value = '';\r\n\t\t\tthis.implementAction(this.addFirst.bind(this), pushVal);\r\n\t\t}\r\n\t}\r\n\r\n\tclearCallback() {\r\n\t\tthis.implementAction(this.clearAll.bind(this), '');\r\n\t}\r\n\r\n\taddLast(elemToaddLast) {\r\n\t\tthis.commands = [];\r\n\r\n\t\tconst labaddLastID = this.nextIndex++;\r\n\t\tconst labaddLastValID = this.nextIndex++;\r\n\t\tconst addIndex = (this.front + this.size) % SIZE;\r\n\r\n\t\tthis.arrayData[addIndex] = elemToaddLast;\r\n\t\tthis.cmd('SetText', this.leftoverLabelID, '');\r\n\r\n\t\tthis.cmd('CreateLabel', labaddLastID, 'Enqueuing Value: ', QUEUE_LABEL_X, QUEUE_LABEL_Y);\r\n\t\tthis.cmd('CreateLabel', labaddLastValID, elemToaddLast, QUEUE_ELEMENT_X, QUEUE_ELEMENT_Y);\r\n\r\n\t\tthis.cmd('Step');\r\n\t\tthis.cmd('CreateHighlightCircle', this.highlight1ID, INDEX_COLOR, SIZE_POS_X, SIZE_POS_Y);\r\n\t\tthis.cmd('Step');\r\n\r\n\t\tconst xpos = (addIndex % ARRRAY_ELEMS_PER_LINE) * ARRAY_ELEM_WIDTH + ARRAY_START_X;\r\n\t\tconst ypos =\r\n\t\t\tMath.floor(addIndex / ARRRAY_ELEMS_PER_LINE) * ARRAY_LINE_SPACING + ARRAY_START_Y;\r\n\r\n\t\tthis.cmd('Move', this.highlight1ID, xpos, ypos + ARRAY_ELEM_HEIGHT);\r\n\t\tthis.cmd('Step');\r\n\r\n\t\tthis.cmd('Move', labaddLastValID, xpos, ypos);\r\n\t\tthis.cmd('Step');\r\n\r\n\t\tthis.cmd('SetText', this.arrayID[addIndex], elemToaddLast);\r\n\t\tthis.cmd('Delete', labaddLastValID);\r\n\r\n\t\tthis.cmd('Delete', this.highlight1ID);\r\n\r\n\t\tthis.cmd('SetHighlight', this.sizeID, 1);\r\n\t\tthis.cmd('Step');\r\n\t\tthis.size = this.size + 1;\r\n\t\tthis.cmd('SetText', this.sizeID, this.size);\r\n\t\tthis.cmd('Step');\r\n\t\tthis.cmd('SetHighlight', this.sizeID, 0);\r\n\t\tthis.cmd('Delete', labaddLastID);\r\n\r\n\t\treturn this.commands;\r\n\t}\r\n\r\n\taddFirst(elemToAdd) {\r\n\t\tthis.commands = [];\r\n\r\n\t\tconst labelAddID = this.nextIndex++;\r\n\r\n\t\tconst addIndex = (this.front - 1 + SIZE) % SIZE;\r\n\r\n\t\tconst xpos = (addIndex % ARRRAY_ELEMS_PER_LINE) * ARRAY_ELEM_WIDTH + ARRAY_START_X;\r\n\t\tconst ypos =\r\n\t\t\tMath.floor(addIndex / ARRRAY_ELEMS_PER_LINE) * ARRAY_LINE_SPACING + ARRAY_START_Y;\r\n\r\n\t\tthis.arrayData[addIndex] = elemToAdd;\r\n\r\n\t\tthis.cmd('CreateLabel', labelAddID, elemToAdd, QUEUE_ELEMENT_X, QUEUE_ELEMENT_Y);\r\n\r\n\t\tthis.cmd('SetText', this.leftoverLabelID, '');\r\n\t\tthis.cmd('SetPosition', this.leftoverLabelID, QUEUE_LABEL_X + 100, QUEUE_LABEL_Y);\r\n\r\n\t\tthis.cmd('Step');\r\n\t\tthis.cmd('CreateHighlightCircle', this.highlight1ID, INDEX_COLOR, FRONT_POS_X, FRONT_POS_Y);\r\n\t\tthis.cmd('Step');\r\n\t\tthis.cmd(\r\n\t\t\t'SetText',\r\n\t\t\tthis.leftoverLabelID,\r\n\t\t\t`Adding ${elemToAdd} at index (${this.front} - 1) % ${SIZE}`\r\n\t\t);\r\n\r\n\t\tthis.cmd('Step');\r\n\t\tthis.cmd(\r\n\t\t\t'Move',\r\n\t\t\tthis.highlight1ID,\r\n\t\t\tthis.front * ARRAY_ELEM_WIDTH + ARRAY_START_X,\r\n\t\t\typos + ARRAY_ELEM_HEIGHT\r\n\t\t);\r\n\t\tthis.cmd('Step');\r\n\t\tthis.cmd('Move', this.highlight1ID, xpos, ypos + ARRAY_ELEM_HEIGHT);\r\n\t\tthis.cmd('Step');\r\n\t\tthis.cmd('Move', labelAddID, xpos, ypos);\r\n\t\tthis.cmd('Step');\r\n\r\n\t\tthis.cmd('SetText', this.arrayID[addIndex], elemToAdd);\r\n\t\tthis.cmd('Step');\r\n\t\tthis.cmd('SetHighlight', this.frontID, 1);\r\n\t\tthis.cmd('Step');\r\n\t\tthis.cmd('SetText', this.frontID, addIndex);\r\n\t\tthis.cmd('Step');\r\n\t\tthis.cmd('SetHighlight', this.frontID, 0);\r\n\r\n\t\tthis.cmd('Step');\r\n\t\tthis.cmd('SetHighlight', this.sizeID, 1);\r\n\t\tthis.cmd('Step');\r\n\t\tthis.cmd('SetText', this.sizeID, this.size + 1);\r\n\t\tthis.cmd('Step');\r\n\t\tthis.cmd('SetHighlight', this.sizeID, 0);\r\n\r\n\t\tthis.cmd('Step');\r\n\r\n\t\tthis.cmd('Delete', labelAddID);\r\n\t\tthis.cmd('Delete', this.highlight1ID);\r\n\t\tthis.cmd('SetText', this.leftoverLabelID, '');\r\n\t\tthis.front = addIndex;\r\n\t\tthis.size++;\r\n\t\treturn this.commands;\r\n\t}\r\n\r\n\tremoveFirst() {\r\n\t\tthis.commands = [];\r\n\r\n\t\tconst labremoveFirstID = this.nextIndex++;\r\n\t\tconst labremoveFirstValID = this.nextIndex++;\r\n\r\n\t\tthis.cmd('SetText', this.leftoverLabelID, '');\r\n\r\n\t\tthis.cmd(\r\n\t\t\t'CreateLabel',\r\n\t\t\tlabremoveFirstID,\r\n\t\t\t'removeFirstd Value: ',\r\n\t\t\tQUEUE_LABEL_X,\r\n\t\t\tQUEUE_LABEL_Y\r\n\t\t);\r\n\r\n\t\tthis.cmd('CreateHighlightCircle', this.highlight1ID, INDEX_COLOR, FRONT_POS_X, FRONT_POS_Y);\r\n\t\tthis.cmd('Step');\r\n\r\n\t\tconst xpos = (this.front % ARRRAY_ELEMS_PER_LINE) * ARRAY_ELEM_WIDTH + ARRAY_START_X;\r\n\t\tconst ypos =\r\n\t\t\tMath.floor(this.front / ARRRAY_ELEMS_PER_LINE) * ARRAY_LINE_SPACING + ARRAY_START_Y;\r\n\r\n\t\tthis.cmd('Move', this.highlight1ID, xpos, ypos + ARRAY_ELEM_HEIGHT);\r\n\t\tthis.cmd('Step');\r\n\r\n\t\tthis.cmd('Delete', this.highlight1ID);\r\n\r\n\t\tconst removeFirstdVal = this.arrayData[this.front];\r\n\t\tthis.cmd('CreateLabel', labremoveFirstValID, removeFirstdVal, xpos, ypos);\r\n\t\tthis.cmd('Settext', this.arrayID[this.front], '');\r\n\t\tthis.cmd('Move', labremoveFirstValID, QUEUE_ELEMENT_X, QUEUE_ELEMENT_Y);\r\n\t\tthis.cmd('Step');\r\n\r\n\t\tthis.cmd('SetHighlight', this.frontID, 1);\r\n\t\tthis.cmd('Step');\r\n\t\tthis.front = (this.front + 1) % SIZE;\r\n\t\tthis.cmd('SetText', this.frontID, this.front);\r\n\t\tthis.cmd('Step');\r\n\t\tthis.cmd('SetHighlight', this.frontID, 0);\r\n\r\n\t\tthis.cmd('SetText', this.leftoverLabelID, 'removeFirstd Value: ' + removeFirstdVal);\r\n\r\n\t\tthis.cmd('Delete', labremoveFirstID);\r\n\t\tthis.cmd('Delete', labremoveFirstValID);\r\n\t\tthis.cmd('Step');\r\n\r\n\t\tthis.cmd('SetHighlight', this.sizeID, 1);\r\n\t\tthis.cmd('Step');\r\n\t\tthis.size--;\r\n\t\tthis.cmd('SetText', this.sizeID, this.size);\r\n\r\n\t\tthis.cmd('Step');\r\n\t\tthis.cmd('SetHighlight', this.sizeID, 0);\r\n\t\tthis.cmd('Step');\r\n\t\tthis.cmd('SetText', this.leftoverLabelID, '');\r\n\r\n\t\tthis.adjustIfEmpty();\r\n\r\n\t\treturn this.commands;\r\n\t}\r\n\r\n\tremoveLast() {\r\n\t\tthis.commands = [];\r\n\t\tconst remLabelID = this.nextIndex++;\r\n\t\tconst remLabelValID = this.nextIndex++;\r\n\r\n\t\tconst remIndex = (this.front + this.size - 1 + SIZE) % SIZE;\r\n\r\n\t\tthis.cmd('SetText', this.leftoverLabelID, '');\r\n\r\n\t\tthis.cmd('CreateLabel', remLabelID, 'Removed Value: ', QUEUE_LABEL_X, QUEUE_LABEL_Y);\r\n\r\n\t\tthis.cmd('CreateHighlightCircle', this.highlight1ID, INDEX_COLOR, FRONT_POS_X, FRONT_POS_Y);\r\n\t\tthis.cmd('CreateHighlightCircle', this.highlight2ID, INDEX_COLOR, SIZE_POS_X, SIZE_POS_Y);\r\n\r\n\t\tthis.cmd('Step');\r\n\r\n\t\tconst xpos = (remIndex % ARRRAY_ELEMS_PER_LINE) * ARRAY_ELEM_WIDTH + ARRAY_START_X;\r\n\t\tconst ypos =\r\n\t\t\tMath.floor(remIndex / ARRRAY_ELEMS_PER_LINE) * ARRAY_LINE_SPACING + ARRAY_START_Y;\r\n\r\n\t\tthis.cmd('Move', this.highlight1ID, xpos, ypos + ARRAY_ELEM_HEIGHT);\r\n\t\tthis.cmd('Move', this.highlight2ID, xpos, ypos + ARRAY_ELEM_HEIGHT);\r\n\r\n\t\tthis.cmd('Step');\r\n\r\n\t\tthis.cmd('Delete', this.highlight1ID);\r\n\t\tthis.cmd('Delete', this.highlight2ID);\r\n\r\n\t\tconst removedVal = this.arrayData[remIndex];\r\n\t\tthis.cmd('CreateLabel', remLabelValID, removedVal, xpos, ypos);\r\n\t\tthis.cmd('Settext', this.arrayID[remIndex], '');\r\n\t\tthis.cmd('Move', remLabelValID, QUEUE_ELEMENT_X, QUEUE_ELEMENT_Y);\r\n\t\tthis.cmd('Step');\r\n\r\n\t\tthis.cmd('SetText', this.leftoverLabelID, 'Removed Value: ' + removedVal);\r\n\r\n\t\tthis.cmd('Delete', remLabelID);\r\n\t\tthis.cmd('Delete', remLabelValID);\r\n\t\tthis.cmd('Step');\r\n\r\n\t\tthis.cmd('SetHighlight', this.sizeID, 1);\r\n\t\tthis.cmd('Step');\r\n\t\tthis.cmd('SetText', this.sizeID, this.size - 1);\r\n\t\tthis.cmd('Step');\r\n\t\tthis.cmd('SetHighlight', this.sizeID, 0);\r\n\t\tthis.cmd('Step');\r\n\r\n\t\tthis.cmd('SetText', this.leftoverLabelID, '');\r\n\r\n\t\tthis.size--;\r\n\r\n\t\tthis.adjustIfEmpty();\r\n\r\n\t\treturn this.commands;\r\n\t}\r\n\r\n\tadjustIfEmpty() {\r\n\t\tif (this.size === 0) {\r\n\t\t\tthis.cmd('SetText', this.leftoverLabelID, 'size = 0, set front to 0');\r\n\t\t\tthis.front = 0;\r\n\r\n\t\t\tthis.cmd('Step');\r\n\t\t\tthis.cmd('SetHighlight', this.frontID, 1);\r\n\t\t\tthis.cmd('Step');\r\n\t\t\tthis.cmd('SetText', this.frontID, 0);\r\n\t\t\tthis.cmd('Step');\r\n\t\t\tthis.cmd('SetHighlight', this.frontID, 0);\r\n\t\t\tthis.cmd('SetText', this.leftoverLabelID, '');\r\n\t\t}\r\n\t}\r\n\r\n\tclearAll() {\r\n\t\tthis.commands = [];\r\n\t\tthis.cmd('SetText', this.leftoverLabelID, '');\r\n\r\n\t\tfor (let i = 0; i < SIZE; i++) {\r\n\t\t\tthis.cmd('SetText', this.arrayID[i], '');\r\n\t\t}\r\n\t\tthis.front = 0;\r\n\t\tthis.size = 0;\r\n\t\tthis.cmd('SetText', this.frontID, '0');\r\n\t\tthis.cmd('SetText', this.sizeID, '0');\r\n\t\treturn this.commands;\r\n\t}\r\n}\r\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\r\n//\r\n// Redistribution and use in source and binary forms, with or without modification, are\r\n// permitted provided that the following conditions are met:\r\n//\r\n// 1. Redistributions of source code must retain the above copyright notice, this list of\r\n// conditions and the following disclaimer.\r\n//\r\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\r\n// of conditions and the following disclaimer in the documentation and/or other materials\r\n// provided with the distribution.\r\n//\r\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\r\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\r\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\r\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\r\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\r\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\r\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\r\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\r\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\r\n//\r\n// The views and conclusions contained in the software and documentation are those of the\r\n// authors and should not be interpreted as representing official policies, either expressed\r\n// or implied, of the University of San Francisco\r\n\r\nimport Algorithm, { addControlToAlgorithmBar, addLabelToAlgorithmBar } from './Algorithm.js';\r\n\r\nconst LINKED_LIST_START_X = 100;\r\nconst LINKED_LIST_START_Y = 200;\r\nconst LINKED_LIST_ELEM_WIDTH = 100;\r\nconst LINKED_LIST_ELEM_HEIGHT = 30;\r\n\r\nconst LINKED_LIST_INSERT_X = 200;\r\nconst LINKED_LIST_INSERT_Y = 50;\r\n\r\nconst LINKED_LIST_ELEMS_PER_LINE = 8;\r\nconst LINKED_LIST_ELEM_SPACING = 150;\r\nconst LINKED_LIST_LINE_SPACING = 100;\r\n\r\n// let TOP_POS_X = 180;\r\n// let TOP_POS_Y = 100;\r\n// let TOP_LABEL_X = 130;\r\n// let TOP_LABEL_Y = 100;\r\n\r\n// let TOP_ELEM_WIDTH = 30;\r\n// let TOP_ELEM_HEIGHT = 30;\r\n\r\nconst PUSH_LABEL_X = 50;\r\nconst PUSH_LABEL_Y = 30;\r\nconst PUSH_ELEMENT_X = 120;\r\nconst PUSH_ELEMENT_Y = 30;\r\n\r\nconst SIZE = 32;\r\n\r\nexport default class DequeLL extends Algorithm {\r\n\tconstructor(am, w, h) {\r\n\t\tsuper(am, w, h);\r\n\r\n\t\tthis.addControls();\r\n\r\n\t\t// Useful for memory management\r\n\t\tthis.nextIndex = 0;\r\n\r\n\t\tthis.setup();\r\n\r\n\t\tthis.initialIndex = this.nextIndex;\r\n\t}\r\n\r\n\taddControls() {\r\n\t\tthis.controls = [];\r\n\r\n\t\taddLabelToAlgorithmBar('Value');\r\n\r\n\t\t// Add's value text field\r\n\t\tthis.addValueField = addControlToAlgorithmBar('Text', '');\r\n\t\tthis.addValueField.onkeydown = this.returnSubmit(\r\n\t\t\tthis.addValueField,\r\n\t\t\tthis.addIndexCallback.bind(this),\r\n\t\t\t4,\r\n\t\t\ttrue\r\n\t\t);\r\n\t\tthis.controls.push(this.addValueField);\r\n\r\n\t\t// Add to front button\r\n\t\tthis.addFrontButton = addControlToAlgorithmBar('Button', 'Add to Front');\r\n\t\tthis.addFrontButton.onclick = this.addFrontCallback.bind(this);\r\n\t\tthis.controls.push(this.addFrontButton);\r\n\r\n\t\t// Add to back button\r\n\t\tthis.addBackButton = addControlToAlgorithmBar('Button', 'Add to Back');\r\n\t\tthis.addBackButton.onclick = this.addBackCallback.bind(this);\r\n\t\tthis.controls.push(this.addBackButton);\r\n\r\n\t\taddLabelToAlgorithmBar('or');\r\n\r\n\t\t// Remove from front button\r\n\t\tthis.removeFrontButton = addControlToAlgorithmBar('Button', 'Remove from Front');\r\n\t\tthis.removeFrontButton.onclick = this.removeFrontCallback.bind(this);\r\n\t\tthis.controls.push(this.removeFrontButton);\r\n\r\n\t\t// Remove from back button\r\n\t\tthis.removeBackButton = addControlToAlgorithmBar('Button', 'Remove from Back');\r\n\t\tthis.removeBackButton.onclick = this.removeBackCallback.bind(this);\r\n\t\tthis.controls.push(this.removeBackButton);\r\n\r\n\t\t// Get's index text field\r\n\t\t// this.getField = addControlToAlgorithmBar(\"Text\", \"\");\r\n\t\t// this.getField.onkeydown = this.returnSubmit(this.getField, this.getCallback.bind(this), 4, true);\r\n\t\t// this.controls.push(this.getField);\r\n\r\n\t\t// Get button\r\n\t\t// this.getButton = addControlToAlgorithmBar(\"Button\", \"Get\");\r\n\t\t// this.getButton.onclick = this.getCallback.bind(this);\r\n\t\t// this.controls.push(this.getButton);\r\n\r\n\t\t// Clear button\r\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear');\r\n\t\tthis.clearButton.onclick = this.clearCallback.bind(this);\r\n\t\tthis.controls.push(this.clearButton);\r\n\t}\r\n\r\n\tenableUI() {\r\n\t\tfor (let i = 0; i < this.controls.length; i++) {\r\n\t\t\tthis.controls[i].disabled = false;\r\n\t\t}\r\n\t}\r\n\r\n\tdisableUI() {\r\n\t\tfor (let i = 0; i < this.controls.length; i++) {\r\n\t\t\tthis.controls[i].disabled = true;\r\n\t\t}\r\n\t}\r\n\r\n\tsetup() {\r\n\t\tthis.linkedListElemID = new Array(SIZE);\r\n\r\n\t\tthis.arrayData = new Array(SIZE);\r\n\t\tthis.size = 0;\r\n\t\tthis.leftoverLabelID = this.nextIndex++;\r\n\r\n\t\tthis.cmd('CreateLabel', this.leftoverLabelID, '', PUSH_LABEL_X, PUSH_LABEL_Y);\r\n\r\n\t\tthis.animationManager.StartNewAnimation(this.commands);\r\n\t\tthis.animationManager.skipForward();\r\n\t\tthis.animationManager.clearHistory();\r\n\t}\r\n\r\n\treset() {\r\n\t\tthis.size = 0;\r\n\t\tthis.nextIndex = this.initialIndex;\r\n\t}\r\n\r\n\taddIndexCallback() {\r\n\t\tif (this.addValueField.value !== '' && this.addIndexField.value !== '') {\r\n\t\t\tconst addVal = this.addValueField.value;\r\n\t\t\tconst index = this.addIndexField.value;\r\n\t\t\tif (index >= 0 && index <= this.size) {\r\n\t\t\t\tthis.addValueField.value = '';\r\n\t\t\t\tthis.addIndexField.value = '';\r\n\t\t\t\tthis.implementAction(this.add.bind(this), addVal + ',' + index);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\taddFrontCallback() {\r\n\t\tif (this.addValueField.value !== '') {\r\n\t\t\tconst addVal = this.addValueField.value;\r\n\t\t\tthis.addValueField.value = '';\r\n\t\t\tthis.implementAction(this.add.bind(this), addVal + ',' + 0);\r\n\t\t}\r\n\t}\r\n\r\n\taddBackCallback() {\r\n\t\tif (this.addValueField.value !== '') {\r\n\t\t\tconst addVal = this.addValueField.value;\r\n\t\t\tthis.addValueField.value = '';\r\n\t\t\tthis.implementAction(this.add.bind(this), addVal + ',' + this.size);\r\n\t\t}\r\n\t}\r\n\r\n\tremoveIndexCallback() {\r\n\t\tif (this.removeField.value !== '') {\r\n\t\t\tconst index = this.removeField.value;\r\n\t\t\tif (index >= 0 && index < this.size) {\r\n\t\t\t\tthis.removeField.value = '';\r\n\t\t\t\tthis.implementAction(this.remove.bind(this), index);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tremoveFrontCallback() {\r\n\t\tif (this.size > 0) {\r\n\t\t\tthis.implementAction(this.remove.bind(this), 0);\r\n\t\t}\r\n\t}\r\n\r\n\tremoveBackCallback() {\r\n\t\tif (this.size > 0) {\r\n\t\t\tthis.implementAction(this.remove.bind(this), this.size - 1);\r\n\t\t}\r\n\t}\r\n\r\n\t// getCallback(event)\r\n\t// {\r\n\t//     if (this.getField.value != \"\" && this.getField.value > 0 && this.getField.value < this.size)\r\n\t//     {\r\n\t//         this.implementAction(this.get.bind(this), \"\");\r\n\t//     }\r\n\t// }\r\n\r\n\tclearCallback() {\r\n\t\tthis.implementAction(this.clearAll.bind(this), '');\r\n\t}\r\n\r\n\tadd(params) {\r\n\t\tthis.commands = [];\r\n\r\n\t\tconst elemToAdd = parseInt(params.split(',')[0]);\r\n\t\tconst index = parseInt(params.split(',')[1]);\r\n\t\tconst labPushID = this.nextIndex++;\r\n\t\tconst labPushValID = this.nextIndex++;\r\n\r\n\t\tfor (let i = this.size - 1; i >= index; i--) {\r\n\t\t\tthis.arrayData[i + 1] = this.arrayData[i];\r\n\t\t\tthis.linkedListElemID[i + 1] = this.linkedListElemID[i];\r\n\t\t}\r\n\t\tthis.arrayData[index] = elemToAdd;\r\n\t\tthis.linkedListElemID[index] = this.nextIndex++;\r\n\r\n\t\tthis.cmd('SetText', this.leftoverLabelID, '');\r\n\r\n\t\tthis.cmd(\r\n\t\t\t'CreateDoublyLinkedList',\r\n\t\t\tthis.linkedListElemID[index],\r\n\t\t\t'',\r\n\t\t\tLINKED_LIST_ELEM_WIDTH,\r\n\t\t\tLINKED_LIST_ELEM_HEIGHT,\r\n\t\t\tLINKED_LIST_INSERT_X,\r\n\t\t\tLINKED_LIST_INSERT_Y,\r\n\t\t\t0.25,\r\n\t\t\t1\r\n\t\t);\r\n\r\n\t\tthis.cmd('CreateLabel', labPushID, 'Adding Value: ', PUSH_LABEL_X, PUSH_LABEL_Y);\r\n\t\tthis.cmd('CreateLabel', labPushValID, elemToAdd, PUSH_ELEMENT_X, PUSH_ELEMENT_Y);\r\n\r\n\t\tthis.cmd('Step');\r\n\r\n\t\tthis.cmd('Move', labPushValID, LINKED_LIST_INSERT_X, LINKED_LIST_INSERT_Y);\r\n\r\n\t\tthis.cmd('Step');\r\n\t\tthis.cmd('SetText', this.linkedListElemID[index], elemToAdd);\r\n\t\tthis.cmd('Delete', labPushValID);\r\n\r\n\t\tif (index === 0) {\r\n\t\t\tthis.cmd('SetPrevNull', this.linkedListElemID[index], 1);\r\n\t\t}\r\n\r\n\t\tif (index === this.size) {\r\n\t\t\tthis.cmd('SetNextNull', this.linkedListElemID[index], 1);\r\n\t\t}\r\n\r\n\t\tif (this.size !== 0) {\r\n\t\t\tif (index === 0) {\r\n\t\t\t\tthis.cmd('SetPrevNull', this.linkedListElemID[index + 1], 0);\r\n\t\t\t\tthis.cmd(\r\n\t\t\t\t\t'ConnectNext',\r\n\t\t\t\t\tthis.linkedListElemID[index],\r\n\t\t\t\t\tthis.linkedListElemID[index + 1]\r\n\t\t\t\t);\r\n\t\t\t\tthis.cmd(\r\n\t\t\t\t\t'ConnectPrev',\r\n\t\t\t\t\tthis.linkedListElemID[index + 1],\r\n\t\t\t\t\tthis.linkedListElemID[index]\r\n\t\t\t\t);\r\n\t\t\t} else if (index === this.size) {\r\n\t\t\t\tthis.cmd('SetNextNull', this.linkedListElemID[index - 1], 0);\r\n\t\t\t\tthis.cmd(\r\n\t\t\t\t\t'ConnectNext',\r\n\t\t\t\t\tthis.linkedListElemID[index - 1],\r\n\t\t\t\t\tthis.linkedListElemID[index]\r\n\t\t\t\t);\r\n\t\t\t\tthis.cmd(\r\n\t\t\t\t\t'ConnectPrev',\r\n\t\t\t\t\tthis.linkedListElemID[index],\r\n\t\t\t\t\tthis.linkedListElemID[index - 1]\r\n\t\t\t\t);\r\n\t\t\t} else {\r\n\t\t\t\tthis.cmd(\r\n\t\t\t\t\t'Disconnect',\r\n\t\t\t\t\tthis.linkedListElemID[index - 1],\r\n\t\t\t\t\tthis.linkedListElemID[index + 1]\r\n\t\t\t\t);\r\n\t\t\t\tthis.cmd(\r\n\t\t\t\t\t'Disconnect',\r\n\t\t\t\t\tthis.linkedListElemID[index + 1],\r\n\t\t\t\t\tthis.linkedListElemID[index - 1]\r\n\t\t\t\t);\r\n\t\t\t\tthis.cmd(\r\n\t\t\t\t\t'ConnectNext',\r\n\t\t\t\t\tthis.linkedListElemID[index - 1],\r\n\t\t\t\t\tthis.linkedListElemID[index]\r\n\t\t\t\t);\r\n\t\t\t\tthis.cmd(\r\n\t\t\t\t\t'ConnectPrev',\r\n\t\t\t\t\tthis.linkedListElemID[index],\r\n\t\t\t\t\tthis.linkedListElemID[index - 1]\r\n\t\t\t\t);\r\n\t\t\t\tthis.cmd(\r\n\t\t\t\t\t'ConnectNext',\r\n\t\t\t\t\tthis.linkedListElemID[index],\r\n\t\t\t\t\tthis.linkedListElemID[index + 1]\r\n\t\t\t\t);\r\n\t\t\t\tthis.cmd(\r\n\t\t\t\t\t'ConnectPrev',\r\n\t\t\t\t\tthis.linkedListElemID[index + 1],\r\n\t\t\t\t\tthis.linkedListElemID[index]\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis.cmd('Step');\r\n\t\tthis.size = this.size + 1;\r\n\t\tthis.resetNodePositions();\r\n\t\tthis.cmd('Delete', labPushID);\r\n\t\tthis.cmd('Step');\r\n\r\n\t\treturn this.commands;\r\n\t}\r\n\r\n\tremove(index) {\r\n\t\tthis.commands = [];\r\n\r\n\t\tindex = parseInt(index);\r\n\t\tconst labPopID = this.nextIndex++;\r\n\t\tconst labPopValID = this.nextIndex++;\r\n\r\n\t\tthis.cmd('SetText', this.leftoverLabelID, '');\r\n\r\n\t\tconst nodePosX = LINKED_LIST_START_X + LINKED_LIST_ELEM_SPACING * index;\r\n\t\tconst nodePosY = LINKED_LIST_START_Y;\r\n\t\tthis.cmd('CreateLabel', labPopID, 'Removing Value: ', PUSH_LABEL_X, PUSH_LABEL_Y);\r\n\t\tthis.cmd('CreateLabel', labPopValID, this.arrayData[index], nodePosX, nodePosY);\r\n\t\tthis.cmd('Move', labPopValID, PUSH_ELEMENT_X, PUSH_ELEMENT_Y);\r\n\t\tthis.cmd('Step');\r\n\r\n\t\tif (this.size !== 1) {\r\n\t\t\tif (index === 0) {\r\n\t\t\t\tthis.cmd(\r\n\t\t\t\t\t'Disconnect',\r\n\t\t\t\t\tthis.linkedListElemID[index + 1],\r\n\t\t\t\t\tthis.linkedListElemID[index]\r\n\t\t\t\t);\r\n\t\t\t\tthis.cmd('SetPrevNull', this.linkedListElemID[index + 1], 1);\r\n\t\t\t} else if (index === this.size - 1) {\r\n\t\t\t\tthis.cmd(\r\n\t\t\t\t\t'Disconnect',\r\n\t\t\t\t\tthis.linkedListElemID[index - 1],\r\n\t\t\t\t\tthis.linkedListElemID[index]\r\n\t\t\t\t);\r\n\t\t\t\tthis.cmd('SetNextNull', this.linkedListElemID[index - 1], 1);\r\n\t\t\t} else {\r\n\t\t\t\tconst xPos =\r\n\t\t\t\t\t(index % LINKED_LIST_ELEMS_PER_LINE) * LINKED_LIST_ELEM_SPACING +\r\n\t\t\t\t\tLINKED_LIST_START_X;\r\n\t\t\t\tconst yPos = LINKED_LIST_START_Y - LINKED_LIST_ELEM_HEIGHT * 2;\r\n\t\t\t\tthis.cmd('Move', this.linkedListElemID[index], xPos, yPos);\r\n\t\t\t\tthis.cmd('Step');\r\n\t\t\t\tthis.cmd(\r\n\t\t\t\t\t'Disconnect',\r\n\t\t\t\t\tthis.linkedListElemID[index - 1],\r\n\t\t\t\t\tthis.linkedListElemID[index]\r\n\t\t\t\t);\r\n\t\t\t\tthis.cmd(\r\n\t\t\t\t\t'Disconnect',\r\n\t\t\t\t\tthis.linkedListElemID[index + 1],\r\n\t\t\t\t\tthis.linkedListElemID[index]\r\n\t\t\t\t);\r\n\t\t\t\tthis.cmd(\r\n\t\t\t\t\t'ConnectNext',\r\n\t\t\t\t\tthis.linkedListElemID[index - 1],\r\n\t\t\t\t\tthis.linkedListElemID[index + 1]\r\n\t\t\t\t);\r\n\t\t\t\tthis.cmd(\r\n\t\t\t\t\t'ConnectPrev',\r\n\t\t\t\t\tthis.linkedListElemID[index + 1],\r\n\t\t\t\t\tthis.linkedListElemID[index - 1]\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.cmd('Step');\r\n\t\tthis.cmd('Delete', this.linkedListElemID[index]);\r\n\r\n\t\tfor (let i = index; i < this.size; i++) {\r\n\t\t\tthis.arrayData[i] = this.arrayData[i + 1];\r\n\t\t\tthis.linkedListElemID[i] = this.linkedListElemID[i + 1];\r\n\t\t}\r\n\t\tthis.size = this.size - 1;\r\n\t\tthis.resetNodePositions();\r\n\r\n\t\tthis.cmd('Delete', labPopValID);\r\n\t\tthis.cmd('Delete', labPopID);\r\n\r\n\t\treturn this.commands;\r\n\t}\r\n\r\n\tresetNodePositions() {\r\n\t\tfor (let i = 0; i < this.size; i++) {\r\n\t\t\tconst nextX =\r\n\t\t\t\t(i % LINKED_LIST_ELEMS_PER_LINE) * LINKED_LIST_ELEM_SPACING + LINKED_LIST_START_X;\r\n\t\t\tconst nextY =\r\n\t\t\t\tMath.floor(i / LINKED_LIST_ELEMS_PER_LINE) * LINKED_LIST_LINE_SPACING +\r\n\t\t\t\tLINKED_LIST_START_Y;\r\n\t\t\tthis.cmd('Move', this.linkedListElemID[i], nextX, nextY);\r\n\t\t}\r\n\t}\r\n\r\n\tclearAll() {\r\n\t\tthis.commands = [];\r\n\t\tfor (let i = 0; i < this.size; i++) {\r\n\t\t\tthis.cmd('Delete', this.linkedListElemID[i]);\r\n\t\t}\r\n\t\tthis.size = 0;\r\n\t\treturn this.commands;\r\n\t}\r\n}\r\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\r\n//\r\n// Redistribution and use in source and binary forms, with or without modification, are\r\n// permitted provided that the following conditions are met:\r\n//\r\n// 1. Redistributions of source code must retain the above copyright notice, this list of\r\n// conditions and the following disclaimer.\r\n//\r\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\r\n// of conditions and the following disclaimer in the documentation and/or other materials\r\n// provided with the distribution.\r\n//\r\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\r\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\r\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\r\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\r\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\r\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\r\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\r\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\r\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\r\n//\r\n// The views and conclusions contained in the software and documentation are those of the\r\n// authors and should not be interpreted as representing official policies, either expressed\r\n// or implied, of the University of San Francisco\r\n\r\nimport Graph, { VERTEX_INDEX_COLOR } from './Graph.js';\r\nimport { addControlToAlgorithmBar, addLabelToAlgorithmBar } from './Algorithm.js';\r\n\r\nconst TABLE_ENTRY_WIDTH = 50;\r\nconst TABLE_ENTRY_HEIGHT = 25;\r\nconst TABLE_START_X = 50;\r\nconst TABLE_START_Y = 80;\r\n\r\nconst MESSAGE_LABEL_1_X = 20;\r\nconst MESSAGE_LABEL_1_Y = 10;\r\n\r\n// const HIGHLIGHT_CIRCLE_COLOR = \"#000000\";\r\n\r\nexport default class DijkstraPrim extends Graph {\r\n\tconstructor(am, runningDijkstra, w, h) {\r\n\t\tsuper(am, w, h, false, false);\r\n\t\tthis.runningDijkstra = runningDijkstra;\r\n\t\tthis.showEdgeCosts = true;\r\n\t}\r\n\r\n\taddControls() {\r\n\t\taddLabelToAlgorithmBar('Start Vertex: ');\r\n\t\tthis.startField = addControlToAlgorithmBar('Text', '');\r\n\t\tthis.startField.onkeydown = this.returnSubmit(\r\n\t\t\tthis.startField,\r\n\t\t\tthis.startCallback.bind(this),\r\n\t\t\t1,\r\n\t\t\tfalse\r\n\t\t);\r\n\t\tthis.startField.size = 2;\r\n\t\tif (this.runningDijkstra) {\r\n\t\t\tthis.startButton = addControlToAlgorithmBar('Button', 'Run Dijkstra');\r\n\t\t} else {\r\n\t\t\tthis.startButton = addControlToAlgorithmBar('Button', 'Run Prim');\r\n\t\t}\r\n\t\tthis.startButton.onclick = this.startCallback.bind(this);\r\n\t\tsuper.addControls(this.runningDijkstra);\r\n\t}\r\n\r\n\tsetup() {\r\n\t\tthis.message1ID = this.nextIndex++;\r\n\t\tsuper.setup();\r\n\r\n\t\tthis.commands = [];\r\n\t\tthis.cmd('CreateLabel', this.message1ID, '', MESSAGE_LABEL_1_X, MESSAGE_LABEL_1_Y, 0);\r\n\r\n\t\tthis.vertexID = new Array(this.size);\r\n\t\tthis.knownID = new Array(this.size);\r\n\t\tthis.distanceID = new Array(this.size);\r\n\t\tthis.pathID = new Array(this.size);\r\n\t\tthis.known = new Array(this.size);\r\n\t\tthis.distance = new Array(this.size);\r\n\t\tthis.path = new Array(this.size);\r\n\r\n\t\tthis.messageID = null;\r\n\r\n\t\tfor (let i = 0; i < this.size; i++) {\r\n\t\t\tthis.vertexID[i] = this.nextIndex++;\r\n\t\t\tthis.knownID[i] = this.nextIndex++;\r\n\t\t\tthis.distanceID[i] = this.nextIndex++;\r\n\t\t\tthis.pathID[i] = this.nextIndex++;\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'CreateRectangle',\r\n\t\t\t\tthis.vertexID[i],\r\n\t\t\t\tString.fromCharCode(65 + i),\r\n\t\t\t\tTABLE_ENTRY_WIDTH,\r\n\t\t\t\tTABLE_ENTRY_HEIGHT,\r\n\t\t\t\tTABLE_START_X,\r\n\t\t\t\tTABLE_START_Y + i * TABLE_ENTRY_HEIGHT\r\n\t\t\t);\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'CreateRectangle',\r\n\t\t\t\tthis.knownID[i],\r\n\t\t\t\t'',\r\n\t\t\t\tTABLE_ENTRY_WIDTH,\r\n\t\t\t\tTABLE_ENTRY_HEIGHT,\r\n\t\t\t\tTABLE_START_X + TABLE_ENTRY_WIDTH,\r\n\t\t\t\tTABLE_START_Y + i * TABLE_ENTRY_HEIGHT\r\n\t\t\t);\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'CreateRectangle',\r\n\t\t\t\tthis.distanceID[i],\r\n\t\t\t\t'',\r\n\t\t\t\tTABLE_ENTRY_WIDTH,\r\n\t\t\t\tTABLE_ENTRY_HEIGHT,\r\n\t\t\t\tTABLE_START_X + 2 * TABLE_ENTRY_WIDTH,\r\n\t\t\t\tTABLE_START_Y + i * TABLE_ENTRY_HEIGHT\r\n\t\t\t);\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'CreateRectangle',\r\n\t\t\t\tthis.pathID[i],\r\n\t\t\t\t'',\r\n\t\t\t\tTABLE_ENTRY_WIDTH,\r\n\t\t\t\tTABLE_ENTRY_HEIGHT,\r\n\t\t\t\tTABLE_START_X + 3 * TABLE_ENTRY_WIDTH,\r\n\t\t\t\tTABLE_START_Y + i * TABLE_ENTRY_HEIGHT\r\n\t\t\t);\r\n\t\t\tthis.cmd('SetTextColor', this.vertexID[i], VERTEX_INDEX_COLOR);\r\n\t\t}\r\n\t\tthis.cmd(\r\n\t\t\t'CreateLabel',\r\n\t\t\tthis.nextIndex++,\r\n\t\t\t'Vertex',\r\n\t\t\tTABLE_START_X,\r\n\t\t\tTABLE_START_Y - TABLE_ENTRY_HEIGHT\r\n\t\t);\r\n\t\tthis.cmd(\r\n\t\t\t'CreateLabel',\r\n\t\t\tthis.nextIndex++,\r\n\t\t\t'Visited',\r\n\t\t\tTABLE_START_X + TABLE_ENTRY_WIDTH,\r\n\t\t\tTABLE_START_Y - TABLE_ENTRY_HEIGHT\r\n\t\t);\r\n\t\tthis.cmd(\r\n\t\t\t'CreateLabel',\r\n\t\t\tthis.nextIndex++,\r\n\t\t\t'Cost',\r\n\t\t\tTABLE_START_X + 2 * TABLE_ENTRY_WIDTH,\r\n\t\t\tTABLE_START_Y - TABLE_ENTRY_HEIGHT\r\n\t\t);\r\n\t\tthis.cmd(\r\n\t\t\t'CreateLabel',\r\n\t\t\tthis.nextIndex++,\r\n\t\t\t'Path',\r\n\t\t\tTABLE_START_X + 3 * TABLE_ENTRY_WIDTH,\r\n\t\t\tTABLE_START_Y - TABLE_ENTRY_HEIGHT\r\n\t\t);\r\n\r\n\t\tthis.animationManager.setAllLayers([0, this.currentLayer]);\r\n\t\tthis.animationManager.StartNewAnimation(this.commands);\r\n\t\tthis.animationManager.skipForward();\r\n\t\tthis.animationManager.clearHistory();\r\n\t\tthis.comparisonMessageID = this.nextIndex++;\r\n\t}\r\n\r\n\tfindCheapestUnknown() {\r\n\t\tlet bestIndex = -1;\r\n\t\tthis.cmd('SetText', this.message1ID, 'Finding Cheapest Uknown Vertex');\r\n\r\n\t\tfor (let i = 0; i < this.size; i++) {\r\n\t\t\tif (!this.known[i]) {\r\n\t\t\t\tthis.cmd('SetHighlight', this.distanceID[i], 1);\r\n\t\t\t}\r\n\r\n\t\t\tif (\r\n\t\t\t\t!this.known[i] &&\r\n\t\t\t\tthis.distance[i] !== -1 &&\r\n\t\t\t\t(bestIndex === -1 || this.distance[i] < this.distance[bestIndex])\r\n\t\t\t) {\r\n\t\t\t\tbestIndex = i;\r\n\t\t\t}\r\n\t\t}\r\n\t\t// if (bestIndex == -1) {\r\n\t\t// \tlet x = 3;\r\n\t\t// \tx = x + 2;\r\n\t\t// }\r\n\t\tthis.cmd('Step');\r\n\t\tfor (let i = 0; i < this.size; i++) {\r\n\t\t\tif (!this.known[i]) {\r\n\t\t\t\tthis.cmd('SetHighlight', this.distanceID[i], 0);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn bestIndex;\r\n\t}\r\n\r\n\tdoDijkstraPrim(startVertex) {\r\n\t\tthis.commands = [];\r\n\r\n\t\tif (!this.runningDijkstra) {\r\n\t\t\tthis.recolorGraph();\r\n\t\t}\r\n\r\n\t\tlet current = startVertex;\r\n\r\n\t\tfor (let i = 0; i < this.size; i++) {\r\n\t\t\tthis.known[i] = false;\r\n\t\t\tthis.distance[i] = -1;\r\n\t\t\tthis.path[i] = -1;\r\n\t\t\tthis.cmd('SetText', this.knownID[i], 'F');\r\n\t\t\tthis.cmd('SetText', this.distanceID[i], 'INF');\r\n\t\t\tthis.cmd('SetText', this.pathID[i], '-1');\r\n\t\t\tthis.cmd('SetTextColor', this.knownID[i], '#000000');\r\n\t\t}\r\n\t\tif (this.messageID != null) {\r\n\t\t\tfor (let i = 0; i < this.messageID.length; i++) {\r\n\t\t\t\tthis.cmd('Delete', this.messageID[i]);\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.messageID = [];\r\n\r\n\t\tthis.distance[current] = 0;\r\n\t\tthis.cmd('SetText', this.distanceID[current], 0);\r\n\r\n\t\tfor (let i = 0; i < this.size; i++) {\r\n\t\t\tcurrent = this.findCheapestUnknown();\r\n\t\t\tif (current < 0) {\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'SetText',\r\n\t\t\t\tthis.message1ID,\r\n\t\t\t\t'Cheapest Unknown Vertex: ' + String.fromCharCode(65 + current)\r\n\t\t\t); // Gotta love Auto Conversion\r\n\t\t\tthis.cmd('SetHighlight', this.distanceID[current], 1);\r\n\r\n\t\t\tthis.cmd('SetHighlight', this.circleID[current], 1);\r\n\t\t\tthis.cmd('Step');\r\n\t\t\tthis.cmd('SetHighlight', this.distanceID[current], 0);\r\n\t\t\tthis.cmd('SetText', this.message1ID, 'Setting known field to True');\r\n\t\t\tthis.cmd('SetHighlight', this.knownID[current], 1);\r\n\t\t\tthis.known[current] = true;\r\n\t\t\tthis.cmd('SetText', this.knownID[current], 'T');\r\n\t\t\tthis.cmd('SetTextColor', this.knownID[current], '#AAAAAA');\r\n\t\t\tthis.cmd('Step');\r\n\t\t\tthis.cmd('SetHighlight', this.knownID[current], 0);\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'SetText',\r\n\t\t\t\tthis.message1ID,\r\n\t\t\t\t'Updating neighbors of vertex ' + String.fromCharCode(65 + current)\r\n\t\t\t); // Gotta love Auto Conversion\r\n\t\t\tfor (let neighbor = 0; neighbor < this.size; neighbor++) {\r\n\t\t\t\tif (this.adj_matrix[current][neighbor] >= 0) {\r\n\t\t\t\t\tthis.highlightEdge(current, neighbor, 1);\r\n\t\t\t\t\tif (this.known[neighbor]) {\r\n\t\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t\t'CreateLabel',\r\n\t\t\t\t\t\t\tthis.comparisonMessageID,\r\n\t\t\t\t\t\t\t'Vertex ' + String.fromCharCode(65 + neighbor) + ' known',\r\n\t\t\t\t\t\t\tTABLE_START_X + 5 * TABLE_ENTRY_WIDTH,\r\n\t\t\t\t\t\t\tTABLE_START_Y + neighbor * TABLE_ENTRY_HEIGHT\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t\tthis.cmd('SetHighlight', this.knownID[neighbor], 1);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.cmd('SetHighlight', this.distanceID[current], 1);\r\n\t\t\t\t\t\tthis.cmd('SetHighlight', this.distanceID[neighbor], 1);\r\n\t\t\t\t\t\tlet distString = String(this.distance[neighbor]);\r\n\t\t\t\t\t\tif (this.distance[neighbor] < 0) {\r\n\t\t\t\t\t\t\tdistString = 'INF';\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif (this.runningDijkstra) {\r\n\t\t\t\t\t\t\tif (\r\n\t\t\t\t\t\t\t\tthis.distance[neighbor] < 0 ||\r\n\t\t\t\t\t\t\t\tthis.distance[neighbor] >\r\n\t\t\t\t\t\t\t\t\tthis.distance[current] + this.adj_matrix[current][neighbor]\r\n\t\t\t\t\t\t\t) {\r\n\t\t\t\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t\t\t\t'CreateLabel',\r\n\t\t\t\t\t\t\t\t\tthis.comparisonMessageID,\r\n\t\t\t\t\t\t\t\t\tdistString +\r\n\t\t\t\t\t\t\t\t\t\t' > ' +\r\n\t\t\t\t\t\t\t\t\t\tString(this.distance[current]) +\r\n\t\t\t\t\t\t\t\t\t\t' + ' +\r\n\t\t\t\t\t\t\t\t\t\tString(this.adj_matrix[current][neighbor]),\r\n\t\t\t\t\t\t\t\t\tTABLE_START_X + 4.3 * TABLE_ENTRY_WIDTH,\r\n\t\t\t\t\t\t\t\t\tTABLE_START_Y + neighbor * TABLE_ENTRY_HEIGHT\r\n\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t\t\t\t'CreateLabel',\r\n\t\t\t\t\t\t\t\t\tthis.comparisonMessageID,\r\n\t\t\t\t\t\t\t\t\t'!(' +\r\n\t\t\t\t\t\t\t\t\t\tString(this.distance[neighbor]) +\r\n\t\t\t\t\t\t\t\t\t\t' > ' +\r\n\t\t\t\t\t\t\t\t\t\tString(this.distance[current]) +\r\n\t\t\t\t\t\t\t\t\t\t' + ' +\r\n\t\t\t\t\t\t\t\t\t\tString(this.adj_matrix[current][neighbor]) +\r\n\t\t\t\t\t\t\t\t\t\t')',\r\n\t\t\t\t\t\t\t\t\tTABLE_START_X + 4.3 * TABLE_ENTRY_WIDTH,\r\n\t\t\t\t\t\t\t\t\tTABLE_START_Y + neighbor * TABLE_ENTRY_HEIGHT\r\n\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tif (\r\n\t\t\t\t\t\t\t\tthis.distance[neighbor] < 0 ||\r\n\t\t\t\t\t\t\t\tthis.distance[neighbor] > this.adj_matrix[current][neighbor]\r\n\t\t\t\t\t\t\t) {\r\n\t\t\t\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t\t\t\t'CreateLabel',\r\n\t\t\t\t\t\t\t\t\tthis.comparisonMessageID,\r\n\t\t\t\t\t\t\t\t\tdistString + ' > ' + String(this.adj_matrix[current][neighbor]),\r\n\t\t\t\t\t\t\t\t\tTABLE_START_X + 4.3 * TABLE_ENTRY_WIDTH,\r\n\t\t\t\t\t\t\t\t\tTABLE_START_Y + neighbor * TABLE_ENTRY_HEIGHT\r\n\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t\t\t\t'CreateLabel',\r\n\t\t\t\t\t\t\t\t\tthis.comparisonMessageID,\r\n\t\t\t\t\t\t\t\t\t'!(' +\r\n\t\t\t\t\t\t\t\t\t\tString(this.distance[neighbor]) +\r\n\t\t\t\t\t\t\t\t\t\t' > ' +\r\n\t\t\t\t\t\t\t\t\t\tString(this.adj_matrix[current][neighbor]) +\r\n\t\t\t\t\t\t\t\t\t\t')',\r\n\t\t\t\t\t\t\t\t\tTABLE_START_X + 4.3 * TABLE_ENTRY_WIDTH,\r\n\t\t\t\t\t\t\t\t\tTABLE_START_Y + neighbor * TABLE_ENTRY_HEIGHT\r\n\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis.cmd('Step');\r\n\t\t\t\t\tthis.cmd('Delete', this.comparisonMessageID);\r\n\t\t\t\t\tthis.highlightEdge(current, neighbor, 0);\r\n\t\t\t\t\tif (this.known[neighbor]) {\r\n\t\t\t\t\t\tthis.cmd('SetHighlight', this.knownID[neighbor], 0);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.cmd('SetHighlight', this.distanceID[current], 0);\r\n\t\t\t\t\t\tthis.cmd('SetHighlight', this.distanceID[neighbor], 0);\r\n\t\t\t\t\t\tlet compare;\r\n\t\t\t\t\t\tif (this.runningDijkstra) {\r\n\t\t\t\t\t\t\tcompare = this.distance[current] + this.adj_matrix[current][neighbor];\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tcompare = this.adj_matrix[current][neighbor];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (this.distance[neighbor] < 0 || this.distance[neighbor] > compare) {\r\n\t\t\t\t\t\t\tthis.distance[neighbor] = compare;\r\n\t\t\t\t\t\t\tthis.path[neighbor] = current;\r\n\t\t\t\t\t\t\tthis.cmd('SetText', this.distanceID[neighbor], this.distance[neighbor]);\r\n\t\t\t\t\t\t\tthis.cmd('SetText', this.pathID[neighbor], this.path[neighbor]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.cmd('SetHighlight', this.circleID[current], 0);\r\n\t\t}\r\n\t\t// Running Dijkstra's algorithm, create the paths\r\n\t\tif (this.runningDijkstra) {\r\n\t\t\tthis.cmd('SetText', this.message1ID, 'Finding Paths in Table');\r\n\t\t\tthis.createPaths();\r\n\t\t}\r\n\t\t// Running Prim's algorithm, highlight the tree\r\n\t\telse {\r\n\t\t\tthis.cmd('SetText', this.message1ID, 'Creating tree from table');\r\n\t\t\tthis.highlightTree();\r\n\t\t}\r\n\r\n\t\tthis.cmd('SetText', this.message1ID, '');\r\n\t\treturn this.commands;\r\n\t}\r\n\r\n\tcreatePaths() {\r\n\t\tfor (let vertex = 0; vertex < this.size; vertex++) {\r\n\t\t\tlet nextLabelID = this.nextIndex++;\r\n\t\t\tif (this.distance[vertex] < 0) {\r\n\t\t\t\tthis.cmd(\r\n\t\t\t\t\t'CreateLabel',\r\n\t\t\t\t\tnextLabelID,\r\n\t\t\t\t\t'No Path',\r\n\t\t\t\t\tTABLE_START_X + 4.3 * TABLE_ENTRY_WIDTH,\r\n\t\t\t\t\tTABLE_START_Y + vertex * TABLE_ENTRY_HEIGHT\r\n\t\t\t\t);\r\n\t\t\t\tthis.messageID.push(nextLabelID);\r\n\t\t\t} else {\r\n\t\t\t\tthis.cmd(\r\n\t\t\t\t\t'CreateLabel',\r\n\t\t\t\t\tnextLabelID,\r\n\t\t\t\t\tString.fromCharCode(65 + vertex),\r\n\t\t\t\t\tTABLE_START_X + 4.3 * TABLE_ENTRY_WIDTH,\r\n\t\t\t\t\tTABLE_START_Y + vertex * TABLE_ENTRY_HEIGHT\r\n\t\t\t\t);\r\n\t\t\t\tthis.messageID.push(nextLabelID);\r\n\t\t\t\tconst pathList = [nextLabelID];\r\n\t\t\t\tlet nextInPath = vertex;\r\n\t\t\t\twhile (nextInPath >= 0) {\r\n\t\t\t\t\tthis.cmd('SetHighlight', this.pathID[nextInPath], 1);\r\n\t\t\t\t\tthis.cmd('Step');\r\n\t\t\t\t\tif (this.path[nextInPath] !== -1) {\r\n\t\t\t\t\t\tnextLabelID = this.nextIndex++;\r\n\t\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t\t'CreateLabel',\r\n\t\t\t\t\t\t\tnextLabelID,\r\n\t\t\t\t\t\t\tString.fromCharCode(65 + this.path[nextInPath]),\r\n\t\t\t\t\t\t\tTABLE_START_X + 3 * TABLE_ENTRY_WIDTH,\r\n\t\t\t\t\t\t\tTABLE_START_Y + nextInPath * TABLE_ENTRY_HEIGHT\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t\t'Move',\r\n\t\t\t\t\t\t\tnextLabelID,\r\n\t\t\t\t\t\t\tTABLE_START_X + 4.3 * TABLE_ENTRY_WIDTH,\r\n\t\t\t\t\t\t\tTABLE_START_Y + vertex * TABLE_ENTRY_HEIGHT\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t\tthis.messageID.push(nextLabelID);\r\n\t\t\t\t\t\tfor (let i = pathList.length - 1; i >= 0; i--) {\r\n\t\t\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t\t\t'Move',\r\n\t\t\t\t\t\t\t\tpathList[i],\r\n\t\t\t\t\t\t\t\tTABLE_START_X +\r\n\t\t\t\t\t\t\t\t\t4.3 * TABLE_ENTRY_WIDTH +\r\n\t\t\t\t\t\t\t\t\t(pathList.length - i) * 17,\r\n\t\t\t\t\t\t\t\tTABLE_START_Y + vertex * TABLE_ENTRY_HEIGHT\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tthis.cmd('Step');\r\n\t\t\t\t\t\tpathList.push(nextLabelID);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.cmd('SetHighlight', this.pathID[nextInPath], 0);\r\n\t\t\t\t\tnextInPath = this.path[nextInPath];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\thighlightTree() {\r\n\t\tfor (let vertex = 0; vertex < this.size; vertex++) {\r\n\t\t\tif (this.path[vertex] >= 0) {\r\n\t\t\t\tthis.cmd('SetHighlight', this.vertexID[vertex], 1);\r\n\t\t\t\tthis.cmd('SetHighlight', this.pathID[vertex], 1);\r\n\t\t\t\tthis.highlightEdge(vertex, this.path[vertex], 1);\r\n\t\t\t\tthis.highlightEdge(this.path[vertex], vertex, 1);\r\n\t\t\t\tthis.cmd('Step');\r\n\t\t\t\tthis.cmd('SetHighlight', this.vertexID[vertex], 0);\r\n\t\t\t\tthis.cmd('SetHighlight', this.pathID[vertex], 0);\r\n\t\t\t\tthis.highlightEdge(vertex, this.path[vertex], 0);\r\n\t\t\t\tthis.highlightEdge(this.path[vertex], vertex, 0);\r\n\t\t\t\tthis.setEdgeColor(vertex, this.path[vertex], '#FF0000');\r\n\t\t\t\tthis.setEdgeColor(this.path[vertex], vertex, '#FF0000');\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\treset() {\r\n\t\tthis.messageID = [];\r\n\t}\r\n\r\n\tstartCallback() {\r\n\t\tlet startvalue;\r\n\r\n\t\tif (this.startField.value !== '') {\r\n\t\t\tstartvalue = this.startField.value;\r\n\t\t\tthis.startField.value = '';\r\n\t\t\tstartvalue = startvalue.toUpperCase().charCodeAt(0) - 65;\r\n\t\t\tif (startvalue < this.size)\r\n\t\t\t\tthis.implementAction(this.doDijkstraPrim.bind(this), startvalue);\r\n\t\t}\r\n\t}\r\n\r\n\tenableUI(event) {\r\n\t\tthis.startField.disabled = false;\r\n\t\tthis.startButton.disabled = false;\r\n\r\n\t\tsuper.enableUI(event);\r\n\t}\r\n\r\n\tdisableUI(event) {\r\n\t\tthis.startField.disabled = true;\r\n\t\tthis.startButton.disabled = true;\r\n\r\n\t\tsuper.disableUI(event);\r\n\t}\r\n}\r\n\r\nexport class Dijkstra extends DijkstraPrim {\r\n\tconstructor(am, w, h) {\r\n\t\tsuper(am, true, w, h);\r\n\t}\r\n}\r\n\r\nexport class Prim extends DijkstraPrim {\r\n\tconstructor(am, w, h) {\r\n\t\tsuper(am, false, w, h);\r\n\t}\r\n}\r\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\r\n//\r\n// Redistribution and use in source and binary forms, with or without modification, are\r\n// permitted provided that the following conditions are met:\r\n//\r\n// 1. Redistributions of source code must retain the above copyright notice, this list of\r\n// conditions and the following disclaimer.\r\n//\r\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\r\n// of conditions and the following disclaimer in the documentation and/or other materials\r\n// provided with the distribution.\r\n//\r\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\r\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\r\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\r\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\r\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\r\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\r\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\r\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\r\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\r\n//\r\n// The views and conclusions contained in the software and documentation are those of the\r\n// authors and should not be interpreted as representing official policies, either expressed\r\n// or implied, of the University of San Francisco\r\n\r\nimport Algorithm, { addControlToAlgorithmBar, addLabelToAlgorithmBar } from './Algorithm.js';\r\n\r\nconst LINKED_LIST_START_X = 100;\r\nconst LINKED_LIST_START_Y = 200;\r\nconst LINKED_LIST_ELEM_WIDTH = 100;\r\nconst LINKED_LIST_ELEM_HEIGHT = 30;\r\n\r\nconst LINKED_LIST_INSERT_X = 200;\r\nconst LINKED_LIST_INSERT_Y = 50;\r\n\r\nconst LINKED_LIST_ELEMS_PER_LINE = 8;\r\nconst LINKED_LIST_ELEM_SPACING = 150;\r\nconst LINKED_LIST_LINE_SPACING = 100;\r\n\r\n// const TOP_POS_X = 180;\r\n// const TOP_POS_Y = 100;\r\n// const TOP_LABEL_X = 130;\r\n// const TOP_LABEL_Y = 100;\r\n\r\n// const TOP_ELEM_WIDTH = 30;\r\n// const TOP_ELEM_HEIGHT = 30;\r\n\r\nconst PUSH_LABEL_X = 50;\r\nconst PUSH_LABEL_Y = 30;\r\nconst PUSH_ELEMENT_X = 120;\r\nconst PUSH_ELEMENT_Y = 30;\r\n\r\nconst SIZE = 32;\r\n\r\nexport default class DoublyLinkedList extends Algorithm {\r\n\tconstructor(am, w, h) {\r\n\t\tsuper(am, w, h);\r\n\t\tthis.addControls();\r\n\r\n\t\t// Useful for memory management\r\n\t\tthis.nextIndex = 0;\r\n\r\n\t\tthis.setup();\r\n\r\n\t\tthis.initialIndex = this.nextIndex;\r\n\t}\r\n\r\n\taddControls() {\r\n\t\tthis.controls = [];\r\n\r\n\t\taddLabelToAlgorithmBar('Value');\r\n\r\n\t\t// Add's value text field\r\n\t\tthis.addValueField = addControlToAlgorithmBar('Text', '');\r\n\t\tthis.addValueField.onkeydown = this.returnSubmit(\r\n\t\t\tthis.addValueField,\r\n\t\t\tthis.addIndexCallback.bind(this),\r\n\t\t\t4,\r\n\t\t\ttrue\r\n\t\t);\r\n\t\tthis.controls.push(this.addValueField);\r\n\r\n\t\taddLabelToAlgorithmBar('at index');\r\n\r\n\t\t// Add's index text field\r\n\t\tthis.addIndexField = addControlToAlgorithmBar('Text', '');\r\n\t\tthis.addIndexField.onkeydown = this.returnSubmit(\r\n\t\t\tthis.addIndexField,\r\n\t\t\tthis.addIndexCallback.bind(this),\r\n\t\t\t4,\r\n\t\t\ttrue\r\n\t\t);\r\n\t\tthis.controls.push(this.addIndexField);\r\n\r\n\t\t// Add at index button\r\n\t\tthis.addIndexButton = addControlToAlgorithmBar('Button', 'Add at Index');\r\n\t\tthis.addIndexButton.onclick = this.addIndexCallback.bind(this);\r\n\t\tthis.controls.push(this.addIndexButton);\r\n\r\n\t\taddLabelToAlgorithmBar('or');\r\n\r\n\t\t// Add to front button\r\n\t\tthis.addFrontButton = addControlToAlgorithmBar('Button', 'Add to Front');\r\n\t\tthis.addFrontButton.onclick = this.addFrontCallback.bind(this);\r\n\t\tthis.controls.push(this.addFrontButton);\r\n\r\n\t\t// Add to back button\r\n\t\tthis.addBackButton = addControlToAlgorithmBar('Button', 'Add to Back');\r\n\t\tthis.addBackButton.onclick = this.addBackCallback.bind(this);\r\n\t\tthis.controls.push(this.addBackButton);\r\n\r\n\t\t// Remove's index text field\r\n\t\tthis.removeField = addControlToAlgorithmBar('Text', '');\r\n\t\tthis.removeField.onkeydown = this.returnSubmit(\r\n\t\t\tthis.removeField,\r\n\t\t\tthis.removeIndexCallback.bind(this),\r\n\t\t\t4,\r\n\t\t\ttrue\r\n\t\t);\r\n\t\tthis.controls.push(this.removeField);\r\n\r\n\t\t// Remove from index button\r\n\t\tthis.removeIndexButton = addControlToAlgorithmBar('Button', 'Remove from Index');\r\n\t\tthis.removeIndexButton.onclick = this.removeIndexCallback.bind(this);\r\n\t\tthis.controls.push(this.removeIndexButton);\r\n\r\n\t\taddLabelToAlgorithmBar('or');\r\n\r\n\t\t// Remove from front button\r\n\t\tthis.removeFrontButton = addControlToAlgorithmBar('Button', 'Remove from Front');\r\n\t\tthis.removeFrontButton.onclick = this.removeFrontCallback.bind(this);\r\n\t\tthis.controls.push(this.removeFrontButton);\r\n\r\n\t\t// Remove from back button\r\n\t\tthis.removeBackButton = addControlToAlgorithmBar('Button', 'Remove from Back');\r\n\t\tthis.removeBackButton.onclick = this.removeBackCallback.bind(this);\r\n\t\tthis.controls.push(this.removeBackButton);\r\n\r\n\t\t// Get's index text field\r\n\t\t// this.getField = addControlToAlgorithmBar(\"Text\", \"\");\r\n\t\t// this.getField.onkeydown = this.returnSubmit(this.getField, this.getCallback.bind(this), 4, true);\r\n\t\t// this.controls.push(this.getField);\r\n\r\n\t\t// Get button\r\n\t\t// this.getButton = addControlToAlgorithmBar(\"Button\", \"Get\");\r\n\t\t// this.getButton.onclick = this.getCallback.bind(this);\r\n\t\t// this.controls.push(this.getButton);\r\n\r\n\t\t// Clear button\r\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear');\r\n\t\tthis.clearButton.onclick = this.clearCallback.bind(this);\r\n\t\tthis.controls.push(this.clearButton);\r\n\t}\r\n\r\n\tenableUI() {\r\n\t\tfor (let i = 0; i < this.controls.length; i++) {\r\n\t\t\tthis.controls[i].disabled = false;\r\n\t\t}\r\n\t}\r\n\r\n\tdisableUI() {\r\n\t\tfor (let i = 0; i < this.controls.length; i++) {\r\n\t\t\tthis.controls[i].disabled = true;\r\n\t\t}\r\n\t}\r\n\r\n\tsetup() {\r\n\t\tthis.linkedListElemID = new Array(SIZE);\r\n\r\n\t\tthis.arrayData = new Array(SIZE);\r\n\t\tthis.size = 0;\r\n\t\tthis.leftoverLabelID = this.nextIndex++;\r\n\r\n\t\tthis.cmd('CreateLabel', this.leftoverLabelID, '', PUSH_LABEL_X, PUSH_LABEL_Y);\r\n\r\n\t\tthis.animationManager.StartNewAnimation(this.commands);\r\n\t\tthis.animationManager.skipForward();\r\n\t\tthis.animationManager.clearHistory();\r\n\t}\r\n\r\n\treset() {\r\n\t\tthis.size = 0;\r\n\t\tthis.nextIndex = this.initialIndex;\r\n\t}\r\n\r\n\taddIndexCallback() {\r\n\t\tif (this.addValueField.value !== '' && this.addIndexField.value !== '') {\r\n\t\t\tconst addVal = this.addValueField.value;\r\n\t\t\tconst index = this.addIndexField.value;\r\n\t\t\tif (index >= 0 && index <= this.size) {\r\n\t\t\t\tthis.addValueField.value = '';\r\n\t\t\t\tthis.addIndexField.value = '';\r\n\t\t\t\tthis.implementAction(this.add.bind(this), addVal + ',' + index);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\taddFrontCallback() {\r\n\t\tif (this.addValueField.value !== '') {\r\n\t\t\tconst addVal = this.addValueField.value;\r\n\t\t\tthis.addValueField.value = '';\r\n\t\t\tthis.implementAction(this.add.bind(this), addVal + ',' + 0);\r\n\t\t}\r\n\t}\r\n\r\n\taddBackCallback() {\r\n\t\tif (this.addValueField.value !== '') {\r\n\t\t\tconst addVal = this.addValueField.value;\r\n\t\t\tthis.addValueField.value = '';\r\n\t\t\tthis.implementAction(this.add.bind(this), addVal + ',' + this.size);\r\n\t\t}\r\n\t}\r\n\r\n\tremoveIndexCallback() {\r\n\t\tif (this.removeField.value !== '') {\r\n\t\t\tconst index = this.removeField.value;\r\n\t\t\tif (index >= 0 && index < this.size) {\r\n\t\t\t\tthis.removeField.value = '';\r\n\t\t\t\tthis.implementAction(this.remove.bind(this), index);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tremoveFrontCallback() {\r\n\t\tif (this.size > 0) {\r\n\t\t\tthis.implementAction(this.remove.bind(this), 0);\r\n\t\t}\r\n\t}\r\n\r\n\tremoveBackCallback() {\r\n\t\tif (this.size > 0) {\r\n\t\t\tthis.implementAction(this.remove.bind(this), this.size - 1);\r\n\t\t}\r\n\t}\r\n\r\n\t// DoublyLinkedList.prototype.getCallback = function(event)\r\n\t// {\r\n\t//     if (this.getField.value != \"\" && this.getField.value > 0 && this.getField.value < this.size)\r\n\t//     {\r\n\t//         this.implementAction(this.get.bind(this), \"\");\r\n\t//     }\r\n\t// }\r\n\r\n\tclearCallback() {\r\n\t\tthis.implementAction(this.clearAll.bind(this), '');\r\n\t}\r\n\r\n\tadd(params) {\r\n\t\tthis.commands = [];\r\n\r\n\t\tconst elemToAdd = parseInt(params.split(',')[0]);\r\n\t\tconst index = parseInt(params.split(',')[1]);\r\n\t\tconst labPushID = this.nextIndex++;\r\n\t\tconst labPushValID = this.nextIndex++;\r\n\r\n\t\tfor (let i = this.size - 1; i >= index; i--) {\r\n\t\t\tthis.arrayData[i + 1] = this.arrayData[i];\r\n\t\t\tthis.linkedListElemID[i + 1] = this.linkedListElemID[i];\r\n\t\t}\r\n\t\tthis.arrayData[index] = elemToAdd;\r\n\t\tthis.linkedListElemID[index] = this.nextIndex++;\r\n\r\n\t\tthis.cmd('SetText', this.leftoverLabelID, '');\r\n\r\n\t\tthis.cmd(\r\n\t\t\t'CreateDoublyLinkedList',\r\n\t\t\tthis.linkedListElemID[index],\r\n\t\t\t'',\r\n\t\t\tLINKED_LIST_ELEM_WIDTH,\r\n\t\t\tLINKED_LIST_ELEM_HEIGHT,\r\n\t\t\tLINKED_LIST_INSERT_X,\r\n\t\t\tLINKED_LIST_INSERT_Y,\r\n\t\t\t0.25,\r\n\t\t\t1\r\n\t\t);\r\n\r\n\t\tthis.cmd('CreateLabel', labPushID, 'Adding Value: ', PUSH_LABEL_X, PUSH_LABEL_Y);\r\n\t\tthis.cmd('CreateLabel', labPushValID, elemToAdd, PUSH_ELEMENT_X, PUSH_ELEMENT_Y);\r\n\r\n\t\tthis.cmd('Step');\r\n\r\n\t\tthis.cmd('Move', labPushValID, LINKED_LIST_INSERT_X, LINKED_LIST_INSERT_Y);\r\n\r\n\t\tthis.cmd('Step');\r\n\t\tthis.cmd('SetText', this.linkedListElemID[index], elemToAdd);\r\n\t\tthis.cmd('Delete', labPushValID);\r\n\r\n\t\tif (index === 0) {\r\n\t\t\tthis.cmd('SetPrevNull', this.linkedListElemID[index], 1);\r\n\t\t}\r\n\r\n\t\tif (index === this.size) {\r\n\t\t\tthis.cmd('SetNextNull', this.linkedListElemID[index], 1);\r\n\t\t}\r\n\r\n\t\tif (this.size !== 0) {\r\n\t\t\tif (index === 0) {\r\n\t\t\t\tthis.cmd('SetPrevNull', this.linkedListElemID[index + 1], 0);\r\n\t\t\t\tthis.cmd(\r\n\t\t\t\t\t'ConnectNext',\r\n\t\t\t\t\tthis.linkedListElemID[index],\r\n\t\t\t\t\tthis.linkedListElemID[index + 1]\r\n\t\t\t\t);\r\n\t\t\t\tthis.cmd(\r\n\t\t\t\t\t'ConnectPrev',\r\n\t\t\t\t\tthis.linkedListElemID[index + 1],\r\n\t\t\t\t\tthis.linkedListElemID[index]\r\n\t\t\t\t);\r\n\t\t\t} else if (index === this.size) {\r\n\t\t\t\tthis.cmd('SetNextNull', this.linkedListElemID[index - 1], 0);\r\n\t\t\t\tthis.cmd(\r\n\t\t\t\t\t'ConnectNext',\r\n\t\t\t\t\tthis.linkedListElemID[index - 1],\r\n\t\t\t\t\tthis.linkedListElemID[index]\r\n\t\t\t\t);\r\n\t\t\t\tthis.cmd(\r\n\t\t\t\t\t'ConnectPrev',\r\n\t\t\t\t\tthis.linkedListElemID[index],\r\n\t\t\t\t\tthis.linkedListElemID[index - 1]\r\n\t\t\t\t);\r\n\t\t\t} else {\r\n\t\t\t\tthis.cmd(\r\n\t\t\t\t\t'Disconnect',\r\n\t\t\t\t\tthis.linkedListElemID[index - 1],\r\n\t\t\t\t\tthis.linkedListElemID[index + 1]\r\n\t\t\t\t);\r\n\t\t\t\tthis.cmd(\r\n\t\t\t\t\t'Disconnect',\r\n\t\t\t\t\tthis.linkedListElemID[index + 1],\r\n\t\t\t\t\tthis.linkedListElemID[index - 1]\r\n\t\t\t\t);\r\n\t\t\t\tthis.cmd(\r\n\t\t\t\t\t'ConnectNext',\r\n\t\t\t\t\tthis.linkedListElemID[index - 1],\r\n\t\t\t\t\tthis.linkedListElemID[index]\r\n\t\t\t\t);\r\n\t\t\t\tthis.cmd(\r\n\t\t\t\t\t'ConnectPrev',\r\n\t\t\t\t\tthis.linkedListElemID[index],\r\n\t\t\t\t\tthis.linkedListElemID[index - 1]\r\n\t\t\t\t);\r\n\t\t\t\tthis.cmd(\r\n\t\t\t\t\t'ConnectNext',\r\n\t\t\t\t\tthis.linkedListElemID[index],\r\n\t\t\t\t\tthis.linkedListElemID[index + 1]\r\n\t\t\t\t);\r\n\t\t\t\tthis.cmd(\r\n\t\t\t\t\t'ConnectPrev',\r\n\t\t\t\t\tthis.linkedListElemID[index + 1],\r\n\t\t\t\t\tthis.linkedListElemID[index]\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis.cmd('Step');\r\n\t\tthis.size = this.size + 1;\r\n\t\tthis.resetNodePositions();\r\n\t\tthis.cmd('Delete', labPushID);\r\n\t\tthis.cmd('Step');\r\n\r\n\t\treturn this.commands;\r\n\t}\r\n\r\n\tremove(index) {\r\n\t\tthis.commands = [];\r\n\r\n\t\tindex = parseInt(index);\r\n\t\tconst labPopID = this.nextIndex++;\r\n\t\tconst labPopValID = this.nextIndex++;\r\n\r\n\t\tthis.cmd('SetText', this.leftoverLabelID, '');\r\n\r\n\t\tconst nodePosX = LINKED_LIST_START_X + LINKED_LIST_ELEM_SPACING * index;\r\n\t\tconst nodePosY = LINKED_LIST_START_Y;\r\n\t\tthis.cmd('CreateLabel', labPopID, 'Removing Value: ', PUSH_LABEL_X, PUSH_LABEL_Y);\r\n\t\tthis.cmd('CreateLabel', labPopValID, this.arrayData[index], nodePosX, nodePosY);\r\n\t\tthis.cmd('Move', labPopValID, PUSH_ELEMENT_X, PUSH_ELEMENT_Y);\r\n\t\tthis.cmd('Step');\r\n\r\n\t\tif (this.size !== 1) {\r\n\t\t\tif (index === 0) {\r\n\t\t\t\tthis.cmd(\r\n\t\t\t\t\t'Disconnect',\r\n\t\t\t\t\tthis.linkedListElemID[index + 1],\r\n\t\t\t\t\tthis.linkedListElemID[index]\r\n\t\t\t\t);\r\n\t\t\t\tthis.cmd('SetPrevNull', this.linkedListElemID[index + 1], 1);\r\n\t\t\t} else if (index === this.size - 1) {\r\n\t\t\t\tthis.cmd(\r\n\t\t\t\t\t'Disconnect',\r\n\t\t\t\t\tthis.linkedListElemID[index - 1],\r\n\t\t\t\t\tthis.linkedListElemID[index]\r\n\t\t\t\t);\r\n\t\t\t\tthis.cmd('SetNextNull', this.linkedListElemID[index - 1], 1);\r\n\t\t\t} else {\r\n\t\t\t\tconst xPos =\r\n\t\t\t\t\t(index % LINKED_LIST_ELEMS_PER_LINE) * LINKED_LIST_ELEM_SPACING +\r\n\t\t\t\t\tLINKED_LIST_START_X;\r\n\t\t\t\tconst yPos = LINKED_LIST_START_Y - LINKED_LIST_ELEM_HEIGHT * 2;\r\n\t\t\t\tthis.cmd('Move', this.linkedListElemID[index], xPos, yPos);\r\n\t\t\t\tthis.cmd('Step');\r\n\t\t\t\tthis.cmd(\r\n\t\t\t\t\t'Disconnect',\r\n\t\t\t\t\tthis.linkedListElemID[index - 1],\r\n\t\t\t\t\tthis.linkedListElemID[index]\r\n\t\t\t\t);\r\n\t\t\t\tthis.cmd(\r\n\t\t\t\t\t'Disconnect',\r\n\t\t\t\t\tthis.linkedListElemID[index + 1],\r\n\t\t\t\t\tthis.linkedListElemID[index]\r\n\t\t\t\t);\r\n\t\t\t\tthis.cmd(\r\n\t\t\t\t\t'ConnectNext',\r\n\t\t\t\t\tthis.linkedListElemID[index - 1],\r\n\t\t\t\t\tthis.linkedListElemID[index + 1]\r\n\t\t\t\t);\r\n\t\t\t\tthis.cmd(\r\n\t\t\t\t\t'ConnectPrev',\r\n\t\t\t\t\tthis.linkedListElemID[index + 1],\r\n\t\t\t\t\tthis.linkedListElemID[index - 1]\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.cmd('Step');\r\n\t\tthis.cmd('Delete', this.linkedListElemID[index]);\r\n\r\n\t\tfor (let i = index; i < this.size; i++) {\r\n\t\t\tthis.arrayData[i] = this.arrayData[i + 1];\r\n\t\t\tthis.linkedListElemID[i] = this.linkedListElemID[i + 1];\r\n\t\t}\r\n\t\tthis.size = this.size - 1;\r\n\t\tthis.resetNodePositions();\r\n\r\n\t\tthis.cmd('Delete', labPopValID);\r\n\t\tthis.cmd('Delete', labPopID);\r\n\r\n\t\treturn this.commands;\r\n\t}\r\n\r\n\tresetNodePositions() {\r\n\t\tfor (let i = 0; i < this.size; i++) {\r\n\t\t\tconst nextX =\r\n\t\t\t\t(i % LINKED_LIST_ELEMS_PER_LINE) * LINKED_LIST_ELEM_SPACING + LINKED_LIST_START_X;\r\n\t\t\tconst nextY =\r\n\t\t\t\tMath.floor(i / LINKED_LIST_ELEMS_PER_LINE) * LINKED_LIST_LINE_SPACING +\r\n\t\t\t\tLINKED_LIST_START_Y;\r\n\t\t\tthis.cmd('Move', this.linkedListElemID[i], nextX, nextY);\r\n\t\t}\r\n\t}\r\n\r\n\tclearAll() {\r\n\t\tthis.commands = [];\r\n\t\tfor (let i = 0; i < this.size; i++) {\r\n\t\t\tthis.cmd('Delete', this.linkedListElemID[i]);\r\n\t\t}\r\n\t\tthis.size = 0;\r\n\t\treturn this.commands;\r\n\t}\r\n}\r\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\r\n//\r\n// Redistribution and use in source and binary forms, with or without modification, are\r\n// permitted provided that the following conditions are met:\r\n//\r\n// 1. Redistributions of source code must retain the above copyright notice, this list of\r\n// conditions and the following disclaimer.\r\n//\r\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\r\n// of conditions and the following disclaimer in the documentation and/or other materials\r\n// provided with the distribution.\r\n//\r\n// THIS SOFTWARE IS PROVIDED BY David Galles ``AS IS'' AND ANY EXPRESS OR IMPLIED\r\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\r\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\r\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\r\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\r\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\r\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\r\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\r\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\r\n//\r\n// The views and conclusions contained in the software and documentation are those of the\r\n// authors and should not be interpreted as representing official policies, either expressed\r\n// or implied, of the University of San Francisco\r\n\r\nimport Graph, { LARGE_SIZE, SMALL_SIZE } from './Graph.js';\r\nimport { addControlToAlgorithmBar } from './Algorithm.js';\r\n\r\nexport default class Floyd extends Graph {\r\n\tconstructor(am, w, h) {\r\n\t\tsuper(am, w, h, true, false);\r\n\t\tthis.showEdgeCosts = true;\r\n\t}\r\n\r\n\taddControls() {\r\n\t\tthis.startButton = addControlToAlgorithmBar('Button', 'Run Floyd-Warshall');\r\n\t\tthis.startButton.onclick = this.startCallback.bind(this);\r\n\r\n\t\tsuper.addControls();\r\n\t\tthis.smallGraphButton.onclick = this.smallGraphCallback.bind(this);\r\n\t\tthis.largeGraphButton.onclick = this.largeGraphCallback.bind(this);\r\n\t}\r\n\r\n\treset() {\r\n\t\tfor (let i = 0; i < this.size; i++) {\r\n\t\t\tfor (let j = 0; j < this.size; j++) {\r\n\t\t\t\tthis.costTable[i][j] = this.adj_matrix[i][j];\r\n\t\t\t\tif (this.costTable[i][j] >= 0) {\r\n\t\t\t\t\tthis.pathTable[i][j] = i;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.pathTable[i][j] = -1;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tsmallGraphCallback() {\r\n\t\tif (this.size !== SMALL_SIZE) {\r\n\t\t\tthis.animationManager.resetAll();\r\n\t\t\tthis.animationManager.setAllLayers([0, this.currentLayer]);\r\n\t\t\tthis.logicalButton.disabled = false;\r\n\t\t\tthis.adjacencyListButton.disabled = false;\r\n\t\t\tthis.adjacencyMatrixButton.disabled = false;\r\n\t\t\tthis.setup_small();\r\n\t\t}\r\n\t}\r\n\r\n\tlargeGraphCallback() {\r\n\t\tif (this.size !== LARGE_SIZE) {\r\n\t\t\tthis.animationManager.resetAll();\r\n\t\t\t//this.animationManager.setAllLayers([0]);\r\n\t\t\tthis.logicalButton.disabled = true;\r\n\t\t\tthis.adjacencyListButton.disabled = true;\r\n\t\t\tthis.adjacencyMatrixButton.disabled = true;\r\n\t\t\tthis.setup_large();\r\n\t\t}\r\n\t}\r\n\r\n\tgetCostLabel(value, alwaysUseINF) {\r\n\t\talwaysUseINF = alwaysUseINF === undefined ? false : alwaysUseINF;\r\n\t\tif (value >= 0) {\r\n\t\t\treturn String(value);\r\n\t\t} else if (this.size === SMALL_SIZE || alwaysUseINF) {\r\n\t\t\treturn 'INF';\r\n\t\t} else {\r\n\t\t\treturn '';\r\n\t\t}\r\n\t}\r\n\r\n\tsetup_small() {\r\n\t\tthis.cost_table_width = Floyd.SMALL_COST_TABLE_WIDTH;\r\n\t\tthis.cost_table_height = Floyd.SMALL_COST_TABLE_HEIGHT;\r\n\t\tthis.cost_table_start_x = Floyd.SMALL_COST_TABLE_START_X;\r\n\t\tthis.cost_table_start_y = Floyd.SMALL_COST_TABLE_START_Y;\r\n\r\n\t\tthis.path_table_width = Floyd.SMALL_PATH_TABLE_WIDTH;\r\n\t\tthis.path_table_height = Floyd.SMALL_PATH_TABLE_HEIGHT;\r\n\t\tthis.path_table_start_x = Floyd.SMALL_PATH_TABLE_START_X;\r\n\t\tthis.path_table_start_y = Floyd.SMALL_PATH_TABLE_START_Y;\r\n\r\n\t\tthis.node_1_x_pos = Floyd.SMALL_NODE_1_X_POS;\r\n\t\tthis.node_1_y_pos = Floyd.SMALL_NODE_1_Y_POS;\r\n\t\tthis.node_2_x_pos = Floyd.SMALL_NODE_2_X_POS;\r\n\t\tthis.node_2_y_pos = Floyd.SMALL_NODE_2_Y_POS;\r\n\t\tthis.node_3_x_pos = Floyd.SMALL_NODE_3_X_POS;\r\n\t\tthis.node_3_y_pos = Floyd.SMALL_NODE_3_Y_POS;\r\n\r\n\t\tthis.message_x = Floyd.SMALL_MESSAGE_X;\r\n\t\tthis.message_y = Floyd.SMALL_MESSAGE_Y;\r\n\t\tsuper.setup_small();\r\n\t}\r\n\r\n\tsetup_large() {\r\n\t\tthis.cost_table_width = Floyd.LARGE_COST_TABLE_WIDTH;\r\n\t\tthis.cost_table_height = Floyd.LARGE_COST_TABLE_HEIGHT;\r\n\t\tthis.cost_table_start_x = Floyd.LARGE_COST_TABLE_START_X;\r\n\t\tthis.cost_table_start_y = Floyd.LARGE_COST_TABLE_START_Y;\r\n\r\n\t\tthis.path_table_width = Floyd.LARGE_PATH_TABLE_WIDTH;\r\n\t\tthis.path_table_height = Floyd.LARGE_PATH_TABLE_HEIGHT;\r\n\t\tthis.path_table_start_x = Floyd.LARGE_PATH_TABLE_START_X;\r\n\t\tthis.path_table_start_y = Floyd.LARGE_PATH_TABLE_START_Y;\r\n\r\n\t\tthis.node_1_x_pos = Floyd.LARGE_NODE_1_X_POS;\r\n\t\tthis.node_1_y_pos = Floyd.LARGE_NODE_1_Y_POS;\r\n\t\tthis.node_2_x_pos = Floyd.LARGE_NODE_2_X_POS;\r\n\t\tthis.node_2_y_pos = Floyd.LARGE_NODE_2_Y_POS;\r\n\t\tthis.node_3_x_pos = Floyd.LARGE_NODE_3_X_POS;\r\n\t\tthis.node_3_y_pos = Floyd.LARGE_NODE_3_Y_POS;\r\n\r\n\t\tthis.message_x = Floyd.LARGE_MESSAGE_X;\r\n\t\tthis.message_y = Floyd.LARGE_MESSAGE_Y;\r\n\r\n\t\tsuper.setup_large();\r\n\t}\r\n\r\n\tsetup() {\r\n\t\tsuper.setup();\r\n\t\tthis.commands = [];\r\n\r\n\t\tthis.costTable = new Array(this.size);\r\n\t\tthis.pathTable = new Array(this.size);\r\n\t\tthis.costTableID = new Array(this.size);\r\n\t\tthis.pathTableID = new Array(this.size);\r\n\t\tthis.pathIndexXID = new Array(this.size);\r\n\t\tthis.pathIndexYID = new Array(this.size);\r\n\t\tthis.costIndexXID = new Array(this.size);\r\n\t\tthis.costIndexYID = new Array(this.size);\r\n\r\n\t\tthis.node1ID = this.nextIndex++;\r\n\t\tthis.node2ID = this.nextIndex++;\r\n\t\tthis.node3ID = this.nextIndex++;\r\n\r\n\t\tlet i;\r\n\t\tfor (i = 0; i < this.size; i++) {\r\n\t\t\tthis.costTable[i] = new Array(this.size);\r\n\t\t\tthis.pathTable[i] = new Array(this.size);\r\n\t\t\tthis.costTableID[i] = new Array(this.size);\r\n\t\t\tthis.pathTableID[i] = new Array(this.size);\r\n\t\t}\r\n\r\n\t\tconst costTableHeader = this.nextIndex++;\r\n\t\tconst pathTableHeader = this.nextIndex++;\r\n\r\n\t\tthis.cmd(\r\n\t\t\t'CreateLabel',\r\n\t\t\tcostTableHeader,\r\n\t\t\t'Cost Table',\r\n\t\t\tthis.cost_table_start_x,\r\n\t\t\tthis.cost_table_start_y - 2 * this.cost_table_height,\r\n\t\t\t0\r\n\t\t);\r\n\t\tthis.cmd(\r\n\t\t\t'CreateLabel',\r\n\t\t\tpathTableHeader,\r\n\t\t\t'Path Table',\r\n\t\t\tthis.path_table_start_x,\r\n\t\t\tthis.path_table_start_y - 2 * this.path_table_height,\r\n\t\t\t0\r\n\t\t);\r\n\r\n\t\tfor (i = 0; i < this.size; i++) {\r\n\t\t\tthis.pathIndexXID[i] = this.nextIndex++;\r\n\t\t\tthis.pathIndexYID[i] = this.nextIndex++;\r\n\t\t\tthis.costIndexXID[i] = this.nextIndex++;\r\n\t\t\tthis.costIndexYID[i] = this.nextIndex++;\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'CreateLabel',\r\n\t\t\t\tthis.pathIndexXID[i],\r\n\t\t\t\ti,\r\n\t\t\t\tthis.path_table_start_x + i * this.path_table_width,\r\n\t\t\t\tthis.path_table_start_y - this.path_table_height\r\n\t\t\t);\r\n\t\t\tthis.cmd('SetTextColor', this.pathIndexXID[i], '#0000FF');\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'CreateLabel',\r\n\t\t\t\tthis.pathIndexYID[i],\r\n\t\t\t\ti,\r\n\t\t\t\tthis.path_table_start_x - this.path_table_width,\r\n\t\t\t\tthis.path_table_start_y + i * this.path_table_height\r\n\t\t\t);\r\n\t\t\tthis.cmd('SetTextColor', this.pathIndexYID[i], '#0000FF');\r\n\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'CreateLabel',\r\n\t\t\t\tthis.costIndexXID[i],\r\n\t\t\t\ti,\r\n\t\t\t\tthis.cost_table_start_x + i * this.cost_table_width,\r\n\t\t\t\tthis.cost_table_start_y - this.cost_table_height\r\n\t\t\t);\r\n\t\t\tthis.cmd('SetTextColor', this.costIndexXID[i], '#0000FF');\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'CreateLabel',\r\n\t\t\t\tthis.costIndexYID[i],\r\n\t\t\t\ti,\r\n\t\t\t\tthis.cost_table_start_x - this.cost_table_width,\r\n\t\t\t\tthis.cost_table_start_y + i * this.cost_table_height\r\n\t\t\t);\r\n\t\t\tthis.cmd('SetTextColor', this.costIndexYID[i], '#0000FF');\r\n\t\t\tfor (let j = 0; j < this.size; j++) {\r\n\t\t\t\tthis.costTable[i][j] = this.adj_matrix[i][j];\r\n\t\t\t\tif (this.costTable[i][j] >= 0) {\r\n\t\t\t\t\tthis.pathTable[i][j] = i;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.pathTable[i][j] = -1;\r\n\t\t\t\t}\r\n\t\t\t\tthis.costTableID[i][j] = this.nextIndex++;\r\n\t\t\t\tthis.pathTableID[i][j] = this.nextIndex++;\r\n\t\t\t\tthis.cmd(\r\n\t\t\t\t\t'CreateRectangle',\r\n\t\t\t\t\tthis.costTableID[i][j],\r\n\t\t\t\t\tthis.getCostLabel(this.costTable[i][j], true),\r\n\t\t\t\t\tthis.cost_table_width,\r\n\t\t\t\t\tthis.cost_table_height,\r\n\t\t\t\t\tthis.cost_table_start_x + j * this.cost_table_width,\r\n\t\t\t\t\tthis.cost_table_start_y + i * this.cost_table_height\r\n\t\t\t\t);\r\n\t\t\t\tthis.cmd(\r\n\t\t\t\t\t'CreateRectangle',\r\n\t\t\t\t\tthis.pathTableID[i][j],\r\n\t\t\t\t\tthis.pathTable[i][j],\r\n\t\t\t\t\tthis.path_table_width,\r\n\t\t\t\t\tthis.path_table_height,\r\n\t\t\t\t\tthis.path_table_start_x + j * this.path_table_width,\r\n\t\t\t\t\tthis.path_table_start_y + i * this.path_table_height\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.animationManager.StartNewAnimation(this.commands);\r\n\t\tthis.animationManager.skipForward();\r\n\t\tthis.animationManager.clearHistory();\r\n\t\tif (this.size === LARGE_SIZE) {\r\n\t\t\tthis.animationManager.setAllLayers([0]);\r\n\t\t}\r\n\t}\r\n\r\n\tstartCallback() {\r\n\t\tthis.implementAction(this.doFloydWarshall.bind(this), '');\r\n\t}\r\n\r\n\tdoFloydWarshall() {\r\n\t\tthis.commands = [];\r\n\r\n\t\tconst oldIndex = this.nextIndex;\r\n\t\tconst messageID = this.nextIndex++;\r\n\t\tconst moveLabel1ID = this.nextIndex++;\r\n\t\tconst moveLabel2ID = this.nextIndex++;\r\n\r\n\t\tthis.cmd('CreateCircle', this.node1ID, '', this.node_1_x_pos, this.node_1_y_pos);\r\n\t\tthis.cmd('CreateCircle', this.node2ID, '', this.node_2_x_pos, this.node_2_y_pos);\r\n\t\tthis.cmd('CreateCircle', this.node3ID, '', this.node_3_x_pos, this.node_3_y_pos);\r\n\t\tthis.cmd('CreateLabel', messageID, '', this.message_x, this.message_y, 0);\r\n\r\n\t\tfor (let k = 0; k < this.size; k++) {\r\n\t\t\tfor (let i = 0; i < this.size; i++) {\r\n\t\t\t\tfor (let j = 0; j < this.size; j++) {\r\n\t\t\t\t\tif (i !== j && j !== k && i !== k) {\r\n\t\t\t\t\t\tthis.cmd('SetText', this.node1ID, i);\r\n\t\t\t\t\t\tthis.cmd('SetText', this.node2ID, k);\r\n\t\t\t\t\t\tthis.cmd('SetText', this.node3ID, j);\r\n\t\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t\t'Connect',\r\n\t\t\t\t\t\t\tthis.node1ID,\r\n\t\t\t\t\t\t\tthis.node2ID,\r\n\t\t\t\t\t\t\t'#009999',\r\n\t\t\t\t\t\t\t-0.1,\r\n\t\t\t\t\t\t\t1,\r\n\t\t\t\t\t\t\tthis.getCostLabel(this.costTable[i][k], true)\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t\t'Connect',\r\n\t\t\t\t\t\t\tthis.node2ID,\r\n\t\t\t\t\t\t\tthis.node3ID,\r\n\t\t\t\t\t\t\t'#9900CC',\r\n\t\t\t\t\t\t\t-0.1,\r\n\t\t\t\t\t\t\t1,\r\n\t\t\t\t\t\t\tthis.getCostLabel(this.costTable[k][j], true)\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t\t'Connect',\r\n\t\t\t\t\t\t\tthis.node1ID,\r\n\t\t\t\t\t\t\tthis.node3ID,\r\n\t\t\t\t\t\t\t'#CC0000',\r\n\t\t\t\t\t\t\t0,\r\n\t\t\t\t\t\t\t1,\r\n\t\t\t\t\t\t\tthis.getCostLabel(this.costTable[i][j], true)\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t\tthis.cmd('SetHighlight', this.costTableID[i][k], 1);\r\n\t\t\t\t\t\tthis.cmd('SetHighlight', this.costTableID[k][j], 1);\r\n\t\t\t\t\t\tthis.cmd('SetHighlight', this.costTableID[i][j], 1);\r\n\t\t\t\t\t\tthis.cmd('SetTextColor', this.costTableID[i][k], '#009999');\r\n\t\t\t\t\t\tthis.cmd('SetTextColor', this.costTableID[k][j], '#9900CC');\r\n\t\t\t\t\t\tthis.cmd('SetTextColor', this.costTableID[i][j], '#CC0000');\r\n\t\t\t\t\t\tif (this.costTable[i][k] >= 0 && this.costTable[k][j] >= 0) {\r\n\t\t\t\t\t\t\tif (\r\n\t\t\t\t\t\t\t\tthis.costTable[i][j] < 0 ||\r\n\t\t\t\t\t\t\t\tthis.costTable[i][k] + this.costTable[k][j] < this.costTable[i][j]\r\n\t\t\t\t\t\t\t) {\r\n\t\t\t\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t\t\t\t'SetText',\r\n\t\t\t\t\t\t\t\t\tmessageID,\r\n\t\t\t\t\t\t\t\t\tthis.getCostLabel(this.costTable[i][k], true) +\r\n\t\t\t\t\t\t\t\t\t\t' + ' +\r\n\t\t\t\t\t\t\t\t\t\tthis.getCostLabel(this.costTable[k][j], true) +\r\n\t\t\t\t\t\t\t\t\t\t' < ' +\r\n\t\t\t\t\t\t\t\t\t\tthis.getCostLabel(this.costTable[i][j], true)\r\n\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\tthis.cmd('Step');\r\n\t\t\t\t\t\t\t\tthis.costTable[i][j] = this.costTable[i][k] + this.costTable[k][j];\r\n\t\t\t\t\t\t\t\tthis.cmd('SetText', this.pathTableID[i][j], '');\r\n\t\t\t\t\t\t\t\tthis.cmd('SetText', this.costTableID[i][j], '');\r\n\t\t\t\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t\t\t\t'CreateLabel',\r\n\t\t\t\t\t\t\t\t\tmoveLabel1ID,\r\n\t\t\t\t\t\t\t\t\tthis.pathTable[k][j],\r\n\t\t\t\t\t\t\t\t\tthis.path_table_start_x + j * this.path_table_width,\r\n\t\t\t\t\t\t\t\t\tthis.path_table_start_y + k * this.path_table_height\r\n\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t\t\t\t'Move',\r\n\t\t\t\t\t\t\t\t\tmoveLabel1ID,\r\n\t\t\t\t\t\t\t\t\tthis.path_table_start_x + j * this.path_table_width,\r\n\t\t\t\t\t\t\t\t\tthis.path_table_start_y + i * this.path_table_height\r\n\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t\t\t\t'CreateLabel',\r\n\t\t\t\t\t\t\t\t\tmoveLabel2ID,\r\n\t\t\t\t\t\t\t\t\tthis.costTable[i][j],\r\n\t\t\t\t\t\t\t\t\tthis.message_x,\r\n\t\t\t\t\t\t\t\t\tthis.message_y\r\n\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\tthis.cmd('SetHighlight', moveLabel2ID, 1);\r\n\t\t\t\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t\t\t\t'Move',\r\n\t\t\t\t\t\t\t\t\tmoveLabel2ID,\r\n\t\t\t\t\t\t\t\t\tthis.cost_table_start_x + j * this.cost_table_width,\r\n\t\t\t\t\t\t\t\t\tthis.cost_table_start_y + i * this.cost_table_height\r\n\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\tthis.pathTable[i][j] = this.pathTable[k][j];\r\n\t\t\t\t\t\t\t\tthis.cmd('Step');\r\n\t\t\t\t\t\t\t\tthis.cmd('SetText', this.costTableID[i][j], this.costTable[i][j]);\r\n\t\t\t\t\t\t\t\tthis.cmd('SetText', this.pathTableID[i][j], this.pathTable[i][j]);\r\n\t\t\t\t\t\t\t\tthis.cmd('Delete', moveLabel1ID);\r\n\t\t\t\t\t\t\t\tthis.cmd('Delete', moveLabel2ID);\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t\t\t\t'SetText',\r\n\t\t\t\t\t\t\t\t\tmessageID,\r\n\t\t\t\t\t\t\t\t\t'!(' +\r\n\t\t\t\t\t\t\t\t\t\tthis.getCostLabel(this.costTable[i][k], true) +\r\n\t\t\t\t\t\t\t\t\t\t' + ' +\r\n\t\t\t\t\t\t\t\t\t\tthis.getCostLabel(this.costTable[k][j], true) +\r\n\t\t\t\t\t\t\t\t\t\t' < ' +\r\n\t\t\t\t\t\t\t\t\t\tthis.getCostLabel(this.costTable[i][j], true) +\r\n\t\t\t\t\t\t\t\t\t\t')'\r\n\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\tthis.cmd('Step');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t\t\t'SetText',\r\n\t\t\t\t\t\t\t\tmessageID,\r\n\t\t\t\t\t\t\t\t'!(' +\r\n\t\t\t\t\t\t\t\t\tthis.getCostLabel(this.costTable[i][k], true) +\r\n\t\t\t\t\t\t\t\t\t' + ' +\r\n\t\t\t\t\t\t\t\t\tthis.getCostLabel(this.costTable[k][j], true) +\r\n\t\t\t\t\t\t\t\t\t' < ' +\r\n\t\t\t\t\t\t\t\t\tthis.getCostLabel(this.costTable[i][j], true) +\r\n\t\t\t\t\t\t\t\t\t')'\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\tthis.cmd('Step');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tthis.cmd('SetTextColor', this.costTableID[i][k], '#000000');\r\n\t\t\t\t\t\tthis.cmd('SetTextColor', this.costTableID[k][j], '#000000');\r\n\t\t\t\t\t\tthis.cmd('SetTextColor', this.costTableID[i][j], '#000000');\r\n\t\t\t\t\t\tthis.cmd('Disconnect', this.node1ID, this.node2ID);\r\n\t\t\t\t\t\tthis.cmd('Disconnect', this.node2ID, this.node3ID);\r\n\t\t\t\t\t\tthis.cmd('Disconnect', this.node1ID, this.node3ID);\r\n\t\t\t\t\t\tthis.cmd('SetHighlight', this.costTableID[i][k], 0);\r\n\t\t\t\t\t\tthis.cmd('SetHighlight', this.costTableID[k][j], 0);\r\n\t\t\t\t\t\tthis.cmd('SetHighlight', this.costTableID[i][j], 0);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.cmd('Delete', this.node1ID);\r\n\t\tthis.cmd('Delete', this.node2ID);\r\n\t\tthis.cmd('Delete', this.node3ID);\r\n\t\tthis.cmd('Delete', messageID);\r\n\t\tthis.nextIndex = oldIndex;\r\n\r\n\t\treturn this.commands;\r\n\t}\r\n\r\n\tenableUI(event) {\r\n\t\tthis.startButton.disabled = false;\r\n\t\tsuper.enableUI(event);\r\n\t}\r\n\r\n\tdisableUI(event) {\r\n\t\tthis.startButton.disabled = true;\r\n\t\tsuper.disableUI(event);\r\n\t}\r\n}\r\n\r\nFloyd.SMALL_COST_TABLE_WIDTH = 30;\r\nFloyd.SMALL_COST_TABLE_HEIGHT = 30;\r\nFloyd.SMALL_COST_TABLE_START_X = 40;\r\nFloyd.SMALL_COST_TABLE_START_Y = 70;\r\n\r\nFloyd.SMALL_PATH_TABLE_WIDTH = 30;\r\nFloyd.SMALL_PATH_TABLE_HEIGHT = 30;\r\nFloyd.SMALL_PATH_TABLE_START_X = 330;\r\nFloyd.SMALL_PATH_TABLE_START_Y = 70;\r\n\r\nFloyd.SMALL_NODE_1_X_POS = 50;\r\nFloyd.SMALL_NODE_1_Y_POS = 400;\r\nFloyd.SMALL_NODE_2_X_POS = 150;\r\nFloyd.SMALL_NODE_2_Y_POS = 350;\r\nFloyd.SMALL_NODE_3_X_POS = 250;\r\nFloyd.SMALL_NODE_3_Y_POS = 400;\r\n\r\nFloyd.SMALL_MESSAGE_X = 400;\r\nFloyd.SMALL_MESSAGE_Y = 350;\r\n\r\nFloyd.LARGE_COST_TABLE_WIDTH = 20;\r\nFloyd.LARGE_COST_TABLE_HEIGHT = 20;\r\nFloyd.LARGE_COST_TABLE_START_X = 40;\r\nFloyd.LARGE_COST_TABLE_START_Y = 50;\r\n\r\nFloyd.LARGE_PATH_TABLE_WIDTH = 20;\r\nFloyd.LARGE_PATH_TABLE_HEIGHT = 20;\r\nFloyd.LARGE_PATH_TABLE_START_X = 500;\r\nFloyd.LARGE_PATH_TABLE_START_Y = 50;\r\n\r\nFloyd.LARGE_NODE_1_X_POS = 50;\r\nFloyd.LARGE_NODE_1_Y_POS = 500;\r\nFloyd.LARGE_NODE_2_X_POS = 150;\r\nFloyd.LARGE_NODE_2_Y_POS = 450;\r\nFloyd.LARGE_NODE_3_X_POS = 250;\r\nFloyd.LARGE_NODE_3_Y_POS = 500;\r\n\r\nFloyd.LARGE_MESSAGE_X = 300;\r\nFloyd.LARGE_MESSAGE_Y = 450;\r\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\r\n//\r\n// Redistribution and use in source and binary forms, with or without modification, are\r\n// permitted provided that the following conditions are met:\r\n//\r\n// 1. Redistributions of source code must retain the above copyright notice, this list of\r\n// conditions and the following disclaimer.\r\n//\r\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\r\n// of conditions and the following disclaimer in the documentation and/or other materials\r\n// provided with the distribution.\r\n//\r\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\r\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\r\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\r\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\r\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\r\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\r\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\r\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\r\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\r\n//\r\n// The views and conclusions contained in the software and documentation are those of the\r\n// authors and should not be interpreted as representing official policies, either expressed\r\n// or implied, of the University of San Francisco\r\n\r\nimport Algorithm, { addControlToAlgorithmBar } from './Algorithm.js';\r\n\r\nconst ARRAY_SIZE = 32;\r\nconst ARRAY_ELEM_WIDTH = 30;\r\nconst ARRAY_ELEM_HEIGHT = 25;\r\nconst ARRAY_INITIAL_X = 30;\r\n\r\nconst ARRAY_Y_POS = 50;\r\nconst ARRAY_LABEL_Y_POS = 70;\r\n\r\nexport default class Heap extends Algorithm {\r\n\tconstructor(am) {\r\n\t\tsuper(am);\r\n\r\n\t\tthis.addControls();\r\n\t\tthis.nextIndex = 0;\r\n\t\tthis.HeapXPositions = [\r\n\t\t\t0,\r\n\t\t\t450,\r\n\t\t\t250,\r\n\t\t\t650,\r\n\t\t\t150,\r\n\t\t\t350,\r\n\t\t\t550,\r\n\t\t\t750,\r\n\t\t\t100,\r\n\t\t\t200,\r\n\t\t\t300,\r\n\t\t\t400,\r\n\t\t\t500,\r\n\t\t\t600,\r\n\t\t\t700,\r\n\t\t\t800,\r\n\t\t\t75,\r\n\t\t\t125,\r\n\t\t\t175,\r\n\t\t\t225,\r\n\t\t\t275,\r\n\t\t\t325,\r\n\t\t\t375,\r\n\t\t\t425,\r\n\t\t\t475,\r\n\t\t\t525,\r\n\t\t\t575,\r\n\t\t\t625,\r\n\t\t\t675,\r\n\t\t\t725,\r\n\t\t\t775,\r\n\t\t\t825,\r\n\t\t];\r\n\t\tthis.HeapYPositions = [\r\n\t\t\t0,\r\n\t\t\t100,\r\n\t\t\t170,\r\n\t\t\t170,\r\n\t\t\t240,\r\n\t\t\t240,\r\n\t\t\t240,\r\n\t\t\t240,\r\n\t\t\t310,\r\n\t\t\t310,\r\n\t\t\t310,\r\n\t\t\t310,\r\n\t\t\t310,\r\n\t\t\t310,\r\n\t\t\t310,\r\n\t\t\t310,\r\n\t\t\t380,\r\n\t\t\t380,\r\n\t\t\t380,\r\n\t\t\t380,\r\n\t\t\t380,\r\n\t\t\t380,\r\n\t\t\t380,\r\n\t\t\t380,\r\n\t\t\t380,\r\n\t\t\t380,\r\n\t\t\t380,\r\n\t\t\t380,\r\n\t\t\t380,\r\n\t\t\t380,\r\n\t\t\t380,\r\n\t\t\t380,\r\n\t\t];\r\n\t\tthis.commands = [];\r\n\t\tthis.createArray();\r\n\r\n\t\t/*this.nextIndex = 0;\r\n\tthis.this.commands = [];\r\n\tthis.cmd(\"CreateLabel\", 0, \"\", 20, 50, 0);\r\n\tthis.animationManager.StartNewAnimation(this.this.commands);\r\n\tthis.animationManager.skipForward();\r\n\tthis.animationManager.clearHistory(); */\r\n\t}\r\n\r\n\taddControls() {\r\n\t\tthis.insertField = addControlToAlgorithmBar('Text', '');\r\n\t\tthis.insertField.onkeydown = this.returnSubmit(\r\n\t\t\tthis.insertField,\r\n\t\t\tthis.insertCallback.bind(this),\r\n\t\t\t4,\r\n\t\t\ttrue\r\n\t\t);\r\n\t\tthis.insertButton = addControlToAlgorithmBar('Button', 'Insert');\r\n\t\tthis.insertButton.onclick = this.insertCallback.bind(this);\r\n\t\tthis.removeSmallestButton = addControlToAlgorithmBar('Button', 'Remove Smallest');\r\n\t\tthis.removeSmallestButton.onclick = this.removeSmallestCallback.bind(this);\r\n\t\tthis.clearHeapButton = addControlToAlgorithmBar('Button', 'Clear Heap');\r\n\t\tthis.clearHeapButton.onclick = this.clearCallback.bind(this);\r\n\t\tthis.buildHeapButton = addControlToAlgorithmBar('Button', 'BuildHeap');\r\n\t\tthis.buildHeapButton.onclick = this.buildHeapCallback.bind(this);\r\n\t}\r\n\r\n\tcreateArray() {\r\n\t\tthis.arrayData = new Array(ARRAY_SIZE);\r\n\t\tthis.arrayLabels = new Array(ARRAY_SIZE);\r\n\t\tthis.arrayRects = new Array(ARRAY_SIZE);\r\n\t\tthis.circleObjs = new Array(ARRAY_SIZE);\r\n\t\tthis.ArrayXPositions = new Array(ARRAY_SIZE);\r\n\t\tthis.currentHeapSize = 0;\r\n\r\n\t\tfor (let i = 0; i < ARRAY_SIZE; i++) {\r\n\t\t\tthis.ArrayXPositions[i] = ARRAY_INITIAL_X + i * ARRAY_ELEM_WIDTH;\r\n\t\t\tthis.arrayLabels[i] = this.nextIndex++;\r\n\t\t\tthis.arrayRects[i] = this.nextIndex++;\r\n\t\t\tthis.circleObjs[i] = this.nextIndex++;\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'CreateRectangle',\r\n\t\t\t\tthis.arrayRects[i],\r\n\t\t\t\t'',\r\n\t\t\t\tARRAY_ELEM_WIDTH,\r\n\t\t\t\tARRAY_ELEM_HEIGHT,\r\n\t\t\t\tthis.ArrayXPositions[i],\r\n\t\t\t\tARRAY_Y_POS\r\n\t\t\t);\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'CreateLabel',\r\n\t\t\t\tthis.arrayLabels[i],\r\n\t\t\t\ti,\r\n\t\t\t\tthis.ArrayXPositions[i],\r\n\t\t\t\tARRAY_LABEL_Y_POS\r\n\t\t\t);\r\n\t\t\tthis.cmd('SetForegroundColor', this.arrayLabels[i], '#0000FF');\r\n\t\t}\r\n\t\tthis.cmd('SetText', this.arrayRects[0], '-INF');\r\n\t\tthis.swapLabel1 = this.nextIndex++;\r\n\t\tthis.swapLabel2 = this.nextIndex++;\r\n\t\tthis.swapLabel3 = this.nextIndex++;\r\n\t\tthis.swapLabel4 = this.nextIndex++;\r\n\t\tthis.descriptLabel1 = this.nextIndex++;\r\n\t\tthis.descriptLabel2 = this.nextIndex++;\r\n\t\tthis.cmd('CreateLabel', this.descriptLabel1, '', 20, 10, 0);\r\n\t\t//this.cmd(\"CreateLabel\", this.descriptLabel2, \"\", this.nextIndex, 40, 120, 0);\r\n\t\tthis.animationManager.StartNewAnimation(this.commands);\r\n\t\tthis.animationManager.skipForward();\r\n\t\tthis.animationManager.clearHistory();\r\n\t}\r\n\r\n\tinsertCallback() {\r\n\t\tconst insertedValue = this.normalizeNumber(this.insertField.value, 4);\r\n\t\tif (insertedValue !== '') {\r\n\t\t\tthis.insertField.value = '';\r\n\t\t\tthis.implementAction(this.insertElement.bind(this), insertedValue);\r\n\t\t}\r\n\t}\r\n\r\n\t//TODO:  Make me undoable!!\r\n\tclearCallback() {\r\n\t\tthis.commands = [];\r\n\t\tthis.implementAction(this.clear.bind(this), '');\r\n\t}\r\n\r\n\t//TODO:  Make me undoable!!\r\n\tclear() {\r\n\t\twhile (this.currentHeapSize > 0) {\r\n\t\t\tthis.cmd('Delete', this.circleObjs[this.currentHeapSize]);\r\n\t\t\tthis.cmd('SetText', this.arrayRects[this.currentHeapSize], '');\r\n\t\t\tthis.currentHeapSize--;\r\n\t\t}\r\n\t\treturn this.commands;\r\n\t}\r\n\r\n\treset() {\r\n\t\tthis.currentHeapSize = 0;\r\n\t}\r\n\r\n\tremoveSmallestCallback() {\r\n\t\tthis.implementAction(this.removeSmallest.bind(this), '');\r\n\t}\r\n\r\n\tswap(index1, index2) {\r\n\t\tthis.cmd('SetText', this.arrayRects[index1], '');\r\n\t\tthis.cmd('SetText', this.arrayRects[index2], '');\r\n\t\tthis.cmd('SetText', this.circleObjs[index1], '');\r\n\t\tthis.cmd('SetText', this.circleObjs[index2], '');\r\n\t\tthis.cmd(\r\n\t\t\t'CreateLabel',\r\n\t\t\tthis.swapLabel1,\r\n\t\t\tthis.arrayData[index1],\r\n\t\t\tthis.ArrayXPositions[index1],\r\n\t\t\tARRAY_Y_POS\r\n\t\t);\r\n\t\tthis.cmd(\r\n\t\t\t'CreateLabel',\r\n\t\t\tthis.swapLabel2,\r\n\t\t\tthis.arrayData[index2],\r\n\t\t\tthis.ArrayXPositions[index2],\r\n\t\t\tARRAY_Y_POS\r\n\t\t);\r\n\t\tthis.cmd(\r\n\t\t\t'CreateLabel',\r\n\t\t\tthis.swapLabel3,\r\n\t\t\tthis.arrayData[index1],\r\n\t\t\tthis.HeapXPositions[index1],\r\n\t\t\tthis.HeapYPositions[index1]\r\n\t\t);\r\n\t\tthis.cmd(\r\n\t\t\t'CreateLabel',\r\n\t\t\tthis.swapLabel4,\r\n\t\t\tthis.arrayData[index2],\r\n\t\t\tthis.HeapXPositions[index2],\r\n\t\t\tthis.HeapYPositions[index2]\r\n\t\t);\r\n\t\tthis.cmd('Move', this.swapLabel1, this.ArrayXPositions[index2], ARRAY_Y_POS);\r\n\t\tthis.cmd('Move', this.swapLabel2, this.ArrayXPositions[index1], ARRAY_Y_POS);\r\n\t\tthis.cmd('Move', this.swapLabel3, this.HeapXPositions[index2], this.HeapYPositions[index2]);\r\n\t\tthis.cmd('Move', this.swapLabel4, this.HeapXPositions[index1], this.HeapYPositions[index1]);\r\n\t\tconst tmp = this.arrayData[index1];\r\n\t\tthis.arrayData[index1] = this.arrayData[index2];\r\n\t\tthis.arrayData[index2] = tmp;\r\n\t\tthis.cmd('Step');\r\n\t\tthis.cmd('SetText', this.arrayRects[index1], this.arrayData[index1]);\r\n\t\tthis.cmd('SetText', this.arrayRects[index2], this.arrayData[index2]);\r\n\t\tthis.cmd('SetText', this.circleObjs[index1], this.arrayData[index1]);\r\n\t\tthis.cmd('SetText', this.circleObjs[index2], this.arrayData[index2]);\r\n\t\tthis.cmd('Delete', this.swapLabel1);\r\n\t\tthis.cmd('Delete', this.swapLabel2);\r\n\t\tthis.cmd('Delete', this.swapLabel3);\r\n\t\tthis.cmd('Delete', this.swapLabel4);\r\n\t}\r\n\r\n\tsetIndexHighlight(index, highlightVal) {\r\n\t\tthis.cmd('SetHighlight', this.circleObjs[index], highlightVal);\r\n\t\tthis.cmd('SetHighlight', this.arrayRects[index], highlightVal);\r\n\t}\r\n\r\n\tpushDown(index) {\r\n\t\tlet smallestIndex;\r\n\r\n\t\twhile (index * 2 <= this.currentHeapSize) {\r\n\t\t\tsmallestIndex = 2 * index;\r\n\r\n\t\t\tif (index * 2 + 1 <= this.currentHeapSize) {\r\n\t\t\t\tthis.setIndexHighlight(2 * index, 1);\r\n\t\t\t\tthis.setIndexHighlight(2 * index + 1, 1);\r\n\t\t\t\tthis.cmd('Step');\r\n\t\t\t\tthis.setIndexHighlight(2 * index, 0);\r\n\t\t\t\tthis.setIndexHighlight(2 * index + 1, 0);\r\n\t\t\t\tif (this.arrayData[2 * index + 1] < this.arrayData[2 * index]) {\r\n\t\t\t\t\tsmallestIndex = 2 * index + 1;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.setIndexHighlight(index, 1);\r\n\t\t\tthis.setIndexHighlight(smallestIndex, 1);\r\n\t\t\tthis.cmd('Step');\r\n\t\t\tthis.setIndexHighlight(index, 0);\r\n\t\t\tthis.setIndexHighlight(smallestIndex, 0);\r\n\r\n\t\t\tif (this.arrayData[smallestIndex] < this.arrayData[index]) {\r\n\t\t\t\tthis.swap(smallestIndex, index);\r\n\t\t\t\tindex = smallestIndex;\r\n\t\t\t} else {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tremoveSmallest() {\r\n\t\tthis.commands = [];\r\n\t\tthis.cmd('SetText', this.descriptLabel1, '');\r\n\r\n\t\tif (this.currentHeapSize === 0) {\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'SetText',\r\n\t\t\t\tthis.descriptLabel1,\r\n\t\t\t\t'Heap is empty, cannot remove smallest element'\r\n\t\t\t);\r\n\t\t\treturn this.commands;\r\n\t\t}\r\n\r\n\t\tthis.cmd('SetText', this.descriptLabel1, 'Removing element:');\r\n\t\tthis.cmd(\r\n\t\t\t'CreateLabel',\r\n\t\t\tthis.descriptLabel2,\r\n\t\t\tthis.arrayData[1],\r\n\t\t\tthis.HeapXPositions[1],\r\n\t\t\tthis.HeapYPositions[1],\r\n\t\t\t0\r\n\t\t);\r\n\t\tthis.cmd('SetText', this.circleObjs[1], '');\r\n\t\tthis.cmd('Move', this.descriptLabel2, 120, 40);\r\n\t\tthis.cmd('Step');\r\n\t\tthis.cmd('Delete', this.descriptLabel2);\r\n\t\tthis.cmd('SetText', this.descriptLabel1, 'Removing element: ' + this.arrayData[1]);\r\n\t\tthis.arrayData[1] = '';\r\n\t\tif (this.currentHeapSize > 1) {\r\n\t\t\tthis.cmd('SetText', this.arrayRects[1], '');\r\n\t\t\tthis.cmd('SetText', this.arrayRects[this.currentHeapSize], '');\r\n\t\t\tthis.swap(1, this.currentHeapSize);\r\n\t\t\tthis.cmd('Delete', this.circleObjs[this.currentHeapSize]);\r\n\t\t\tthis.currentHeapSize--;\r\n\t\t\tthis.pushDown(1);\r\n\t\t} else {\r\n\t\t\tthis.cmd('SetText', this.arrayRects[1], '');\r\n\t\t\tthis.cmd('Delete', this.circleObjs[this.currentHeapSize]);\r\n\t\t\tthis.currentHeapSize--;\r\n\t\t}\r\n\t\treturn this.commands;\r\n\t}\r\n\r\n\tbuildHeapCallback() {\r\n\t\tthis.implementAction(this.buildHeap.bind(this), '');\r\n\t}\r\n\r\n\tbuildHeap() {\r\n\t\tthis.commands = [];\r\n\t\tthis.clear();\r\n\t\tfor (let i = 1; i < ARRAY_SIZE; i++) {\r\n\t\t\tthis.arrayData[i] = this.normalizeNumber(String(ARRAY_SIZE - i), 4);\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'CreateCircle',\r\n\t\t\t\tthis.circleObjs[i],\r\n\t\t\t\tthis.arrayData[i],\r\n\t\t\t\tthis.HeapXPositions[i],\r\n\t\t\t\tthis.HeapYPositions[i]\r\n\t\t\t);\r\n\t\t\tthis.cmd('SetText', this.arrayRects[i], this.arrayData[i]);\r\n\t\t\tif (i > 1) {\r\n\t\t\t\tthis.cmd('Connect', this.circleObjs[Math.floor(i / 2)], this.circleObjs[i]);\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.cmd('Step');\r\n\t\tthis.currentHeapSize = ARRAY_SIZE - 1;\r\n\t\tlet nextElem = this.currentHeapSize;\r\n\t\twhile (nextElem > 0) {\r\n\t\t\tthis.pushDown(nextElem);\r\n\t\t\tnextElem = nextElem - 1;\r\n\t\t}\r\n\t\treturn this.commands;\r\n\t}\r\n\r\n\tinsertElement(insertedValue) {\r\n\t\tthis.commands = [];\r\n\r\n\t\tif (this.currentHeapSize >= ARRAY_SIZE - 1) {\r\n\t\t\tthis.cmd('SetText', this.descriptLabel1, 'Heap Full!');\r\n\t\t\treturn this.commands;\r\n\t\t}\r\n\r\n\t\tthis.cmd('SetText', this.descriptLabel1, 'Inserting Element: ' + insertedValue);\r\n\t\tthis.cmd('Step');\r\n\t\tthis.cmd('SetText', this.descriptLabel1, 'Inserting Element: ');\r\n\t\tthis.currentHeapSize++;\r\n\t\tthis.arrayData[this.currentHeapSize] = insertedValue;\r\n\t\tthis.cmd(\r\n\t\t\t'CreateCircle',\r\n\t\t\tthis.circleObjs[this.currentHeapSize],\r\n\t\t\t'',\r\n\t\t\tthis.HeapXPositions[this.currentHeapSize],\r\n\t\t\tthis.HeapYPositions[this.currentHeapSize]\r\n\t\t);\r\n\t\tthis.cmd('CreateLabel', this.descriptLabel2, insertedValue, 120, 45, 1);\r\n\t\tif (this.currentHeapSize > 1) {\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'Connect',\r\n\t\t\t\tthis.circleObjs[Math.floor(this.currentHeapSize / 2)],\r\n\t\t\t\tthis.circleObjs[this.currentHeapSize]\r\n\t\t\t);\r\n\t\t}\r\n\r\n\t\tthis.cmd(\r\n\t\t\t'Move',\r\n\t\t\tthis.descriptLabel2,\r\n\t\t\tthis.HeapXPositions[this.currentHeapSize],\r\n\t\t\tthis.HeapYPositions[this.currentHeapSize]\r\n\t\t);\r\n\t\tthis.cmd('Step');\r\n\t\tthis.cmd('SetText', this.circleObjs[this.currentHeapSize], insertedValue);\r\n\t\tthis.cmd('delete', this.descriptLabel2);\r\n\t\tthis.cmd('SetText', this.arrayRects[this.currentHeapSize], insertedValue);\r\n\r\n\t\tlet currentIndex = this.currentHeapSize;\r\n\t\tlet parentIndex = Math.floor(currentIndex / 2);\r\n\r\n\t\tif (currentIndex > 1) {\r\n\t\t\tthis.setIndexHighlight(currentIndex, 1);\r\n\t\t\tthis.setIndexHighlight(parentIndex, 1);\r\n\t\t\tthis.cmd('Step');\r\n\t\t\tthis.setIndexHighlight(currentIndex, 0);\r\n\t\t\tthis.setIndexHighlight(parentIndex, 0);\r\n\t\t}\r\n\r\n\t\twhile (currentIndex > 1 && this.arrayData[currentIndex] < this.arrayData[parentIndex]) {\r\n\t\t\tthis.swap(currentIndex, parentIndex);\r\n\t\t\tcurrentIndex = parentIndex;\r\n\t\t\tparentIndex = Math.floor(parentIndex / 2);\r\n\t\t\tif (currentIndex > 1) {\r\n\t\t\t\tthis.setIndexHighlight(currentIndex, 1);\r\n\t\t\t\tthis.setIndexHighlight(parentIndex, 1);\r\n\t\t\t\tthis.cmd('Step');\r\n\t\t\t\tthis.setIndexHighlight(currentIndex, 0);\r\n\t\t\t\tthis.setIndexHighlight(parentIndex, 0);\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.cmd('SetText', this.descriptLabel1, '');\r\n\r\n\t\treturn this.commands;\r\n\t}\r\n\r\n\tdisableUI() {\r\n\t\tthis.insertField.disabled = true;\r\n\t\tthis.insertButton.disabled = true;\r\n\t\tthis.removeSmallestButton.disabled = true;\r\n\t\tthis.clearHeapButton.disabled = true;\r\n\t\tthis.buildHeapButton.disabled = true;\r\n\t}\r\n\r\n\tenableUI() {\r\n\t\tthis.insertField.disabled = false;\r\n\t\tthis.insertButton.disabled = false;\r\n\t\tthis.removeSmallestButton.disabled = false;\r\n\t\tthis.clearHeapButton.disabled = false;\r\n\t\tthis.buildHeapButton.disabled = false;\r\n\t}\r\n}\r\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\r\n//\r\n// Redistribution and use in source and binary forms, with or without modification, are\r\n// permitted provided that the following conditions are met:\r\n//\r\n// 1. Redistributions of source code must retain the above copyright notice, this list of\r\n// conditions and the following disclaimer.\r\n//\r\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\r\n// of conditions and the following disclaimer in the documentation and/or other materials\r\n// provided with the distribution.\r\n//\r\n// THIS SOFTWARE IS PROVIDED BY David Galles ``AS IS'' AND ANY EXPRESS OR IMPLIED\r\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\r\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\r\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\r\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\r\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\r\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\r\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\r\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\r\n//\r\n// The views and conclusions contained in the software and documentation are those of the\r\n// authors and should not be interpreted as representing official policies, either expressed\r\n// or implied, of the University of San Francisco\r\n\r\nimport Algorithm, { addControlToAlgorithmBar, addLabelToAlgorithmBar } from './Algorithm.js';\r\n\r\nconst ARRAY_START_X = 100;\r\nconst ARRAY_START_Y = 200;\r\nconst ARRAY_ELEM_WIDTH = 50;\r\nconst ARRAY_ELEM_HEIGHT = 50;\r\n\r\n// const ARRRAY_ELEMS_PER_LINE = 15;\r\n// const ARRAY_LINE_SPACING = 130;\r\n\r\n// const TOP_POS_X = 180;\r\n// const TOP_POS_Y = 100;\r\n// const TOP_LABEL_X = 130;\r\n// const TOP_LABEL_Y = 100;\r\n\r\n// const PUSH_LABEL_X = 50;\r\n// const PUSH_LABEL_Y = 30;\r\n// const PUSH_ELEMENT_X = 120;\r\n// const PUSH_ELEMENT_Y = 30;\r\n\r\n// const SIZE = 10;\r\n\r\nexport default class InsertionSort extends Algorithm {\r\n\tconstructor(am, w, h) {\r\n\t\tsuper(am, w, h);\r\n\r\n\t\tthis.addControls();\r\n\r\n\t\t// Useful for memory management\r\n\t\tthis.nextIndex = 0;\r\n\r\n\t\t// TODO:  Add any code necessary to set up your own algorithm.  Initialize data\r\n\t\t// structures, etc.\r\n\t\tthis.setup();\r\n\t}\r\n\r\n\taddControls() {\r\n\t\tthis.controls = [];\r\n\r\n\t\taddLabelToAlgorithmBar('Comma seperated list (e.g. \"3,1,2\", max 18 elements)');\r\n\r\n\t\t// List text field\r\n\t\tthis.listField = addControlToAlgorithmBar('Text', '');\r\n\t\tthis.listField.onkeydown = this.returnSubmit(\r\n\t\t\tthis.listField,\r\n\t\t\tthis.sortCallback.bind(this),\r\n\t\t\t60,\r\n\t\t\tfalse\r\n\t\t);\r\n\t\tthis.controls.push(this.listField);\r\n\r\n\t\t// Sort button\r\n\t\tthis.findButton = addControlToAlgorithmBar('Button', 'Sort');\r\n\t\tthis.findButton.onclick = this.sortCallback.bind(this);\r\n\t\tthis.controls.push(this.findButton);\r\n\r\n\t\t// Clear button\r\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear');\r\n\t\tthis.clearButton.onclick = this.clearCallback.bind(this);\r\n\t\tthis.controls.push(this.clearButton);\r\n\t}\r\n\r\n\tsetup() {\r\n\t\tthis.arrayData = [];\r\n\t\tthis.arrayID = [];\r\n\t\tthis.displayData = [];\r\n\t\tthis.iPointerID = this.nextIndex++;\r\n\t\tthis.jPointerID = this.nextIndex++;\r\n\t}\r\n\r\n\treset() {\r\n\t\t// Reset all of your data structures to *exactly* the state they have immediately after the init\r\n\t\t// function is called.  This method is called whenever an \"undo\" is performed.  Your data\r\n\t\t// structures are completely cleaned, and then all of the actions *up to but not including* the\r\n\t\t// last action are then redone.  If you implement all of your actions through the \"implementAction\"\r\n\t\t// method below, then all of this work is done for you in the Animation \"superexport default class\"\r\n\r\n\t\t// Reset the (very simple) memory manager\r\n\t\tthis.nextIndex = 0;\r\n\t}\r\n\r\n\tsortCallback() {\r\n\t\tif (this.listField.value !== '') {\r\n\t\t\tthis.implementAction(this.clear.bind(this), '');\r\n\t\t\tconst list = this.listField.value;\r\n\t\t\tthis.listField.value = '';\r\n\t\t\tthis.implementAction(this.sort.bind(this), list);\r\n\t\t}\r\n\t}\r\n\r\n\tclearCallback() {\r\n\t\tthis.implementAction(this.clear.bind(this), '');\r\n\t}\r\n\r\n\tclear() {\r\n\t\tthis.commands = [];\r\n\t\tfor (let i = 0; i < this.arrayID.length; i++) {\r\n\t\t\tthis.cmd('Delete', this.arrayID[i]);\r\n\t\t}\r\n\t\tthis.arrayData = [];\r\n\t\tthis.arrayID = [];\r\n\t\tthis.displayData = [];\r\n\t\treturn this.commands;\r\n\t}\r\n\r\n\tsort(params) {\r\n\t\tthis.commands = [];\r\n\r\n\t\tthis.arrayID = [];\r\n\t\tthis.arrayData = params\r\n\t\t\t.split(',')\r\n\t\t\t.map(Number)\r\n\t\t\t.filter(x => x)\r\n\t\t\t.slice(0, 18);\r\n\t\tthis.displayData = new Array(this.arrayData.length);\r\n\t\tconst length = this.arrayData.length;\r\n\t\tconst elemCounts = new Map();\r\n\t\tconst letterMap = new Map();\r\n\r\n\t\tfor (let i = 0; i < length; i++) {\r\n\t\t\tconst count = elemCounts.has(this.arrayData[i]) ? elemCounts.get(this.arrayData[i]) : 0;\r\n\t\t\tif (count > 0) {\r\n\t\t\t\tletterMap.set(this.arrayData[i], 'A');\r\n\t\t\t}\r\n\t\t\telemCounts.set(this.arrayData[i], count + 1);\r\n\t\t}\r\n\r\n\t\tfor (let i = 0; i < length; i++) {\r\n\t\t\tthis.arrayID[i] = this.nextIndex++;\r\n\t\t\tconst xpos = i * ARRAY_ELEM_WIDTH + ARRAY_START_X;\r\n\t\t\tconst ypos = ARRAY_START_Y;\r\n\r\n\t\t\tlet displayData = this.arrayData[i].toString();\r\n\t\t\tif (letterMap.has(this.arrayData[i])) {\r\n\t\t\t\tconst currChar = letterMap.get(this.arrayData[i]);\r\n\t\t\t\tdisplayData += currChar;\r\n\t\t\t\tletterMap.set(this.arrayData[i], String.fromCharCode(currChar.charCodeAt(0) + 1));\r\n\t\t\t}\r\n\t\t\tthis.displayData[i] = displayData;\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'CreateRectangle',\r\n\t\t\t\tthis.arrayID[i],\r\n\t\t\t\tdisplayData,\r\n\t\t\t\tARRAY_ELEM_WIDTH,\r\n\t\t\t\tARRAY_ELEM_HEIGHT,\r\n\t\t\t\txpos,\r\n\t\t\t\typos\r\n\t\t\t);\r\n\t\t}\r\n\t\tthis.cmd('CreateHighlightCircle', this.iPointerID, '#0000FF', ARRAY_START_X, ARRAY_START_Y);\r\n\t\tthis.cmd('SetHighlight', this.iPointerID, 1);\r\n\t\tthis.cmd(\r\n\t\t\t'CreateHighlightCircle',\r\n\t\t\tthis.jPointerID,\r\n\t\t\t'#0000FF',\r\n\t\t\tARRAY_START_X + ARRAY_ELEM_WIDTH,\r\n\t\t\tARRAY_START_Y\r\n\t\t);\r\n\t\tthis.cmd('SetHighlight', this.jPointerID, 1);\r\n\t\tthis.cmd('Step');\r\n\r\n\t\tfor (let i = 1; i < this.arrayData.length; i++) {\r\n\t\t\tfor (let j = i; j >= 1; j--) {\r\n\t\t\t\tthis.movePointers(j - 1, j);\r\n\t\t\t\tif (this.arrayData[j] < this.arrayData[j - 1]) {\r\n\t\t\t\t\tthis.swap(j, j - 1);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (i === 1) this.cmd('SetBackgroundColor', this.arrayID[0], '#2ECC71');\r\n\t\t\tthis.cmd('SetBackgroundColor', this.arrayID[i], '#2ECC71');\r\n\t\t\tthis.cmd('Step');\r\n\t\t}\r\n\r\n\t\tthis.cmd('Delete', this.iPointerID);\r\n\t\tthis.cmd('Delete', this.jPointerID);\r\n\t\tthis.cmd('Step');\r\n\r\n\t\treturn this.commands;\r\n\t}\r\n\r\n\tmovePointers(i, j) {\r\n\t\tconst iXPos = i * ARRAY_ELEM_WIDTH + ARRAY_START_X;\r\n\t\tconst iYPos = ARRAY_START_Y;\r\n\t\tthis.cmd('Move', this.iPointerID, iXPos, iYPos);\r\n\t\tconst jXPos = j * ARRAY_ELEM_WIDTH + ARRAY_START_X;\r\n\t\tconst jYPos = ARRAY_START_Y;\r\n\t\tthis.cmd('Move', this.jPointerID, jXPos, jYPos);\r\n\t\tthis.cmd('Step');\r\n\t}\r\n\r\n\tswap(i, j) {\r\n\t\tthis.cmd('SetForegroundColor', this.iPointerID, '#FF0000');\r\n\t\tthis.cmd('SetForegroundColor', this.jPointerID, '#FF0000');\r\n\t\tconst iLabelID = this.nextIndex++;\r\n\t\tconst iXPos = i * ARRAY_ELEM_WIDTH + ARRAY_START_X;\r\n\t\tconst iYPos = ARRAY_START_Y;\r\n\t\tthis.cmd('CreateLabel', iLabelID, this.displayData[i], iXPos, iYPos);\r\n\t\tconst jLabelID = this.nextIndex++;\r\n\t\tconst jXPos = j * ARRAY_ELEM_WIDTH + ARRAY_START_X;\r\n\t\tconst jYPos = ARRAY_START_Y;\r\n\t\tthis.cmd('CreateLabel', jLabelID, this.displayData[j], jXPos, jYPos);\r\n\t\tthis.cmd('Settext', this.arrayID[i], '');\r\n\t\tthis.cmd('Settext', this.arrayID[j], '');\r\n\t\tthis.cmd('Move', iLabelID, jXPos, jYPos);\r\n\t\tthis.cmd('Move', jLabelID, iXPos, iYPos);\r\n\t\tthis.cmd('Step');\r\n\t\tthis.cmd('Settext', this.arrayID[i], this.displayData[j]);\r\n\t\tthis.cmd('Settext', this.arrayID[j], this.displayData[i]);\r\n\t\tthis.cmd('Delete', iLabelID);\r\n\t\tthis.cmd('Delete', jLabelID);\r\n\r\n\t\t// Swap data in backend array\r\n\t\tlet temp = this.arrayData[i];\r\n\t\tthis.arrayData[i] = this.arrayData[j];\r\n\t\tthis.arrayData[j] = temp;\r\n\r\n\t\t// Swap data in display array\r\n\t\ttemp = this.displayData[i];\r\n\t\tthis.displayData[i] = this.displayData[j];\r\n\t\tthis.displayData[j] = temp;\r\n\r\n\t\tthis.cmd('SetForegroundColor', this.iPointerID, '#0000FF');\r\n\t\tthis.cmd('SetForegroundColor', this.jPointerID, '#0000FF');\r\n\t\tthis.cmd('Step');\r\n\t}\r\n\r\n\t// Called by our superexport default class when we get an animation started event -- need to wait for the\r\n\t// event to finish before we start doing anything\r\n\tdisableUI() {\r\n\t\tfor (let i = 0; i < this.controls.length; i++) {\r\n\t\t\tthis.controls[i].disabled = true;\r\n\t\t}\r\n\t}\r\n\r\n\t// Called by our superexport default class when we get an animation completed event -- we can\r\n\t/// now interact again.\r\n\tenableUI() {\r\n\t\tfor (let i = 0; i < this.controls.length; i++) {\r\n\t\t\tthis.controls[i].disabled = false;\r\n\t\t}\r\n\t}\r\n}\r\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\r\n//\r\n// Redistribution and use in source and binary forms, with or without modification, are\r\n// permitted provided that the following conditions are met:\r\n//\r\n// 1. Redistributions of source code must retain the above copyright notice, this list of\r\n// conditions and the following disclaimer.\r\n//\r\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\r\n// of conditions and the following disclaimer in the documentation and/or other materials\r\n// provided with the distribution.\r\n//\r\n// THIS SOFTWARE IS PROVIDED BY David Galles ``AS IS'' AND ANY EXPRESS OR IMPLIED\r\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\r\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\r\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\r\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\r\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\r\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\r\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\r\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\r\n//\r\n// The views and conclusions contained in the software and documentation are those of the\r\n// authors and should not be interpreted as representing official policies, either expressed\r\n// or implied, of the University of San Francisco\r\n\r\nimport Algorithm, { addControlToAlgorithmBar, addLabelToAlgorithmBar } from './Algorithm.js';\r\n\r\nconst ARRAY_START_X = 100;\r\nconst ARRAY_START_Y = 30;\r\n\r\nconst MAX_LENGTH = 22;\r\n\r\nconst FAILURE_TABLE_START_Y = 100;\r\n\r\nexport default class KMP extends Algorithm {\r\n\tconstructor(am, w, h) {\r\n\t\tsuper(am, w, h);\r\n\r\n\t\tthis.addControls();\r\n\r\n\t\t// Useful for memory management\r\n\t\tthis.nextIndex = 0;\r\n\r\n\t\t// TODO:  Add any code necessary to set up your own algorithm.  Initialize data\r\n\t\t// structures, etc.\r\n\t\tthis.setup();\r\n\t}\r\n\r\n\taddControls() {\r\n\t\tthis.controls = [];\r\n\r\n\t\taddLabelToAlgorithmBar('Text');\r\n\r\n\t\t// Text text field\r\n\t\tthis.textField = addControlToAlgorithmBar('Text', '');\r\n\t\tthis.textField.onkeydown = this.returnSubmit(\r\n\t\t\tthis.textField,\r\n\t\t\tthis.findCallback.bind(this),\r\n\t\t\tMAX_LENGTH,\r\n\t\t\tfalse\r\n\t\t);\r\n\t\tthis.controls.push(this.textField);\r\n\r\n\t\taddLabelToAlgorithmBar('Pattern');\r\n\r\n\t\t// Pattern text field\r\n\t\tthis.patternField = addControlToAlgorithmBar('Text', '');\r\n\t\tthis.patternField.onkeydown = this.returnSubmit(\r\n\t\t\tthis.patternField,\r\n\t\t\tthis.findCallback.bind(this),\r\n\t\t\tMAX_LENGTH,\r\n\t\t\tfalse\r\n\t\t);\r\n\t\tthis.controls.push(this.patternField);\r\n\r\n\t\t// Find button\r\n\t\tthis.findButton = addControlToAlgorithmBar('Button', 'Find');\r\n\t\tthis.findButton.onclick = this.findCallback.bind(this);\r\n\t\tthis.controls.push(this.findButton);\r\n\r\n\t\t// Clear button\r\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear');\r\n\t\tthis.clearButton.onclick = this.clearCallback.bind(this);\r\n\t\tthis.controls.push(this.clearButton);\r\n\t}\r\n\r\n\tsetup() {\r\n\t\tthis.textRowID = [];\r\n\t\tthis.comparisonMatrixID = [];\r\n\t\tthis.failureTableLabelID = this.nextIndex++;\r\n\t\tthis.failureTableCharacterID = [];\r\n\t\tthis.failureTableValueID = [];\r\n\t}\r\n\r\n\treset() {\r\n\t\t// Reset all of your data structures to *exactly* the state they have immediately after the init\r\n\t\t// function is called.  This method is called whenever an \"undo\" is performed.  Your data\r\n\t\t// structures are completely cleaned, and then all of the actions *up to but not including* the\r\n\t\t// last action are then redone.  If you implement all of your actions through the \"implementAction\"\r\n\t\t// method below, then all of this work is done for you in the Animation \"superexport default class\"\r\n\r\n\t\t// Reset the (very simple) memory manager\r\n\t\tthis.nextIndex = 0;\r\n\t}\r\n\r\n\tfindCallback() {\r\n\t\tif (\r\n\t\t\tthis.textField.value !== '' &&\r\n\t\t\tthis.patternField.value !== '' &&\r\n\t\t\tthis.textField.value.length >= this.patternField.value.length\r\n\t\t) {\r\n\t\t\tthis.implementAction(this.clear.bind(this), '');\r\n\t\t\tconst text = this.textField.value;\r\n\t\t\tconst pattern = this.patternField.value;\r\n\t\t\tthis.textField.value = '';\r\n\t\t\tthis.patternField.value = '';\r\n\t\t\tthis.implementAction(this.find.bind(this), text + ',' + pattern);\r\n\t\t}\r\n\t}\r\n\r\n\tclearCallback() {\r\n\t\tthis.implementAction(this.clear.bind(this), '');\r\n\t}\r\n\r\n\tfind(params) {\r\n\t\tthis.commands = [];\r\n\r\n\t\tconst text = params.split(',')[0];\r\n\t\tconst pattern = params.split(',')[1];\r\n\r\n\t\tif (text.length <= 14) {\r\n\t\t\tthis.cellSize = 30;\r\n\t\t} else if (text.length <= 17) {\r\n\t\t\tthis.cellSize = 25;\r\n\t\t} else {\r\n\t\t\tthis.cellSize = 20;\r\n\t\t}\r\n\r\n\t\tthis.textRowID = new Array(text.length);\r\n\t\tthis.comparisonMatrixID = new Array(text.length);\r\n\t\tfor (let i = 0; i < text.length; i++) {\r\n\t\t\tthis.comparisonMatrixID[i] = new Array(text.length);\r\n\t\t}\r\n\r\n\t\tlet xpos, ypos;\r\n\t\tfor (let i = 0; i < text.length; i++) {\r\n\t\t\txpos = i * this.cellSize + ARRAY_START_X;\r\n\t\t\typos = ARRAY_START_Y;\r\n\t\t\tthis.textRowID[i] = this.nextIndex;\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'CreateRectangle',\r\n\t\t\t\tthis.nextIndex,\r\n\t\t\t\ttext.charAt(i),\r\n\t\t\t\tthis.cellSize,\r\n\t\t\t\tthis.cellSize,\r\n\t\t\t\txpos,\r\n\t\t\t\typos\r\n\t\t\t);\r\n\t\t\tthis.cmd('SetBackgroundColor', this.nextIndex++, '#D3D3D3');\r\n\t\t}\r\n\r\n\t\tfor (let row = 0; row < text.length; row++) {\r\n\t\t\tfor (let col = 0; col < text.length; col++) {\r\n\t\t\t\txpos = col * this.cellSize + ARRAY_START_X;\r\n\t\t\t\typos = (row + 1) * this.cellSize + ARRAY_START_Y;\r\n\t\t\t\tthis.comparisonMatrixID[row][col] = this.nextIndex;\r\n\t\t\t\tthis.cmd(\r\n\t\t\t\t\t'CreateRectangle',\r\n\t\t\t\t\tthis.nextIndex++,\r\n\t\t\t\t\t'',\r\n\t\t\t\t\tthis.cellSize,\r\n\t\t\t\t\tthis.cellSize,\r\n\t\t\t\t\txpos,\r\n\t\t\t\t\typos\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tconst failureTable = this.buildFailureTable(text.length, pattern);\r\n\r\n\t\tconst iPointerID = this.nextIndex++;\r\n\t\tconst jPointerID = this.nextIndex++;\r\n\t\tthis.cmd(\r\n\t\t\t'CreateHighlightCircle',\r\n\t\t\tiPointerID,\r\n\t\t\t'#0000FF',\r\n\t\t\tARRAY_START_X,\r\n\t\t\tARRAY_START_Y,\r\n\t\t\tthis.cellSize / 2\r\n\t\t);\r\n\t\tthis.cmd(\r\n\t\t\t'CreateHighlightCircle',\r\n\t\t\tjPointerID,\r\n\t\t\t'#0000FF',\r\n\t\t\tARRAY_START_X,\r\n\t\t\tARRAY_START_Y + this.cellSize,\r\n\t\t\tthis.cellSize / 2\r\n\t\t);\r\n\r\n\t\tlet i = 0;\r\n\t\tlet j = 0;\r\n\t\tlet row = 0;\r\n\t\twhile (i <= text.length - pattern.length) {\r\n\t\t\tfor (let k = i; k < i + pattern.length; k++) {\r\n\t\t\t\tthis.cmd(\r\n\t\t\t\t\t'SetText',\r\n\t\t\t\t\tthis.comparisonMatrixID[row][k],\r\n\t\t\t\t\tpattern.charAt(k - i),\r\n\t\t\t\t\txpos,\r\n\t\t\t\t\typos\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t\tthis.cmd('Step');\r\n\t\t\twhile (j < pattern.length && pattern.charAt(j) === text.charAt(i + j)) {\r\n\t\t\t\tthis.cmd('SetBackgroundColor', this.comparisonMatrixID[row][i + j], '#2ECC71');\r\n\t\t\t\tj++;\r\n\t\t\t\tthis.cmd('Step');\r\n\t\t\t\tif (j < pattern.length) {\r\n\t\t\t\t\txpos = (i + j) * this.cellSize + ARRAY_START_X;\r\n\t\t\t\t\tthis.cmd('Move', iPointerID, xpos, ARRAY_START_Y);\r\n\t\t\t\t\typos = (row + 1) * this.cellSize + ARRAY_START_Y;\r\n\t\t\t\t\tthis.cmd('Move', jPointerID, xpos, ypos);\r\n\t\t\t\t\tthis.cmd('Step');\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (j === 0) {\r\n\t\t\t\tthis.cmd('SetBackgroundColor', this.comparisonMatrixID[row][i], '#E74C3C');\r\n\t\t\t\ti++;\r\n\t\t\t} else {\r\n\t\t\t\tif (j !== pattern.length) {\r\n\t\t\t\t\tthis.cmd('SetBackgroundColor', this.comparisonMatrixID[row][i + j], '#E74C3C');\r\n\t\t\t\t}\r\n\t\t\t\tconst nextAlignment = failureTable[j - 1];\r\n\t\t\t\ti += j - nextAlignment;\r\n\t\t\t\tj = nextAlignment;\r\n\t\t\t}\r\n\t\t\trow++;\r\n\t\t\tif (i <= text.length - pattern.length) {\r\n\t\t\t\txpos = (i + j) * this.cellSize + ARRAY_START_X;\r\n\t\t\t\tthis.cmd('Move', iPointerID, xpos, ARRAY_START_Y);\r\n\t\t\t\typos = (row + 1) * this.cellSize + ARRAY_START_Y;\r\n\t\t\t\tthis.cmd('Move', jPointerID, xpos, ypos);\r\n\t\t\t\tthis.cmd('Step');\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis.cmd('Delete', iPointerID);\r\n\t\tthis.cmd('Delete', jPointerID);\r\n\t\treturn this.commands;\r\n\t}\r\n\r\n\tbuildFailureTable(textLength, pattern) {\r\n\t\t// Display label\r\n\t\tconst labelX = ARRAY_START_X + textLength * this.cellSize + 10;\r\n\t\tthis.cmd(\r\n\t\t\t'CreateLabel',\r\n\t\t\tthis.failureTableLabelID,\r\n\t\t\t'Failure table:',\r\n\t\t\tlabelX,\r\n\t\t\tFAILURE_TABLE_START_Y,\r\n\t\t\t0\r\n\t\t);\r\n\r\n\t\t// Display empty failure table\r\n\t\tconst tableStartX = ARRAY_START_X + textLength * this.cellSize + 100;\r\n\t\tthis.failureTableCharacterID = new Array(pattern.length);\r\n\t\tthis.failureTableValueID = new Array(pattern.length);\r\n\t\tfor (let i = 0; i < pattern.length; i++) {\r\n\t\t\tconst xpos = tableStartX + i * this.cellSize;\r\n\t\t\tthis.failureTableCharacterID[i] = this.nextIndex++;\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'CreateRectangle',\r\n\t\t\t\tthis.failureTableCharacterID[i],\r\n\t\t\t\tpattern.charAt(i),\r\n\t\t\t\tthis.cellSize,\r\n\t\t\t\tthis.cellSize,\r\n\t\t\t\txpos,\r\n\t\t\t\tFAILURE_TABLE_START_Y\r\n\t\t\t);\r\n\t\t\tthis.cmd('SetBackgroundColor', this.failureTableCharacterID[i], '#D3D3D3');\r\n\t\t\tthis.failureTableValueID[i] = this.nextIndex++;\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'CreateRectangle',\r\n\t\t\t\tthis.failureTableValueID[i],\r\n\t\t\t\t'',\r\n\t\t\t\tthis.cellSize,\r\n\t\t\t\tthis.cellSize,\r\n\t\t\t\txpos,\r\n\t\t\t\tFAILURE_TABLE_START_Y + this.cellSize\r\n\t\t\t);\r\n\t\t}\r\n\t\tthis.cmd('Step');\r\n\r\n\t\t// Display pointers and set first value to 0\r\n\t\tconst iPointerID = this.nextIndex++;\r\n\t\tconst jPointerID = this.nextIndex++;\r\n\t\tthis.cmd(\r\n\t\t\t'CreateHighlightCircle',\r\n\t\t\tiPointerID,\r\n\t\t\t'#0000FF',\r\n\t\t\ttableStartX,\r\n\t\t\tFAILURE_TABLE_START_Y,\r\n\t\t\tthis.cellSize / 2\r\n\t\t);\r\n\t\tthis.cmd(\r\n\t\t\t'CreateHighlightCircle',\r\n\t\t\tjPointerID,\r\n\t\t\t'#FF0000',\r\n\t\t\ttableStartX + this.cellSize,\r\n\t\t\tFAILURE_TABLE_START_Y,\r\n\t\t\tthis.cellSize / 2\r\n\t\t);\r\n\t\tthis.cmd('SetText', this.failureTableValueID[0], 0);\r\n\t\tthis.cmd('Step');\r\n\r\n\t\tconst failureTable = [];\r\n\t\tfailureTable[0] = 0;\r\n\t\tlet i = 0;\r\n\t\tlet j = 1;\r\n\t\twhile (j < pattern.length) {\r\n\t\t\tif (pattern.charAt(i) === pattern.charAt(j)) {\r\n\t\t\t\ti++;\r\n\t\t\t\tfailureTable[j] = i;\r\n\t\t\t\tthis.cmd('SetText', this.failureTableValueID[j], i);\r\n\t\t\t\tj++;\r\n\t\t\t\tif (j < pattern.length) {\r\n\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t'Move',\r\n\t\t\t\t\t\tiPointerID,\r\n\t\t\t\t\t\ttableStartX + i * this.cellSize,\r\n\t\t\t\t\t\tFAILURE_TABLE_START_Y\r\n\t\t\t\t\t);\r\n\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t'Move',\r\n\t\t\t\t\t\tjPointerID,\r\n\t\t\t\t\t\ttableStartX + j * this.cellSize,\r\n\t\t\t\t\t\tFAILURE_TABLE_START_Y\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\t\t\t\tthis.cmd('Step');\r\n\t\t\t} else {\r\n\t\t\t\tif (i === 0) {\r\n\t\t\t\t\tfailureTable[j] = i;\r\n\t\t\t\t\tthis.cmd('SetText', this.failureTableValueID[j], i);\r\n\t\t\t\t\tj++;\r\n\t\t\t\t\tif (j < pattern.length) {\r\n\t\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t\t'Move',\r\n\t\t\t\t\t\t\tjPointerID,\r\n\t\t\t\t\t\t\ttableStartX + j * this.cellSize,\r\n\t\t\t\t\t\t\tFAILURE_TABLE_START_Y\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.cmd('Step');\r\n\t\t\t\t} else {\r\n\t\t\t\t\ti = failureTable[i - 1];\r\n\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t'Move',\r\n\t\t\t\t\t\tiPointerID,\r\n\t\t\t\t\t\ttableStartX + i * this.cellSize,\r\n\t\t\t\t\t\tFAILURE_TABLE_START_Y\r\n\t\t\t\t\t);\r\n\t\t\t\t\tthis.cmd('Step');\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis.cmd('Delete', iPointerID);\r\n\t\tthis.cmd('Delete', jPointerID);\r\n\r\n\t\treturn failureTable;\r\n\t}\r\n\r\n\tclear() {\r\n\t\tthis.commands = [];\r\n\t\tfor (let i = 0; i < this.textRowID.length; i++) {\r\n\t\t\tthis.cmd('Delete', this.textRowID[i]);\r\n\t\t}\r\n\t\tthis.textRowID = [];\r\n\t\tfor (let i = 0; i < this.comparisonMatrixID.length; i++) {\r\n\t\t\tfor (let j = 0; j < this.comparisonMatrixID.length; j++) {\r\n\t\t\t\tthis.cmd('Delete', this.comparisonMatrixID[i][j]);\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.comparisonMatrixID = [];\r\n\t\tif (this.failureTableValueID.length !== 0) {\r\n\t\t\tthis.cmd('Delete', this.failureTableLabelID);\r\n\t\t}\r\n\t\tfor (let i = 0; i < this.failureTableCharacterID.length; i++) {\r\n\t\t\tthis.cmd('Delete', this.failureTableCharacterID[i]);\r\n\t\t\tthis.cmd('Delete', this.failureTableValueID[i]);\r\n\t\t}\r\n\t\tthis.failureTableCharacterID = [];\r\n\t\tthis.failureTableValueID = [];\r\n\t\treturn this.commands;\r\n\t}\r\n\r\n\t// Called by our superexport default class when we get an animation started event -- need to wait for the\r\n\t// event to finish before we start doing anything\r\n\tdisableUI() {\r\n\t\tfor (let i = 0; i < this.controls.length; i++) {\r\n\t\t\tthis.controls[i].disabled = true;\r\n\t\t}\r\n\t}\r\n\r\n\t// Called by our superexport default class when we get an animation completed event -- we can\r\n\t/// now interact again.\r\n\tenableUI() {\r\n\t\tfor (let i = 0; i < this.controls.length; i++) {\r\n\t\t\tthis.controls[i].disabled = false;\r\n\t\t}\r\n\t}\r\n}\r\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\r\n//\r\n// Redistribution and use in source and binary forms, with or without modification, are\r\n// permitted provided that the following conditions are met:\r\n//\r\n// 1. Redistributions of source code must retain the above copyright notice, this list of\r\n// conditions and the following disclaimer.\r\n//\r\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\r\n// of conditions and the following disclaimer in the documentation and/or other materials\r\n// provided with the distribution.\r\n//\r\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\r\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\r\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\r\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\r\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\r\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\r\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\r\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\r\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\r\n//\r\n// The views and conclusions contained in the software and documentation are those of the\r\n// authors and should not be interpreted as representing official policies, either expressed\r\n// or implied, of the University of San Francisco\r\n\r\nimport Graph, { EDGE_COLOR, VERTEX_INDEX_COLOR } from './Graph.js';\r\nimport { addControlToAlgorithmBar } from './Algorithm.js';\r\n\r\nexport default class Kruskal extends Graph {\r\n\tconstructor(am, w, h) {\r\n\t\tsuper(am, w, h, false, false);\r\n\t\tthis.showEdgeCosts = true;\r\n\t}\r\n\r\n\taddControls() {\r\n\t\tthis.startButton = addControlToAlgorithmBar('Button', 'Run Kruskal');\r\n\t\tthis.startButton.onclick = this.startCallback.bind(this);\r\n\r\n\t\tsuper.addControls(false);\r\n\t}\r\n\r\n\tsetup() {\r\n\t\tsuper.setup();\r\n\t\tthis.messageID = [];\r\n\t\tthis.commands = [];\r\n\t\tthis.setID = new Array(this.size);\r\n\t\tthis.setIndexID = new Array(this.size);\r\n\t\tthis.setData = new Array(this.size);\r\n\r\n\t\tlet i;\r\n\t\tfor (i = 0; i < this.size; i++) {\r\n\t\t\tthis.setID[i] = this.nextIndex++;\r\n\t\t\tthis.setIndexID[i] = this.nextIndex++;\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'CreateRectangle',\r\n\t\t\t\tthis.setID[i],\r\n\t\t\t\t'-1',\r\n\t\t\t\tKruskal.SET_ARRAY_ELEM_WIDTH,\r\n\t\t\t\tKruskal.SET_ARRAY_ELEM_HEIGHT,\r\n\t\t\t\tKruskal.SET_ARRAY_START_X,\r\n\t\t\t\tKruskal.SET_ARRAY_START_Y + i * Kruskal.SET_ARRAY_ELEM_HEIGHT\r\n\t\t\t);\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'CreateLabel',\r\n\t\t\t\tthis.setIndexID[i],\r\n\t\t\t\ti,\r\n\t\t\t\tKruskal.SET_ARRAY_START_X - Kruskal.SET_ARRAY_ELEM_WIDTH,\r\n\t\t\t\tKruskal.SET_ARRAY_START_Y + i * Kruskal.SET_ARRAY_ELEM_HEIGHT\r\n\t\t\t);\r\n\t\t\tthis.cmd('SetForegroundColor', this.setIndexID[i], VERTEX_INDEX_COLOR);\r\n\t\t}\r\n\t\tthis.cmd(\r\n\t\t\t'CreateLabel',\r\n\t\t\tthis.nextIndex++,\r\n\t\t\t'Disjoint Set',\r\n\t\t\tKruskal.SET_ARRAY_START_X - 1 * Kruskal.SET_ARRAY_ELEM_WIDTH,\r\n\t\t\tKruskal.SET_ARRAY_START_Y - Kruskal.SET_ARRAY_ELEM_HEIGHT * 1.5,\r\n\t\t\t0\r\n\t\t);\r\n\t\tthis.animationManager.setAllLayers([0, this.currentLayer]);\r\n\t\tthis.animationManager.StartNewAnimation(this.commands);\r\n\t\tthis.animationManager.skipForward();\r\n\t\tthis.animationManager.clearHistory();\r\n\t}\r\n\r\n\tstartCallback() {\r\n\t\tthis.implementAction(this.doKruskal.bind(this), '');\r\n\t}\r\n\r\n\tdisjointSetFind(valueToFind, highlightCircleID) {\r\n\t\tthis.cmd('SetTextColor', this.setID[valueToFind], '#FF0000');\r\n\t\tthis.cmd('Step');\r\n\t\twhile (this.setData[valueToFind] >= 0) {\r\n\t\t\tthis.cmd('SetTextColor', this.setID[valueToFind], '#000000');\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'Move',\r\n\t\t\t\thighlightCircleID,\r\n\t\t\t\tKruskal.SET_ARRAY_START_X - Kruskal.SET_ARRAY_ELEM_WIDTH,\r\n\t\t\t\tKruskal.SET_ARRAY_START_Y +\r\n\t\t\t\t\tthis.setData[valueToFind] * Kruskal.SET_ARRAY_ELEM_HEIGHT\r\n\t\t\t);\r\n\t\t\tthis.cmd('Step');\r\n\t\t\tvalueToFind = this.setData[valueToFind];\r\n\t\t\tthis.cmd('SetTextColor', this.setID[valueToFind], '#FF0000');\r\n\t\t\tthis.cmd('Step');\r\n\t\t}\r\n\t\tthis.cmd('SetTextColor', this.setID[valueToFind], '#000000');\r\n\t\treturn valueToFind;\r\n\t}\r\n\r\n\tdoKruskal() {\r\n\t\tthis.commands = [];\r\n\r\n\t\tthis.edgesListLeftID = [];\r\n\t\tthis.edgesListRightID = [];\r\n\t\tthis.edgesListLeft = [];\r\n\t\tthis.edgesListRight = [];\r\n\r\n\t\tlet i;\r\n\t\tlet j;\r\n\t\tfor (i = 0; i < this.size; i++) {\r\n\t\t\tthis.setData[i] = -1;\r\n\t\t\tthis.cmd('SetText', this.setID[i], '-1');\r\n\t\t}\r\n\r\n\t\tthis.recolorGraph();\r\n\r\n\t\t// Create Edge List\r\n\t\tlet top;\r\n\t\tfor (i = 0; i < this.size; i++) {\r\n\t\t\tfor (j = i + 1; j < this.size; j++) {\r\n\t\t\t\tif (this.adj_matrix[i][j] >= 0) {\r\n\t\t\t\t\tthis.edgesListLeftID.push(this.nextIndex++);\r\n\t\t\t\t\tthis.edgesListRightID.push(this.nextIndex++);\r\n\t\t\t\t\ttop = this.edgesListLeftID.length - 1;\r\n\t\t\t\t\tthis.edgesListLeft.push(i);\r\n\t\t\t\t\tthis.edgesListRight.push(j);\r\n\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t'CreateLabel',\r\n\t\t\t\t\t\tthis.edgesListLeftID[top],\r\n\t\t\t\t\t\ti,\r\n\t\t\t\t\t\tKruskal.EDGE_LIST_START_X +\r\n\t\t\t\t\t\t\tMath.floor(top / Kruskal.EDGE_LIST_MAX_PER_COLUMN) *\r\n\t\t\t\t\t\t\t\tKruskal.EDGE_LIST_COLUMN_WIDTH,\r\n\t\t\t\t\t\tKruskal.EDGE_LIST_START_Y +\r\n\t\t\t\t\t\t\t(top % Kruskal.EDGE_LIST_MAX_PER_COLUMN) * Kruskal.EDGE_LIST_ELEM_HEIGHT\r\n\t\t\t\t\t);\r\n\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t'CreateLabel',\r\n\t\t\t\t\t\tthis.edgesListRightID[top],\r\n\t\t\t\t\t\tj,\r\n\t\t\t\t\t\tKruskal.EDGE_LIST_START_X +\r\n\t\t\t\t\t\t\tKruskal.EDGE_LIST_ELEM_WIDTH +\r\n\t\t\t\t\t\t\tMath.floor(top / Kruskal.EDGE_LIST_MAX_PER_COLUMN) *\r\n\t\t\t\t\t\t\t\tKruskal.EDGE_LIST_COLUMN_WIDTH,\r\n\t\t\t\t\t\tKruskal.EDGE_LIST_START_Y +\r\n\t\t\t\t\t\t\t(top % Kruskal.EDGE_LIST_MAX_PER_COLUMN) * Kruskal.EDGE_LIST_ELEM_HEIGHT\r\n\t\t\t\t\t);\r\n\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t'Connect',\r\n\t\t\t\t\t\tthis.edgesListLeftID[top],\r\n\t\t\t\t\t\tthis.edgesListRightID[top],\r\n\t\t\t\t\t\tEDGE_COLOR,\r\n\t\t\t\t\t\t0,\r\n\t\t\t\t\t\t0,\r\n\t\t\t\t\t\tthis.adj_matrix[i][j]\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.cmd('Step');\r\n\r\n\t\t// Sort edge list based on edge cost\r\n\t\tconst edgeCount = this.edgesListLeftID.length;\r\n\t\tlet tmpLeftID;\r\n\t\tlet tmpRightID;\r\n\t\tlet tmpLeft;\r\n\t\tlet tmpRight;\r\n\t\tfor (i = 1; i < edgeCount; i++) {\r\n\t\t\ttmpLeftID = this.edgesListLeftID[i];\r\n\t\t\ttmpRightID = this.edgesListRightID[i];\r\n\t\t\ttmpLeft = this.edgesListLeft[i];\r\n\t\t\ttmpRight = this.edgesListRight[i];\r\n\t\t\tj = i;\r\n\t\t\twhile (\r\n\t\t\t\tj > 0 &&\r\n\t\t\t\tthis.adj_matrix[this.edgesListLeft[j - 1]][this.edgesListRight[j - 1]] >\r\n\t\t\t\t\tthis.adj_matrix[tmpLeft][tmpRight]\r\n\t\t\t) {\r\n\t\t\t\tthis.edgesListLeft[j] = this.edgesListLeft[j - 1];\r\n\t\t\t\tthis.edgesListRight[j] = this.edgesListRight[j - 1];\r\n\t\t\t\tthis.edgesListLeftID[j] = this.edgesListLeftID[j - 1];\r\n\t\t\t\tthis.edgesListRightID[j] = this.edgesListRightID[j - 1];\r\n\t\t\t\tj = j - 1;\r\n\t\t\t}\r\n\t\t\tthis.edgesListLeft[j] = tmpLeft;\r\n\t\t\tthis.edgesListRight[j] = tmpRight;\r\n\t\t\tthis.edgesListLeftID[j] = tmpLeftID;\r\n\t\t\tthis.edgesListRightID[j] = tmpRightID;\r\n\t\t}\r\n\t\tfor (i = 0; i < edgeCount; i++) {\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'Move',\r\n\t\t\t\tthis.edgesListLeftID[i],\r\n\t\t\t\tKruskal.EDGE_LIST_START_X +\r\n\t\t\t\t\tMath.floor(i / Kruskal.EDGE_LIST_MAX_PER_COLUMN) *\r\n\t\t\t\t\t\tKruskal.EDGE_LIST_COLUMN_WIDTH,\r\n\t\t\t\tKruskal.EDGE_LIST_START_Y +\r\n\t\t\t\t\t(i % Kruskal.EDGE_LIST_MAX_PER_COLUMN) * Kruskal.EDGE_LIST_ELEM_HEIGHT\r\n\t\t\t);\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'Move',\r\n\t\t\t\tthis.edgesListRightID[i],\r\n\t\t\t\tKruskal.EDGE_LIST_START_X +\r\n\t\t\t\t\tKruskal.EDGE_LIST_ELEM_WIDTH +\r\n\t\t\t\t\tMath.floor(i / Kruskal.EDGE_LIST_MAX_PER_COLUMN) *\r\n\t\t\t\t\t\tKruskal.EDGE_LIST_COLUMN_WIDTH,\r\n\t\t\t\tKruskal.EDGE_LIST_START_Y +\r\n\t\t\t\t\t(i % Kruskal.EDGE_LIST_MAX_PER_COLUMN) * Kruskal.EDGE_LIST_ELEM_HEIGHT\r\n\t\t\t);\r\n\t\t}\r\n\r\n\t\tthis.cmd('Step');\r\n\r\n\t\tconst findLabelLeft = this.nextIndex++;\r\n\t\tconst findLabelRight = this.nextIndex++;\r\n\t\tconst highlightCircle1 = this.nextIndex++;\r\n\t\tconst highlightCircle2 = this.nextIndex++;\r\n\t\tconst moveLabelID = this.nextIndex++;\r\n\t\tconst messageLabelID = this.nextIndex++;\r\n\r\n\t\tlet edgesAdded = 0;\r\n\t\tlet nextListIndex = 0;\r\n\t\tthis.cmd(\r\n\t\t\t'CreateLabel',\r\n\t\t\tfindLabelLeft,\r\n\t\t\t'',\r\n\t\t\tKruskal.FIND_LABEL_1_X,\r\n\t\t\tKruskal.FIND_LABEL_1_Y,\r\n\t\t\t0\r\n\t\t);\r\n\t\tthis.cmd(\r\n\t\t\t'CreateLabel',\r\n\t\t\tfindLabelRight,\r\n\t\t\t'',\r\n\t\t\tKruskal.FIND_LABEL_2_X,\r\n\t\t\tKruskal.FIND_LABEL_2_Y,\r\n\t\t\t0\r\n\t\t);\r\n\r\n\t\twhile (edgesAdded < this.size - 1 && nextListIndex < edgeCount) {\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'SetEdgeHighlight',\r\n\t\t\t\tthis.edgesListLeftID[nextListIndex],\r\n\t\t\t\tthis.edgesListRightID[nextListIndex],\r\n\t\t\t\t1\r\n\t\t\t);\r\n\r\n\t\t\tthis.highlightEdge(\r\n\t\t\t\tthis.edgesListLeft[nextListIndex],\r\n\t\t\t\tthis.edgesListRight[nextListIndex],\r\n\t\t\t\t1\r\n\t\t\t);\r\n\t\t\tthis.highlightEdge(\r\n\t\t\t\tthis.edgesListRight[nextListIndex],\r\n\t\t\t\tthis.edgesListLeft[nextListIndex],\r\n\t\t\t\t1\r\n\t\t\t);\r\n\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'SetText',\r\n\t\t\t\tfindLabelLeft,\r\n\t\t\t\t'find(' + String(this.edgesListLeft[nextListIndex]) + ') = '\r\n\t\t\t);\r\n\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'CreateHighlightCircle',\r\n\t\t\t\thighlightCircle1,\r\n\t\t\t\tKruskal.HIGHLIGHT_CIRCLE_COLOR_1,\r\n\t\t\t\tKruskal.EDGE_LIST_START_X +\r\n\t\t\t\t\tMath.floor(nextListIndex / Kruskal.EDGE_LIST_MAX_PER_COLUMN) *\r\n\t\t\t\t\t\tKruskal.EDGE_LIST_COLUMN_WIDTH,\r\n\t\t\t\tKruskal.EDGE_LIST_START_Y +\r\n\t\t\t\t\t(nextListIndex % Kruskal.EDGE_LIST_MAX_PER_COLUMN) *\r\n\t\t\t\t\t\tKruskal.EDGE_LIST_ELEM_HEIGHT,\r\n\t\t\t\t15\r\n\t\t\t);\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'Move',\r\n\t\t\t\thighlightCircle1,\r\n\t\t\t\tKruskal.SET_ARRAY_START_X - Kruskal.SET_ARRAY_ELEM_WIDTH,\r\n\t\t\t\tKruskal.SET_ARRAY_START_Y +\r\n\t\t\t\t\tthis.edgesListLeft[nextListIndex] * Kruskal.SET_ARRAY_ELEM_HEIGHT\r\n\t\t\t);\r\n\t\t\tthis.cmd('Step');\r\n\r\n\t\t\tconst left = this.disjointSetFind(this.edgesListLeft[nextListIndex], highlightCircle1);\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'SetText',\r\n\t\t\t\tfindLabelLeft,\r\n\t\t\t\t'find(' + String(this.edgesListLeft[nextListIndex]) + ') = ' + String(left)\r\n\t\t\t);\r\n\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'SetText',\r\n\t\t\t\tfindLabelRight,\r\n\t\t\t\t'find(' + String(this.edgesListRight[nextListIndex]) + ') = '\r\n\t\t\t);\r\n\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'CreateHighlightCircle',\r\n\t\t\t\thighlightCircle2,\r\n\t\t\t\tKruskal.HIGHLIGHT_CIRCLE_COLOR_2,\r\n\t\t\t\tKruskal.EDGE_LIST_START_X +\r\n\t\t\t\t\tKruskal.EDGE_LIST_ELEM_WIDTH +\r\n\t\t\t\t\tMath.floor(nextListIndex / Kruskal.EDGE_LIST_MAX_PER_COLUMN) *\r\n\t\t\t\t\t\tKruskal.EDGE_LIST_COLUMN_WIDTH,\r\n\t\t\t\tKruskal.EDGE_LIST_START_Y +\r\n\t\t\t\t\t(nextListIndex % Kruskal.EDGE_LIST_MAX_PER_COLUMN) *\r\n\t\t\t\t\t\tKruskal.EDGE_LIST_ELEM_HEIGHT,\r\n\t\t\t\t15\r\n\t\t\t);\r\n\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'Move',\r\n\t\t\t\thighlightCircle2,\r\n\t\t\t\tKruskal.SET_ARRAY_START_X - Kruskal.SET_ARRAY_ELEM_WIDTH,\r\n\t\t\t\tKruskal.SET_ARRAY_START_Y +\r\n\t\t\t\t\tthis.edgesListRight[nextListIndex] * Kruskal.SET_ARRAY_ELEM_HEIGHT\r\n\t\t\t);\r\n\t\t\tthis.cmd('Step');\r\n\r\n\t\t\tconst right = this.disjointSetFind(\r\n\t\t\t\tthis.edgesListRight[nextListIndex],\r\n\t\t\t\thighlightCircle2\r\n\t\t\t);\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'SetText',\r\n\t\t\t\tfindLabelRight,\r\n\t\t\t\t'find(' + String(this.edgesListRight[nextListIndex]) + ') = ' + String(right)\r\n\t\t\t);\r\n\r\n\t\t\tthis.cmd('Step');\r\n\r\n\t\t\tif (left !== right) {\r\n\t\t\t\tthis.cmd(\r\n\t\t\t\t\t'CreateLabel',\r\n\t\t\t\t\tmessageLabelID,\r\n\t\t\t\t\t'Vertices in different trees.  Add edge to tree: Union(' +\r\n\t\t\t\t\t\tString(left) +\r\n\t\t\t\t\t\t',' +\r\n\t\t\t\t\t\tString(right) +\r\n\t\t\t\t\t\t')',\r\n\t\t\t\t\tKruskal.MESSAGE_LABEL_X,\r\n\t\t\t\t\tKruskal.MESSAGE_LABEL_Y,\r\n\t\t\t\t\t0\r\n\t\t\t\t);\r\n\t\t\t\tthis.cmd('Step');\r\n\t\t\t\tthis.highlightEdge(\r\n\t\t\t\t\tthis.edgesListLeft[nextListIndex],\r\n\t\t\t\t\tthis.edgesListRight[nextListIndex],\r\n\t\t\t\t\t1\r\n\t\t\t\t);\r\n\t\t\t\tthis.highlightEdge(\r\n\t\t\t\t\tthis.edgesListRight[nextListIndex],\r\n\t\t\t\t\tthis.edgesListLeft[nextListIndex],\r\n\t\t\t\t\t1\r\n\t\t\t\t);\r\n\t\t\t\tedgesAdded++;\r\n\t\t\t\tthis.setEdgeColor(\r\n\t\t\t\t\tthis.edgesListLeft[nextListIndex],\r\n\t\t\t\t\tthis.edgesListRight[nextListIndex],\r\n\t\t\t\t\t'#FF0000'\r\n\t\t\t\t);\r\n\t\t\t\tthis.setEdgeColor(\r\n\t\t\t\t\tthis.edgesListRight[nextListIndex],\r\n\t\t\t\t\tthis.edgesListLeft[nextListIndex],\r\n\t\t\t\t\t'#FF0000'\r\n\t\t\t\t);\r\n\t\t\t\tif (this.setData[left] < this.setData[right]) {\r\n\t\t\t\t\tthis.cmd('SetText', this.setID[right], '');\r\n\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t'CreateLabel',\r\n\t\t\t\t\t\tmoveLabelID,\r\n\t\t\t\t\t\tthis.setData[right],\r\n\t\t\t\t\t\tKruskal.SET_ARRAY_START_X,\r\n\t\t\t\t\t\tKruskal.SET_ARRAY_START_Y + right * Kruskal.SET_ARRAY_ELEM_HEIGHT\r\n\t\t\t\t\t);\r\n\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t'Move',\r\n\t\t\t\t\t\tmoveLabelID,\r\n\t\t\t\t\t\tKruskal.SET_ARRAY_START_X,\r\n\t\t\t\t\t\tKruskal.SET_ARRAY_START_Y + left * Kruskal.SET_ARRAY_ELEM_HEIGHT\r\n\t\t\t\t\t);\r\n\t\t\t\t\tthis.cmd('Step');\r\n\t\t\t\t\tthis.cmd('Delete', moveLabelID);\r\n\t\t\t\t\tthis.setData[left] = this.setData[left] + this.setData[right];\r\n\t\t\t\t\tthis.setData[right] = left;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.cmd('SetText', this.setID[left], '');\r\n\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t'CreateLabel',\r\n\t\t\t\t\t\tmoveLabelID,\r\n\t\t\t\t\t\tthis.setData[left],\r\n\t\t\t\t\t\tKruskal.SET_ARRAY_START_X,\r\n\t\t\t\t\t\tKruskal.SET_ARRAY_START_Y + left * Kruskal.SET_ARRAY_ELEM_HEIGHT\r\n\t\t\t\t\t);\r\n\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t'Move',\r\n\t\t\t\t\t\tmoveLabelID,\r\n\t\t\t\t\t\tKruskal.SET_ARRAY_START_X,\r\n\t\t\t\t\t\tKruskal.SET_ARRAY_START_Y + right * Kruskal.SET_ARRAY_ELEM_HEIGHT\r\n\t\t\t\t\t);\r\n\t\t\t\t\tthis.cmd('Step');\r\n\t\t\t\t\tthis.cmd('Delete', moveLabelID);\r\n\t\t\t\t\tthis.setData[right] = this.setData[right] + this.setData[left];\r\n\t\t\t\t\tthis.setData[left] = right;\r\n\t\t\t\t}\r\n\t\t\t\tthis.cmd('SetText', this.setID[left], this.setData[left]);\r\n\t\t\t\tthis.cmd('SetText', this.setID[right], this.setData[right]);\r\n\t\t\t} else {\r\n\t\t\t\tthis.cmd(\r\n\t\t\t\t\t'CreateLabel',\r\n\t\t\t\t\tmessageLabelID,\r\n\t\t\t\t\t'Vertices in the same tree.  Skip edge',\r\n\t\t\t\t\tKruskal.MESSAGE_LABEL_X,\r\n\t\t\t\t\tKruskal.MESSAGE_LABEL_Y,\r\n\t\t\t\t\t0\r\n\t\t\t\t);\r\n\t\t\t\tthis.cmd('Step');\r\n\t\t\t}\r\n\r\n\t\t\tthis.highlightEdge(\r\n\t\t\t\tthis.edgesListLeft[nextListIndex],\r\n\t\t\t\tthis.edgesListRight[nextListIndex],\r\n\t\t\t\t0\r\n\t\t\t);\r\n\t\t\tthis.highlightEdge(\r\n\t\t\t\tthis.edgesListRight[nextListIndex],\r\n\t\t\t\tthis.edgesListLeft[nextListIndex],\r\n\t\t\t\t0\r\n\t\t\t);\r\n\r\n\t\t\tthis.cmd('Delete', messageLabelID);\r\n\t\t\tthis.cmd('Delete', highlightCircle1);\r\n\t\t\tthis.cmd('Delete', highlightCircle2);\r\n\r\n\t\t\tthis.cmd('Delete', this.edgesListLeftID[nextListIndex]);\r\n\t\t\tthis.cmd('Delete', this.edgesListRightID[nextListIndex]);\r\n\t\t\tthis.cmd('SetText', findLabelLeft, '');\r\n\t\t\tthis.cmd('SetText', findLabelRight, '');\r\n\t\t\tnextListIndex++;\r\n\t\t}\r\n\t\tthis.cmd('Delete', findLabelLeft);\r\n\t\tthis.cmd('Delete', findLabelRight);\r\n\r\n\t\treturn this.commands;\r\n\t}\r\n\r\n\treset() {\r\n\t\tthis.messageID = [];\r\n\t}\r\n\r\n\tenableUI(event) {\r\n\t\tthis.startButton.disabled = false;\r\n\r\n\t\tsuper.enableUI(event);\r\n\t}\r\n\r\n\tdisableUI(event) {\r\n\t\tthis.startButton.disabled = true;\r\n\r\n\t\tsuper.disableUI(event);\r\n\t}\r\n}\r\n\r\nKruskal.HIGHLIGHT_CIRCLE_COLOR = '#000000';\r\n\r\nKruskal.SET_ARRAY_ELEM_WIDTH = 25;\r\nKruskal.SET_ARRAY_ELEM_HEIGHT = 25;\r\nKruskal.SET_ARRAY_START_X = 50;\r\nKruskal.SET_ARRAY_START_Y = 130;\r\n\r\nKruskal.EDGE_LIST_ELEM_WIDTH = 40;\r\nKruskal.EDGE_LIST_ELEM_HEIGHT = 40;\r\nKruskal.EDGE_LIST_COLUMN_WIDTH = 100;\r\nKruskal.EDGE_LIST_MAX_PER_COLUMN = 10;\r\n\r\nKruskal.EDGE_LIST_START_X = 150;\r\nKruskal.EDGE_LIST_START_Y = 130;\r\n\r\nKruskal.FIND_LABEL_1_X = 30;\r\nKruskal.FIND_LABEL_2_X = 100;\r\nKruskal.FIND_LABEL_1_Y = 30;\r\nKruskal.FIND_LABEL_2_Y = Kruskal.FIND_LABEL_1_Y;\r\n\r\nKruskal.MESSAGE_LABEL_X = 30;\r\nKruskal.MESSAGE_LABEL_Y = 50;\r\n\r\nKruskal.HIGHLIGHT_CIRCLE_COLOR_1 = '#FFAAAA';\r\nKruskal.HIGHLIGHT_CIRCLE_COLOR_2 = '#FF0000';\r\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\r\n//\r\n// Redistribution and use in source and binary forms, with or without modification, are\r\n// permitted provided that the following conditions are met:\r\n//\r\n// 1. Redistributions of source code must retain the above copyright notice, this list of\r\n// conditions and the following disclaimer.\r\n//\r\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\r\n// of conditions and the following disclaimer in the documentation and/or other materials\r\n// provided with the distribution.\r\n//\r\n// THIS SOFTWARE IS PROVIDED BY David Galles ``AS IS'' AND ANY EXPRESS OR IMPLIED\r\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\r\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\r\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\r\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\r\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\r\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\r\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\r\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\r\n//\r\n// The views and conclusions contained in the software and documentation are those of the\r\n// authors and should not be interpreted as representing official policies, either expressed\r\n// or implied, of the University of San Francisco\r\n\r\nimport Algorithm, { addControlToAlgorithmBar, addLabelToAlgorithmBar } from './Algorithm.js';\r\n\r\nconst INFO_LABEL_X = 75;\r\nconst INFO_LABEL_Y = 20;\r\n\r\nconst ARRAY_START_X = 100;\r\nconst ARRAY_START_Y = 70;\r\n\r\nconst ARRAY_ELEM_WIDTH = 50;\r\nconst ARRAY_ELEM_HEIGHT = 50;\r\n\r\nconst BUCKETS_START_X = 100;\r\nconst BUCKETS_START_Y = 140;\r\n\r\nconst BUCKET_ELEM_WIDTH = 50;\r\nconst BUCKET_ELEM_HEIGHT = 20;\r\nconst BUCKET_ELEM_SPACING = 15;\r\n\r\nexport default class LSDRadix extends Algorithm {\r\n\tconstructor(am, w, h) {\r\n\t\tsuper(am, w, h);\r\n\r\n\t\tthis.addControls();\r\n\r\n\t\t// Useful for memory management\r\n\t\tthis.nextIndex = 0;\r\n\r\n\t\t// TODO:  Add any code necessary to set up your own algorithm.  Initialize data\r\n\t\t// structures, etc.\r\n\t\tthis.setup();\r\n\t}\r\n\r\n\taddControls() {\r\n\t\tthis.controls = [];\r\n\r\n\t\taddLabelToAlgorithmBar('Comma separated list (e.g. \"3,1,2\", max 9 elements)');\r\n\r\n\t\t// List text field\r\n\t\tthis.listField = addControlToAlgorithmBar('Text', '');\r\n\t\tthis.listField.onkeydown = this.returnSubmit(\r\n\t\t\tthis.listField,\r\n\t\t\tthis.sortCallback.bind(this),\r\n\t\t\t60,\r\n\t\t\tfalse\r\n\t\t);\r\n\t\tthis.controls.push(this.listField);\r\n\r\n\t\t// Sort button\r\n\t\tthis.findButton = addControlToAlgorithmBar('Button', 'Sort');\r\n\t\tthis.findButton.onclick = this.sortCallback.bind(this);\r\n\t\tthis.controls.push(this.findButton);\r\n\r\n\t\t// Clear button\r\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear');\r\n\t\tthis.clearButton.onclick = this.clearCallback.bind(this);\r\n\t\tthis.controls.push(this.clearButton);\r\n\t}\r\n\r\n\tsetup() {\r\n\t\tthis.arrayData = [];\r\n\t\tthis.arrayID = [];\r\n\t\tthis.arrayDisplay = [];\r\n\t\tthis.bucketsData = [];\r\n\t\tthis.bucketsID = [];\r\n\t\tthis.bucketsDisplay = [];\r\n\t\tthis.iPointerID = this.nextIndex++;\r\n\t\tthis.jPointerID = this.nextIndex++;\r\n\t\tthis.infoLabelID = this.nextIndex++;\r\n\t}\r\n\r\n\treset() {\r\n\t\t// Reset all of your data structures to *exactly* the state they have immediately after the init\r\n\t\t// function is called.  This method is called whenever an \"undo\" is performed.  Your data\r\n\t\t// structures are completely cleaned, and then all of the actions *up to but not including* the\r\n\t\t// last action are then redone.  If you implement all of your actions through the \"implementAction\"\r\n\t\t// method below, then all of this work is done for you in the Animation \"superexport default class\"\r\n\r\n\t\t// Reset the (very simple) memory manager\r\n\t\tthis.nextIndex = 0;\r\n\t}\r\n\r\n\tsortCallback() {\r\n\t\tif (this.listField.value !== '') {\r\n\t\t\tthis.implementAction(this.clear.bind(this), '');\r\n\t\t\tconst list = this.listField.value;\r\n\t\t\tthis.listField.value = '';\r\n\t\t\tthis.implementAction(this.sort.bind(this), list);\r\n\t\t}\r\n\t}\r\n\r\n\tclearCallback() {\r\n\t\tthis.implementAction(this.clear.bind(this), '');\r\n\t}\r\n\r\n\tclear() {\r\n\t\tthis.commands = [];\r\n\t\tfor (let i = 0; i < this.arrayID.length; i++) {\r\n\t\t\tthis.cmd('Delete', this.arrayID[i]);\r\n\t\t}\r\n\t\tthis.arrayData = [];\r\n\t\tthis.arrayID = [];\r\n\t\tthis.arrayDisplay = [];\r\n\t\tthis.bucketsData = [];\r\n\t\tthis.bucketsID = [];\r\n\t\tthis.bucketsDisplay = [];\r\n\t\treturn this.commands;\r\n\t}\r\n\r\n\tsort(params) {\r\n\t\tthis.commands = [];\r\n\r\n\t\tthis.arrayID = [];\r\n\t\tthis.arrayData = params\r\n\t\t\t.split(',')\r\n\t\t\t.map(Number)\r\n\t\t\t.filter(x => x)\r\n\t\t\t.slice(0, 9);\r\n\t\tconst length = this.arrayData.length;\r\n\t\tconst elemCounts = new Map();\r\n\t\tconst letterMap = new Map();\r\n\r\n\t\tfor (let i = 0; i < length; i++) {\r\n\t\t\tconst count = elemCounts.has(this.arrayData[i]) ? elemCounts.get(this.arrayData[i]) : 0;\r\n\t\t\tif (count > 0) {\r\n\t\t\t\tletterMap.set(this.arrayData[i], 'A');\r\n\t\t\t}\r\n\t\t\telemCounts.set(this.arrayData[i], count + 1);\r\n\t\t}\r\n\r\n\t\tfor (let i = 0; i < length; i++) {\r\n\t\t\tthis.arrayID[i] = this.nextIndex++;\r\n\t\t\tconst xpos = i * ARRAY_ELEM_WIDTH + ARRAY_START_X;\r\n\t\t\tconst ypos = ARRAY_START_Y;\r\n\r\n\t\t\tlet arrayDisplay = this.arrayData[i].toString();\r\n\t\t\tif (letterMap.has(this.arrayData[i])) {\r\n\t\t\t\tconst currChar = letterMap.get(this.arrayData[i]);\r\n\t\t\t\tarrayDisplay += currChar;\r\n\t\t\t\tletterMap.set(this.arrayData[i], String.fromCharCode(currChar.charCodeAt(0) + 1));\r\n\t\t\t}\r\n\t\t\tthis.arrayDisplay[i] = arrayDisplay;\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'CreateRectangle',\r\n\t\t\t\tthis.arrayID[i],\r\n\t\t\t\tarrayDisplay,\r\n\t\t\t\tARRAY_ELEM_WIDTH,\r\n\t\t\t\tARRAY_ELEM_HEIGHT,\r\n\t\t\t\txpos,\r\n\t\t\t\typos\r\n\t\t\t);\r\n\t\t}\r\n\r\n\t\tthis.bucketsData = [];\r\n\t\tthis.bucketsID = [];\r\n\r\n\t\tfor (let i = 0; i < 10; i++) {\r\n\t\t\tthis.bucketsData[i] = [];\r\n\t\t\tthis.bucketsID[i] = [];\r\n\t\t\tthis.bucketsDisplay[i] = [];\r\n\t\t\tthis.bucketsID[i].push(this.nextIndex++);\r\n\t\t\tconst xpos = i * ARRAY_ELEM_WIDTH + BUCKETS_START_X;\r\n\t\t\tconst ypos = BUCKETS_START_Y;\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'CreateRectangle',\r\n\t\t\t\tthis.bucketsID[i],\r\n\t\t\t\ti,\r\n\t\t\t\tBUCKET_ELEM_WIDTH,\r\n\t\t\t\tBUCKET_ELEM_HEIGHT,\r\n\t\t\t\txpos,\r\n\t\t\t\typos\r\n\t\t\t);\r\n\t\t\tthis.cmd('SetBackgroundColor', this.bucketsID[i], '#D3D3D3');\r\n\t\t}\r\n\r\n\t\tthis.cmd(\r\n\t\t\t'CreateLabel',\r\n\t\t\tthis.infoLabelID,\r\n\t\t\t'Searching for number with greatest magnitude',\r\n\t\t\tINFO_LABEL_X,\r\n\t\t\tINFO_LABEL_Y,\r\n\t\t\t0\r\n\t\t);\r\n\t\tthis.cmd('CreateHighlightCircle', this.iPointerID, '#FF0000', ARRAY_START_X, ARRAY_START_Y);\r\n\t\tthis.cmd('SetHighlight', this.iPointerID, 1);\r\n\t\tthis.cmd(\r\n\t\t\t'CreateHighlightCircle',\r\n\t\t\tthis.jPointerID,\r\n\t\t\t'#0000FF',\r\n\t\t\tARRAY_START_X + ARRAY_ELEM_WIDTH,\r\n\t\t\tARRAY_START_Y\r\n\t\t);\r\n\t\tthis.cmd('SetHighlight', this.jPointerID, 1);\r\n\t\tthis.cmd('SetBackgroundColor', this.arrayID[0], '#FFFF00');\r\n\t\tthis.cmd('Step');\r\n\r\n\t\tlet greatest = 0;\r\n\t\tfor (let i = 1; i < this.arrayData.length; i++) {\r\n\t\t\tthis.movePointers(greatest, i);\r\n\t\t\tif (this.arrayData[i] > this.arrayData[greatest]) {\r\n\t\t\t\tthis.cmd('SetBackgroundColor', this.arrayID[greatest], '#FFFFFF');\r\n\t\t\t\tthis.cmd('Step');\r\n\t\t\t\tgreatest = i;\r\n\t\t\t\tthis.movePointers(greatest, i);\r\n\t\t\t\tthis.cmd('SetBackgroundColor', this.arrayID[greatest], '#FFFF00');\r\n\t\t\t\tthis.cmd('Step');\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis.cmd('Delete', this.iPointerID);\r\n\t\tthis.cmd('Delete', this.jPointerID);\r\n\t\tthis.cmd('Step');\r\n\r\n\t\tlet digits = Math.floor(Math.log10(this.arrayData[greatest])) + 1;\r\n\t\tdigits = digits || 1; // If greatest is 0, above returns NaN, so set to 1 if that happens\r\n\r\n\t\tconst longData = this.arrayData[greatest];\r\n\t\tthis.cmd(\r\n\t\t\t'SetText',\r\n\t\t\tthis.infoLabelID,\r\n\t\t\tlongData + ' has greatest magnitude, number of digits is ' + digits\r\n\t\t);\r\n\t\tthis.cmd('Step');\r\n\r\n\t\tthis.cmd('SetBackgroundColor', this.arrayID[greatest], '#FFFFFF');\r\n\r\n\t\tfor (let i = 0; i < digits; i++) {\r\n\t\t\tthis.cmd('SetText', this.infoLabelID, 'Getting digits at position ' + (i + 1));\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'CreateHighlightCircle',\r\n\t\t\t\tthis.iPointerID,\r\n\t\t\t\t'#0000FF',\r\n\t\t\t\tARRAY_START_X,\r\n\t\t\t\tARRAY_START_Y\r\n\t\t\t);\r\n\t\t\tthis.cmd('SetHighlight', this.iPointerID, 1);\r\n\t\t\tfor (let j = 0; j < this.arrayData.length; j++) {\r\n\t\t\t\tthis.cmd(\r\n\t\t\t\t\t'Move',\r\n\t\t\t\t\tthis.iPointerID,\r\n\t\t\t\t\tARRAY_START_X + j * ARRAY_ELEM_WIDTH,\r\n\t\t\t\t\tARRAY_START_Y\r\n\t\t\t\t);\r\n\t\t\t\tthis.cmd('Step');\r\n\t\t\t\tconst id = this.nextIndex++;\r\n\t\t\t\tconst data = this.arrayData[j];\r\n\t\t\t\tconst display = this.arrayDisplay[j];\r\n\t\t\t\tconst digit = this.nthDigit(data, i);\r\n\t\t\t\tthis.bucketsID[digit].push(id);\r\n\t\t\t\tthis.bucketsData[digit].push(data);\r\n\t\t\t\tthis.bucketsDisplay[digit].push(display);\r\n\t\t\t\tconst len = this.bucketsData[digit].length;\r\n\t\t\t\tthis.cmd(\r\n\t\t\t\t\t'CreateRectangle',\r\n\t\t\t\t\tid,\r\n\t\t\t\t\tdisplay,\r\n\t\t\t\t\tBUCKET_ELEM_WIDTH,\r\n\t\t\t\t\tBUCKET_ELEM_HEIGHT,\r\n\t\t\t\t\tBUCKETS_START_X + digit * BUCKET_ELEM_WIDTH,\r\n\t\t\t\t\tBUCKETS_START_Y + len * BUCKET_ELEM_HEIGHT + len * BUCKET_ELEM_SPACING\r\n\t\t\t\t);\r\n\t\t\t\tthis.cmd(\r\n\t\t\t\t\t'Connect',\r\n\t\t\t\t\tthis.bucketsID[digit][this.bucketsID[digit].length - 2],\r\n\t\t\t\t\tid,\r\n\t\t\t\t\t0,\r\n\t\t\t\t\t0,\r\n\t\t\t\t\t1,\r\n\t\t\t\t\t'',\r\n\t\t\t\t\t2\r\n\t\t\t\t);\r\n\t\t\t\tthis.cmd('Step');\r\n\t\t\t}\r\n\t\t\tthis.cmd('Delete', this.iPointerID);\r\n\t\t\tthis.cmd('Step');\r\n\t\t\tlet index = 0;\r\n\t\t\tfor (let j = 0; j < 10; j++) {\r\n\t\t\t\tconst idBucket = this.bucketsID[j];\r\n\t\t\t\tconst dataBucket = this.bucketsData[j];\r\n\t\t\t\tconst displayBucket = this.bucketsDisplay[j];\r\n\t\t\t\twhile (dataBucket.length) {\r\n\t\t\t\t\tconst labelID = this.nextIndex++;\r\n\t\t\t\t\tconst nodeID = idBucket.splice(1, 1)[0];\r\n\t\t\t\t\tconst data = dataBucket.shift();\r\n\t\t\t\t\tconst display = displayBucket.shift();\r\n\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t'CreateLabel',\r\n\t\t\t\t\t\tlabelID,\r\n\t\t\t\t\t\tdisplay,\r\n\t\t\t\t\t\tBUCKETS_START_X + j * BUCKET_ELEM_WIDTH,\r\n\t\t\t\t\t\tBUCKETS_START_Y + BUCKET_ELEM_HEIGHT + BUCKET_ELEM_SPACING\r\n\t\t\t\t\t);\r\n\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t'Move',\r\n\t\t\t\t\t\tlabelID,\r\n\t\t\t\t\t\tARRAY_START_X + index * ARRAY_ELEM_WIDTH,\r\n\t\t\t\t\t\tARRAY_START_Y\r\n\t\t\t\t\t);\r\n\t\t\t\t\tthis.cmd('Step');\r\n\t\t\t\t\tthis.cmd('SetText', this.arrayID[index], display);\r\n\t\t\t\t\tthis.cmd('Delete', labelID);\r\n\t\t\t\t\tthis.cmd('Step');\r\n\t\t\t\t\tthis.cmd('Delete', nodeID);\r\n\t\t\t\t\tif (dataBucket.length) {\r\n\t\t\t\t\t\tthis.cmd('Connect', idBucket[0], idBucket[1]);\r\n\t\t\t\t\t\tfor (let k = 1; k < idBucket.length; k++) {\r\n\t\t\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t\t\t'Move',\r\n\t\t\t\t\t\t\t\tidBucket[k],\r\n\t\t\t\t\t\t\t\tBUCKETS_START_X + j * BUCKET_ELEM_WIDTH,\r\n\t\t\t\t\t\t\t\tBUCKETS_START_Y + k * BUCKET_ELEM_HEIGHT + k * BUCKET_ELEM_SPACING\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tthis.cmd('Step');\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.arrayData[index] = data;\r\n\t\t\t\t\tthis.arrayDisplay[index] = display;\r\n\t\t\t\t\tindex++;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis.cmd('Delete', this.infoLabelID);\r\n\r\n\t\treturn this.commands;\r\n\t}\r\n\r\n\tmovePointers(i, j) {\r\n\t\tconst iXPos = i * ARRAY_ELEM_WIDTH + ARRAY_START_X;\r\n\t\tconst iYPos = ARRAY_START_Y;\r\n\t\tthis.cmd('Move', this.iPointerID, iXPos, iYPos);\r\n\t\tconst jXPos = j * ARRAY_ELEM_WIDTH + ARRAY_START_X;\r\n\t\tconst jYPos = ARRAY_START_Y;\r\n\t\tthis.cmd('Move', this.jPointerID, jXPos, jYPos);\r\n\t\tthis.cmd('Step');\r\n\t}\r\n\r\n\tswap(i, j) {\r\n\t\tconst iLabelID = this.nextIndex++;\r\n\t\tconst iXPos = i * ARRAY_ELEM_WIDTH + ARRAY_START_X;\r\n\t\tconst iYPos = ARRAY_START_Y;\r\n\t\tthis.cmd('CreateLabel', iLabelID, this.displayData[i], iXPos, iYPos);\r\n\t\tconst jLabelID = this.nextIndex++;\r\n\t\tconst jXPos = j * ARRAY_ELEM_WIDTH + ARRAY_START_X;\r\n\t\tconst jYPos = ARRAY_START_Y;\r\n\t\tthis.cmd('CreateLabel', jLabelID, this.displayData[j], jXPos, jYPos);\r\n\t\tthis.cmd('Settext', this.arrayID[i], '');\r\n\t\tthis.cmd('Settext', this.arrayID[j], '');\r\n\t\tthis.cmd('Move', iLabelID, jXPos, jYPos);\r\n\t\tthis.cmd('Move', jLabelID, iXPos, iYPos);\r\n\t\tthis.cmd('Step');\r\n\t\tthis.cmd('Settext', this.arrayID[i], this.displayData[j]);\r\n\t\tthis.cmd('Settext', this.arrayID[j], this.displayData[i]);\r\n\t\tthis.cmd('Delete', iLabelID);\r\n\t\tthis.cmd('Delete', jLabelID);\r\n\t\t// Swap data in backend array\r\n\t\tlet temp = this.arrayData[i];\r\n\t\tthis.arrayData[i] = this.arrayData[j];\r\n\t\tthis.arrayData[j] = temp;\r\n\t\t// Swap data in display array\r\n\t\ttemp = this.displayData[i];\r\n\t\tthis.displayData[i] = this.displayData[j];\r\n\t\tthis.displayData[j] = temp;\r\n\t}\r\n\r\n\tnthDigit(data, digit) {\r\n\t\tdata = Math.floor(data / Math.pow(10, digit));\r\n\t\tdata %= 10;\r\n\t\treturn data;\r\n\t}\r\n\r\n\t// Called by our superexport default class when we get an animation started event -- need to wait for the\r\n\t// event to finish before we start doing anything\r\n\tdisableUI() {\r\n\t\tfor (let i = 0; i < this.controls.length; i++) {\r\n\t\t\tthis.controls[i].disabled = true;\r\n\t\t}\r\n\t}\r\n\r\n\t// Called by our superexport default class when we get an animation completed event -- we can\r\n\t/// now interact again.\r\n\tenableUI() {\r\n\t\tfor (let i = 0; i < this.controls.length; i++) {\r\n\t\t\tthis.controls[i].disabled = false;\r\n\t\t}\r\n\t}\r\n}\r\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\r\n//\r\n// Redistribution and use in source and binary forms, with or without modification, are\r\n// permitted provided that the following conditions are met:\r\n//\r\n// 1. Redistributions of source code must retain the above copyright notice, this list of\r\n// conditions and the following disclaimer.\r\n//\r\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\r\n// of conditions and the following disclaimer in the documentation and/or other materials\r\n// provided with the distribution.\r\n//\r\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\r\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\r\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\r\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\r\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\r\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\r\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\r\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\r\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\r\n//\r\n// The views and conclusions contained in the software and documentation are those of the\r\n// authors and should not be interpreted as representing official policies, either expressed\r\n// or implied, of the University of San Francisco\r\n\r\nimport Algorithm, { addControlToAlgorithmBar, addLabelToAlgorithmBar } from './Algorithm.js';\r\n\r\nconst LINKED_LIST_START_X = 100;\r\nconst LINKED_LIST_START_Y = 200;\r\nconst LINKED_LIST_ELEM_WIDTH = 70;\r\nconst LINKED_LIST_ELEM_HEIGHT = 30;\r\n\r\nconst LINKED_LIST_INSERT_X = 200;\r\nconst LINKED_LIST_INSERT_Y = 50;\r\n\r\nconst LINKED_LIST_ELEMS_PER_LINE = 8;\r\nconst LINKED_LIST_ELEM_SPACING = 100;\r\nconst LINKED_LIST_LINE_SPACING = 100;\r\n\r\n// const TOP_POS_X = 180;\r\n// const TOP_POS_Y = 100;\r\n// const TOP_LABEL_X = 130;\r\n// const TOP_LABEL_Y =  100;\r\n\r\n// const TOP_ELEM_WIDTH = 30;\r\n// const TOP_ELEM_HEIGHT = 30;\r\n\r\nconst PUSH_LABEL_X = 50;\r\nconst PUSH_LABEL_Y = 30;\r\nconst PUSH_ELEMENT_X = 120;\r\nconst PUSH_ELEMENT_Y = 30;\r\n\r\nconst SIZE = 32;\r\n\r\nexport default class LinkedList extends Algorithm {\r\n\tconstructor(am, w, h) {\r\n\t\tsuper(am, w, h);\r\n\t\tthis.addControls();\r\n\r\n\t\t// Useful for memory management\r\n\t\tthis.nextIndex = 0;\r\n\r\n\t\tthis.setup();\r\n\r\n\t\tthis.initialIndex = this.nextIndex;\r\n\t}\r\n\r\n\taddControls() {\r\n\t\tthis.controls = [];\r\n\r\n\t\taddLabelToAlgorithmBar('Value');\r\n\r\n\t\t// Add's value text field\r\n\t\tthis.addValueField = addControlToAlgorithmBar('Text', '');\r\n\t\tthis.addValueField.onkeydown = this.returnSubmit(\r\n\t\t\tthis.addValueField,\r\n\t\t\tthis.addIndexCallback.bind(this),\r\n\t\t\t4,\r\n\t\t\ttrue\r\n\t\t);\r\n\t\tthis.controls.push(this.addValueField);\r\n\r\n\t\taddLabelToAlgorithmBar('at index');\r\n\r\n\t\t// Add's index text field\r\n\t\tthis.addIndexField = addControlToAlgorithmBar('Text', '');\r\n\t\tthis.addIndexField.onkeydown = this.returnSubmit(\r\n\t\t\tthis.addIndexField,\r\n\t\t\tthis.addIndexCallback.bind(this),\r\n\t\t\t4,\r\n\t\t\ttrue\r\n\t\t);\r\n\t\tthis.controls.push(this.addIndexField);\r\n\r\n\t\t// Add at index button\r\n\t\tthis.addIndexButton = addControlToAlgorithmBar('Button', 'Add at Index');\r\n\t\tthis.addIndexButton.onclick = this.addIndexCallback.bind(this);\r\n\t\tthis.controls.push(this.addIndexButton);\r\n\r\n\t\taddLabelToAlgorithmBar('or');\r\n\r\n\t\t// Add to front button\r\n\t\tthis.addFrontButton = addControlToAlgorithmBar('Button', 'Add to Front');\r\n\t\tthis.addFrontButton.onclick = this.addFrontCallback.bind(this);\r\n\t\tthis.controls.push(this.addFrontButton);\r\n\r\n\t\t// Add to back button\r\n\t\tthis.addBackButton = addControlToAlgorithmBar('Button', 'Add to Back');\r\n\t\tthis.addBackButton.onclick = this.addBackCallback.bind(this);\r\n\t\tthis.controls.push(this.addBackButton);\r\n\r\n\t\t// Remove's index text field\r\n\t\tthis.removeField = addControlToAlgorithmBar('Text', '');\r\n\t\tthis.removeField.onkeydown = this.returnSubmit(\r\n\t\t\tthis.removeField,\r\n\t\t\tthis.removeIndexCallback.bind(this),\r\n\t\t\t4,\r\n\t\t\ttrue\r\n\t\t);\r\n\t\tthis.controls.push(this.removeField);\r\n\r\n\t\t// Remove from index button\r\n\t\tthis.removeIndexButton = addControlToAlgorithmBar('Button', 'Remove from Index');\r\n\t\tthis.removeIndexButton.onclick = this.removeIndexCallback.bind(this);\r\n\t\tthis.controls.push(this.removeIndexButton);\r\n\r\n\t\taddLabelToAlgorithmBar('or');\r\n\r\n\t\t// Remove from front button\r\n\t\tthis.removeFrontButton = addControlToAlgorithmBar('Button', 'Remove from Front');\r\n\t\tthis.removeFrontButton.onclick = this.removeFrontCallback.bind(this);\r\n\t\tthis.controls.push(this.removeFrontButton);\r\n\r\n\t\t// Remove from back button\r\n\t\tthis.removeBackButton = addControlToAlgorithmBar('Button', 'Remove from Back');\r\n\t\tthis.removeBackButton.onclick = this.removeBackCallback.bind(this);\r\n\t\tthis.controls.push(this.removeBackButton);\r\n\r\n\t\t// Get's index text field\r\n\t\t// this.getField = addControlToAlgorithmBar(\"Text\", \"\");\r\n\t\t// this.getField.onkeydown = this.returnSubmit(this.getField, this.getCallback.bind(this), 4, true);\r\n\t\t// this.controls.push(this.getField);\r\n\r\n\t\t// Get button\r\n\t\t// this.getButton = addControlToAlgorithmBar(\"Button\", \"Get\");\r\n\t\t// this.getButton.onclick = this.getCallback.bind(this);\r\n\t\t// this.controls.push(this.getButton);\r\n\r\n\t\t// Clear button\r\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear');\r\n\t\tthis.clearButton.onclick = this.clearCallback.bind(this);\r\n\t\tthis.controls.push(this.clearButton);\r\n\t}\r\n\r\n\tenableUI() {\r\n\t\tfor (let i = 0; i < this.controls.length; i++) {\r\n\t\t\tthis.controls[i].disabled = false;\r\n\t\t}\r\n\t}\r\n\r\n\tdisableUI() {\r\n\t\tfor (let i = 0; i < this.controls.length; i++) {\r\n\t\t\tthis.controls[i].disabled = true;\r\n\t\t}\r\n\t}\r\n\r\n\tsetup() {\r\n\t\tthis.linkedListElemID = new Array(SIZE);\r\n\r\n\t\tthis.arrayData = new Array(SIZE);\r\n\t\tthis.size = 0;\r\n\t\tthis.leftoverLabelID = this.nextIndex++;\r\n\r\n\t\tthis.cmd('CreateLabel', this.leftoverLabelID, '', PUSH_LABEL_X, PUSH_LABEL_Y);\r\n\r\n\t\tthis.animationManager.StartNewAnimation(this.commands);\r\n\t\tthis.animationManager.skipForward();\r\n\t\tthis.animationManager.clearHistory();\r\n\t}\r\n\r\n\treset() {\r\n\t\tthis.size = 0;\r\n\t\tthis.nextIndex = this.initialIndex;\r\n\t}\r\n\r\n\taddIndexCallback() {\r\n\t\tif (this.addValueField.value !== '' && this.addIndexField.value !== '') {\r\n\t\t\tconst addVal = this.addValueField.value;\r\n\t\t\tconst index = this.addIndexField.value;\r\n\t\t\tif (index >= 0 && index <= this.size) {\r\n\t\t\t\tthis.addValueField.value = '';\r\n\t\t\t\tthis.addIndexField.value = '';\r\n\t\t\t\tthis.implementAction(this.add.bind(this), addVal + ',' + index);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\taddFrontCallback() {\r\n\t\tif (this.addValueField.value !== '') {\r\n\t\t\tconst addVal = this.addValueField.value;\r\n\t\t\tthis.addValueField.value = '';\r\n\t\t\tthis.implementAction(this.add.bind(this), addVal + ',' + 0);\r\n\t\t}\r\n\t}\r\n\r\n\taddBackCallback() {\r\n\t\tif (this.addValueField.value !== '') {\r\n\t\t\tconst addVal = this.addValueField.value;\r\n\t\t\tthis.addValueField.value = '';\r\n\t\t\tthis.implementAction(this.add.bind(this), addVal + ',' + this.size);\r\n\t\t}\r\n\t}\r\n\r\n\tremoveIndexCallback() {\r\n\t\tif (this.removeField.value !== '') {\r\n\t\t\tconst index = this.removeField.value;\r\n\t\t\tif (index >= 0 && index < this.size) {\r\n\t\t\t\tthis.removeField.value = '';\r\n\t\t\t\tthis.implementAction(this.remove.bind(this), index);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tremoveFrontCallback() {\r\n\t\tif (this.size > 0) {\r\n\t\t\tthis.implementAction(this.remove.bind(this), 0);\r\n\t\t}\r\n\t}\r\n\r\n\tremoveBackCallback() {\r\n\t\tif (this.size > 0) {\r\n\t\t\tthis.implementAction(this.remove.bind(this), this.size - 1);\r\n\t\t}\r\n\t}\r\n\r\n\t// getCallback()\r\n\t// {\r\n\t//     if (this.getField.value != \"\" && this.getField.value > 0 && this.getField.value < this.size)\r\n\t//     {\r\n\t//         this.implementAction(this.get.bind(this), \"\");\r\n\t//     }\r\n\t// }\r\n\r\n\tclearCallback() {\r\n\t\tthis.implementAction(this.clearAll.bind(this), '');\r\n\t}\r\n\r\n\tadd(params) {\r\n\t\tthis.commands = [];\r\n\r\n\t\tconst elemToAdd = parseInt(params.split(',')[0]);\r\n\t\tconst index = parseInt(params.split(',')[1]);\r\n\r\n\t\tconst labPushID = this.nextIndex++;\r\n\t\tconst labPushValID = this.nextIndex++;\r\n\r\n\t\tfor (let i = this.size - 1; i >= index; i--) {\r\n\t\t\tthis.arrayData[i + 1] = this.arrayData[i];\r\n\t\t\tthis.linkedListElemID[i + 1] = this.linkedListElemID[i];\r\n\t\t}\r\n\t\tthis.arrayData[index] = elemToAdd;\r\n\t\tthis.linkedListElemID[index] = this.nextIndex++;\r\n\r\n\t\tthis.cmd('SetText', this.leftoverLabelID, '');\r\n\r\n\t\tthis.cmd(\r\n\t\t\t'CreateLinkedList',\r\n\t\t\tthis.linkedListElemID[index],\r\n\t\t\t'',\r\n\t\t\tLINKED_LIST_ELEM_WIDTH,\r\n\t\t\tLINKED_LIST_ELEM_HEIGHT,\r\n\t\t\tLINKED_LIST_INSERT_X,\r\n\t\t\tLINKED_LIST_INSERT_Y,\r\n\t\t\t0.25,\r\n\t\t\t0,\r\n\t\t\t1,\r\n\t\t\t1\r\n\t\t);\r\n\r\n\t\tthis.cmd('CreateLabel', labPushID, 'Adding Value: ', PUSH_LABEL_X, PUSH_LABEL_Y);\r\n\t\tthis.cmd('CreateLabel', labPushValID, elemToAdd, PUSH_ELEMENT_X, PUSH_ELEMENT_Y);\r\n\r\n\t\tthis.cmd('Step');\r\n\r\n\t\tthis.cmd('Move', labPushValID, LINKED_LIST_INSERT_X, LINKED_LIST_INSERT_Y);\r\n\r\n\t\tthis.cmd('Step');\r\n\t\tthis.cmd('SetText', this.linkedListElemID[index], elemToAdd);\r\n\t\tthis.cmd('Delete', labPushValID);\r\n\r\n\t\tif (index === this.size) {\r\n\t\t\tthis.cmd('SetNull', this.linkedListElemID[index], 1);\r\n\t\t}\r\n\r\n\t\tif (this.size !== 0) {\r\n\t\t\tif (index === 0) {\r\n\t\t\t\tthis.cmd('Connect', this.linkedListElemID[index], this.linkedListElemID[index + 1]);\r\n\t\t\t} else if (index === this.size) {\r\n\t\t\t\tthis.cmd('SetNull', this.linkedListElemID[index - 1], 0);\r\n\t\t\t\tthis.cmd('Connect', this.linkedListElemID[index - 1], this.linkedListElemID[index]);\r\n\t\t\t} else {\r\n\t\t\t\tthis.cmd(\r\n\t\t\t\t\t'Disconnect',\r\n\t\t\t\t\tthis.linkedListElemID[index - 1],\r\n\t\t\t\t\tthis.linkedListElemID[index + 1]\r\n\t\t\t\t);\r\n\t\t\t\tthis.cmd('Connect', this.linkedListElemID[index - 1], this.linkedListElemID[index]);\r\n\t\t\t\tthis.cmd('Connect', this.linkedListElemID[index], this.linkedListElemID[index + 1]);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis.cmd('Step');\r\n\t\tthis.size = this.size + 1;\r\n\t\tthis.resetNodePositions();\r\n\t\tthis.cmd('Delete', labPushID);\r\n\t\tthis.cmd('Step');\r\n\r\n\t\treturn this.commands;\r\n\t}\r\n\r\n\tremove(index) {\r\n\t\tthis.commands = [];\r\n\r\n\t\tindex = parseInt(index);\r\n\t\tconst labPopID = this.nextIndex++;\r\n\t\tconst labPopValID = this.nextIndex++;\r\n\r\n\t\tthis.cmd('SetText', this.leftoverLabelID, '');\r\n\r\n\t\tconst nodePosX = LINKED_LIST_START_X + LINKED_LIST_ELEM_SPACING * index;\r\n\t\tconst nodePosY = LINKED_LIST_START_Y;\r\n\t\tthis.cmd('CreateLabel', labPopID, 'Removing Value: ', PUSH_LABEL_X, PUSH_LABEL_Y);\r\n\t\tthis.cmd('CreateLabel', labPopValID, this.arrayData[index], nodePosX, nodePosY);\r\n\t\tthis.cmd('Move', labPopValID, PUSH_ELEMENT_X, PUSH_ELEMENT_Y);\r\n\t\tthis.cmd('Step');\r\n\r\n\t\tif (this.size !== 1) {\r\n\t\t\tif (index === 0) {\r\n\t\t\t\t//TODO: Move head pointer\r\n\t\t\t} else if (index === this.size - 1) {\r\n\t\t\t\tthis.cmd(\r\n\t\t\t\t\t'Disconnect',\r\n\t\t\t\t\tthis.linkedListElemID[index - 1],\r\n\t\t\t\t\tthis.linkedListElemID[index]\r\n\t\t\t\t);\r\n\t\t\t\tthis.cmd('SetNull', this.linkedListElemID[index - 1], 1);\r\n\t\t\t} else {\r\n\t\t\t\tconst xPos =\r\n\t\t\t\t\t(index % LINKED_LIST_ELEMS_PER_LINE) * LINKED_LIST_ELEM_SPACING +\r\n\t\t\t\t\tLINKED_LIST_START_X;\r\n\t\t\t\tconst yPos = LINKED_LIST_START_Y - LINKED_LIST_ELEM_HEIGHT * 2;\r\n\t\t\t\tthis.cmd('Move', this.linkedListElemID[index], xPos, yPos);\r\n\t\t\t\tthis.cmd('Step');\r\n\t\t\t\tthis.cmd(\r\n\t\t\t\t\t'Disconnect',\r\n\t\t\t\t\tthis.linkedListElemID[index - 1],\r\n\t\t\t\t\tthis.linkedListElemID[index]\r\n\t\t\t\t);\r\n\t\t\t\tthis.cmd(\r\n\t\t\t\t\t'Connect',\r\n\t\t\t\t\tthis.linkedListElemID[index - 1],\r\n\t\t\t\t\tthis.linkedListElemID[index + 1]\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.cmd('Step');\r\n\t\tthis.cmd('Delete', this.linkedListElemID[index]);\r\n\r\n\t\tfor (let i = index; i < this.size; i++) {\r\n\t\t\tthis.arrayData[i] = this.arrayData[i + 1];\r\n\t\t\tthis.linkedListElemID[i] = this.linkedListElemID[i + 1];\r\n\t\t}\r\n\t\tthis.size = this.size - 1;\r\n\t\tthis.resetNodePositions();\r\n\r\n\t\tthis.cmd('Delete', labPopValID);\r\n\t\tthis.cmd('Delete', labPopID);\r\n\r\n\t\treturn this.commands;\r\n\t}\r\n\r\n\tresetNodePositions() {\r\n\t\tfor (let i = 0; i < this.size; i++) {\r\n\t\t\tconst nextX =\r\n\t\t\t\t(i % LINKED_LIST_ELEMS_PER_LINE) * LINKED_LIST_ELEM_SPACING + LINKED_LIST_START_X;\r\n\t\t\tconst nextY =\r\n\t\t\t\tMath.floor(i / LINKED_LIST_ELEMS_PER_LINE) * LINKED_LIST_LINE_SPACING +\r\n\t\t\t\tLINKED_LIST_START_Y;\r\n\t\t\tthis.cmd('Move', this.linkedListElemID[i], nextX, nextY);\r\n\t\t}\r\n\t}\r\n\r\n\tclearAll() {\r\n\t\tthis.commands = [];\r\n\t\tfor (let i = 0; i < this.size; i++) {\r\n\t\t\tthis.cmd('Delete', this.linkedListElemID[i]);\r\n\t\t}\r\n\t\tthis.size = 0;\r\n\t\treturn this.commands;\r\n\t}\r\n}\r\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\r\n//\r\n// Redistribution and use in source and binary forms, with or without modification, are\r\n// permitted provided that the following conditions are met:\r\n//\r\n// 1. Redistributions of source code must retain the above copyright notice, this list of\r\n// conditions and the following disclaimer.\r\n//\r\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\r\n// of conditions and the following disclaimer in the documentation and/or other materials\r\n// provided with the distribution.\r\n//\r\n// THIS SOFTWARE IS PROVIDED BY David Galles ``AS IS'' AND ANY EXPRESS OR IMPLIED\r\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\r\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\r\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\r\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\r\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\r\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\r\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\r\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\r\n//\r\n// The views and conclusions contained in the software and documentation are those of the\r\n// authors and should not be interpreted as representing official policies, either expressed\r\n// or implied, of the University of San Francisco\r\n\r\nimport Algorithm, { addControlToAlgorithmBar, addLabelToAlgorithmBar } from './Algorithm.js';\r\n\r\nconst ARRAY_START_X = 120;\r\nconst ARRAY_START_Y = 50;\r\nconst ARRAY_LINE_SPACING = 80;\r\nconst ARRAY_ELEM_WIDTH = 50;\r\nconst ARRAY_ELEM_HEIGHT = 50;\r\n\r\n// const ARRRAY_ELEMS_PER_LINE = 15;\r\n\r\n// const TOP_POS_X = 180;\r\n// const TOP_POS_Y = 100;\r\n// const TOP_LABEL_X = 130;\r\n// const TOP_LABEL_Y = 100;\r\n\r\n// const PUSH_LABEL_X = 50;\r\n// const PUSH_LABEL_Y = 30;\r\n// const PUSH_ELEMENT_X = 120;\r\n// const PUSH_ELEMENT_Y = 30;\r\n\r\n// const SIZE = 10;\r\n\r\nconst LARGE_OFFSET = 15;\r\nconst SMALL_OFFSET = 7;\r\n\r\nexport default class MergeSort extends Algorithm {\r\n\tconstructor(am, w, h) {\r\n\t\tsuper(am, w, h);\r\n\r\n\t\tthis.addControls();\r\n\r\n\t\t// Useful for memory management\r\n\t\tthis.nextIndex = 0;\r\n\r\n\t\t// TODO:  Add any code necessary to set up your own algorithm.  Initialize data\r\n\t\t// structures, etc.\r\n\t\tthis.setup();\r\n\t}\r\n\r\n\taddControls() {\r\n\t\tthis.controls = [];\r\n\r\n\t\taddLabelToAlgorithmBar('Comma separated list (e.g. \"3,1,2\", max 12 elements)');\r\n\r\n\t\t// List text field\r\n\t\tthis.listField = addControlToAlgorithmBar('Text', '');\r\n\t\tthis.listField.onkeydown = this.returnSubmit(\r\n\t\t\tthis.listField,\r\n\t\t\tthis.sortCallback.bind(this),\r\n\t\t\t60,\r\n\t\t\tfalse\r\n\t\t);\r\n\t\tthis.controls.push(this.listField);\r\n\r\n\t\t// Sort button\r\n\t\tthis.findButton = addControlToAlgorithmBar('Button', 'Sort');\r\n\t\tthis.findButton.onclick = this.sortCallback.bind(this);\r\n\t\tthis.controls.push(this.findButton);\r\n\r\n\t\t// Clear button\r\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear');\r\n\t\tthis.clearButton.onclick = this.clearCallback.bind(this);\r\n\t\tthis.controls.push(this.clearButton);\r\n\t}\r\n\r\n\tsetup() {\r\n\t\tthis.arrayData = [];\r\n\t\tthis.arrayID = [];\r\n\t\tthis.iPointerID = 0;\r\n\t\tthis.jPointerID = 0;\r\n\t\tthis.kPointerID = 0;\r\n\t}\r\n\r\n\treset() {\r\n\t\t// Reset all of your data structures to *exactly* the state they have immediately after the init\r\n\t\t// function is called.  This method is called whenever an \"undo\" is performed.  Your data\r\n\t\t// structures are completely cleaned, and then all of the actions *up to but not including* the\r\n\t\t// last action are then redone.  If you implement all of your actions through the \"implementAction\"\r\n\t\t// method below, then all of this work is done for you in the Animation \"superexport default class\"\r\n\r\n\t\t// Reset the (very simple) memory manager\r\n\t\tthis.nextIndex = 0;\r\n\t}\r\n\r\n\tsortCallback() {\r\n\t\tif (this.listField.value !== '') {\r\n\t\t\tthis.implementAction(this.clear.bind(this), '');\r\n\t\t\tconst list = this.listField.value;\r\n\t\t\tthis.listField.value = '';\r\n\t\t\tthis.implementAction(this.sort.bind(this), list);\r\n\t\t}\r\n\t}\r\n\r\n\tclearCallback() {\r\n\t\tthis.implementAction(this.clear.bind(this), '');\r\n\t}\r\n\r\n\tclear() {\r\n\t\tthis.commands = [];\r\n\t\tfor (let i = 0; i < this.arrayID.length; i++) {\r\n\t\t\tthis.cmd('Delete', this.arrayID[i]);\r\n\t\t}\r\n\t\tthis.arrayData = [];\r\n\t\tthis.displayData = [];\r\n\t\tthis.arrayID = [];\r\n\t\treturn this.commands;\r\n\t}\r\n\r\n\tsort(params) {\r\n\t\tthis.commands = [];\r\n\r\n\t\tthis.arrayID = [];\r\n\t\tthis.arrayData = params\r\n\t\t\t.split(',')\r\n\t\t\t.map(Number)\r\n\t\t\t.filter(x => x)\r\n\t\t\t.slice(0, 12);\r\n\t\tthis.displayData = new Array(this.arrayData.length);\r\n\r\n\t\tconst elemCounts = new Map();\r\n\t\tconst letterMap = new Map();\r\n\r\n\t\tfor (let i = 0; i < this.arrayData.length; i++) {\r\n\t\t\tconst count = elemCounts.has(this.arrayData[i]) ? elemCounts.get(this.arrayData[i]) : 0;\r\n\t\t\tif (count > 0) {\r\n\t\t\t\tletterMap.set(this.arrayData[i], 'A');\r\n\t\t\t}\r\n\t\t\telemCounts.set(this.arrayData[i], count + 1);\r\n\t\t}\r\n\r\n\t\tfor (let i = 0; i < this.arrayData.length; i++) {\r\n\t\t\tthis.arrayData[i] = parseInt(this.arrayData[i]);\r\n\t\t\tconst xPos = i * ARRAY_ELEM_WIDTH + ARRAY_START_X;\r\n\t\t\tconst yPos = ARRAY_START_Y;\r\n\t\t\tthis.arrayID.push(this.nextIndex);\r\n\r\n\t\t\tlet displayData = this.arrayData[i].toString();\r\n\t\t\tif (letterMap.has(this.arrayData[i])) {\r\n\t\t\t\tconst currChar = letterMap.get(this.arrayData[i]);\r\n\t\t\t\tdisplayData += currChar;\r\n\t\t\t\tletterMap.set(this.arrayData[i], String.fromCharCode(currChar.charCodeAt(0) + 1));\r\n\t\t\t}\r\n\t\t\tthis.displayData[i] = displayData;\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'CreateRectangle',\r\n\t\t\t\tthis.nextIndex++,\r\n\t\t\t\tdisplayData,\r\n\t\t\t\tARRAY_ELEM_WIDTH,\r\n\t\t\t\tARRAY_ELEM_HEIGHT,\r\n\t\t\t\txPos,\r\n\t\t\t\tyPos\r\n\t\t\t);\r\n\t\t}\r\n\t\tthis.cmd('Step');\r\n\r\n\t\tif (this.arrayData.length !== 1) {\r\n\t\t\tconst mid = Math.ceil((this.arrayData.length - 1) / 2);\r\n\t\t\tthis.leftHelper(0, mid - 1, -LARGE_OFFSET, 0, 1);\r\n\t\t\tthis.rightHelper(mid, this.arrayData.length - 1, LARGE_OFFSET, 0, 1);\r\n\t\t\tthis.merge(\r\n\t\t\t\t0,\r\n\t\t\t\tthis.arrayData.length - 1,\r\n\t\t\t\tmid,\r\n\t\t\t\t0,\r\n\t\t\t\t0,\r\n\t\t\t\t-LARGE_OFFSET,\r\n\t\t\t\tLARGE_OFFSET,\r\n\t\t\t\tthis.arrayID\r\n\t\t\t);\r\n\t\t} else {\r\n\t\t\tthis.cmd('SetBackgroundColor', this.arrayID[0], '#2ECC71');\r\n\t\t\tthis.cmd('Step');\r\n\t\t}\r\n\r\n\t\treturn this.commands;\r\n\t}\r\n\r\n\tleftHelper(left, right, offset, prevOffset, row) {\r\n\t\tif (left > right) return;\r\n\r\n\t\tconst tempArrayID = this.drawArrayAndCopy(left, right, offset, prevOffset, row);\r\n\r\n\t\tif (left !== right) {\r\n\t\t\tconst mid = Math.ceil((left + right) / 2);\r\n\t\t\tconst extraOffset = row < 2 ? 2 * LARGE_OFFSET : 2 * SMALL_OFFSET;\r\n\t\t\tthis.leftHelper(left, mid - 1, offset - extraOffset, offset, row + 1);\r\n\t\t\tthis.leftHelper(mid, right, offset, offset, row + 1);\r\n\t\t\tthis.merge(left, right, mid, row, offset, offset - extraOffset, offset, tempArrayID);\r\n\t\t} else {\r\n\t\t\tthis.cmd('SetBackgroundColor', tempArrayID[left], '#2ECC71');\r\n\t\t\tthis.cmd('Step');\r\n\t\t}\r\n\t}\r\n\r\n\trightHelper(left, right, offset, prevOffset, row) {\r\n\t\tif (left > right) return;\r\n\r\n\t\tconst tempArrayID = this.drawArrayAndCopy(left, right, offset, prevOffset, row);\r\n\r\n\t\tif (left !== right) {\r\n\t\t\tconst mid = Math.ceil((left + right) / 2);\r\n\t\t\tconst extraOffset = row < 2 ? 2 * LARGE_OFFSET : 2 * SMALL_OFFSET;\r\n\t\t\tthis.rightHelper(left, mid - 1, offset, offset, row + 1);\r\n\t\t\tthis.rightHelper(mid, right, offset + extraOffset, offset, row + 1);\r\n\t\t\tthis.merge(left, right, mid, row, offset, offset, offset + extraOffset, tempArrayID);\r\n\t\t} else {\r\n\t\t\tthis.cmd('SetBackgroundColor', tempArrayID[left], '#2ECC71');\r\n\t\t\tthis.cmd('Step');\r\n\t\t}\r\n\t}\r\n\r\n\tdrawArrayAndCopy(left, right, offset, prevOffset, row) {\r\n\t\tconst tempArrayID = [];\r\n\r\n\t\t// Display subarray\r\n\t\tfor (let i = left; i <= right; i++) {\r\n\t\t\tconst xPos = i * ARRAY_ELEM_WIDTH + ARRAY_START_X + offset;\r\n\t\t\tconst yPos = ARRAY_START_Y + row * ARRAY_LINE_SPACING;\r\n\t\t\ttempArrayID[i] = this.nextIndex;\r\n\t\t\tthis.arrayID.push(this.nextIndex);\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'CreateRectangle',\r\n\t\t\t\tthis.nextIndex++,\r\n\t\t\t\t'',\r\n\t\t\t\tARRAY_ELEM_WIDTH,\r\n\t\t\t\tARRAY_ELEM_HEIGHT,\r\n\t\t\t\txPos,\r\n\t\t\t\tyPos\r\n\t\t\t);\r\n\t\t}\r\n\t\tthis.cmd('Step');\r\n\r\n\t\t// Copy elements from big array to current subarray\r\n\t\tfor (let i = left; i <= right; i++) {\r\n\t\t\tthis.copyData(\r\n\t\t\t\ti,\r\n\t\t\t\ti,\r\n\t\t\t\tprevOffset,\r\n\t\t\t\toffset,\r\n\t\t\t\trow - 1,\r\n\t\t\t\trow,\r\n\t\t\t\tthis.displayData[i],\r\n\t\t\t\ttempArrayID[i],\r\n\t\t\t\t-1\r\n\t\t\t);\r\n\t\t}\r\n\r\n\t\treturn tempArrayID;\r\n\t}\r\n\r\n\tmerge(left, right, mid, row, currOffset, leftOffset, rightOffset, currArrayID) {\r\n\t\tconst tempArray = new Array(this.arrayData.length); // Temporary array to store data for sorting\r\n\t\tconst tempDisplay = new Array(this.arrayData.length);\r\n\r\n\t\t// Copy data to temporary array\r\n\t\tfor (let i = left; i <= right; i++) {\r\n\t\t\ttempArray[i] = this.arrayData[i];\r\n\t\t\ttempDisplay[i] = this.displayData[i];\r\n\t\t}\r\n\r\n\t\t// Create pointers\r\n\t\tconst bottomYPos = ARRAY_START_Y + (row + 1) * ARRAY_LINE_SPACING;\r\n\t\tconst iPointerID = this.nextIndex++;\r\n\t\tconst iXPos = left * ARRAY_ELEM_WIDTH + ARRAY_START_X + leftOffset;\r\n\t\tthis.cmd('CreateHighlightCircle', iPointerID, '#0000FF', iXPos, bottomYPos);\r\n\t\tconst jPointerID = this.nextIndex++;\r\n\t\tconst jXPos = mid * ARRAY_ELEM_WIDTH + ARRAY_START_X + rightOffset;\r\n\t\tthis.cmd('CreateHighlightCircle', jPointerID, '#0000FF', jXPos, bottomYPos);\r\n\t\tconst kPointerID = this.nextIndex++;\r\n\t\tconst kXPos = left * ARRAY_ELEM_WIDTH + ARRAY_START_X + currOffset;\r\n\t\tconst topYPos = ARRAY_START_Y + row * ARRAY_LINE_SPACING;\r\n\t\tthis.cmd('CreateHighlightCircle', kPointerID, '#0000FF', kXPos, topYPos);\r\n\t\tthis.cmd('Step');\r\n\r\n\t\t// Merge data and animate\r\n\t\tlet i = left;\r\n\t\tlet j = mid;\r\n\t\tlet k = left;\r\n\t\twhile (i < mid && j <= right) {\r\n\t\t\tif (tempArray[i] <= tempArray[j]) {\r\n\t\t\t\tthis.copyData(\r\n\t\t\t\t\ti,\r\n\t\t\t\t\tk,\r\n\t\t\t\t\tleftOffset,\r\n\t\t\t\t\tcurrOffset,\r\n\t\t\t\t\trow + 1,\r\n\t\t\t\t\trow,\r\n\t\t\t\t\ttempDisplay[i],\r\n\t\t\t\t\tcurrArrayID[k],\r\n\t\t\t\t\tiPointerID\r\n\t\t\t\t);\r\n\t\t\t\tthis.arrayData[k] = tempArray[i];\r\n\t\t\t\tthis.displayData[k] = tempDisplay[i];\r\n\t\t\t\tk++;\r\n\t\t\t\tthis.movePointer(k, row, currOffset, kPointerID);\r\n\t\t\t\ti++;\r\n\t\t\t\tif (i < mid) {\r\n\t\t\t\t\tthis.movePointer(i, row + 1, leftOffset, iPointerID);\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tthis.copyData(\r\n\t\t\t\t\tj,\r\n\t\t\t\t\tk,\r\n\t\t\t\t\trightOffset,\r\n\t\t\t\t\tcurrOffset,\r\n\t\t\t\t\trow + 1,\r\n\t\t\t\t\trow,\r\n\t\t\t\t\ttempDisplay[j],\r\n\t\t\t\t\tcurrArrayID[k],\r\n\t\t\t\t\tjPointerID\r\n\t\t\t\t);\r\n\t\t\t\tthis.arrayData[k] = tempArray[j];\r\n\t\t\t\tthis.displayData[k] = tempDisplay[i];\r\n\t\t\t\tk++;\r\n\t\t\t\tthis.movePointer(k, row, currOffset, kPointerID);\r\n\t\t\t\tj++;\r\n\t\t\t\tif (j <= right) {\r\n\t\t\t\t\tthis.movePointer(j, row + 1, rightOffset, jPointerID);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.cmd('Step');\r\n\t\t}\r\n\t\twhile (i < mid) {\r\n\t\t\tthis.copyData(\r\n\t\t\t\ti,\r\n\t\t\t\tk,\r\n\t\t\t\tleftOffset,\r\n\t\t\t\tcurrOffset,\r\n\t\t\t\trow + 1,\r\n\t\t\t\trow,\r\n\t\t\t\ttempDisplay[i],\r\n\t\t\t\tcurrArrayID[k],\r\n\t\t\t\tiPointerID\r\n\t\t\t);\r\n\t\t\tthis.arrayData[k] = tempArray[i];\r\n\t\t\tthis.displayData[k] = tempDisplay[i];\r\n\t\t\tk++;\r\n\t\t\ti++;\r\n\t\t\tif (k <= right) {\r\n\t\t\t\tthis.movePointer(i, row + 1, leftOffset, iPointerID);\r\n\t\t\t\tthis.movePointer(k, row, currOffset, kPointerID);\r\n\t\t\t}\r\n\t\t}\r\n\t\twhile (j <= right) {\r\n\t\t\tthis.copyData(\r\n\t\t\t\tj,\r\n\t\t\t\tk,\r\n\t\t\t\trightOffset,\r\n\t\t\t\tcurrOffset,\r\n\t\t\t\trow + 1,\r\n\t\t\t\trow,\r\n\t\t\t\ttempDisplay[j],\r\n\t\t\t\tcurrArrayID[k],\r\n\t\t\t\tjPointerID\r\n\t\t\t);\r\n\t\t\tthis.arrayData[k] = tempArray[j];\r\n\t\t\tthis.displayData[k] = tempDisplay[j];\r\n\t\t\tj++;\r\n\t\t\tk++;\r\n\t\t\tif (k <= right) {\r\n\t\t\t\tthis.movePointer(j, row + 1, rightOffset, jPointerID);\r\n\t\t\t\tthis.movePointer(k, row, currOffset, kPointerID);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// Delete pointers\r\n\t\tthis.cmd('Delete', iPointerID);\r\n\t\tthis.cmd('Delete', jPointerID);\r\n\t\tthis.cmd('Delete', kPointerID);\r\n\t\tthis.cmd('Step');\r\n\t}\r\n\r\n\tcopyData(fromIndex, toIndex, fromOffset, toOffset, fromRow, toRow, value, cellID, pointerID) {\r\n\t\tif (pointerID !== -1) {\r\n\t\t\tthis.cmd('SetForegroundColor', pointerID, '#FF0000');\r\n\t\t\tthis.cmd('Step');\r\n\t\t}\r\n\t\tconst fromXPos = fromIndex * ARRAY_ELEM_WIDTH + ARRAY_START_X + fromOffset;\r\n\t\tconst fromYPos = ARRAY_START_Y + fromRow * ARRAY_LINE_SPACING;\r\n\t\tconst labelID = this.nextIndex++;\r\n\t\tthis.cmd('CreateLabel', labelID, value, fromXPos, fromYPos);\r\n\t\tconst toXPos = toIndex * ARRAY_ELEM_WIDTH + ARRAY_START_X + toOffset;\r\n\t\tconst toYPos = ARRAY_START_Y + toRow * ARRAY_LINE_SPACING;\r\n\t\tthis.cmd('Move', labelID, toXPos, toYPos);\r\n\t\tthis.cmd('Step');\r\n\t\tthis.cmd('SetText', cellID, value);\r\n\t\tthis.cmd('Delete', labelID);\r\n\t\tif (pointerID !== -1) {\r\n\t\t\tthis.cmd('SetBackgroundColor', cellID, '#2ECC71');\r\n\t\t\tthis.cmd('SetForegroundColor', pointerID, '#0000FF');\r\n\t\t\tthis.cmd('Step');\r\n\t\t}\r\n\t}\r\n\r\n\tmovePointer(index, row, offset, pointerID) {\r\n\t\tconst xPos = index * ARRAY_ELEM_WIDTH + ARRAY_START_X + offset;\r\n\t\tconst yPos = ARRAY_START_Y + row * ARRAY_LINE_SPACING;\r\n\t\tthis.cmd('Move', pointerID, xPos, yPos);\r\n\t}\r\n\r\n\t// Called by our superexport default class when we get an animation started event -- need to wait for the\r\n\t// event to finish before we start doing anything\r\n\tdisableUI() {\r\n\t\tfor (let i = 0; i < this.controls.length; i++) {\r\n\t\t\tthis.controls[i].disabled = true;\r\n\t\t}\r\n\t}\r\n\r\n\t// Called by our superexport default class when we get an animation completed event -- we can\r\n\t/// now interact again.\r\n\tenableUI() {\r\n\t\tfor (let i = 0; i < this.controls.length; i++) {\r\n\t\t\tthis.controls[i].disabled = false;\r\n\t\t}\r\n\t}\r\n}\r\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\r\n//\r\n// Redistribution and use in source and binary forms, with or without modification, are\r\n// permitted provided that the following conditions are met:\r\n//\r\n// 1. Redistributions of source code must retain the above copyright notice, this list of\r\n// conditions and the following disclaimer.\r\n//\r\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\r\n// of conditions and the following disclaimer in the documentation and/or other materials\r\n// provided with the distribution.\r\n//\r\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\r\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\r\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\r\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\r\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\r\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\r\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\r\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\r\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\r\n//\r\n// The views and conclusions contained in the software and documentation are those of the\r\n// authors and should not be interpreted as representing official policies, either expressed\r\n// or implied, of the University of San Francisco\r\n\r\nimport Hash from './Hash.js';\r\n\r\nconst POINTER_ARRAY_ELEM_WIDTH = 70;\r\nconst POINTER_ARRAY_ELEM_HEIGHT = 30;\r\nconst POINTER_ARRAY_ELEM_START_X = 50;\r\n\r\nconst LINKED_ITEM_HEIGHT = 30;\r\nconst LINKED_ITEM_WIDTH = 65;\r\n\r\nconst LINKED_ITEM_Y_DELTA = 50;\r\n// var LINKED_ITEM_POINTER_PERCENT = 0.25;\r\n\r\n// var MAX_DATA_VALUE = 999;\r\n\r\nconst HASH_TABLE_SIZE = 13;\r\n\r\n// var ARRAY_Y_POS = 350;\r\n\r\nconst INDEX_COLOR = '#0000FF';\r\n\r\nexport default class OpenHash extends Hash {\r\n\tconstructor(am, w, h) {\r\n\t\tsuper(am, w, h);\r\n\t\tthis.nextIndex = 0;\r\n\t\tthis.POINTER_ARRAY_ELEM_Y = h - POINTER_ARRAY_ELEM_WIDTH;\r\n\t\tthis.setup();\r\n\t}\r\n\r\n\taddControls() {\r\n\t\tsuper.addControls();\r\n\r\n\t\t// Add new controls\r\n\t}\r\n\r\n\tinsertElement(elem) {\r\n\t\tthis.commands = [];\r\n\t\tthis.cmd('SetText', this.ExplainLabel, 'Inserting element: ' + String(elem));\r\n\t\tconst index = this.doHash(elem);\r\n\r\n\t\tconst node = new LinkedListNode(elem, this.nextIndex++, 100, 75);\r\n\t\tthis.cmd(\r\n\t\t\t'CreateLinkedList',\r\n\t\t\tnode.graphicID,\r\n\t\t\telem,\r\n\t\t\tLINKED_ITEM_WIDTH,\r\n\t\t\tLINKED_ITEM_HEIGHT,\r\n\t\t\t100,\r\n\t\t\t75\r\n\t\t);\r\n\t\tlet found = false;\r\n\t\tif (this.hashTableValues[index] != null) {\r\n\t\t\t// Search for duplicates\r\n\t\t\tthis.cmd('SetText', this.ExplainLabel, 'Searching for duplicates of ' + elem);\r\n\r\n\t\t\tconst compareIndex = this.nextIndex++;\r\n\t\t\tlet tmp = this.hashTableValues[index];\r\n\t\t\tthis.cmd('CreateLabel', compareIndex, '', 10, 40, 0);\r\n\t\t\twhile (tmp != null && !found) {\r\n\t\t\t\tthis.cmd('SetHighlight', tmp.graphicID, 1);\r\n\t\t\t\tif (tmp.data === elem) {\r\n\t\t\t\t\tthis.cmd('SetText', compareIndex, tmp.data + '==' + elem);\r\n\t\t\t\t\tfound = true;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.cmd('SetText', compareIndex, tmp.data + '!=' + elem);\r\n\t\t\t\t}\r\n\t\t\t\tthis.cmd('Step');\r\n\t\t\t\tthis.cmd('SetHighlight', tmp.graphicID, 0);\r\n\t\t\t\ttmp = tmp.next;\r\n\t\t\t}\r\n\r\n\t\t\tthis.cmd('Delete', compareIndex);\r\n\t\t\tthis.nextIndex--;\r\n\t\t} else {\r\n\t\t\tthis.cmd('SetNull', node.graphicID, 1);\r\n\t\t\tthis.cmd('SetNull', this.hashTableVisual[index], 0);\r\n\t\t}\r\n\r\n\t\tif (found) {\r\n\t\t\tthis.cmd('SetText', this.ExplainLabel, 'Duplicate of  ' + elem + '  found!');\r\n\t\t\tthis.cmd('Delete', node.graphicID);\r\n\t\t\tthis.cmd('Step');\r\n\t\t} else {\r\n\t\t\tthis.cmd('SetText', this.ExplainLabel, 'Duplicate of  ' + elem + '  not found!');\r\n\t\t\tthis.cmd('Step');\r\n\r\n\t\t\tif (this.hashTableValues[index] != null) {\r\n\t\t\t\tthis.cmd('connect', node.graphicID, this.hashTableValues[index].graphicID);\r\n\t\t\t\tthis.cmd(\r\n\t\t\t\t\t'disconnect',\r\n\t\t\t\t\tthis.hashTableVisual[index],\r\n\t\t\t\t\tthis.hashTableValues[index].graphicID\r\n\t\t\t\t);\r\n\t\t\t}\r\n\r\n\t\t\tthis.cmd('connect', this.hashTableVisual[index], node.graphicID);\r\n\t\t\tnode.next = this.hashTableValues[index];\r\n\t\t\tthis.hashTableValues[index] = node;\r\n\t\t\tthis.repositionList(index);\r\n\t\t}\r\n\r\n\t\tthis.cmd('SetText', this.ExplainLabel, '');\r\n\r\n\t\treturn this.commands;\r\n\t}\r\n\r\n\trepositionList(index) {\r\n\t\tconst startX = POINTER_ARRAY_ELEM_START_X + index * POINTER_ARRAY_ELEM_WIDTH;\r\n\t\tlet startY = this.POINTER_ARRAY_ELEM_Y - LINKED_ITEM_Y_DELTA;\r\n\t\tlet tmp = this.hashTableValues[index];\r\n\t\twhile (tmp != null) {\r\n\t\t\ttmp.x = startX;\r\n\t\t\ttmp.y = startY;\r\n\t\t\tthis.cmd('Move', tmp.graphicID, tmp.x, tmp.y);\r\n\t\t\tstartY = startY - LINKED_ITEM_Y_DELTA;\r\n\t\t\ttmp = tmp.next;\r\n\t\t}\r\n\t}\r\n\r\n\tdeleteElement(elem) {\r\n\t\tthis.commands = [];\r\n\t\tthis.cmd('SetText', this.ExplainLabel, 'Deleting element: ' + elem);\r\n\t\tconst index = this.doHash(elem);\r\n\t\tif (this.hashTableValues[index] == null) {\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'SetText',\r\n\t\t\t\tthis.ExplainLabel,\r\n\t\t\t\t'Deleting element: ' + elem + '  Element not in table'\r\n\t\t\t);\r\n\t\t\treturn this.commands;\r\n\t\t}\r\n\t\tthis.cmd('SetHighlight', this.hashTableValues[index].graphicID, 1);\r\n\t\tthis.cmd('Step');\r\n\t\tthis.cmd('SetHighlight', this.hashTableValues[index].graphicID, 0);\r\n\t\tif (this.hashTableValues[index].data === elem) {\r\n\t\t\tif (this.hashTableValues[index].next != null) {\r\n\t\t\t\tthis.cmd(\r\n\t\t\t\t\t'Connect',\r\n\t\t\t\t\tthis.hashTableVisual[index],\r\n\t\t\t\t\tthis.hashTableValues[index].next.graphicID\r\n\t\t\t\t);\r\n\t\t\t} else {\r\n\t\t\t\tthis.cmd('SetNull', this.hashTableVisual[index], 1);\r\n\t\t\t}\r\n\t\t\tthis.cmd('Delete', this.hashTableValues[index].graphicID);\r\n\t\t\tthis.hashTableValues[index] = this.hashTableValues[index].next;\r\n\t\t\tthis.repositionList(index);\r\n\t\t\treturn this.commands;\r\n\t\t}\r\n\t\tlet tmpPrev = this.hashTableValues[index];\r\n\t\tlet tmp = this.hashTableValues[index].next;\r\n\t\tlet found = false;\r\n\t\twhile (tmp != null && !found) {\r\n\t\t\tthis.cmd('SetHighlight', tmp.graphicID, 1);\r\n\t\t\tthis.cmd('Step');\r\n\t\t\tthis.cmd('SetHighlight', tmp.graphicID, 0);\r\n\t\t\tif (tmp.data === elem) {\r\n\t\t\t\tfound = true;\r\n\t\t\t\tthis.cmd(\r\n\t\t\t\t\t'SetText',\r\n\t\t\t\t\tthis.ExplainLabel,\r\n\t\t\t\t\t'Deleting element: ' + elem + '  Element deleted'\r\n\t\t\t\t);\r\n\t\t\t\tif (tmp.next != null) {\r\n\t\t\t\t\tthis.cmd('Connect', tmpPrev.graphicID, tmp.next.graphicID);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.cmd('SetNull', tmpPrev.graphicID, 1);\r\n\t\t\t\t}\r\n\t\t\t\ttmpPrev.next = tmpPrev.next.next;\r\n\t\t\t\tthis.cmd('Delete', tmp.graphicID);\r\n\t\t\t\tthis.repositionList(index);\r\n\t\t\t} else {\r\n\t\t\t\ttmpPrev = tmp;\r\n\t\t\t\ttmp = tmp.next;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (!found) {\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'SetText',\r\n\t\t\t\tthis.ExplainLabel,\r\n\t\t\t\t'Deleting element: ' + elem + '  Element not in table'\r\n\t\t\t);\r\n\t\t}\r\n\t\treturn this.commands;\r\n\t}\r\n\r\n\tfindElement(elem) {\r\n\t\tthis.commands = [];\r\n\t\tthis.cmd('SetText', this.ExplainLabel, 'Finding Element: ' + elem);\r\n\r\n\t\tconst index = this.doHash(elem);\r\n\t\tconst compareIndex = this.nextIndex++;\r\n\t\tlet found = false;\r\n\t\tlet tmp = this.hashTableValues[index];\r\n\t\tthis.cmd('CreateLabel', compareIndex, '', 10, 40, 0);\r\n\t\twhile (tmp != null && !found) {\r\n\t\t\tthis.cmd('SetHighlight', tmp.graphicID, 1);\r\n\t\t\tif (tmp.data === elem) {\r\n\t\t\t\tthis.cmd('SetText', compareIndex, tmp.data + '==' + elem);\r\n\t\t\t\tfound = true;\r\n\t\t\t} else {\r\n\t\t\t\tthis.cmd('SetText', compareIndex, tmp.data + '!=' + elem);\r\n\t\t\t}\r\n\t\t\tthis.cmd('Step');\r\n\t\t\tthis.cmd('SetHighlight', tmp.graphicID, 0);\r\n\t\t\ttmp = tmp.next;\r\n\t\t}\r\n\t\tif (found) {\r\n\t\t\tthis.cmd('SetText', this.ExplainLabel, 'Finding Element: ' + elem + '  Found!');\r\n\t\t} else {\r\n\t\t\tthis.cmd('SetText', this.ExplainLabel, 'Finding Element: ' + elem + '  Not Found!');\r\n\t\t}\r\n\t\tthis.cmd('Delete', compareIndex);\r\n\t\tthis.nextIndex--;\r\n\t\treturn this.commands;\r\n\t}\r\n\r\n\tsetup() {\r\n\t\tthis.hashTableVisual = new Array(HASH_TABLE_SIZE);\r\n\t\tthis.hashTableIndices = new Array(HASH_TABLE_SIZE);\r\n\t\tthis.hashTableValues = new Array(HASH_TABLE_SIZE);\r\n\r\n\t\tthis.indexXPos = new Array(HASH_TABLE_SIZE);\r\n\t\tthis.indexYPos = new Array(HASH_TABLE_SIZE);\r\n\r\n\t\tthis.ExplainLabel = this.nextIndex++;\r\n\r\n\t\tthis.table_size = HASH_TABLE_SIZE;\r\n\r\n\t\tthis.commands = [];\r\n\t\tfor (let i = 0; i < HASH_TABLE_SIZE; i++) {\r\n\t\t\tlet nextID = this.nextIndex++;\r\n\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'CreateRectangle',\r\n\t\t\t\tnextID,\r\n\t\t\t\t'',\r\n\t\t\t\tPOINTER_ARRAY_ELEM_WIDTH,\r\n\t\t\t\tPOINTER_ARRAY_ELEM_HEIGHT,\r\n\t\t\t\tPOINTER_ARRAY_ELEM_START_X + i * POINTER_ARRAY_ELEM_WIDTH,\r\n\t\t\t\tthis.POINTER_ARRAY_ELEM_Y\r\n\t\t\t);\r\n\t\t\tthis.hashTableVisual[i] = nextID;\r\n\t\t\tthis.cmd('SetNull', this.hashTableVisual[i], 1);\r\n\r\n\t\t\tnextID = this.nextIndex++;\r\n\t\t\tthis.hashTableIndices[i] = nextID;\r\n\t\t\tthis.indexXPos[i] = POINTER_ARRAY_ELEM_START_X + i * POINTER_ARRAY_ELEM_WIDTH;\r\n\t\t\tthis.indexYPos[i] = this.POINTER_ARRAY_ELEM_Y + POINTER_ARRAY_ELEM_HEIGHT;\r\n\t\t\tthis.hashTableValues[i] = null;\r\n\r\n\t\t\tthis.cmd('CreateLabel', nextID, i, this.indexXPos[i], this.indexYPos[i]);\r\n\t\t\tthis.cmd('SetForegroundColor', nextID, INDEX_COLOR);\r\n\t\t}\r\n\t\tthis.cmd('CreateLabel', this.ExplainLabel, '', 10, 25, 0);\r\n\t\tthis.animationManager.StartNewAnimation(this.commands);\r\n\t\tthis.animationManager.skipForward();\r\n\t\tthis.animationManager.clearHistory();\r\n\t\tthis.resetIndex = this.nextIndex;\r\n\t}\r\n\r\n\tresetAll() {\r\n\t\tlet tmp;\r\n\t\tthis.commands = super.resetAll();\r\n\t\tfor (let i = 0; i < this.hashTableValues.length; i++) {\r\n\t\t\ttmp = this.hashTableValues[i];\r\n\t\t\tif (tmp != null) {\r\n\t\t\t\twhile (tmp != null) {\r\n\t\t\t\t\tthis.cmd('Delete', tmp.graphicID);\r\n\t\t\t\t\ttmp = tmp.next;\r\n\t\t\t\t}\r\n\t\t\t\tthis.hashTableValues[i] = null;\r\n\t\t\t\tthis.cmd('SetNull', this.hashTableVisual[i], 1);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn this.commands;\r\n\t}\r\n\r\n\t// NEED TO OVERRIDE IN PARENT\r\n\treset() {\r\n\t\tfor (let i = 0; i < this.table_size; i++) {\r\n\t\t\tthis.hashTableValues[i] = null;\r\n\t\t}\r\n\t\tthis.nextIndex = this.resetIndex;\r\n\t\tsuper.reset();\r\n\t}\r\n\r\n\tresetCallback() {}\r\n\r\n\t/*this.nextIndex = 0;\r\n this.commands = [];\r\n this.cmd(\"CreateLabel\", 0, \"\", 20, 50, 0);\r\n this.animationManager.StartNewAnimation(this.commands);\r\n this.animationManager.skipForward();\r\n this.animationManager.clearHistory(); */\r\n\r\n\tdisableUI() {\r\n\t\tsuper.disableUI();\r\n\t}\r\n\r\n\tenableUI() {\r\n\t\tsuper.enableUI();\r\n\t}\r\n}\r\n\r\nclass LinkedListNode {\r\n\tconstructor(val, id, initialX, initialY) {\r\n\t\tthis.data = val;\r\n\t\tthis.graphicID = id;\r\n\t\tthis.x = initialX;\r\n\t\tthis.y = initialY;\r\n\t\tthis.next = null;\r\n\t}\r\n}\r\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\r\n//\r\n// Redistribution and use in source and binary forms, with or without modification, are\r\n// permitted provided that the following conditions are met:\r\n//\r\n// 1. Redistributions of source code must retain the above copyright notice, this list of\r\n// conditions and the following disclaimer.\r\n//\r\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\r\n// of conditions and the following disclaimer in the documentation and/or other materials\r\n// provided with the distribution.\r\n//\r\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\r\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\r\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\r\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\r\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\r\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\r\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\r\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\r\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\r\n//\r\n// The views and conclusions contained in the software and documentation are those of the\r\n// authors and should not be interpreted as representing official policies, either expressed\r\n// or implied, of the University of San Francisco\r\n\r\nimport Algorithm, { addControlToAlgorithmBar } from './Algorithm.js';\r\n\r\nconst ARRAY_START_X = 100;\r\nconst ARRAY_START_Y = 200;\r\nconst ARRAY_ELEM_WIDTH = 50;\r\nconst ARRAY_ELEM_HEIGHT = 50;\r\n\r\nconst ARRRAY_ELEMS_PER_LINE = 15;\r\nconst ARRAY_LINE_SPACING = 130;\r\n\r\nconst HEAD_POS_X = 180;\r\nconst HEAD_POS_Y = 100;\r\nconst HEAD_LABEL_X = 130;\r\nconst HEAD_LABEL_Y = 100;\r\n\r\nconst TAIL_POS_X = 280;\r\nconst TAIL_POS_Y = 100;\r\nconst TAIL_LABEL_X = 230;\r\nconst TAIL_LABEL_Y = 100;\r\n\r\nconst QUEUE_LABEL_X = 50;\r\nconst QUEUE_LABEL_Y = 30;\r\nconst QUEUE_ELEMENT_X = 120;\r\nconst QUEUE_ELEMENT_Y = 30;\r\n\r\nconst INDEX_COLOR = '#0000FF';\r\n\r\nconst SIZE = 15;\r\n\r\nexport default class QueueArray extends Algorithm {\r\n\tconstructor(am, w, h) {\r\n\t\tsuper(am, w, h);\r\n\r\n\t\tthis.addControls();\r\n\t\tthis.nextIndex = 0;\r\n\t\tthis.commands = [];\r\n\t\t//this.tail_pos_y = h - LINKED_LIST_ELEM_HEIGHT;\r\n\t\t//\tthis.tail_label_y = this.tail_pos_y;\r\n\t\tthis.setup();\r\n\t\tthis.initialIndex = this.nextIndex;\r\n\t}\r\n\r\n\taddControls() {\r\n\t\tthis.controls = [];\r\n\t\tthis.enqueueField = addControlToAlgorithmBar('Text', '');\r\n\t\tthis.enqueueField.onkeydown = this.returnSubmit(\r\n\t\t\tthis.enqueueField,\r\n\t\t\tthis.enqueueCallback.bind(this),\r\n\t\t\t6\r\n\t\t);\r\n\t\tthis.enqueueButton = addControlToAlgorithmBar('Button', 'Enqueue');\r\n\t\tthis.enqueueButton.onclick = this.enqueueCallback.bind(this);\r\n\t\tthis.controls.push(this.enqueueField);\r\n\t\tthis.controls.push(this.enqueueButton);\r\n\r\n\t\tthis.dequeueButton = addControlToAlgorithmBar('Button', 'Dequeue');\r\n\t\tthis.dequeueButton.onclick = this.dequeueCallback.bind(this);\r\n\t\tthis.controls.push(this.dequeueButton);\r\n\r\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear Queue');\r\n\t\tthis.clearButton.onclick = this.clearCallback.bind(this);\r\n\t\tthis.controls.push(this.clearButton);\r\n\t}\r\n\r\n\tenableUI() {\r\n\t\tfor (let i = 0; i < this.controls.length; i++) {\r\n\t\t\tthis.controls[i].disabled = false;\r\n\t\t}\r\n\t}\r\n\r\n\tdisableUI() {\r\n\t\tfor (let i = 0; i < this.controls.length; i++) {\r\n\t\t\tthis.controls[i].disabled = true;\r\n\t\t}\r\n\t}\r\n\r\n\tsetup() {\r\n\t\tthis.nextIndex = 0;\r\n\r\n\t\tthis.arrayID = new Array(SIZE);\r\n\t\tthis.arrayLabelID = new Array(SIZE);\r\n\t\tfor (let i = 0; i < SIZE; i++) {\r\n\t\t\tthis.arrayID[i] = this.nextIndex++;\r\n\t\t\tthis.arrayLabelID[i] = this.nextIndex++;\r\n\t\t}\r\n\t\tthis.headID = this.nextIndex++;\r\n\t\tconst headLabelID = this.nextIndex++;\r\n\t\tthis.tailID = this.nextIndex++;\r\n\t\tconst tailLabelID = this.nextIndex++;\r\n\r\n\t\tthis.arrayData = new Array(SIZE);\r\n\t\tthis.head = 0;\r\n\t\tthis.tail = 0;\r\n\t\tthis.leftoverLabelID = this.nextIndex++;\r\n\r\n\t\tfor (let i = 0; i < SIZE; i++) {\r\n\t\t\tconst xpos = (i % ARRRAY_ELEMS_PER_LINE) * ARRAY_ELEM_WIDTH + ARRAY_START_X;\r\n\t\t\tconst ypos = Math.floor(i / ARRRAY_ELEMS_PER_LINE) * ARRAY_LINE_SPACING + ARRAY_START_Y;\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'CreateRectangle',\r\n\t\t\t\tthis.arrayID[i],\r\n\t\t\t\t'',\r\n\t\t\t\tARRAY_ELEM_WIDTH,\r\n\t\t\t\tARRAY_ELEM_HEIGHT,\r\n\t\t\t\txpos,\r\n\t\t\t\typos\r\n\t\t\t);\r\n\t\t\tthis.cmd('CreateLabel', this.arrayLabelID[i], i, xpos, ypos + ARRAY_ELEM_HEIGHT);\r\n\t\t\tthis.cmd('SetForegroundColor', this.arrayLabelID[i], INDEX_COLOR);\r\n\t\t}\r\n\t\tthis.cmd('CreateLabel', headLabelID, 'Head', HEAD_LABEL_X, HEAD_LABEL_Y);\r\n\t\tthis.cmd(\r\n\t\t\t'CreateRectangle',\r\n\t\t\tthis.headID,\r\n\t\t\t0,\r\n\t\t\tARRAY_ELEM_WIDTH,\r\n\t\t\tARRAY_ELEM_HEIGHT,\r\n\t\t\tHEAD_POS_X,\r\n\t\t\tHEAD_POS_Y\r\n\t\t);\r\n\r\n\t\tthis.cmd('CreateLabel', tailLabelID, 'Tail', TAIL_LABEL_X, TAIL_LABEL_Y);\r\n\t\tthis.cmd(\r\n\t\t\t'CreateRectangle',\r\n\t\t\tthis.tailID,\r\n\t\t\t0,\r\n\t\t\tARRAY_ELEM_WIDTH,\r\n\t\t\tARRAY_ELEM_HEIGHT,\r\n\t\t\tTAIL_POS_X,\r\n\t\t\tTAIL_POS_Y\r\n\t\t);\r\n\r\n\t\tthis.cmd('CreateLabel', this.leftoverLabelID, '', QUEUE_LABEL_X, QUEUE_LABEL_Y);\r\n\r\n\t\tthis.initialIndex = this.nextIndex;\r\n\r\n\t\tthis.highlight1ID = this.nextIndex++;\r\n\t\tthis.highlight2ID = this.nextIndex++;\r\n\r\n\t\tthis.animationManager.StartNewAnimation(this.commands);\r\n\t\tthis.animationManager.skipForward();\r\n\t\tthis.animationManager.clearHistory();\r\n\t}\r\n\r\n\treset() {\r\n\t\tthis.top = 0;\r\n\t\tthis.nextIndex = this.initialIndex;\r\n\t}\r\n\r\n\tenqueueCallback() {\r\n\t\tif ((this.tail + 1) % SIZE !== this.head && this.enqueueField.value !== '') {\r\n\t\t\tconst pushVal = this.enqueueField.value;\r\n\t\t\tthis.enqueueField.value = '';\r\n\t\t\tthis.implementAction(this.enqueue.bind(this), pushVal);\r\n\t\t}\r\n\t}\r\n\r\n\tdequeueCallback() {\r\n\t\tif (this.tail !== this.head) {\r\n\t\t\tthis.implementAction(this.dequeue.bind(this), '');\r\n\t\t}\r\n\t}\r\n\r\n\tclearCallback() {\r\n\t\tthis.implementAction(this.clearAll.bind(this), '');\r\n\t}\r\n\r\n\tenqueue(elemToEnqueue) {\r\n\t\tthis.commands = [];\r\n\r\n\t\tconst labEnqueueID = this.nextIndex++;\r\n\t\tconst labEnqueueValID = this.nextIndex++;\r\n\t\tthis.arrayData[this.tail] = elemToEnqueue;\r\n\t\tthis.cmd('SetText', this.leftoverLabelID, '');\r\n\r\n\t\tthis.cmd('CreateLabel', labEnqueueID, 'Enqueuing Value: ', QUEUE_LABEL_X, QUEUE_LABEL_Y);\r\n\t\tthis.cmd('CreateLabel', labEnqueueValID, elemToEnqueue, QUEUE_ELEMENT_X, QUEUE_ELEMENT_Y);\r\n\r\n\t\tthis.cmd('Step');\r\n\t\tthis.cmd('CreateHighlightCircle', this.highlight1ID, INDEX_COLOR, TAIL_POS_X, TAIL_POS_Y);\r\n\t\tthis.cmd('Step');\r\n\r\n\t\tconst xpos = (this.tail % ARRRAY_ELEMS_PER_LINE) * ARRAY_ELEM_WIDTH + ARRAY_START_X;\r\n\t\tconst ypos =\r\n\t\t\tMath.floor(this.tail / ARRRAY_ELEMS_PER_LINE) * ARRAY_LINE_SPACING + ARRAY_START_Y;\r\n\r\n\t\tthis.cmd('Move', this.highlight1ID, xpos, ypos + ARRAY_ELEM_HEIGHT);\r\n\t\tthis.cmd('Step');\r\n\r\n\t\tthis.cmd('Move', labEnqueueValID, xpos, ypos);\r\n\t\tthis.cmd('Step');\r\n\r\n\t\tthis.cmd('Settext', this.arrayID[this.tail], elemToEnqueue);\r\n\t\tthis.cmd('Delete', labEnqueueValID);\r\n\r\n\t\tthis.cmd('Delete', this.highlight1ID);\r\n\r\n\t\tthis.cmd('SetHighlight', this.tailID, 1);\r\n\t\tthis.cmd('Step');\r\n\t\tthis.tail = (this.tail + 1) % SIZE;\r\n\t\tthis.cmd('SetText', this.tailID, this.tail);\r\n\t\tthis.cmd('Step');\r\n\t\tthis.cmd('SetHighlight', this.tailID, 0);\r\n\t\tthis.cmd('Delete', labEnqueueID);\r\n\r\n\t\treturn this.commands;\r\n\t}\r\n\r\n\tdequeue() {\r\n\t\tthis.commands = [];\r\n\r\n\t\tconst labDequeueID = this.nextIndex++;\r\n\t\tconst labDequeueValID = this.nextIndex++;\r\n\r\n\t\tthis.cmd('SetText', this.leftoverLabelID, '');\r\n\r\n\t\tthis.cmd('CreateLabel', labDequeueID, 'Dequeued Value: ', QUEUE_LABEL_X, QUEUE_LABEL_Y);\r\n\r\n\t\tthis.cmd('CreateHighlightCircle', this.highlight1ID, INDEX_COLOR, HEAD_POS_X, HEAD_POS_Y);\r\n\t\tthis.cmd('Step');\r\n\r\n\t\tconst xpos = (this.head % ARRRAY_ELEMS_PER_LINE) * ARRAY_ELEM_WIDTH + ARRAY_START_X;\r\n\t\tconst ypos =\r\n\t\t\tMath.floor(this.head / ARRRAY_ELEMS_PER_LINE) * ARRAY_LINE_SPACING + ARRAY_START_Y;\r\n\r\n\t\tthis.cmd('Move', this.highlight1ID, xpos, ypos + ARRAY_ELEM_HEIGHT);\r\n\t\tthis.cmd('Step');\r\n\r\n\t\tthis.cmd('Delete', this.highlight1ID);\r\n\r\n\t\tconst dequeuedVal = this.arrayData[this.head];\r\n\t\tthis.cmd('CreateLabel', labDequeueValID, dequeuedVal, xpos, ypos);\r\n\t\tthis.cmd('Settext', this.arrayID[this.head], '');\r\n\t\tthis.cmd('Move', labDequeueValID, QUEUE_ELEMENT_X, QUEUE_ELEMENT_Y);\r\n\t\tthis.cmd('Step');\r\n\r\n\t\tthis.cmd('SetHighlight', this.headID, 1);\r\n\t\tthis.cmd('Step');\r\n\t\tthis.head = (this.head + 1) % SIZE;\r\n\t\tthis.cmd('SetText', this.headID, this.head);\r\n\t\tthis.cmd('Step');\r\n\t\tthis.cmd('SetHighlight', this.headID, 0);\r\n\r\n\t\tthis.cmd('SetText', this.leftoverLabelID, 'Dequeued Value: ' + dequeuedVal);\r\n\r\n\t\tthis.cmd('Delete', labDequeueID);\r\n\t\tthis.cmd('Delete', labDequeueValID);\r\n\r\n\t\treturn this.commands;\r\n\t}\r\n\r\n\tclearAll() {\r\n\t\tthis.commands = [];\r\n\t\tthis.cmd('SetText', this.leftoverLabelID, '');\r\n\r\n\t\tfor (let i = 0; i < SIZE; i++) {\r\n\t\t\tthis.cmd('SetText', this.arrayID[i], '');\r\n\t\t}\r\n\t\tthis.head = 0;\r\n\t\tthis.tail = 0;\r\n\t\tthis.cmd('SetText', this.headID, '0');\r\n\t\tthis.cmd('SetText', this.tailID, '0');\r\n\t\treturn this.commands;\r\n\t}\r\n}\r\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\r\n//\r\n// Redistribution and use in source and binary forms, with or without modification, are\r\n// permitted provided that the following conditions are met:\r\n//\r\n// 1. Redistributions of source code must retain the above copyright notice, this list of\r\n// conditions and the following disclaimer.\r\n//\r\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\r\n// of conditions and the following disclaimer in the documentation and/or other materials\r\n// provided with the distribution.\r\n//\r\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\r\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\r\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\r\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\r\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\r\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\r\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\r\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\r\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\r\n//\r\n// The views and conclusions contained in the software and documentation are those of the\r\n// authors and should not be interpreted as representing official policies, either expressed\r\n// or implied, of the University of San Francisco\r\n\r\nimport Algorithm, { addControlToAlgorithmBar } from './Algorithm.js';\r\n\r\nconst LINKED_LIST_START_X = 100;\r\nconst LINKED_LIST_START_Y = 200;\r\nconst LINKED_LIST_ELEM_WIDTH = 70;\r\nconst LINKED_LIST_ELEM_HEIGHT = 30;\r\n\r\nconst LINKED_LIST_INSERT_X = 250;\r\nconst LINKED_LIST_INSERT_Y = 50;\r\n\r\nconst LINKED_LIST_ELEMS_PER_LINE = 8;\r\nconst LINKED_LIST_ELEM_SPACING = 100;\r\nconst LINKED_LIST_LINE_SPACING = 100;\r\n\r\nconst TOP_POS_X = 180;\r\nconst TOP_POS_Y = 100;\r\nconst TOP_LABEL_X = 130;\r\nconst TOP_LABEL_Y = 100;\r\n\r\nconst TOP_ELEM_WIDTH = 30;\r\nconst TOP_ELEM_HEIGHT = 30;\r\n\r\nconst TAIL_POS_X = 180;\r\nconst TAIL_LABEL_X = 130;\r\n\r\nconst PUSH_LABEL_X = 50;\r\nconst PUSH_LABEL_Y = 30;\r\nconst PUSH_ELEMENT_X = 120;\r\nconst PUSH_ELEMENT_Y = 30;\r\n\r\nconst SIZE = 32;\r\n\r\nexport default class QueueLL extends Algorithm {\r\n\tconstructor(am, w, h) {\r\n\t\tsuper(am, w, h);\r\n\r\n\t\tthis.addControls();\r\n\t\tthis.nextIndex = 0;\r\n\t\tthis.commands = [];\r\n\t\tthis.tail_pos_y = h - LINKED_LIST_ELEM_HEIGHT;\r\n\t\tthis.tail_label_y = this.tail_pos_y;\r\n\t\tthis.setup();\r\n\t\tthis.initialIndex = this.nextIndex;\r\n\t}\r\n\r\n\taddControls() {\r\n\t\tthis.controls = [];\r\n\t\tthis.enqueueField = addControlToAlgorithmBar('Text', '');\r\n\t\tthis.enqueueField.onkeydown = this.returnSubmit(\r\n\t\t\tthis.enqueueField,\r\n\t\t\tthis.enqueueCallback.bind(this),\r\n\t\t\t6\r\n\t\t);\r\n\t\tthis.enqueueButton = addControlToAlgorithmBar('Button', 'Enqueue');\r\n\t\tthis.enqueueButton.onclick = this.enqueueCallback.bind(this);\r\n\t\tthis.controls.push(this.enqueueField);\r\n\t\tthis.controls.push(this.enqueueButton);\r\n\r\n\t\tthis.dequeueButton = addControlToAlgorithmBar('Button', 'Dequeue');\r\n\t\tthis.dequeueButton.onclick = this.dequeueCallback.bind(this);\r\n\t\tthis.controls.push(this.dequeueButton);\r\n\r\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear Queue');\r\n\t\tthis.clearButton.onclick = this.clearCallback.bind(this);\r\n\t\tthis.controls.push(this.clearButton);\r\n\t}\r\n\r\n\tenableUI() {\r\n\t\tfor (let i = 0; i < this.controls.length; i++) {\r\n\t\t\tthis.controls[i].disabled = false;\r\n\t\t}\r\n\t}\r\n\r\n\tdisableUI() {\r\n\t\tfor (let i = 0; i < this.controls.length; i++) {\r\n\t\t\tthis.controls[i].disabled = true;\r\n\t\t}\r\n\t}\r\n\r\n\tsetup() {\r\n\t\tthis.linkedListElemID = new Array(SIZE);\r\n\t\tfor (let i = 0; i < SIZE; i++) {\r\n\t\t\tthis.linkedListElemID[i] = this.nextIndex++;\r\n\t\t}\r\n\t\tthis.headID = this.nextIndex++;\r\n\t\tthis.headLabelID = this.nextIndex++;\r\n\r\n\t\tthis.tailID = this.nextIndex++;\r\n\t\tthis.tailLabelID = this.nextIndex++;\r\n\r\n\t\tthis.arrayData = new Array(SIZE);\r\n\t\tthis.top = 0;\r\n\t\tthis.leftoverLabelID = this.nextIndex++;\r\n\r\n\t\tthis.cmd('CreateLabel', this.headLabelID, 'Head', TOP_LABEL_X, TOP_LABEL_Y);\r\n\t\tthis.cmd(\r\n\t\t\t'CreateRectangle',\r\n\t\t\tthis.headID,\r\n\t\t\t'',\r\n\t\t\tTOP_ELEM_WIDTH,\r\n\t\t\tTOP_ELEM_HEIGHT,\r\n\t\t\tTOP_POS_X,\r\n\t\t\tTOP_POS_Y\r\n\t\t);\r\n\t\tthis.cmd('SetNull', this.headID, 1);\r\n\r\n\t\tthis.cmd('CreateLabel', this.tailLabelID, 'Tail', TAIL_LABEL_X, this.tail_label_y);\r\n\t\tthis.cmd(\r\n\t\t\t'CreateRectangle',\r\n\t\t\tthis.tailID,\r\n\t\t\t'',\r\n\t\t\tTOP_ELEM_WIDTH,\r\n\t\t\tTOP_ELEM_HEIGHT,\r\n\t\t\tTAIL_POS_X,\r\n\t\t\tthis.tail_pos_y\r\n\t\t);\r\n\t\tthis.cmd('SetNull', this.tailID, 1);\r\n\r\n\t\tthis.cmd('CreateLabel', this.leftoverLabelID, '', 5, PUSH_LABEL_Y, 0);\r\n\r\n\t\tthis.animationManager.StartNewAnimation(this.commands);\r\n\t\tthis.animationManager.skipForward();\r\n\t\tthis.animationManager.clearHistory();\r\n\t}\r\n\r\n\tresetLinkedListPositions() {\r\n\t\tfor (let i = this.top - 1; i >= 0; i--) {\r\n\t\t\tconst nextX =\r\n\t\t\t\t((this.top - 1 - i) % LINKED_LIST_ELEMS_PER_LINE) * LINKED_LIST_ELEM_SPACING +\r\n\t\t\t\tLINKED_LIST_START_X;\r\n\t\t\tconst nextY =\r\n\t\t\t\tMath.floor((this.top - 1 - i) / LINKED_LIST_ELEMS_PER_LINE) *\r\n\t\t\t\t\tLINKED_LIST_LINE_SPACING +\r\n\t\t\t\tLINKED_LIST_START_Y;\r\n\t\t\tthis.cmd('Move', this.linkedListElemID[i], nextX, nextY);\r\n\t\t}\r\n\t}\r\n\r\n\treset() {\r\n\t\tthis.top = 0;\r\n\t\tthis.nextIndex = this.initialIndex;\r\n\t}\r\n\r\n\tenqueueCallback() {\r\n\t\tif (this.top < SIZE && this.enqueueField.value !== '') {\r\n\t\t\tconst pushVal = this.enqueueField.value;\r\n\t\t\tthis.enqueueField.value = '';\r\n\t\t\tthis.implementAction(this.enqueue.bind(this), pushVal);\r\n\t\t}\r\n\t}\r\n\r\n\tdequeueCallback() {\r\n\t\tif (this.top > 0) {\r\n\t\t\tthis.implementAction(this.dequeue.bind(this), '');\r\n\t\t}\r\n\t}\r\n\r\n\tclearCallback() {\r\n\t\tthis.implementAction(this.clearAll.bind(this), '');\r\n\t}\r\n\r\n\tenqueue(elemToPush) {\r\n\t\tthis.commands = [];\r\n\r\n\t\tthis.arrayData[this.top] = elemToPush;\r\n\r\n\t\tthis.cmd('SetText', this.leftoverLabelID, '');\r\n\r\n\t\tfor (let i = this.top; i > 0; i--) {\r\n\t\t\tthis.arrayData[i] = this.arrayData[i - 1];\r\n\t\t\tthis.linkedListElemID[i] = this.linkedListElemID[i - 1];\r\n\t\t}\r\n\t\tthis.arrayData[0] = elemToPush;\r\n\t\tthis.linkedListElemID[0] = this.nextIndex++;\r\n\r\n\t\tconst labPushID = this.nextIndex++;\r\n\t\tconst labPushValID = this.nextIndex++;\r\n\t\tthis.cmd(\r\n\t\t\t'CreateLinkedList',\r\n\t\t\tthis.linkedListElemID[0],\r\n\t\t\t'',\r\n\t\t\tLINKED_LIST_ELEM_WIDTH,\r\n\t\t\tLINKED_LIST_ELEM_HEIGHT,\r\n\t\t\tLINKED_LIST_INSERT_X,\r\n\t\t\tLINKED_LIST_INSERT_Y,\r\n\t\t\t0.25,\r\n\t\t\t0,\r\n\t\t\t1,\r\n\t\t\t1\r\n\t\t);\r\n\r\n\t\tthis.cmd('SetNull', this.linkedListElemID[0], 1);\r\n\t\tthis.cmd('CreateLabel', labPushID, 'Enqueuing Value: ', PUSH_LABEL_X, PUSH_LABEL_Y);\r\n\t\tthis.cmd('CreateLabel', labPushValID, elemToPush, PUSH_ELEMENT_X, PUSH_ELEMENT_Y);\r\n\r\n\t\tthis.cmd('Step');\r\n\r\n\t\tthis.cmd('Move', labPushValID, LINKED_LIST_INSERT_X, LINKED_LIST_INSERT_Y);\r\n\r\n\t\tthis.cmd('Step');\r\n\t\tthis.cmd('SetText', this.linkedListElemID[0], elemToPush);\r\n\t\tthis.cmd('Delete', labPushValID);\r\n\r\n\t\tif (this.top === 0) {\r\n\t\t\tthis.cmd('SetNull', this.headID, 0);\r\n\t\t\tthis.cmd('SetNull', this.tailID, 0);\r\n\t\t\tthis.cmd('connect', this.headID, this.linkedListElemID[this.top]);\r\n\t\t\tthis.cmd('connect', this.tailID, this.linkedListElemID[this.top]);\r\n\t\t} else {\r\n\t\t\tthis.cmd('SetNull', this.linkedListElemID[1], 0);\r\n\t\t\tthis.cmd('Connect', this.linkedListElemID[1], this.linkedListElemID[0]);\r\n\t\t\tthis.cmd('Step');\r\n\t\t\tthis.cmd('Disconnect', this.tailID, this.linkedListElemID[1]);\r\n\t\t}\r\n\t\tthis.cmd('Connect', this.tailID, this.linkedListElemID[0]);\r\n\r\n\t\tthis.cmd('Step');\r\n\t\tthis.top = this.top + 1;\r\n\t\tthis.resetLinkedListPositions();\r\n\t\tthis.cmd('Delete', labPushID);\r\n\t\tthis.cmd('Step');\r\n\r\n\t\treturn this.commands;\r\n\t}\r\n\r\n\tdequeue() {\r\n\t\tthis.commands = [];\r\n\r\n\t\tconst labPopID = this.nextIndex++;\r\n\t\tconst labPopValID = this.nextIndex++;\r\n\r\n\t\tthis.cmd('SetText', this.leftoverLabelID, '');\r\n\r\n\t\tthis.cmd('CreateLabel', labPopID, 'Dequeued Value: ', PUSH_LABEL_X, PUSH_LABEL_Y);\r\n\t\tthis.cmd(\r\n\t\t\t'CreateLabel',\r\n\t\t\tlabPopValID,\r\n\t\t\tthis.arrayData[this.top - 1],\r\n\t\t\tLINKED_LIST_START_X,\r\n\t\t\tLINKED_LIST_START_Y\r\n\t\t);\r\n\r\n\t\tthis.cmd('Move', labPopValID, PUSH_ELEMENT_X, PUSH_ELEMENT_Y);\r\n\t\tthis.cmd('Step');\r\n\t\tthis.cmd('Disconnect', this.headID, this.linkedListElemID[this.top - 1]);\r\n\r\n\t\tif (this.top === 1) {\r\n\t\t\tthis.cmd('SetNull', this.headID, 1);\r\n\t\t\tthis.cmd('SetNull', this.tailID, 1);\r\n\t\t\tthis.cmd('Disconnect', this.tailID, this.linkedListElemID[this.top - 1]);\r\n\t\t} else {\r\n\t\t\tthis.cmd('Connect', this.headID, this.linkedListElemID[this.top - 2]);\r\n\t\t}\r\n\t\tthis.cmd('Step');\r\n\t\tthis.cmd('Delete', this.linkedListElemID[this.top - 1]);\r\n\t\tthis.top = this.top - 1;\r\n\t\tthis.resetLinkedListPositions();\r\n\r\n\t\tthis.cmd('Delete', labPopValID);\r\n\t\tthis.cmd('Delete', labPopID);\r\n\t\tthis.cmd('SetText', this.leftoverLabelID, 'Dequeued Value: ' + this.arrayData[this.top]);\r\n\r\n\t\treturn this.commands;\r\n\t}\r\n\r\n\tclearAll() {\r\n\t\tthis.commands = [];\r\n\t\tfor (let i = 0; i < this.top; i++) {\r\n\t\t\tthis.cmd('Delete', this.linkedListElemID[i]);\r\n\t\t}\r\n\t\tthis.top = 0;\r\n\t\tthis.cmd('SetNull', this.headID, 1);\r\n\t\treturn this.commands;\r\n\t}\r\n}\r\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\r\n//\r\n// Redistribution and use in source and binary forms, with or without modification, are\r\n// permitted provided that the following conditions are met:\r\n//\r\n// 1. Redistributions of source code must retain the above copyright notice, this list of\r\n// conditions and the following disclaimer.\r\n//\r\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\r\n// of conditions and the following disclaimer in the documentation and/or other materials\r\n// provided with the distribution.\r\n//\r\n// THIS SOFTWARE IS PROVIDED BY David Galles ``AS IS'' AND ANY EXPRESS OR IMPLIED\r\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\r\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\r\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\r\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\r\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\r\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\r\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\r\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\r\n//\r\n// The views and conclusions contained in the software and documentation are those of the\r\n// authors and should not be interpreted as representing official policies, either expressed\r\n// or implied, of the University of San Francisco\r\n\r\nimport Algorithm, {\r\n\taddCheckboxToAlgorithmBar,\r\n\taddControlToAlgorithmBar,\r\n\taddGroupToAlgorithmBar,\r\n\taddLabelToAlgorithmBar,\r\n} from './Algorithm.js';\r\n\r\nconst ARRAY_START_X = 100;\r\nconst ARRAY_START_Y = 200;\r\nconst ARRAY_ELEM_WIDTH = 50;\r\nconst ARRAY_ELEM_HEIGHT = 50;\r\n\r\nlet worstPivotEnabled = false;\r\nlet firstPivotEnabled = false;\r\n\r\nexport default class QuickSelect extends Algorithm {\r\n\tconstructor(am, w, h) {\r\n\t\tsuper(am, w, h);\r\n\r\n\t\tthis.addControls();\r\n\r\n\t\t// Useful for memory management\r\n\t\tthis.nextIndex = 0;\r\n\r\n\t\t// TODO:  Add any code necessary to set up your own algorithm.  Initialize data\r\n\t\t// structures, etc.\r\n\t\tthis.setup();\r\n\t}\r\n\r\n\taddControls() {\r\n\t\tthis.controls = [];\r\n\r\n\t\taddLabelToAlgorithmBar('Comma separated list (e.g. \"3,1,2\", max 18 elements)');\r\n\r\n\t\t// List text field\r\n\t\tthis.listField = addControlToAlgorithmBar('Text', '');\r\n\t\tthis.listField.onkeydown = this.returnSubmit(\r\n\t\t\tthis.listField,\r\n\t\t\tthis.runCallback.bind(this),\r\n\t\t\t60,\r\n\t\t\tfalse\r\n\t\t);\r\n\t\tthis.controls.push(this.listField);\r\n\r\n\t\taddLabelToAlgorithmBar('k element (1 indexed)');\r\n\r\n\t\t// k text field\r\n\t\tthis.kField = addControlToAlgorithmBar('Text', '');\r\n\t\tthis.kField.onkeydown = this.returnSubmit(\r\n\t\t\tthis.kField,\r\n\t\t\tthis.runCallback.bind(this),\r\n\t\t\t2,\r\n\t\t\ttrue\r\n\t\t);\r\n\t\tthis.controls.push(this.kField);\r\n\r\n\t\t// Run button\r\n\t\tthis.findButton = addControlToAlgorithmBar('Button', 'Run');\r\n\t\tthis.findButton.onclick = this.runCallback.bind(this);\r\n\t\tthis.controls.push(this.findButton);\r\n\r\n\t\t// Clear button\r\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear');\r\n\t\tthis.clearButton.onclick = this.clearCallback.bind(this);\r\n\t\tthis.controls.push(this.clearButton);\r\n\r\n\t\t// Toggles\r\n\t\tthis.togglesGroup = addGroupToAlgorithmBar();\r\n\t\tthis.worstPivotToggle = addCheckboxToAlgorithmBar(\r\n\t\t\t'Pick min element as pivot',\r\n\t\t\tfalse,\r\n\t\t\tthis.togglesGroup\r\n\t\t);\r\n\t\tthis.worstPivotToggle.onclick = this.toggleWorstPivot.bind(this);\r\n\t\tthis.controls.push(this.worstPivotToggle);\r\n\t\tthis.firstPivotToggle = addCheckboxToAlgorithmBar(\r\n\t\t\t'Pick first element as pivot',\r\n\t\t\tfalse,\r\n\t\t\tthis.togglesGroup\r\n\t\t);\r\n\t\tthis.firstPivotToggle.onclick = this.toggleFirstPivot.bind(this);\r\n\t\tthis.controls.push(this.firstPivotToggle);\r\n\t}\r\n\r\n\tsetup() {\r\n\t\tthis.arrayData = [];\r\n\t\tthis.displayData = [];\r\n\t\tthis.arrayID = [];\r\n\t\tthis.iPointerID = 0;\r\n\t\tthis.jPointerID = 0;\r\n\t\tthis.pPointerID = 0;\r\n\t}\r\n\r\n\treset() {\r\n\t\t// Reset all of your data structures to *exactly* the state they have immediately after the init\r\n\t\t// function is called.  This method is called whenever an \"undo\" is performed.  Your data\r\n\t\t// structures are completely cleaned, and then all of the actions *up to but not including* the\r\n\t\t// last action are then redone.  If you implement all of your actions through the \"implementAction\"\r\n\t\t// method below, then all of this work is done for you in the Animation \"superexport default class\"\r\n\r\n\t\t// Reset the (very simple) memory manager\r\n\t\tthis.nextIndex = 0;\r\n\t}\r\n\r\n\trunCallback() {\r\n\t\tif (this.listField.value !== '' && this.kField.value !== '') {\r\n\t\t\tconst listStr = this.listField.value;\r\n\t\t\tconst list = listStr\r\n\t\t\t\t.split(',')\r\n\t\t\t\t.map(Number)\r\n\t\t\t\t.filter(x => x)\r\n\t\t\t\t.slice(0, 18);\r\n\t\t\tconst k = this.kField.value;\r\n\t\t\tif (k > 0 && k <= list.length) {\r\n\t\t\t\tthis.implementAction(this.clear.bind(this), '');\r\n\t\t\t\tthis.listField.value = '';\r\n\t\t\t\tthis.kField.value = '';\r\n\t\t\t\tthis.implementAction(this.run.bind(this), listStr + '-' + k);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tclearCallback() {\r\n\t\tthis.implementAction(this.clear.bind(this), '');\r\n\t}\r\n\r\n\tclear() {\r\n\t\tthis.commands = [];\r\n\t\tfor (let i = 0; i < this.arrayID.length; i++) {\r\n\t\t\tthis.cmd('Delete', this.arrayID[i]);\r\n\t\t}\r\n\t\tthis.arrayData = [];\r\n\t\tthis.arrayID = [];\r\n\t\tthis.displayData = [];\r\n\t\treturn this.commands;\r\n\t}\r\n\r\n\trun(params) {\r\n\t\tthis.commands = [];\r\n\r\n\t\tconst list = params.split('-')[0];\r\n\t\tthis.k = Number(params.split('-')[1]);\r\n\r\n\t\tthis.arrayID = [];\r\n\t\tthis.arrayData = list\r\n\t\t\t.split(',')\r\n\t\t\t.map(Number)\r\n\t\t\t.filter(x => x)\r\n\t\t\t.slice(0, 18);\r\n\t\tthis.displayData = new Array(this.arrayData.length);\r\n\r\n\t\tconst elemCounts = new Map();\r\n\t\tconst letterMap = new Map();\r\n\r\n\t\tfor (let i = 0; i < this.arrayData.length; i++) {\r\n\t\t\tconst count = elemCounts.has(this.arrayData[i]) ? elemCounts.get(this.arrayData[i]) : 0;\r\n\t\t\tif (count > 0) {\r\n\t\t\t\tletterMap.set(this.arrayData[i], 'A');\r\n\t\t\t}\r\n\t\t\telemCounts.set(this.arrayData[i], count + 1);\r\n\t\t}\r\n\r\n\t\tfor (let i = 0; i < this.arrayData.length; i++) {\r\n\t\t\tthis.arrayData[i] = parseInt(this.arrayData[i]);\r\n\t\t\tthis.arrayID[i] = this.nextIndex++;\r\n\t\t\tconst xpos = i * ARRAY_ELEM_WIDTH + ARRAY_START_X;\r\n\t\t\tconst ypos = ARRAY_START_Y;\r\n\r\n\t\t\tlet displayData = this.arrayData[i].toString();\r\n\t\t\tif (letterMap.has(this.arrayData[i])) {\r\n\t\t\t\tconst currChar = letterMap.get(this.arrayData[i]);\r\n\t\t\t\tdisplayData += currChar;\r\n\t\t\t\tletterMap.set(this.arrayData[i], String.fromCharCode(currChar.charCodeAt(0) + 1));\r\n\t\t\t}\r\n\t\t\tthis.displayData[i] = displayData;\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'CreateRectangle',\r\n\t\t\t\tthis.arrayID[i],\r\n\t\t\t\tdisplayData,\r\n\t\t\t\tARRAY_ELEM_WIDTH,\r\n\t\t\t\tARRAY_ELEM_HEIGHT,\r\n\t\t\t\txpos,\r\n\t\t\t\typos\r\n\t\t\t);\r\n\t\t}\r\n\r\n\t\tthis.iPointerID = this.nextIndex++;\r\n\t\tthis.jPointerID = this.nextIndex++;\r\n\t\tthis.pPointerID = this.nextIndex++;\r\n\t\tthis.helper(0, this.arrayData.length - 1);\r\n\r\n\t\treturn this.commands;\r\n\t}\r\n\r\n\thelper(left, right) {\r\n\t\tif (left > right) return;\r\n\r\n\t\t// Hightlight cells in the current sub-array\r\n\t\tfor (let i = left; i <= right; i++) {\r\n\t\t\tthis.cmd('SetBackgroundColor', this.arrayID[i], '#99CCFF');\r\n\t\t}\r\n\t\tthis.cmd('Step');\r\n\r\n\t\tif (left === right) {\r\n\t\t\tthis.cmd('SetBackgroundColor', this.arrayID[left], '#2ECC71');\r\n\t\t\tthis.cmd('Step');\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// Create pivot pointer and swap with left-most element\r\n\t\t// To make things more interesting (and clearer), we don't pick the left-most element as pivot\r\n\t\tlet pivot;\r\n\t\tif (worstPivotEnabled) {\r\n\t\t\tlet min = left;\r\n\t\t\tfor (let i = left + 1; i <= right; i++) {\r\n\t\t\t\tif (this.arrayData[i] < this.arrayData[min]) {\r\n\t\t\t\t\tmin = i;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tpivot = min;\r\n\t\t} else if (firstPivotEnabled) {\r\n\t\t\tpivot = left;\r\n\t\t} else {\r\n\t\t\tpivot = Math.floor(Math.random() * (right - left)) + left + 1;\r\n\t\t}\r\n\t\tconst pXPos = pivot * ARRAY_ELEM_WIDTH + ARRAY_START_X;\r\n\t\tthis.cmd('CreateHighlightCircle', this.pPointerID, '#FFFF00', pXPos, ARRAY_START_Y);\r\n\t\tthis.cmd('Step');\r\n\t\tthis.swapPivot(pivot, left);\r\n\r\n\t\t// Partition\r\n\t\tlet i = left + 1;\r\n\t\tlet j = right;\r\n\t\tconst iXPos = i * ARRAY_ELEM_WIDTH + ARRAY_START_X;\r\n\t\tconst jXPos = j * ARRAY_ELEM_WIDTH + ARRAY_START_X;\r\n\t\tthis.cmd('CreateHighlightCircle', this.iPointerID, '#0000FF', iXPos, ARRAY_START_Y);\r\n\t\tthis.cmd('CreateHighlightCircle', this.jPointerID, '#0000FF', jXPos, ARRAY_START_Y);\r\n\t\tthis.cmd('Step');\r\n\t\twhile (i <= j) {\r\n\t\t\twhile (i <= j && this.arrayData[left] >= this.arrayData[i]) {\r\n\t\t\t\ti++;\r\n\t\t\t\tthis.movePointers(i, j);\r\n\t\t\t}\r\n\t\t\tif (i <= j) {\r\n\t\t\t\tthis.cmd('SetForegroundColor', this.iPointerID, '#FF0000');\r\n\t\t\t\tthis.cmd('Step');\r\n\t\t\t}\r\n\t\t\twhile (i <= j && this.arrayData[left] <= this.arrayData[j]) {\r\n\t\t\t\tj--;\r\n\t\t\t\tthis.movePointers(i, j);\r\n\t\t\t}\r\n\t\t\tif (i <= j) {\r\n\t\t\t\tthis.cmd('SetForegroundColor', this.jPointerID, '#FF0000');\r\n\t\t\t\tthis.cmd('Step');\r\n\t\t\t}\r\n\t\t\tif (i <= j) {\r\n\t\t\t\tthis.swap(i, j);\r\n\t\t\t\ti++;\r\n\t\t\t\tj--;\r\n\t\t\t\tthis.movePointers(i, j);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// Move pivot back and delete pivot pointer\r\n\t\tthis.swapPivot(left, j, true);\r\n\r\n\t\t// Delete i and j pointers\r\n\t\tthis.cmd('Delete', this.iPointerID);\r\n\t\tthis.cmd('Delete', this.jPointerID);\r\n\t\tthis.cmd('Delete', this.pPointerID);\r\n\t\tthis.cmd('Step');\r\n\r\n\t\t// Un-hightlight cells in sub-array and set pivot cell to green\r\n\t\tfor (let i = left; i <= right; i++) {\r\n\t\t\tthis.cmd('SetBackgroundColor', this.arrayID[i], '#FFFFFF');\r\n\t\t}\r\n\t\tif (this.k - 1 === j) {\r\n\t\t\tthis.cmd('SetBackgroundColor', this.arrayID[j], '#2ECC71');\r\n\t\t\tthis.cmd('Step');\r\n\t\t} else {\r\n\t\t\tthis.cmd('SetBackgroundColor', this.arrayID[j], '#4DA6ff');\r\n\t\t\tthis.cmd('Step');\r\n\r\n\t\t\tif (this.k - 1 < j) {\r\n\t\t\t\tthis.helper(left, j - 1);\r\n\t\t\t} else {\r\n\t\t\t\tthis.helper(j + 1, right);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tmovePointers(i, j) {\r\n\t\tconst iXPos = i * ARRAY_ELEM_WIDTH + ARRAY_START_X;\r\n\t\tthis.cmd('Move', this.iPointerID, iXPos, ARRAY_START_Y);\r\n\t\tconst jXPos = j * ARRAY_ELEM_WIDTH + ARRAY_START_X;\r\n\t\tthis.cmd('Move', this.jPointerID, jXPos, ARRAY_START_Y);\r\n\t\tthis.cmd('Step');\r\n\t}\r\n\r\n\tswapPivot(pivot, other, moveJ) {\r\n\t\tif (pivot === other) return;\r\n\t\t// Create temporary labels and remove text in array\r\n\t\tconst lLabelID = this.nextIndex++;\r\n\t\tconst lXPos = other * ARRAY_ELEM_WIDTH + ARRAY_START_X;\r\n\t\tthis.cmd('CreateLabel', lLabelID, this.displayData[other], lXPos, ARRAY_START_Y);\r\n\t\tconst pLabelID = this.nextIndex++;\r\n\t\tconst pXPos = pivot * ARRAY_ELEM_WIDTH + ARRAY_START_X;\r\n\t\tthis.cmd('CreateLabel', pLabelID, this.displayData[pivot], pXPos, ARRAY_START_Y);\r\n\t\tthis.cmd('Settext', this.arrayID[other], '');\r\n\t\tthis.cmd('Settext', this.arrayID[pivot], '');\r\n\t\t// Move labels and pivot pointer\r\n\t\tthis.cmd('Move', pLabelID, lXPos, ARRAY_START_Y);\r\n\t\tthis.cmd('Move', this.pPointerID, lXPos, ARRAY_START_Y);\r\n\t\tthis.cmd('Move', lLabelID, pXPos, ARRAY_START_Y);\r\n\t\tmoveJ && this.cmd('Move', this.jPointerID, pXPos, ARRAY_START_Y);\r\n\t\tthis.cmd('Step');\r\n\t\t// Set text in array, and delete temporary labels and pointer\r\n\t\tthis.cmd('Settext', this.arrayID[other], this.displayData[pivot]);\r\n\t\tthis.cmd('Settext', this.arrayID[pivot], this.displayData[other]);\r\n\t\tthis.cmd('Delete', pLabelID);\r\n\t\tthis.cmd('Delete', lLabelID);\r\n\t\t// Swap data in backend array\r\n\t\tlet temp = this.arrayData[pivot];\r\n\t\tthis.arrayData[pivot] = this.arrayData[other];\r\n\t\tthis.arrayData[other] = temp;\r\n\t\t//Swap data in backend display data\r\n\t\ttemp = this.displayData[pivot];\r\n\t\tthis.displayData[pivot] = this.displayData[other];\r\n\t\tthis.displayData[other] = temp;\r\n\t}\r\n\r\n\tswap(i, j) {\r\n\t\t// Create temporary labels and remove text in array\r\n\t\tconst iLabelID = this.nextIndex++;\r\n\t\tconst iXPos = i * ARRAY_ELEM_WIDTH + ARRAY_START_X;\r\n\t\tthis.cmd('CreateLabel', iLabelID, this.displayData[i], iXPos, ARRAY_START_Y);\r\n\t\tconst jLabelID = this.nextIndex++;\r\n\t\tconst jXPos = j * ARRAY_ELEM_WIDTH + ARRAY_START_X;\r\n\t\tthis.cmd('CreateLabel', jLabelID, this.displayData[j], jXPos, ARRAY_START_Y);\r\n\t\tthis.cmd('Settext', this.arrayID[i], '');\r\n\t\tthis.cmd('Settext', this.arrayID[j], '');\r\n\t\t// Move labels\r\n\t\tthis.cmd('Move', iLabelID, jXPos, ARRAY_START_Y);\r\n\t\tthis.cmd('Move', jLabelID, iXPos, ARRAY_START_Y);\r\n\t\tthis.cmd('Step');\r\n\t\t// Set text in array and delete temporary labels\r\n\t\tthis.cmd('Settext', this.arrayID[i], this.displayData[j]);\r\n\t\tthis.cmd('Settext', this.arrayID[j], this.displayData[i]);\r\n\t\tthis.cmd('Delete', iLabelID);\r\n\t\tthis.cmd('Delete', jLabelID);\r\n\t\t// Swap data in backend array\r\n\t\tlet temp = this.arrayData[i];\r\n\t\tthis.arrayData[i] = this.arrayData[j];\r\n\t\tthis.arrayData[j] = temp;\r\n\t\t//Swap data in backend display data\r\n\t\ttemp = this.displayData[i];\r\n\t\tthis.displayData[i] = this.displayData[j];\r\n\t\tthis.displayData[j] = temp;\r\n\t\t// Reset pointer colors back to blue\r\n\t\tthis.cmd('SetForegroundColor', this.iPointerID, '#0000FF');\r\n\t\tthis.cmd('SetForegroundColor', this.jPointerID, '#0000FF');\r\n\t\tthis.cmd('Step');\r\n\t}\r\n\r\n\ttoggleWorstPivot() {\r\n\t\tworstPivotEnabled = !worstPivotEnabled;\r\n\t\tthis.firstPivotToggle.disabled = worstPivotEnabled;\r\n\t}\r\n\r\n\ttoggleFirstPivot() {\r\n\t\tfirstPivotEnabled = !firstPivotEnabled;\r\n\t\tthis.worstPivotToggle.disabled = firstPivotEnabled;\r\n\t}\r\n\r\n\t// Called by our superexport default class when we get an animation started event -- need to wait for the\r\n\t// event to finish before we start doing anything\r\n\tdisableUI() {\r\n\t\tfor (let i = 0; i < this.controls.length; i++) {\r\n\t\t\tthis.controls[i].disabled = true;\r\n\t\t}\r\n\t}\r\n\r\n\t// Called by our superexport default class when we get an animation completed event -- we can\r\n\t/// now interact again.\r\n\tenableUI() {\r\n\t\tfor (let i = 0; i < this.controls.length; i++) {\r\n\t\t\tthis.controls[i].disabled = false;\r\n\t\t}\r\n\t}\r\n}\r\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\r\n//\r\n// Redistribution and use in source and binary forms, with or without modification, are\r\n// permitted provided that the following conditions are met:\r\n//\r\n// 1. Redistributions of source code must retain the above copyright notice, this list of\r\n// conditions and the following disclaimer.\r\n//\r\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\r\n// of conditions and the following disclaimer in the documentation and/or other materials\r\n// provided with the distribution.\r\n//\r\n// THIS SOFTWARE IS PROVIDED BY David Galles ``AS IS'' AND ANY EXPRESS OR IMPLIED\r\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\r\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\r\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\r\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\r\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\r\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\r\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\r\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\r\n//\r\n// The views and conclusions contained in the software and documentation are those of the\r\n// authors and should not be interpreted as representing official policies, either expressed\r\n// or implied, of the University of San Francisco\r\n\r\nimport Algorithm, {\r\n\taddCheckboxToAlgorithmBar,\r\n\taddControlToAlgorithmBar,\r\n\taddGroupToAlgorithmBar,\r\n\taddLabelToAlgorithmBar,\r\n} from './Algorithm.js';\r\n\r\nconst ARRAY_START_X = 100;\r\nconst ARRAY_START_Y = 200;\r\nconst ARRAY_ELEM_WIDTH = 50;\r\nconst ARRAY_ELEM_HEIGHT = 50;\r\n\r\nlet worstPivotEnabled = false;\r\nlet firstPivotEnabled = false;\r\n\r\nexport default class QuickSort extends Algorithm {\r\n\tconstructor(am, w, h) {\r\n\t\tsuper(am, w, h);\r\n\r\n\t\tthis.addControls();\r\n\r\n\t\t// Useful for memory management\r\n\t\tthis.nextIndex = 0;\r\n\r\n\t\t// TODO:  Add any code necessary to set up your own algorithm.  Initialize data\r\n\t\t// structures, etc.\r\n\t\tthis.setup();\r\n\t}\r\n\r\n\taddControls() {\r\n\t\tthis.controls = [];\r\n\r\n\t\taddLabelToAlgorithmBar('Comma separated list (e.g. \"3,1,2\", max 18 elements)');\r\n\r\n\t\t// List text field\r\n\t\tthis.listField = addControlToAlgorithmBar('Text', '');\r\n\t\tthis.listField.onkeydown = this.returnSubmit(\r\n\t\t\tthis.listField,\r\n\t\t\tthis.sortCallback.bind(this),\r\n\t\t\t60,\r\n\t\t\tfalse\r\n\t\t);\r\n\t\tthis.controls.push(this.listField);\r\n\r\n\t\t// Sort button\r\n\t\tthis.findButton = addControlToAlgorithmBar('Button', 'Sort');\r\n\t\tthis.findButton.onclick = this.sortCallback.bind(this);\r\n\t\tthis.controls.push(this.findButton);\r\n\r\n\t\t// Clear button\r\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear');\r\n\t\tthis.clearButton.onclick = this.clearCallback.bind(this);\r\n\t\tthis.controls.push(this.clearButton);\r\n\r\n\t\t// Toggles\r\n\t\tthis.togglesGroup = addGroupToAlgorithmBar();\r\n\t\tthis.worstPivotToggle = addCheckboxToAlgorithmBar(\r\n\t\t\t'Pick min element as pivot',\r\n\t\t\tfalse,\r\n\t\t\tthis.togglesGroup\r\n\t\t);\r\n\t\tthis.worstPivotToggle.onclick = this.toggleWorstPivot.bind(this);\r\n\t\tthis.controls.push(this.worstPivotToggle);\r\n\t\tthis.firstPivotToggle = addCheckboxToAlgorithmBar(\r\n\t\t\t'Pick first element as pivot',\r\n\t\t\tfalse,\r\n\t\t\tthis.togglesGroup\r\n\t\t);\r\n\t\tthis.firstPivotToggle.onclick = this.toggleFirstPivot.bind(this);\r\n\t\tthis.controls.push(this.firstPivotToggle);\r\n\t}\r\n\r\n\tsetup() {\r\n\t\tthis.arrayData = [];\r\n\t\tthis.displayData = [];\r\n\t\tthis.arrayID = [];\r\n\t\tthis.iPointerID = 0;\r\n\t\tthis.jPointerID = 0;\r\n\t\tthis.pPointerID = 0;\r\n\t}\r\n\r\n\treset() {\r\n\t\t// Reset all of your data structures to *exactly* the state they have immediately after the init\r\n\t\t// function is called.  This method is called whenever an \"undo\" is performed.  Your data\r\n\t\t// structures are completely cleaned, and then all of the actions *up to but not including* the\r\n\t\t// last action are then redone.  If you implement all of your actions through the \"implementAction\"\r\n\t\t// method below, then all of this work is done for you in the Animation \"superexport default class\"\r\n\r\n\t\t// Reset the (very simple) memory manager\r\n\t\tthis.nextIndex = 0;\r\n\t}\r\n\r\n\tsortCallback() {\r\n\t\tif (this.listField.value !== '') {\r\n\t\t\tthis.implementAction(this.clear.bind(this), '');\r\n\t\t\tconst list = this.listField.value;\r\n\t\t\tthis.listField.value = '';\r\n\t\t\tthis.implementAction(this.sort.bind(this), list);\r\n\t\t}\r\n\t}\r\n\r\n\tclearCallback() {\r\n\t\tthis.implementAction(this.clear.bind(this), '');\r\n\t}\r\n\r\n\tclear() {\r\n\t\tthis.commands = [];\r\n\t\tfor (let i = 0; i < this.arrayID.length; i++) {\r\n\t\t\tthis.cmd('Delete', this.arrayID[i]);\r\n\t\t}\r\n\t\tthis.arrayData = [];\r\n\t\tthis.arrayID = [];\r\n\t\tthis.displayData = [];\r\n\t\treturn this.commands;\r\n\t}\r\n\r\n\tsort(params) {\r\n\t\tthis.commands = [];\r\n\r\n\t\tthis.arrayID = [];\r\n\t\tthis.arrayData = params\r\n\t\t\t.split(',')\r\n\t\t\t.map(Number)\r\n\t\t\t.filter(x => x)\r\n\t\t\t.slice(0, 18);\r\n\t\tthis.displayData = new Array(this.arrayData.length);\r\n\r\n\t\tconst elemCounts = new Map();\r\n\t\tconst letterMap = new Map();\r\n\r\n\t\tfor (let i = 0; i < this.arrayData.length; i++) {\r\n\t\t\tconst count = elemCounts.has(this.arrayData[i]) ? elemCounts.get(this.arrayData[i]) : 0;\r\n\t\t\tif (count > 0) {\r\n\t\t\t\tletterMap.set(this.arrayData[i], 'A');\r\n\t\t\t}\r\n\t\t\telemCounts.set(this.arrayData[i], count + 1);\r\n\t\t}\r\n\r\n\t\tfor (let i = 0; i < this.arrayData.length; i++) {\r\n\t\t\tthis.arrayData[i] = parseInt(this.arrayData[i]);\r\n\t\t\tthis.arrayID[i] = this.nextIndex++;\r\n\t\t\tconst xpos = i * ARRAY_ELEM_WIDTH + ARRAY_START_X;\r\n\t\t\tconst ypos = ARRAY_START_Y;\r\n\r\n\t\t\tlet displayData = this.arrayData[i].toString();\r\n\t\t\tif (letterMap.has(this.arrayData[i])) {\r\n\t\t\t\tconst currChar = letterMap.get(this.arrayData[i]);\r\n\t\t\t\tdisplayData += currChar;\r\n\t\t\t\tletterMap.set(this.arrayData[i], String.fromCharCode(currChar.charCodeAt(0) + 1));\r\n\t\t\t}\r\n\t\t\tthis.displayData[i] = displayData;\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'CreateRectangle',\r\n\t\t\t\tthis.arrayID[i],\r\n\t\t\t\tdisplayData,\r\n\t\t\t\tARRAY_ELEM_WIDTH,\r\n\t\t\t\tARRAY_ELEM_HEIGHT,\r\n\t\t\t\txpos,\r\n\t\t\t\typos\r\n\t\t\t);\r\n\t\t}\r\n\r\n\t\tthis.iPointerID = this.nextIndex++;\r\n\t\tthis.jPointerID = this.nextIndex++;\r\n\t\tthis.pPointerID = this.nextIndex++;\r\n\t\tthis.helper(0, this.arrayData.length - 1);\r\n\r\n\t\treturn this.commands;\r\n\t}\r\n\r\n\thelper(left, right) {\r\n\t\tif (left > right) return;\r\n\r\n\t\t// Hightlight cells in the current sub-array\r\n\t\tfor (let i = left; i <= right; i++) {\r\n\t\t\tthis.cmd('SetBackgroundColor', this.arrayID[i], '#99CCFF');\r\n\t\t}\r\n\t\tthis.cmd('Step');\r\n\r\n\t\tif (left === right) {\r\n\t\t\tthis.cmd('SetBackgroundColor', this.arrayID[left], '#2ECC71');\r\n\t\t\tthis.cmd('Step');\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// Create pivot pointer and swap with left-most element\r\n\t\t// To make things more interesting (and clearer), we don't pick the left-most element as pivot\r\n\t\tlet pivot;\r\n\t\tif (worstPivotEnabled) {\r\n\t\t\tlet min = left;\r\n\t\t\tfor (let i = left + 1; i <= right; i++) {\r\n\t\t\t\tif (this.arrayData[i] < this.arrayData[min]) {\r\n\t\t\t\t\tmin = i;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tpivot = min;\r\n\t\t} else if (firstPivotEnabled) {\r\n\t\t\tpivot = left;\r\n\t\t} else {\r\n\t\t\tpivot = Math.floor(Math.random() * (right - left)) + left + 1;\r\n\t\t}\r\n\t\tconst pXPos = pivot * ARRAY_ELEM_WIDTH + ARRAY_START_X;\r\n\t\tthis.cmd('CreateHighlightCircle', this.pPointerID, '#FFFF00', pXPos, ARRAY_START_Y);\r\n\t\tthis.cmd('Step');\r\n\t\tthis.swapPivot(pivot, left);\r\n\r\n\t\t// Partition\r\n\t\tlet i = left + 1;\r\n\t\tlet j = right;\r\n\t\tconst iXPos = i * ARRAY_ELEM_WIDTH + ARRAY_START_X;\r\n\t\tconst jXPos = j * ARRAY_ELEM_WIDTH + ARRAY_START_X;\r\n\t\tthis.cmd('CreateHighlightCircle', this.iPointerID, '#0000FF', iXPos, ARRAY_START_Y);\r\n\t\tthis.cmd('CreateHighlightCircle', this.jPointerID, '#0000FF', jXPos, ARRAY_START_Y);\r\n\t\tthis.cmd('Step');\r\n\t\twhile (i <= j) {\r\n\t\t\twhile (i <= j && this.arrayData[left] >= this.arrayData[i]) {\r\n\t\t\t\ti++;\r\n\t\t\t\tthis.movePointers(i, j);\r\n\t\t\t}\r\n\t\t\tif (i <= j) {\r\n\t\t\t\tthis.cmd('SetForegroundColor', this.iPointerID, '#FF0000');\r\n\t\t\t\tthis.cmd('Step');\r\n\t\t\t}\r\n\t\t\twhile (i <= j && this.arrayData[left] <= this.arrayData[j]) {\r\n\t\t\t\tj--;\r\n\t\t\t\tthis.movePointers(i, j);\r\n\t\t\t}\r\n\t\t\tif (i <= j) {\r\n\t\t\t\tthis.cmd('SetForegroundColor', this.jPointerID, '#FF0000');\r\n\t\t\t\tthis.cmd('Step');\r\n\t\t\t}\r\n\t\t\tif (i <= j) {\r\n\t\t\t\tthis.swap(i, j);\r\n\t\t\t\ti++;\r\n\t\t\t\tj--;\r\n\t\t\t\tthis.movePointers(i, j);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// Move pivot back and delete pivot pointer\r\n\t\tthis.swapPivot(left, j, true);\r\n\r\n\t\t// Delete i and j pointers\r\n\t\tthis.cmd('Delete', this.iPointerID);\r\n\t\tthis.cmd('Delete', this.jPointerID);\r\n\t\tthis.cmd('Delete', this.pPointerID);\r\n\t\tthis.cmd('Step');\r\n\r\n\t\t// Un-hightlight cells in sub-array and set pivot cell to green\r\n\t\tfor (let i = left; i <= right; i++) {\r\n\t\t\tthis.cmd('SetBackgroundColor', this.arrayID[i], '#FFFFFF');\r\n\t\t}\r\n\t\tthis.cmd('SetBackgroundColor', this.arrayID[j], '#2ECC71');\r\n\t\tthis.cmd('Step');\r\n\r\n\t\tthis.helper(left, j - 1);\r\n\t\tthis.helper(j + 1, right);\r\n\t}\r\n\r\n\tmovePointers(i, j) {\r\n\t\tconst iXPos = i * ARRAY_ELEM_WIDTH + ARRAY_START_X;\r\n\t\tthis.cmd('Move', this.iPointerID, iXPos, ARRAY_START_Y);\r\n\t\tconst jXPos = j * ARRAY_ELEM_WIDTH + ARRAY_START_X;\r\n\t\tthis.cmd('Move', this.jPointerID, jXPos, ARRAY_START_Y);\r\n\t\tthis.cmd('Step');\r\n\t}\r\n\r\n\tswapPivot(pivot, other, moveJ) {\r\n\t\tif (pivot === other) return;\r\n\t\t// Create temporary labels and remove text in array\r\n\t\tconst lLabelID = this.nextIndex++;\r\n\t\tconst lXPos = other * ARRAY_ELEM_WIDTH + ARRAY_START_X;\r\n\t\tthis.cmd('CreateLabel', lLabelID, this.displayData[other], lXPos, ARRAY_START_Y);\r\n\t\tconst pLabelID = this.nextIndex++;\r\n\t\tconst pXPos = pivot * ARRAY_ELEM_WIDTH + ARRAY_START_X;\r\n\t\tthis.cmd('CreateLabel', pLabelID, this.displayData[pivot], pXPos, ARRAY_START_Y);\r\n\t\tthis.cmd('Settext', this.arrayID[other], '');\r\n\t\tthis.cmd('Settext', this.arrayID[pivot], '');\r\n\t\t// Move labels and pivot pointer\r\n\t\tthis.cmd('Move', pLabelID, lXPos, ARRAY_START_Y);\r\n\t\tthis.cmd('Move', this.pPointerID, lXPos, ARRAY_START_Y);\r\n\t\tthis.cmd('Move', lLabelID, pXPos, ARRAY_START_Y);\r\n\t\tmoveJ && this.cmd('Move', this.jPointerID, pXPos, ARRAY_START_Y);\r\n\t\tthis.cmd('Step');\r\n\t\t// Set text in array, and delete temporary labels and pointer\r\n\t\tthis.cmd('Settext', this.arrayID[other], this.displayData[pivot]);\r\n\t\tthis.cmd('Settext', this.arrayID[pivot], this.displayData[other]);\r\n\t\tthis.cmd('Delete', pLabelID);\r\n\t\tthis.cmd('Delete', lLabelID);\r\n\t\t// Swap data in backend array\r\n\t\tlet temp = this.arrayData[pivot];\r\n\t\tthis.arrayData[pivot] = this.arrayData[other];\r\n\t\tthis.arrayData[other] = temp;\r\n\t\t//Swap data in backend display data\r\n\t\ttemp = this.displayData[pivot];\r\n\t\tthis.displayData[pivot] = this.displayData[other];\r\n\t\tthis.displayData[other] = temp;\r\n\t}\r\n\r\n\tswap(i, j) {\r\n\t\t// Create temporary labels and remove text in array\r\n\t\tconst iLabelID = this.nextIndex++;\r\n\t\tconst iXPos = i * ARRAY_ELEM_WIDTH + ARRAY_START_X;\r\n\t\tthis.cmd('CreateLabel', iLabelID, this.displayData[i], iXPos, ARRAY_START_Y);\r\n\t\tconst jLabelID = this.nextIndex++;\r\n\t\tconst jXPos = j * ARRAY_ELEM_WIDTH + ARRAY_START_X;\r\n\t\tthis.cmd('CreateLabel', jLabelID, this.displayData[j], jXPos, ARRAY_START_Y);\r\n\t\tthis.cmd('Settext', this.arrayID[i], '');\r\n\t\tthis.cmd('Settext', this.arrayID[j], '');\r\n\t\t// Move labels\r\n\t\tthis.cmd('Move', iLabelID, jXPos, ARRAY_START_Y);\r\n\t\tthis.cmd('Move', jLabelID, iXPos, ARRAY_START_Y);\r\n\t\tthis.cmd('Step');\r\n\t\t// Set text in array and delete temporary labels\r\n\t\tthis.cmd('Settext', this.arrayID[i], this.displayData[j]);\r\n\t\tthis.cmd('Settext', this.arrayID[j], this.displayData[i]);\r\n\t\tthis.cmd('Delete', iLabelID);\r\n\t\tthis.cmd('Delete', jLabelID);\r\n\t\t// Swap data in backend array\r\n\t\tlet temp = this.arrayData[i];\r\n\t\tthis.arrayData[i] = this.arrayData[j];\r\n\t\tthis.arrayData[j] = temp;\r\n\t\t//Swap data in backend display data\r\n\t\ttemp = this.displayData[i];\r\n\t\tthis.displayData[i] = this.displayData[j];\r\n\t\tthis.displayData[j] = temp;\r\n\t\t// Reset pointer colors back to blue\r\n\t\tthis.cmd('SetForegroundColor', this.iPointerID, '#0000FF');\r\n\t\tthis.cmd('SetForegroundColor', this.jPointerID, '#0000FF');\r\n\t\tthis.cmd('Step');\r\n\t}\r\n\r\n\ttoggleWorstPivot() {\r\n\t\tworstPivotEnabled = !worstPivotEnabled;\r\n\t\tthis.firstPivotToggle.disabled = worstPivotEnabled;\r\n\t}\r\n\r\n\ttoggleFirstPivot() {\r\n\t\tfirstPivotEnabled = !firstPivotEnabled;\r\n\t\tthis.worstPivotToggle.disabled = firstPivotEnabled;\r\n\t}\r\n\r\n\t// Called by our superexport default class when we get an animation started event -- need to wait for the\r\n\t// event to finish before we start doing anything\r\n\tdisableUI() {\r\n\t\tfor (let i = 0; i < this.controls.length; i++) {\r\n\t\t\tthis.controls[i].disabled = true;\r\n\t\t}\r\n\t}\r\n\r\n\t// Called by our superexport default class when we get an animation completed event -- we can\r\n\t/// now interact again.\r\n\tenableUI() {\r\n\t\tfor (let i = 0; i < this.controls.length; i++) {\r\n\t\t\tthis.controls[i].disabled = false;\r\n\t\t}\r\n\t}\r\n}\r\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\r\n//\r\n// Redistribution and use in source and binary forms, with or without modification, are\r\n// permitted provided that the following conditions are met:\r\n//\r\n// 1. Redistributions of source code must retain the above copyright notice, this list of\r\n// conditions and the following disclaimer.\r\n//\r\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\r\n// of conditions and the following disclaimer in the documentation and/or other materials\r\n// provided with the distribution.\r\n//\r\n// THIS SOFTWARE IS PROVIDED BY David Galles ``AS IS'' AND ANY EXPRESS OR IMPLIED\r\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\r\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\r\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\r\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\r\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\r\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\r\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\r\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\r\n//\r\n// The views and conclusions contained in the software and documentation are those of the\r\n// authors and should not be interpreted as representing official policies, either expressed\r\n// or implied, of the University of San Francisco\r\n\r\nimport Algorithm, { addControlToAlgorithmBar, addLabelToAlgorithmBar } from './Algorithm.js';\r\n\r\nconst ARRAY_START_X = 100;\r\nconst ARRAY_START_Y = 30;\r\n\r\nconst MAX_LENGTH = 22;\r\n\r\n// const LOWER_A_CHAR_CODE = 97;\r\n\r\nconst BASE_LABEL_Y = 45;\r\nconst CHARACTER_VALUES_LABEL_Y = 60;\r\nconst TEXT_HASH_LABEL_START_Y = 100;\r\nconst PATTERN_HASH_LABEL_START_Y = 115;\r\n\r\nexport default class RabinKarp extends Algorithm {\r\n\tconstructor(am, w, h) {\r\n\t\tsuper(am, w, h);\r\n\r\n\t\tthis.addControls();\r\n\r\n\t\t// Useful for memory management\r\n\t\tthis.nextIndex = 0;\r\n\r\n\t\t// TODO:  Add any code necessary to set up your own algorithm.  Initialize data\r\n\t\t// structures, etc.\r\n\t\tthis.setup();\r\n\t}\r\n\r\n\taddControls() {\r\n\t\tthis.controls = [];\r\n\r\n\t\taddLabelToAlgorithmBar('Text');\r\n\r\n\t\t// Text text field\r\n\t\tthis.textField = addControlToAlgorithmBar('Text', '');\r\n\t\tthis.textField.onkeydown = this.returnSubmit(\r\n\t\t\tthis.textField,\r\n\t\t\tthis.findCallback.bind(this),\r\n\t\t\tMAX_LENGTH,\r\n\t\t\tfalse\r\n\t\t);\r\n\t\tthis.controls.push(this.textField);\r\n\r\n\t\taddLabelToAlgorithmBar('Pattern');\r\n\r\n\t\t// Pattern text field\r\n\t\tthis.patternField = addControlToAlgorithmBar('Text', '');\r\n\t\tthis.patternField.onkeydown = this.returnSubmit(\r\n\t\t\tthis.patternField,\r\n\t\t\tthis.findCallback.bind(this),\r\n\t\t\tMAX_LENGTH,\r\n\t\t\tfalse\r\n\t\t);\r\n\t\tthis.controls.push(this.patternField);\r\n\r\n\t\t// Find button\r\n\t\tthis.findButton = addControlToAlgorithmBar('Button', 'Find');\r\n\t\tthis.findButton.onclick = this.findCallback.bind(this);\r\n\t\tthis.controls.push(this.findButton);\r\n\r\n\t\t// Clear button\r\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear');\r\n\t\tthis.clearButton.onclick = this.clearCallback.bind(this);\r\n\t\tthis.controls.push(this.clearButton);\r\n\t}\r\n\r\n\tsetup() {\r\n\t\tthis.textRowID = [];\r\n\t\tthis.comparisonMatrixID = [];\r\n\t\tthis.baseLabelID = this.nextIndex++;\r\n\t\tthis.characterValuesLabelID = this.nextIndex++;\r\n\t\tthis.textHashLabelID = this.nextIndex++;\r\n\t\tthis.textHashCalculationID = this.nextIndex++;\r\n\t\tthis.patternHashLabelID = this.nextIndex++;\r\n\t\tthis.patternHashCalculationID = this.nextIndex++;\r\n\t}\r\n\r\n\treset() {\r\n\t\t// Reset all of your data structures to *exactly* the state they have immediately after the init\r\n\t\t// function is called.  This method is called whenever an \"undo\" is performed.  Your data\r\n\t\t// structures are completely cleaned, and then all of the actions *up to but not including* the\r\n\t\t// last action are then redone.  If you implement all of your actions through the \"implementAction\"\r\n\t\t// method below, then all of this work is done for you in the Animation \"superexport default class\"\r\n\r\n\t\t// Reset the (very simple) memory manager\r\n\t\tthis.nextIndex = 0;\r\n\t}\r\n\r\n\tfindCallback() {\r\n\t\tif (\r\n\t\t\tthis.textField.value !== '' &&\r\n\t\t\tthis.patternField.value !== '' &&\r\n\t\t\tthis.textField.value.length >= this.patternField.value.length\r\n\t\t) {\r\n\t\t\tthis.implementAction(this.clear.bind(this), '');\r\n\t\t\tconst text = this.textField.value;\r\n\t\t\tconst pattern = this.patternField.value;\r\n\t\t\tthis.textField.value = '';\r\n\t\t\tthis.patternField.value = '';\r\n\t\t\tthis.implementAction(this.find.bind(this), text + ',' + pattern);\r\n\t\t}\r\n\t}\r\n\r\n\tclearCallback() {\r\n\t\tthis.implementAction(this.clear.bind(this), '');\r\n\t}\r\n\r\n\tfind(params) {\r\n\t\tthis.commands = [];\r\n\r\n\t\t// Filter non-letters from string and make lower case\r\n\t\tconst text = params\r\n\t\t\t.split(',')[0]\r\n\t\t\t.replace(/[^a-zA-Z]/g, '')\r\n\t\t\t.toLowerCase();\r\n\t\tconst pattern = params\r\n\t\t\t.split(',')[1]\r\n\t\t\t.replace(/[^a-zA-Z]/g, '')\r\n\t\t\t.toLowerCase();\r\n\r\n\t\tif (text.length <= 14) {\r\n\t\t\tthis.cellSize = 30;\r\n\t\t} else if (text.length <= 17) {\r\n\t\t\tthis.cellSize = 25;\r\n\t\t} else {\r\n\t\t\tthis.cellSize = 20;\r\n\t\t}\r\n\r\n\t\tthis.textRowID = new Array(text.length);\r\n\t\tthis.comparisonMatrixID = new Array(text.length);\r\n\t\tfor (let i = 0; i < text.length; i++) {\r\n\t\t\tthis.comparisonMatrixID[i] = new Array(text.length);\r\n\t\t}\r\n\r\n\t\tlet xpos, ypos;\r\n\r\n\t\tfor (let i = 0; i < text.length; i++) {\r\n\t\t\txpos = i * this.cellSize + ARRAY_START_X;\r\n\t\t\typos = ARRAY_START_Y;\r\n\t\t\tthis.textRowID[i] = this.nextIndex;\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'CreateRectangle',\r\n\t\t\t\tthis.nextIndex,\r\n\t\t\t\ttext.charAt(i),\r\n\t\t\t\tthis.cellSize,\r\n\t\t\t\tthis.cellSize,\r\n\t\t\t\txpos,\r\n\t\t\t\typos\r\n\t\t\t);\r\n\t\t\tthis.cmd('SetBackgroundColor', this.nextIndex++, '#D3D3D3');\r\n\t\t}\r\n\r\n\t\tfor (let row = 0; row < text.length; row++) {\r\n\t\t\tfor (let col = 0; col < text.length; col++) {\r\n\t\t\t\txpos = col * this.cellSize + ARRAY_START_X;\r\n\t\t\t\typos = (row + 1) * this.cellSize + ARRAY_START_Y;\r\n\t\t\t\tthis.comparisonMatrixID[row][col] = this.nextIndex;\r\n\t\t\t\tthis.cmd(\r\n\t\t\t\t\t'CreateRectangle',\r\n\t\t\t\t\tthis.nextIndex++,\r\n\t\t\t\t\t'',\r\n\t\t\t\t\tthis.cellSize,\r\n\t\t\t\t\tthis.cellSize,\r\n\t\t\t\t\txpos,\r\n\t\t\t\t\typos\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tconst labelsX = ARRAY_START_X + text.length * this.cellSize + 10;\r\n\t\tthis.cmd('CreateLabel', this.baseLabelID, 'Base constant = 1', labelsX, BASE_LABEL_Y, 0);\r\n\t\tthis.cmd(\r\n\t\t\t'CreateLabel',\r\n\t\t\tthis.characterValuesLabelID,\r\n\t\t\t'Character values: a = 0, b = 1, ..., z = 25',\r\n\t\t\tlabelsX,\r\n\t\t\tCHARACTER_VALUES_LABEL_Y,\r\n\t\t\t0\r\n\t\t);\r\n\t\tthis.cmd(\r\n\t\t\t'CreateLabel',\r\n\t\t\tthis.textHashLabelID,\r\n\t\t\t'Text hash:',\r\n\t\t\tlabelsX,\r\n\t\t\tTEXT_HASH_LABEL_START_Y,\r\n\t\t\t0\r\n\t\t);\r\n\t\tthis.cmd(\r\n\t\t\t'CreateLabel',\r\n\t\t\tthis.patternHashLabelID,\r\n\t\t\t'Pattern hash:',\r\n\t\t\tlabelsX,\r\n\t\t\tPATTERN_HASH_LABEL_START_Y,\r\n\t\t\t0\r\n\t\t);\r\n\r\n\t\tlet textCalculation = '';\r\n\t\tlet textHash = 0;\r\n\t\tlet patternCalculation = '';\r\n\t\tlet patternHash = 0;\r\n\t\tfor (let i = 0; i < pattern.length; i++) {\r\n\t\t\ttextHash += text.charCodeAt(i) - 97;\r\n\t\t\ttextCalculation += text.charAt(i) + ' + ';\r\n\t\t\tpatternHash += pattern.charCodeAt(i) - 97;\r\n\t\t\tpatternCalculation += pattern.charAt(i) + ' + ';\r\n\t\t}\r\n\t\ttextCalculation =\r\n\t\t\ttextCalculation.substring(0, textCalculation.length - 2) + ' = ' + textHash;\r\n\t\tpatternCalculation =\r\n\t\t\tpatternCalculation.substring(0, patternCalculation.length - 2) + ' = ' + patternHash;\r\n\t\tconst calculationsX = ARRAY_START_X + text.length * this.cellSize + 80;\r\n\t\tthis.cmd(\r\n\t\t\t'CreateLabel',\r\n\t\t\tthis.textHashCalculationID,\r\n\t\t\ttextCalculation,\r\n\t\t\tcalculationsX,\r\n\t\t\tTEXT_HASH_LABEL_START_Y,\r\n\t\t\t0\r\n\t\t);\r\n\t\tthis.cmd(\r\n\t\t\t'CreateLabel',\r\n\t\t\tthis.patternHashCalculationID,\r\n\t\t\tpatternCalculation,\r\n\t\t\tcalculationsX,\r\n\t\t\tPATTERN_HASH_LABEL_START_Y,\r\n\t\t\t0\r\n\t\t);\r\n\r\n\t\tconst iPointerID = this.nextIndex++;\r\n\t\tconst jPointerID = this.nextIndex++;\r\n\r\n\t\tlet row = 0;\r\n\t\tfor (let i = 0; i <= text.length - pattern.length; i++) {\r\n\t\t\tfor (let k = i; k < i + pattern.length; k++) {\r\n\t\t\t\tthis.cmd(\r\n\t\t\t\t\t'SetText',\r\n\t\t\t\t\tthis.comparisonMatrixID[row][k],\r\n\t\t\t\t\tpattern.charAt(k - i),\r\n\t\t\t\t\txpos,\r\n\t\t\t\t\typos\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t\tthis.cmd('Step');\r\n\t\t\tif (patternHash === textHash) {\r\n\t\t\t\txpos = i * this.cellSize + ARRAY_START_X;\r\n\t\t\t\tthis.cmd('CreateHighlightCircle', iPointerID, '#0000FF', xpos, ARRAY_START_Y);\r\n\t\t\t\typos = (row + 1) * this.cellSize + ARRAY_START_Y;\r\n\t\t\t\tthis.cmd('CreateHighlightCircle', jPointerID, '#0000FF', xpos, ypos);\r\n\t\t\t\tthis.cmd('Step');\r\n\t\t\t\tlet j = 0;\r\n\t\t\t\twhile (j < pattern.length && pattern.charAt(j) === text.charAt(i + j)) {\r\n\t\t\t\t\tthis.cmd('SetBackgroundColor', this.comparisonMatrixID[row][i + j], '#2ECC71');\r\n\t\t\t\t\tj++;\r\n\t\t\t\t\tif (j !== pattern.length) {\r\n\t\t\t\t\t\txpos = (i + j) * this.cellSize + ARRAY_START_X;\r\n\t\t\t\t\t\tthis.cmd('Move', iPointerID, xpos, ARRAY_START_Y);\r\n\t\t\t\t\t\typos = (row + 1) * this.cellSize + ARRAY_START_Y;\r\n\t\t\t\t\t\tthis.cmd('Move', jPointerID, xpos, ypos);\r\n\t\t\t\t\t\tthis.cmd('Step');\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (j !== pattern.length) {\r\n\t\t\t\t\tthis.cmd('SetBackgroundColor', this.comparisonMatrixID[row][i + j], '#E74C3C');\r\n\t\t\t\t}\r\n\t\t\t\tthis.cmd('Delete', iPointerID);\r\n\t\t\t\tthis.cmd('Delete', jPointerID);\r\n\t\t\t\tthis.cmd('Step');\r\n\t\t\t} else {\r\n\t\t\t\tfor (let k = i; k < i + pattern.length; k++) {\r\n\t\t\t\t\tthis.cmd('SetBackgroundColor', this.comparisonMatrixID[row][k], '#FFFF4D');\r\n\t\t\t\t}\r\n\t\t\t\tthis.cmd('Step');\r\n\t\t\t}\r\n\t\t\tif (i < text.length - pattern.length) {\r\n\t\t\t\ttextHash =\r\n\t\t\t\t\ttextHash -\r\n\t\t\t\t\t(text.charCodeAt(i) - 97) +\r\n\t\t\t\t\t(text.charCodeAt(i + pattern.length) - 97);\r\n\t\t\t\ttextCalculation = '';\r\n\t\t\t\tfor (let k = 0; k < pattern.length; k++) {\r\n\t\t\t\t\ttextCalculation += text.charAt(k + i + 1) + ' + ';\r\n\t\t\t\t}\r\n\t\t\t\ttextCalculation =\r\n\t\t\t\t\ttextCalculation.substring(0, textCalculation.length - 2) + ' = ' + textHash;\r\n\t\t\t\tthis.cmd('SetText', this.textHashCalculationID, textCalculation);\r\n\t\t\t}\r\n\t\t\trow++;\r\n\t\t}\r\n\r\n\t\treturn this.commands;\r\n\t}\r\n\r\n\tclear() {\r\n\t\tthis.commands = [];\r\n\t\tif (this.textRowID.length !== 0) {\r\n\t\t\tthis.cmd('Delete', this.baseLabelID);\r\n\t\t\tthis.cmd('Delete', this.characterValuesLabelID);\r\n\t\t\tthis.cmd('Delete', this.textHashLabelID);\r\n\t\t\tthis.cmd('Delete', this.textHashCalculationID);\r\n\t\t\tthis.cmd('Delete', this.patternHashLabelID);\r\n\t\t\tthis.cmd('Delete', this.patternHashCalculationID);\r\n\t\t}\r\n\t\tfor (let i = 0; i < this.textRowID.length; i++) {\r\n\t\t\tthis.cmd('Delete', this.textRowID[i]);\r\n\t\t}\r\n\t\tthis.textRowID = [];\r\n\t\tfor (let i = 0; i < this.comparisonMatrixID.length; i++) {\r\n\t\t\tfor (let j = 0; j < this.comparisonMatrixID.length; j++) {\r\n\t\t\t\tthis.cmd('Delete', this.comparisonMatrixID[i][j]);\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.comparisonMatrixID = [];\r\n\r\n\t\treturn this.commands;\r\n\t}\r\n\r\n\t// Called by our superexport default class when we get an animation started event -- need to wait for the\r\n\t// event to finish before we start doing anything\r\n\tdisableUI() {\r\n\t\tfor (let i = 0; i < this.controls.length; i++) {\r\n\t\t\tthis.controls[i].disabled = true;\r\n\t\t}\r\n\t}\r\n\r\n\t// Called by our superexport default class when we get an animation completed event -- we can\r\n\t/// now interact again.\r\n\tenableUI() {\r\n\t\tfor (let i = 0; i < this.controls.length; i++) {\r\n\t\t\tthis.controls[i].disabled = false;\r\n\t\t}\r\n\t}\r\n}\r\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\r\n//\r\n// Redistribution and use in source and binary forms, with or without modification, are\r\n// permitted provided that the following conditions are met:\r\n//\r\n// 1. Redistributions of source code must retain the above copyright notice, this list of\r\n// conditions and the following disclaimer.\r\n//\r\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\r\n// of conditions and the following disclaimer in the documentation and/or other materials\r\n// provided with the distribution.\r\n//\r\n// THIS SOFTWARE IS PROVIDED BY David Galles ``AS IS'' AND ANY EXPRESS OR IMPLIED\r\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\r\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\r\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\r\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\r\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\r\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\r\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\r\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\r\n//\r\n// The views and conclusions contained in the software and documentation are those of the\r\n// authors and should not be interpreted as representing official policies, either expressed\r\n// or implied, of the University of San Francisco\r\n\r\nimport Algorithm, { addControlToAlgorithmBar, addLabelToAlgorithmBar } from './Algorithm.js';\r\n\r\nconst ARRAY_START_X = 100;\r\nconst ARRAY_START_Y = 200;\r\nconst ARRAY_ELEM_WIDTH = 50;\r\nconst ARRAY_ELEM_HEIGHT = 50;\r\n\r\n// const ARRRAY_ELEMS_PER_LINE = 15;\r\n// const ARRAY_LINE_SPACING = 130;\r\n\r\n// const TOP_POS_X = 180;\r\n// const TOP_POS_Y = 100;\r\n// const TOP_LABEL_X = 130;\r\n// const TOP_LABEL_Y = 100;\r\n\r\n// const PUSH_LABEL_X = 50;\r\n// const PUSH_LABEL_Y = 30;\r\n// const PUSH_ELEMENT_X = 120;\r\n// const PUSH_ELEMENT_Y = 30;\r\n\r\n// const SIZE = 10;\r\n\r\nexport default class SelectionSort extends Algorithm {\r\n\tconstructor(am, w, h) {\r\n\t\tsuper(am, w, h);\r\n\r\n\t\tthis.addControls();\r\n\r\n\t\t// Useful for memory management\r\n\t\tthis.nextIndex = 0;\r\n\r\n\t\t// TODO:  Add any code necessary to set up your own algorithm.  Initialize data\r\n\t\t// structures, etc.\r\n\t\tthis.setup();\r\n\t}\r\n\r\n\taddControls() {\r\n\t\tthis.controls = [];\r\n\r\n\t\taddLabelToAlgorithmBar('Comma separated list (e.g. \"3,1,2\", max 18 elements)');\r\n\r\n\t\t// List text field\r\n\t\tthis.listField = addControlToAlgorithmBar('Text', '');\r\n\t\tthis.listField.onkeydown = this.returnSubmit(\r\n\t\t\tthis.listField,\r\n\t\t\tthis.sortCallback.bind(this),\r\n\t\t\t60,\r\n\t\t\tfalse\r\n\t\t);\r\n\t\tthis.controls.push(this.listField);\r\n\r\n\t\t// Sort button\r\n\t\tthis.findButton = addControlToAlgorithmBar('Button', 'Sort');\r\n\t\tthis.findButton.onclick = this.sortCallback.bind(this);\r\n\t\tthis.controls.push(this.findButton);\r\n\r\n\t\t// Clear button\r\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear');\r\n\t\tthis.clearButton.onclick = this.clearCallback.bind(this);\r\n\t\tthis.controls.push(this.clearButton);\r\n\t}\r\n\r\n\tsetup() {\r\n\t\tthis.arrayData = [];\r\n\t\tthis.arrayID = [];\r\n\t\tthis.displayData = [];\r\n\t\tthis.iPointerID = this.nextIndex++;\r\n\t\tthis.jPointerID = this.nextIndex++;\r\n\t}\r\n\r\n\treset() {\r\n\t\t// Reset all of your data structures to *exactly* the state they have immediately after the init\r\n\t\t// function is called.  This method is called whenever an \"undo\" is performed.  Your data\r\n\t\t// structures are completely cleaned, and then all of the actions *up to but not including* the\r\n\t\t// last action are then redone.  If you implement all of your actions through the \"implementAction\"\r\n\t\t// method below, then all of this work is done for you in the Animation \"superexport default class\"\r\n\r\n\t\t// Reset the (very simple) memory manager\r\n\t\tthis.nextIndex = 0;\r\n\t}\r\n\r\n\tsortCallback() {\r\n\t\tif (this.listField.value !== '') {\r\n\t\t\tthis.implementAction(this.clear.bind(this), '');\r\n\t\t\tconst list = this.listField.value;\r\n\t\t\tthis.listField.value = '';\r\n\t\t\tthis.implementAction(this.sort.bind(this), list);\r\n\t\t}\r\n\t}\r\n\r\n\tclearCallback() {\r\n\t\tthis.implementAction(this.clear.bind(this), '');\r\n\t}\r\n\r\n\tclear() {\r\n\t\tthis.commands = [];\r\n\t\tfor (let i = 0; i < this.arrayID.length; i++) {\r\n\t\t\tthis.cmd('Delete', this.arrayID[i]);\r\n\t\t}\r\n\t\tthis.arrayData = [];\r\n\t\tthis.arrayID = [];\r\n\t\tthis.displayData = [];\r\n\t\treturn this.commands;\r\n\t}\r\n\r\n\tsort(params) {\r\n\t\tthis.commands = [];\r\n\r\n\t\tthis.arrayID = [];\r\n\t\tthis.arrayData = params\r\n\t\t\t.split(',')\r\n\t\t\t.map(Number)\r\n\t\t\t.filter(x => x)\r\n\t\t\t.slice(0, 18);\r\n\t\tconst length = this.arrayData.length;\r\n\t\tthis.displayData = new Array(length);\r\n\r\n\t\tconst elemCounts = new Map();\r\n\t\tconst letterMap = new Map();\r\n\r\n\t\tfor (let i = 0; i < length; i++) {\r\n\t\t\tconst count = elemCounts.has(this.arrayData[i]) ? elemCounts.get(this.arrayData[i]) : 0;\r\n\t\t\tif (count > 0) {\r\n\t\t\t\tletterMap.set(this.arrayData[i], 'A');\r\n\t\t\t}\r\n\t\t\telemCounts.set(this.arrayData[i], count + 1);\r\n\t\t}\r\n\r\n\t\tfor (let i = 0; i < length; i++) {\r\n\t\t\tthis.arrayID[i] = this.nextIndex++;\r\n\t\t\tconst xpos = i * ARRAY_ELEM_WIDTH + ARRAY_START_X;\r\n\t\t\tconst ypos = ARRAY_START_Y;\r\n\r\n\t\t\tlet displayData = this.arrayData[i].toString();\r\n\t\t\tif (letterMap.has(this.arrayData[i])) {\r\n\t\t\t\tconst currChar = letterMap.get(this.arrayData[i]);\r\n\t\t\t\tdisplayData += currChar;\r\n\t\t\t\tletterMap.set(this.arrayData[i], String.fromCharCode(currChar.charCodeAt(0) + 1));\r\n\t\t\t}\r\n\t\t\tthis.displayData[i] = displayData;\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'CreateRectangle',\r\n\t\t\t\tthis.arrayID[i],\r\n\t\t\t\tdisplayData,\r\n\t\t\t\tARRAY_ELEM_WIDTH,\r\n\t\t\t\tARRAY_ELEM_HEIGHT,\r\n\t\t\t\txpos,\r\n\t\t\t\typos\r\n\t\t\t);\r\n\t\t}\r\n\r\n\t\tthis.cmd('CreateHighlightCircle', this.iPointerID, '#FF0000', ARRAY_START_X, ARRAY_START_Y);\r\n\t\tthis.cmd('SetHighlight', this.iPointerID, 1);\r\n\t\tthis.cmd(\r\n\t\t\t'CreateHighlightCircle',\r\n\t\t\tthis.jPointerID,\r\n\t\t\t'#0000FF',\r\n\t\t\tARRAY_START_X + ARRAY_ELEM_WIDTH,\r\n\t\t\tARRAY_START_Y\r\n\t\t);\r\n\t\tthis.cmd('SetHighlight', this.jPointerID, 1);\r\n\t\tthis.cmd('Step');\r\n\r\n\t\tfor (let i = 0; i < this.arrayData.length - 1; i++) {\r\n\t\t\tlet smallest = i;\r\n\t\t\tthis.cmd('SetBackgroundColor', this.arrayID[smallest], '#FFFF00');\r\n\t\t\tfor (let j = i + 1; j < this.arrayData.length; j++) {\r\n\t\t\t\tthis.movePointers(smallest, j);\r\n\t\t\t\tif (this.arrayData[j] < this.arrayData[smallest]) {\r\n\t\t\t\t\tthis.cmd('SetBackgroundColor', this.arrayID[smallest], '#FFFFFF');\r\n\t\t\t\t\tthis.cmd('Step');\r\n\t\t\t\t\tsmallest = j;\r\n\t\t\t\t\tthis.movePointers(smallest, j);\r\n\t\t\t\t\tthis.cmd('SetBackgroundColor', this.arrayID[smallest], '#FFFF00');\r\n\t\t\t\t\tthis.cmd('Step');\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.swap(i, smallest);\r\n\t\t\tthis.cmd('SetBackgroundColor', this.arrayID[smallest], '#FFFFFF');\r\n\t\t\tthis.cmd('Step');\r\n\t\t\tthis.cmd('SetBackgroundColor', this.arrayID[i], '#2ECC71');\r\n\t\t\tthis.cmd('Step');\r\n\t\t}\r\n\r\n\t\tthis.cmd('Delete', this.iPointerID);\r\n\t\tthis.cmd('Delete', this.jPointerID);\r\n\t\tthis.cmd('Step');\r\n\r\n\t\tthis.cmd('SetBackgroundColor', this.arrayID[this.arrayID.length - 1], '#2ECC71');\r\n\r\n\t\treturn this.commands;\r\n\t}\r\n\r\n\tmovePointers(i, j) {\r\n\t\tconst iXPos = i * ARRAY_ELEM_WIDTH + ARRAY_START_X;\r\n\t\tconst iYPos = ARRAY_START_Y;\r\n\t\tthis.cmd('Move', this.iPointerID, iXPos, iYPos);\r\n\t\tconst jXPos = j * ARRAY_ELEM_WIDTH + ARRAY_START_X;\r\n\t\tconst jYPos = ARRAY_START_Y;\r\n\t\tthis.cmd('Move', this.jPointerID, jXPos, jYPos);\r\n\t\tthis.cmd('Step');\r\n\t}\r\n\r\n\tswap(i, j) {\r\n\t\tconst iLabelID = this.nextIndex++;\r\n\t\tconst iXPos = i * ARRAY_ELEM_WIDTH + ARRAY_START_X;\r\n\t\tconst iYPos = ARRAY_START_Y;\r\n\t\tthis.cmd('CreateLabel', iLabelID, this.displayData[i], iXPos, iYPos);\r\n\t\tconst jLabelID = this.nextIndex++;\r\n\t\tconst jXPos = j * ARRAY_ELEM_WIDTH + ARRAY_START_X;\r\n\t\tconst jYPos = ARRAY_START_Y;\r\n\t\tthis.cmd('CreateLabel', jLabelID, this.displayData[j], jXPos, jYPos);\r\n\t\tthis.cmd('Settext', this.arrayID[i], '');\r\n\t\tthis.cmd('Settext', this.arrayID[j], '');\r\n\t\tthis.cmd('Move', iLabelID, jXPos, jYPos);\r\n\t\tthis.cmd('Move', jLabelID, iXPos, iYPos);\r\n\t\tthis.cmd('Step');\r\n\t\tthis.cmd('Settext', this.arrayID[i], this.displayData[j]);\r\n\t\tthis.cmd('Settext', this.arrayID[j], this.displayData[i]);\r\n\t\tthis.cmd('Delete', iLabelID);\r\n\t\tthis.cmd('Delete', jLabelID);\r\n\t\t// Swap data in backend array\r\n\t\tlet temp = this.arrayData[i];\r\n\t\tthis.arrayData[i] = this.arrayData[j];\r\n\t\tthis.arrayData[j] = temp;\r\n\t\t// Swap data in display array\r\n\t\ttemp = this.displayData[i];\r\n\t\tthis.displayData[i] = this.displayData[j];\r\n\t\tthis.displayData[j] = temp;\r\n\t}\r\n\r\n\t// Called by our superexport default class when we get an animation started event -- need to wait for the\r\n\t// event to finish before we start doing anything\r\n\tdisableUI() {\r\n\t\tfor (let i = 0; i < this.controls.length; i++) {\r\n\t\t\tthis.controls[i].disabled = true;\r\n\t\t}\r\n\t}\r\n\r\n\t// Called by our superexport default class when we get an animation completed event -- we can\r\n\t/// now interact again.\r\n\tenableUI() {\r\n\t\tfor (let i = 0; i < this.controls.length; i++) {\r\n\t\t\tthis.controls[i].disabled = false;\r\n\t\t}\r\n\t}\r\n}\r\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\r\n//\r\n// Redistribution and use in source and binary forms, with or without modification, are\r\n// permitted provided that the following conditions are met:\r\n//\r\n// 1. Redistributions of source code must retain the above copyright notice, this list of\r\n// conditions and the following disclaimer.\r\n//\r\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\r\n// of conditions and the following disclaimer in the documentation and/or other materials\r\n// provided with the distribution.\r\n//\r\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\r\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\r\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\r\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\r\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\r\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\r\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\r\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\r\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\r\n//\r\n// The views and conclusions contained in the software and documentation are those of the\r\n// authors and should not be interpreted as representing official policies, either expressed\r\n// or implied, of the University of San Francisco\r\n\r\nimport Algorithm, { addControlToAlgorithmBar, addLabelToAlgorithmBar } from './Algorithm.js';\r\n\r\nconst LINKED_LIST_START_X = 100;\r\nconst LINKED_LIST_START_Y = 200;\r\nconst LINKED_LIST_ELEM_WIDTH = 70;\r\nconst LINKED_LIST_ELEM_HEIGHT = 30;\r\n\r\nconst LINKED_LIST_INSERT_X = 200;\r\nconst LINKED_LIST_INSERT_Y = 50;\r\n\r\nconst LINKED_LIST_ELEMS_PER_LINE = 9;\r\nconst LINKED_LIST_ELEM_SPACING = 100;\r\nconst LINKED_LIST_LINE_SPACING = 100;\r\n\r\n// const TOP_POS_X = 180;\r\n// const TOP_POS_Y = 100;\r\n// const TOP_LABEL_X = 130;\r\n// const TOP_LABEL_Y =  100;\r\n\r\n// const TOP_ELEM_WIDTH = 30;\r\n// const TOP_ELEM_HEIGHT = 30;\r\n\r\nconst PUSH_LABEL_X = 50;\r\nconst PUSH_LABEL_Y = 30;\r\nconst PUSH_ELEMENT_X = 120;\r\nconst PUSH_ELEMENT_Y = 30;\r\n\r\nconst SIZE = 9;\r\n\r\nexport default class CircularlySinglyLinkedList extends Algorithm {\r\n\tconstructor(am, w, h) {\r\n\t\t// Call the unit function of our \"superexport default class\", which adds a couple of\r\n\t\t// listeners, and sets up the undo stack\r\n\t\tsuper(am, w, h);\r\n\r\n\t\tthis.addControls();\r\n\r\n\t\t// Useful for memory management\r\n\t\tthis.nextIndex = 0;\r\n\r\n\t\tthis.setup();\r\n\r\n\t\tthis.initialIndex = this.nextIndex;\r\n\t}\r\n\r\n\taddControls() {\r\n\t\tthis.controls = [];\r\n\r\n\t\taddLabelToAlgorithmBar('Value');\r\n\r\n\t\t// Add's value text field\r\n\t\tthis.addValueField = addControlToAlgorithmBar('Text', '');\r\n\t\tthis.addValueField.onkeydown = this.returnSubmit(\r\n\t\t\tthis.addValueField,\r\n\t\t\tthis.addIndexCallback.bind(this),\r\n\t\t\t4,\r\n\t\t\ttrue\r\n\t\t);\r\n\t\tthis.controls.push(this.addValueField);\r\n\r\n\t\taddLabelToAlgorithmBar('at index');\r\n\r\n\t\t// Add's index text field\r\n\t\tthis.addIndexField = addControlToAlgorithmBar('Text', '');\r\n\t\tthis.addIndexField.onkeydown = this.returnSubmit(\r\n\t\t\tthis.addIndexField,\r\n\t\t\tthis.addIndexCallback.bind(this),\r\n\t\t\t4,\r\n\t\t\ttrue\r\n\t\t);\r\n\t\tthis.controls.push(this.addIndexField);\r\n\r\n\t\t// Add at index button\r\n\t\tthis.addIndexButton = addControlToAlgorithmBar('Button', 'Add at Index');\r\n\t\tthis.addIndexButton.onclick = this.addIndexCallback.bind(this);\r\n\t\tthis.controls.push(this.addIndexButton);\r\n\r\n\t\taddLabelToAlgorithmBar('or');\r\n\r\n\t\t// Add to front button\r\n\t\tthis.addFrontButton = addControlToAlgorithmBar('Button', 'Add to Front');\r\n\t\tthis.addFrontButton.onclick = this.addFrontCallback.bind(this);\r\n\t\tthis.controls.push(this.addFrontButton);\r\n\r\n\t\t// Add to back button\r\n\t\tthis.addBackButton = addControlToAlgorithmBar('Button', 'Add to Back');\r\n\t\tthis.addBackButton.onclick = this.addBackCallback.bind(this);\r\n\t\tthis.controls.push(this.addBackButton);\r\n\r\n\t\t// Remove's index text field\r\n\t\tthis.removeField = addControlToAlgorithmBar('Text', '');\r\n\t\tthis.removeField.onkeydown = this.returnSubmit(\r\n\t\t\tthis.removeField,\r\n\t\t\tthis.removeIndexCallback.bind(this),\r\n\t\t\t4,\r\n\t\t\ttrue\r\n\t\t);\r\n\t\tthis.controls.push(this.removeField);\r\n\r\n\t\t// Remove from index button\r\n\t\tthis.removeIndexButton = addControlToAlgorithmBar('Button', 'Remove from Index');\r\n\t\tthis.removeIndexButton.onclick = this.removeIndexCallback.bind(this);\r\n\t\tthis.controls.push(this.removeIndexButton);\r\n\r\n\t\taddLabelToAlgorithmBar('or');\r\n\r\n\t\t// Remove from front button\r\n\t\tthis.removeFrontButton = addControlToAlgorithmBar('Button', 'Remove from Front');\r\n\t\tthis.removeFrontButton.onclick = this.removeFrontCallback.bind(this);\r\n\t\tthis.controls.push(this.removeFrontButton);\r\n\r\n\t\t// Remove from back button\r\n\t\tthis.removeBackButton = addControlToAlgorithmBar('Button', 'Remove from Back');\r\n\t\tthis.removeBackButton.onclick = this.removeBackCallback.bind(this);\r\n\t\tthis.controls.push(this.removeBackButton);\r\n\r\n\t\t// Get's index text field\r\n\t\t// this.getField = addControlToAlgorithmBar(\"Text\", \"\");\r\n\t\t// this.getField.onkeydown = this.returnSubmit(this.getField, this.getCallback.bind(this), 4, true);\r\n\t\t// this.controls.push(this.getField);\r\n\r\n\t\t// Get button\r\n\t\t// this.getButton = addControlToAlgorithmBar(\"Button\", \"Get\");\r\n\t\t// this.getButton.onclick = this.getCallback.bind(this);\r\n\t\t// this.controls.push(this.getButton);\r\n\r\n\t\t// Clear button\r\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear');\r\n\t\tthis.clearButton.onclick = this.clearCallback.bind(this);\r\n\t\tthis.controls.push(this.clearButton);\r\n\t}\r\n\r\n\tenableUI() {\r\n\t\tfor (let i = 0; i < this.controls.length; i++) {\r\n\t\t\tthis.controls[i].disabled = false;\r\n\t\t}\r\n\t}\r\n\r\n\tdisableUI() {\r\n\t\tfor (let i = 0; i < this.controls.length; i++) {\r\n\t\t\tthis.controls[i].disabled = true;\r\n\t\t}\r\n\t}\r\n\r\n\tsetup() {\r\n\t\tthis.linkedListElemID = new Array(SIZE);\r\n\r\n\t\tthis.arrayData = new Array(SIZE);\r\n\t\tthis.size = 0;\r\n\t\tthis.leftoverLabelID = this.nextIndex++;\r\n\r\n\t\tthis.cmd('CreateLabel', this.leftoverLabelID, '', PUSH_LABEL_X, PUSH_LABEL_Y);\r\n\r\n\t\tthis.animationManager.StartNewAnimation(this.commands);\r\n\t\tthis.animationManager.skipForward();\r\n\t\tthis.animationManager.clearHistory();\r\n\t}\r\n\r\n\treset() {\r\n\t\tthis.size = 0;\r\n\t\tthis.nextIndex = this.initialIndex;\r\n\t}\r\n\r\n\taddIndexCallback() {\r\n\t\tif (\r\n\t\t\tthis.addValueField.value !== '' &&\r\n\t\t\tthis.addIndexField.value !== '' &&\r\n\t\t\tthis.size < SIZE\r\n\t\t) {\r\n\t\t\tconst addVal = this.addValueField.value;\r\n\t\t\tconst index = this.addIndexField.value;\r\n\t\t\tif (index >= 0 && index <= this.size) {\r\n\t\t\t\tthis.addValueField.value = '';\r\n\t\t\t\tthis.addIndexField.value = '';\r\n\t\t\t\tthis.implementAction(this.add.bind(this), addVal + ',' + index);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\taddFrontCallback() {\r\n\t\tif (this.addValueField.value !== '' && this.size < SIZE) {\r\n\t\t\tconst addVal = this.addValueField.value;\r\n\t\t\tthis.addValueField.value = '';\r\n\t\t\tthis.implementAction(this.add.bind(this), addVal + ',' + 0);\r\n\t\t}\r\n\t}\r\n\r\n\taddBackCallback() {\r\n\t\tif (this.addValueField.value !== '' && this.size < SIZE) {\r\n\t\t\tconst addVal = this.addValueField.value;\r\n\t\t\tthis.addValueField.value = '';\r\n\t\t\tthis.implementAction(this.add.bind(this), addVal + ',' + this.size);\r\n\t\t}\r\n\t}\r\n\r\n\tremoveIndexCallback() {\r\n\t\tif (this.removeField.value !== '') {\r\n\t\t\tconst index = this.removeField.value;\r\n\t\t\tif (index >= 0 && index < this.size) {\r\n\t\t\t\tthis.removeField.value = '';\r\n\t\t\t\tthis.implementAction(this.remove.bind(this), index);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tremoveFrontCallback() {\r\n\t\tif (this.size > 0) {\r\n\t\t\tthis.implementAction(this.remove.bind(this), 0);\r\n\t\t}\r\n\t}\r\n\r\n\tremoveBackCallback() {\r\n\t\tif (this.size > 0) {\r\n\t\t\tthis.implementAction(this.remove.bind(this), this.size - 1);\r\n\t\t}\r\n\t}\r\n\r\n\t// CircularlySinglyLinkedList.prototype.getCallback = function()\r\n\t// {\r\n\t//     if (this.getField.value != \"\" && this.getField.value > 0 && this.getField.value < this.size)\r\n\t//     {\r\n\t//         this.implementAction(this.get.bind(this), \"\");\r\n\t//     }\r\n\t// }\r\n\r\n\tclearCallback() {\r\n\t\tthis.implementAction(this.clearAll.bind(this), '');\r\n\t}\r\n\r\n\tadd(params) {\r\n\t\tthis.commands = [];\r\n\r\n\t\tconst elemToAdd = parseInt(params.split(',')[0]);\r\n\t\tconst index = parseInt(params.split(',')[1]);\r\n\t\tconst labPushID = this.nextIndex++;\r\n\t\tconst labPushValID = this.nextIndex++;\r\n\r\n\t\t// Order of data should behave as normal\r\n\t\tfor (let i = this.size - 1; i >= index; i--) {\r\n\t\t\tthis.arrayData[i + 1] = this.arrayData[i];\r\n\t\t}\r\n\t\tthis.arrayData[index] = elemToAdd;\r\n\r\n\t\t// Adding to the front or back using O(1) trick, so new node will be added to index 1\r\n\t\tif (this.size !== 0 && (index === 0 || index === this.size)) {\r\n\t\t\t// Move over all node IDs but the first\r\n\t\t\tfor (let i = this.size - 1; i >= 1; i--) {\r\n\t\t\t\tthis.linkedListElemID[i + 1] = this.linkedListElemID[i];\r\n\t\t\t}\r\n\t\t\t// Place new node's ID at index 1\r\n\t\t\tthis.linkedListElemID[1] = this.nextIndex++;\r\n\t\t}\r\n\t\t// Adding first node or to the middle, so new node will be placed normally\r\n\t\telse {\r\n\t\t\tfor (let i = this.size - 1; i >= index; i--) {\r\n\t\t\t\tthis.linkedListElemID[i + 1] = this.linkedListElemID[i];\r\n\t\t\t}\r\n\t\t\tthis.linkedListElemID[index] = this.nextIndex++;\r\n\t\t}\r\n\r\n\t\tthis.cmd('SetText', this.leftoverLabelID, '');\r\n\r\n\t\tif (this.size !== 0 && (index === 0 || index === this.size)) {\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'CreateCircularlyLinkedList',\r\n\t\t\t\tthis.linkedListElemID[1],\r\n\t\t\t\t'',\r\n\t\t\t\tLINKED_LIST_ELEM_WIDTH,\r\n\t\t\t\tLINKED_LIST_ELEM_HEIGHT,\r\n\t\t\t\tLINKED_LIST_INSERT_X,\r\n\t\t\t\tLINKED_LIST_INSERT_Y,\r\n\t\t\t\t0.25,\r\n\t\t\t\t1\r\n\t\t\t);\r\n\t\t} else {\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'CreateCircularlyLinkedList',\r\n\t\t\t\tthis.linkedListElemID[index],\r\n\t\t\t\t'',\r\n\t\t\t\tLINKED_LIST_ELEM_WIDTH,\r\n\t\t\t\tLINKED_LIST_ELEM_HEIGHT,\r\n\t\t\t\tLINKED_LIST_INSERT_X,\r\n\t\t\t\tLINKED_LIST_INSERT_Y,\r\n\t\t\t\t0.25,\r\n\t\t\t\t1\r\n\t\t\t);\r\n\t\t}\r\n\t\tthis.cmd('CreateLabel', labPushID, 'Adding Value: ', PUSH_LABEL_X, PUSH_LABEL_Y);\r\n\t\tthis.cmd('CreateLabel', labPushValID, elemToAdd, PUSH_ELEMENT_X, PUSH_ELEMENT_Y);\r\n\t\tthis.cmd('Step');\r\n\r\n\t\tif (this.size === 0) {\r\n\t\t\tthis.cmd('Move', labPushValID, LINKED_LIST_INSERT_X, LINKED_LIST_INSERT_Y);\r\n\t\t\tthis.cmd('Step');\r\n\r\n\t\t\tthis.cmd('SetText', this.linkedListElemID[0], elemToAdd);\r\n\t\t\tthis.cmd('Delete', labPushValID);\r\n\t\t\tthis.cmd('ConnectCurve', this.linkedListElemID[0], this.linkedListElemID[0], -0.5);\r\n\t\t\tthis.cmd('Step');\r\n\r\n\t\t\tthis.size = this.size + 1;\r\n\t\t\tthis.resetNodePositions();\r\n\t\t} else {\r\n\t\t\tif (index === 0 || index === this.size) {\r\n\t\t\t\t// Move label from first node to new node\r\n\t\t\t\tconst labCopiedValID = this.nextIndex++;\r\n\t\t\t\tconst copiedData = index === 0 ? this.arrayData[1] : this.arrayData[0];\r\n\t\t\t\tthis.cmd(\r\n\t\t\t\t\t'CreateLabel',\r\n\t\t\t\t\tlabCopiedValID,\r\n\t\t\t\t\tcopiedData,\r\n\t\t\t\t\tLINKED_LIST_START_X,\r\n\t\t\t\t\tLINKED_LIST_START_Y\r\n\t\t\t\t);\r\n\t\t\t\tthis.cmd('Move', labCopiedValID, LINKED_LIST_INSERT_X, LINKED_LIST_INSERT_Y);\r\n\t\t\t\tthis.cmd('Step');\r\n\r\n\t\t\t\tthis.cmd('SetText', this.linkedListElemID[1], copiedData);\r\n\t\t\t\tthis.cmd('Delete', labCopiedValID);\r\n\t\t\t\tthis.cmd('Step');\r\n\r\n\t\t\t\t// Move label for new data to the first node\r\n\t\t\t\tthis.cmd('Move', labPushValID, LINKED_LIST_START_X, LINKED_LIST_START_Y);\r\n\t\t\t\tthis.cmd('Step');\r\n\r\n\t\t\t\tthis.cmd('SetText', this.linkedListElemID[0], elemToAdd);\r\n\t\t\t\tthis.cmd('Delete', labPushValID);\r\n\t\t\t\tthis.cmd('Step');\r\n\r\n\t\t\t\t// Change pointers\r\n\t\t\t\tif (this.size === 1) {\r\n\t\t\t\t\t// Case where we're adding the second node\r\n\t\t\t\t\tthis.cmd('Disconnect', this.linkedListElemID[0], this.linkedListElemID[0]); // Disconnect head node from itself\r\n\t\t\t\t\tthis.cmd('Connect', this.linkedListElemID[0], this.linkedListElemID[1]); // Connect head node to new node\r\n\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t'ConnectCurve',\r\n\t\t\t\t\t\tthis.linkedListElemID[1],\r\n\t\t\t\t\t\tthis.linkedListElemID[0],\r\n\t\t\t\t\t\t-0.5\r\n\t\t\t\t\t); // Connect new node to head node\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// Other cases\r\n\t\t\t\t\tthis.cmd('Disconnect', this.linkedListElemID[0], this.linkedListElemID[2]); // Disconnect head from old second node\r\n\t\t\t\t\tthis.cmd('Connect', this.linkedListElemID[0], this.linkedListElemID[1]); // Connect head node to new node\r\n\t\t\t\t\tthis.cmd('Connect', this.linkedListElemID[1], this.linkedListElemID[2]); // Connect new node to old second node\r\n\t\t\t\t}\r\n\t\t\t\tthis.cmd('Step');\r\n\r\n\t\t\t\tthis.size = this.size + 1;\r\n\t\t\t\tthis.resetNodePositions();\r\n\t\t\t\tthis.cmd('Step');\r\n\r\n\t\t\t\t// If adding to the back, \"move head over\" (rotate elements backwards)\r\n\t\t\t\tif (index === this.size - 1) {\r\n\t\t\t\t\t// We increment size above, so subtract one to check if adding to back\r\n\t\t\t\t\tlet i;\r\n\t\t\t\t\tconst firstNodeID = this.linkedListElemID[0];\r\n\t\t\t\t\tfor (i = 0; i < this.size - 1; i++) {\r\n\t\t\t\t\t\tthis.linkedListElemID[i] = this.linkedListElemID[i + 1];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.linkedListElemID[this.size - 1] = firstNodeID;\r\n\r\n\t\t\t\t\tconst lastX =\r\n\t\t\t\t\t\t((this.size - 1) % LINKED_LIST_ELEMS_PER_LINE) * LINKED_LIST_ELEM_SPACING +\r\n\t\t\t\t\t\tLINKED_LIST_START_X;\r\n\t\t\t\t\tconst lastY =\r\n\t\t\t\t\t\tMath.floor((this.size - 1) / LINKED_LIST_ELEMS_PER_LINE) *\r\n\t\t\t\t\t\t\tLINKED_LIST_LINE_SPACING +\r\n\t\t\t\t\t\tLINKED_LIST_START_Y;\r\n\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t'Move',\r\n\t\t\t\t\t\tthis.linkedListElemID[i],\r\n\t\t\t\t\t\t(LINKED_LIST_START_X + lastX) / 2,\r\n\t\t\t\t\t\tlastY + LINKED_LIST_ELEM_HEIGHT * 3\r\n\t\t\t\t\t);\r\n\t\t\t\t\tthis.cmd('Step');\r\n\r\n\t\t\t\t\tfor (let i = 0; i < this.size - 1; i++) {\r\n\t\t\t\t\t\tconst nextX =\r\n\t\t\t\t\t\t\t(i % LINKED_LIST_ELEMS_PER_LINE) * LINKED_LIST_ELEM_SPACING +\r\n\t\t\t\t\t\t\tLINKED_LIST_START_X;\r\n\t\t\t\t\t\tconst nextY =\r\n\t\t\t\t\t\t\tMath.floor(i / LINKED_LIST_ELEMS_PER_LINE) * LINKED_LIST_LINE_SPACING +\r\n\t\t\t\t\t\t\tLINKED_LIST_START_Y;\r\n\t\t\t\t\t\tthis.cmd('Move', this.linkedListElemID[i], nextX, nextY);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t'Disconnect',\r\n\t\t\t\t\t\tthis.linkedListElemID[this.size - 2],\r\n\t\t\t\t\t\tthis.linkedListElemID[this.size - 1]\r\n\t\t\t\t\t); // Disconnect curved pointer\r\n\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t'Connect',\r\n\t\t\t\t\t\tthis.linkedListElemID[this.size - 2],\r\n\t\t\t\t\t\tthis.linkedListElemID[this.size - 1]\r\n\t\t\t\t\t); // Connect with normal pointer\r\n\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t'Disconnect',\r\n\t\t\t\t\t\tthis.linkedListElemID[this.size - 1],\r\n\t\t\t\t\t\tthis.linkedListElemID[0]\r\n\t\t\t\t\t); // Disconnect normal pointer\r\n\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t'ConnectCurve',\r\n\t\t\t\t\t\tthis.linkedListElemID[this.size - 1],\r\n\t\t\t\t\t\tthis.linkedListElemID[0],\r\n\t\t\t\t\t\t-0.5\r\n\t\t\t\t\t); // Connect with curved pointer\r\n\t\t\t\t\tthis.cmd('Move', this.linkedListElemID[i], lastX, lastY);\r\n\t\t\t\t\tthis.cmd('Step');\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tthis.cmd('Move', labPushValID, LINKED_LIST_INSERT_X, LINKED_LIST_INSERT_Y);\r\n\t\t\t\tthis.cmd('Step');\r\n\r\n\t\t\t\tthis.cmd('SetText', this.linkedListElemID[index], elemToAdd);\r\n\t\t\t\tthis.cmd('Delete', labPushValID);\r\n\t\t\t\tthis.cmd('Step');\r\n\r\n\t\t\t\tthis.cmd(\r\n\t\t\t\t\t'Disconnect',\r\n\t\t\t\t\tthis.linkedListElemID[index - 1],\r\n\t\t\t\t\tthis.linkedListElemID[index + 1]\r\n\t\t\t\t);\r\n\t\t\t\tthis.cmd('Connect', this.linkedListElemID[index - 1], this.linkedListElemID[index]);\r\n\t\t\t\tthis.cmd('Connect', this.linkedListElemID[index], this.linkedListElemID[index + 1]);\r\n\r\n\t\t\t\tthis.size = this.size + 1;\r\n\t\t\t\tthis.resetNodePositions();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis.cmd('Delete', labPushID);\r\n\t\tthis.cmd('Step');\r\n\r\n\t\treturn this.commands;\r\n\t}\r\n\r\n\tremove(index) {\r\n\t\tthis.commands = [];\r\n\r\n\t\tindex = parseInt(index);\r\n\t\tconst labPopID = this.nextIndex++;\r\n\t\tconst labPopValID = this.nextIndex++;\r\n\r\n\t\tthis.cmd('SetText', this.leftoverLabelID, '');\r\n\r\n\t\tconst nodePosX = LINKED_LIST_START_X + LINKED_LIST_ELEM_SPACING * index;\r\n\t\tconst nodePosY = LINKED_LIST_START_Y;\r\n\t\tthis.cmd('CreateLabel', labPopID, 'Removing Value: ', PUSH_LABEL_X, PUSH_LABEL_Y);\r\n\t\tthis.cmd('CreateLabel', labPopValID, this.arrayData[index], nodePosX, nodePosY);\r\n\t\tthis.cmd('Move', labPopValID, PUSH_ELEMENT_X, PUSH_ELEMENT_Y);\r\n\t\tthis.cmd('Step');\r\n\r\n\t\tif (this.size !== 1) {\r\n\t\t\tif (index === 0) {\r\n\t\t\t\t// O(1) remove from front trick\r\n\t\t\t\tconst labCopiedValID = this.nextIndex++;\r\n\t\t\t\tconst secondNodeX = LINKED_LIST_START_X + LINKED_LIST_ELEM_SPACING;\r\n\t\t\t\tconst secondNodeY = LINKED_LIST_START_Y;\r\n\t\t\t\tthis.cmd(\r\n\t\t\t\t\t'CreateLabel',\r\n\t\t\t\t\tlabCopiedValID,\r\n\t\t\t\t\tthis.arrayData[1],\r\n\t\t\t\t\tsecondNodeX,\r\n\t\t\t\t\tsecondNodeY\r\n\t\t\t\t);\r\n\t\t\t\tthis.cmd('Move', labCopiedValID, LINKED_LIST_START_X, LINKED_LIST_START_Y);\r\n\t\t\t\tthis.cmd('Step');\r\n\r\n\t\t\t\tthis.cmd('SetText', this.linkedListElemID[0], this.arrayData[1]);\r\n\t\t\t\tthis.cmd('Delete', labCopiedValID);\r\n\t\t\t\tthis.cmd('Step');\r\n\r\n\t\t\t\tthis.cmd(\r\n\t\t\t\t\t'Move',\r\n\t\t\t\t\tthis.linkedListElemID[1],\r\n\t\t\t\t\tsecondNodeX,\r\n\t\t\t\t\tsecondNodeY - LINKED_LIST_ELEM_HEIGHT * 2\r\n\t\t\t\t);\r\n\t\t\t\tthis.cmd('Step');\r\n\r\n\t\t\t\tthis.cmd('Disconnect', this.linkedListElemID[0], this.linkedListElemID[1]);\r\n\t\t\t\tif (this.size === 2) {\r\n\t\t\t\t\t// Only one node will remain, connect it to itself\r\n\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t'ConnectCurve',\r\n\t\t\t\t\t\tthis.linkedListElemID[0],\r\n\t\t\t\t\t\tthis.linkedListElemID[0],\r\n\t\t\t\t\t\t-0.5\r\n\t\t\t\t\t);\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// Normal remove\r\n\t\t\t\t\tthis.cmd('Connect', this.linkedListElemID[0], this.linkedListElemID[2]);\r\n\t\t\t\t}\r\n\t\t\t} else if (index === this.size - 1) {\r\n\t\t\t\tthis.cmd(\r\n\t\t\t\t\t'Disconnect',\r\n\t\t\t\t\tthis.linkedListElemID[index - 1],\r\n\t\t\t\t\tthis.linkedListElemID[index]\r\n\t\t\t\t);\r\n\t\t\t\tif (this.size === 2) {\r\n\t\t\t\t\t// Only one node will remain, connect it to itself\r\n\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t'ConnectCurve',\r\n\t\t\t\t\t\tthis.linkedListElemID[0],\r\n\t\t\t\t\t\tthis.linkedListElemID[0],\r\n\t\t\t\t\t\t-0.5\r\n\t\t\t\t\t);\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// Normal remove\r\n\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t'ConnectCurve',\r\n\t\t\t\t\t\tthis.linkedListElemID[index - 1],\r\n\t\t\t\t\t\tthis.linkedListElemID[0],\r\n\t\t\t\t\t\t-0.5\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tconst xPos =\r\n\t\t\t\t\t(index % LINKED_LIST_ELEMS_PER_LINE) * LINKED_LIST_ELEM_SPACING +\r\n\t\t\t\t\tLINKED_LIST_START_X;\r\n\t\t\t\tconst yPos = LINKED_LIST_START_Y - LINKED_LIST_ELEM_HEIGHT * 2;\r\n\t\t\t\tthis.cmd('Move', this.linkedListElemID[index], xPos, yPos);\r\n\t\t\t\tthis.cmd('Step');\r\n\r\n\t\t\t\tthis.cmd(\r\n\t\t\t\t\t'Disconnect',\r\n\t\t\t\t\tthis.linkedListElemID[index - 1],\r\n\t\t\t\t\tthis.linkedListElemID[index]\r\n\t\t\t\t);\r\n\t\t\t\tthis.cmd(\r\n\t\t\t\t\t'Connect',\r\n\t\t\t\t\tthis.linkedListElemID[index - 1],\r\n\t\t\t\t\tthis.linkedListElemID[index + 1]\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t\tthis.cmd('Step');\r\n\r\n\t\t\tconst removedNodeIndex = index === 0 ? 1 : index; // If deleting from front, we need to remove the second node\r\n\t\t\tthis.cmd('Delete', this.linkedListElemID[removedNodeIndex]);\r\n\t\t\tfor (let i = removedNodeIndex; i < this.size; i++) {\r\n\t\t\t\tthis.linkedListElemID[i] = this.linkedListElemID[i + 1];\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tthis.cmd('Delete', this.linkedListElemID[0]);\r\n\t\t}\r\n\r\n\t\tfor (let i = index; i < this.size; i++) {\r\n\t\t\tthis.arrayData[i] = this.arrayData[i + 1];\r\n\t\t}\r\n\t\tthis.size = this.size - 1;\r\n\t\tthis.resetNodePositions();\r\n\r\n\t\tthis.cmd('Delete', labPopValID);\r\n\t\tthis.cmd('Delete', labPopID);\r\n\t\tthis.cmd('Step');\r\n\r\n\t\treturn this.commands;\r\n\t}\r\n\r\n\tresetNodePositions() {\r\n\t\tfor (let i = 0; i < this.size; i++) {\r\n\t\t\tconst nextX =\r\n\t\t\t\t(i % LINKED_LIST_ELEMS_PER_LINE) * LINKED_LIST_ELEM_SPACING + LINKED_LIST_START_X;\r\n\t\t\tconst nextY =\r\n\t\t\t\tMath.floor(i / LINKED_LIST_ELEMS_PER_LINE) * LINKED_LIST_LINE_SPACING +\r\n\t\t\t\tLINKED_LIST_START_Y;\r\n\t\t\tthis.cmd('Move', this.linkedListElemID[i], nextX, nextY);\r\n\t\t}\r\n\t}\r\n\r\n\tclearAll() {\r\n\t\tthis.commands = [];\r\n\t\tfor (let i = 0; i < this.size; i++) {\r\n\t\t\tthis.cmd('Delete', this.linkedListElemID[i]);\r\n\t\t}\r\n\t\tthis.size = 0;\r\n\t\treturn this.commands;\r\n\t}\r\n}\r\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\r\n//\r\n// Redistribution and use in source and binary forms, with or without modification, are\r\n// permitted provided that the following conditions are met:\r\n//\r\n// 1. Redistributions of source code must retain the above copyright notice, this list of\r\n// conditions and the following disclaimer.\r\n//\r\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\r\n// of conditions and the following disclaimer in the documentation and/or other materials\r\n// provided with the distribution.\r\n//\r\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\r\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\r\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\r\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\r\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\r\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\r\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\r\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\r\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\r\n//\r\n// The views and conclusions contained in the software and documentation are those of the\r\n// authors and should not be interpreted as representing official policies, either expressed\r\n// or implied, of the University of San Francisco\r\n\r\nimport Algorithm, { addControlToAlgorithmBar, addLabelToAlgorithmBar } from './Algorithm.js';\r\n\r\nconst SKIP_LIST_START_X = 100;\r\nconst SKIP_LIST_START_Y = 400;\r\nconst SKIP_LIST_ELEM_SIZE = 40;\r\n\r\nconst SKIP_LIST_SPACING = 80;\r\n\r\n// const TOP_POS_X = 180;\r\n// const TOP_POS_Y = 100;\r\n// const TOP_LABEL_X = 130;\r\n// const TOP_LABEL_Y = 100;\r\n\r\n// const TOP_ELEM_WIDTH = 30;\r\n// const TOP_ELEM_HEIGHT = 30;\r\n\r\nconst VALUE_LABEL_X = 50;\r\nconst VALUE_LABEL_Y = 23;\r\nconst VALUE_STRING_X = 120;\r\nconst VALUE_STRING_Y = 23;\r\n\r\nconst CF_LABEL_X = 50;\r\nconst CF_LABEL_Y = 37;\r\nconst CF_STRING_X = 120;\r\nconst CF_STRING_Y = 37;\r\n\r\nconst NINF = '\\u2212\\u221E'; // Negative infinity\r\nconst PINF = '\\u221E'; // Positive infinity\r\n\r\nexport default class SkipList extends Algorithm {\r\n\tconstructor(am, w, h) {\r\n\t\tsuper(am, w, h);\r\n\r\n\t\tthis.addControls();\r\n\r\n\t\t// Useful for memory management\r\n\t\tthis.nextIndex = 0;\r\n\r\n\t\tthis.setup();\r\n\t}\r\n\r\n\taddControls() {\r\n\t\tthis.controls = [];\r\n\r\n\t\taddLabelToAlgorithmBar('Add');\r\n\r\n\t\t// Add's value text field\r\n\t\tthis.addValueField = addControlToAlgorithmBar('Text', '');\r\n\t\tthis.addValueField.onkeydown = this.returnSubmit(\r\n\t\t\tthis.addValueField,\r\n\t\t\tthis.addRandomlyCallback.bind(this),\r\n\t\t\t4,\r\n\t\t\ttrue\r\n\t\t);\r\n\t\tthis.controls.push(this.addValueField);\r\n\r\n\t\taddLabelToAlgorithmBar('with');\r\n\r\n\t\t// Heads' text field\r\n\t\tthis.headsField = addControlToAlgorithmBar('Text', '');\r\n\t\tthis.headsField.onkeydown = this.returnSubmit(\r\n\t\t\tthis.headsField,\r\n\t\t\tthis.addWithHeadsCallback.bind(this),\r\n\t\t\t4,\r\n\t\t\ttrue\r\n\t\t);\r\n\t\tthis.controls.push(this.headsField);\r\n\r\n\t\taddLabelToAlgorithmBar('heads');\r\n\r\n\t\t// Add with heads button\r\n\t\tthis.addWithHeadsButton = addControlToAlgorithmBar('Button', 'Add with heads');\r\n\t\tthis.addWithHeadsButton.onclick = this.addWithHeadsCallback.bind(this);\r\n\t\tthis.controls.push(this.addWithHeadsButton);\r\n\r\n\t\taddLabelToAlgorithmBar('or');\r\n\r\n\t\t// Add randomly button\r\n\t\tthis.addRandomlyButton = addControlToAlgorithmBar('Button', 'Add randomly');\r\n\t\tthis.addRandomlyButton.onclick = this.addRandomlyCallback.bind(this);\r\n\t\tthis.controls.push(this.addRandomlyButton);\r\n\r\n\t\t// Remove's text field\r\n\t\tthis.removeField = addControlToAlgorithmBar('Text', '');\r\n\t\tthis.removeField.onkeydown = this.returnSubmit(\r\n\t\t\tthis.removeField,\r\n\t\t\tthis.removeCallback.bind(this),\r\n\t\t\t4,\r\n\t\t\ttrue\r\n\t\t);\r\n\t\tthis.controls.push(this.removeField);\r\n\r\n\t\t// Remove button\r\n\t\tthis.removeButton = addControlToAlgorithmBar('Button', 'Remove');\r\n\t\tthis.removeButton.onclick = this.removeCallback.bind(this);\r\n\t\tthis.controls.push(this.removeButton);\r\n\r\n\t\t// Get's index text field\r\n\t\tthis.getField = addControlToAlgorithmBar('Text', '');\r\n\t\tthis.getField.onkeydown = this.returnSubmit(\r\n\t\t\tthis.getField,\r\n\t\t\tthis.getCallback.bind(this),\r\n\t\t\t4,\r\n\t\t\ttrue\r\n\t\t);\r\n\t\tthis.controls.push(this.getField);\r\n\r\n\t\t// Get button\r\n\t\tthis.getButton = addControlToAlgorithmBar('Button', 'Get');\r\n\t\tthis.getButton.onclick = this.getCallback.bind(this);\r\n\t\tthis.controls.push(this.getButton);\r\n\r\n\t\t// Clear button\r\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear');\r\n\t\tthis.clearButton.onclick = this.clearCallback.bind(this);\r\n\t\tthis.controls.push(this.clearButton);\r\n\t}\r\n\r\n\tenableUI() {\r\n\t\tfor (let i = 0; i < this.controls.length; i++) {\r\n\t\t\tthis.controls[i].disabled = false;\r\n\t\t}\r\n\t}\r\n\r\n\tdisableUI() {\r\n\t\tfor (let i = 0; i < this.controls.length; i++) {\r\n\t\t\tthis.controls[i].disabled = true;\r\n\t\t}\r\n\t}\r\n\r\n\tsetup() {\r\n\t\tthis.commands = [];\r\n\r\n\t\tthis.nodeID = [[this.nextIndex++], [this.nextIndex++]];\r\n\t\tthis.data = [[Number.NEGATIVE_INFINITY], [Number.POSITIVE_INFINITY]];\r\n\t\tthis.size = 0;\r\n\r\n\t\tthis.cmd(\r\n\t\t\t'CreateSkipList',\r\n\t\t\tthis.nodeID[0][0],\r\n\t\t\tNINF,\r\n\t\t\tSKIP_LIST_ELEM_SIZE,\r\n\t\t\tSKIP_LIST_ELEM_SIZE,\r\n\t\t\tSKIP_LIST_START_X,\r\n\t\t\tSKIP_LIST_START_Y\r\n\t\t);\r\n\t\tthis.cmd(\r\n\t\t\t'CreateSkipList',\r\n\t\t\tthis.nodeID[1][0],\r\n\t\t\tPINF,\r\n\t\t\tSKIP_LIST_ELEM_SIZE,\r\n\t\t\tSKIP_LIST_ELEM_SIZE,\r\n\t\t\tSKIP_LIST_START_X + SKIP_LIST_SPACING,\r\n\t\t\tSKIP_LIST_START_Y\r\n\t\t);\r\n\t\tthis.cmd('ConnectSkipList', this.nodeID[0][0], this.nodeID[1][0], 3);\r\n\r\n\t\tthis.animationManager.StartNewAnimation(this.commands);\r\n\t\tthis.animationManager.skipForward();\r\n\t\tthis.animationManager.clearHistory();\r\n\t}\r\n\r\n\treset() {\r\n\t\tthis.nextIndex = 0;\r\n\t\tthis.nodeID = [[this.nextIndex++], [this.nextIndex++]];\r\n\t\tthis.data = [[Number.NEGATIVE_INFINITY], [Number.POSITIVE_INFINITY]];\r\n\t\tthis.size = 0;\r\n\t}\r\n\r\n\taddRandomlyCallback() {\r\n\t\tif (this.addValueField.value !== '') {\r\n\t\t\tconst addVal = this.addValueField.value;\r\n\t\t\tthis.addValueField.value = '';\r\n\t\t\tthis.headsField.value = '';\r\n\t\t\tthis.implementAction(this.add.bind(this), addVal);\r\n\t\t}\r\n\t}\r\n\r\n\taddWithHeadsCallback() {\r\n\t\tif (this.addValueField.value !== '') {\r\n\t\t\tconst addVal = this.addValueField.value;\r\n\t\t\tthis.addValueField.value = '';\r\n\t\t\tconst heads = this.headsField.value;\r\n\t\t\tthis.headsField.value = '';\r\n\t\t\tthis.implementAction(this.add.bind(this), addVal + ',' + heads);\r\n\t\t}\r\n\t}\r\n\r\n\tremoveCallback() {\r\n\t\tif (this.removeField.value !== '') {\r\n\t\t\tconst value = this.removeField.value;\r\n\t\t\tthis.removeField.value = '';\r\n\t\t\tthis.implementAction(this.remove.bind(this), value);\r\n\t\t}\r\n\t}\r\n\r\n\tgetCallback() {\r\n\t\tif (this.getField.value !== '') {\r\n\t\t\tconst value = this.getField.value;\r\n\t\t\tthis.getField.value = '';\r\n\t\t\tthis.implementAction(this.get.bind(this), value);\r\n\t\t}\r\n\t}\r\n\r\n\tclearCallback() {\r\n\t\tthis.implementAction(this.clearAll.bind(this), '');\r\n\t}\r\n\r\n\tadd(params) {\r\n\t\tthis.commands = [];\r\n\r\n\t\tconst value = parseInt(params.split(',')[0]);\r\n\r\n\t\tlet heads;\r\n\t\tif (params.split(',').length === 2) {\r\n\t\t\theads = params.split(',')[1];\r\n\t\t} else {\r\n\t\t\theads = Math.floor(Math.random() * (this.size + 1));\r\n\t\t}\r\n\t\theads = Math.min(heads, 4);\r\n\r\n\t\tconst valueLabelId = this.nextIndex++;\r\n\t\tconst valueStringId = this.nextIndex++;\r\n\r\n\t\tconst cfLabelId = this.nextIndex++;\r\n\t\tconst cfStringId = this.nextIndex++;\r\n\r\n\t\tlet headsString = '';\r\n\t\tfor (let i = 0; i < heads; i++) {\r\n\t\t\theadsString += 'H';\r\n\t\t}\r\n\t\theadsString += 'T';\r\n\r\n\t\tthis.cmd('CreateLabel', valueLabelId, 'Value to add:', VALUE_LABEL_X, VALUE_LABEL_Y);\r\n\t\tthis.cmd('CreateLabel', valueStringId, value, VALUE_STRING_X, VALUE_STRING_Y);\r\n\t\tthis.cmd('CreateLabel', cfLabelId, 'Coin Flipper:', CF_LABEL_X, CF_LABEL_Y);\r\n\t\tthis.cmd('CreateLabel', cfStringId, headsString, CF_STRING_X, CF_STRING_Y);\r\n\t\tthis.cmd('Step');\r\n\r\n\t\t// Add levels\r\n\t\tfor (let row = this.nodeID[0].length; row <= heads; row++) {\r\n\t\t\tconst rightPhantomsCol = this.nodeID.length - 1;\r\n\t\t\tthis.data[0][row] = Number.NEGATIVE_INFINITY;\r\n\t\t\tthis.nodeID[0][row] = this.nextIndex++;\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'CreateSkipList',\r\n\t\t\t\tthis.nodeID[0][row],\r\n\t\t\t\tNINF,\r\n\t\t\t\tSKIP_LIST_ELEM_SIZE,\r\n\t\t\t\tSKIP_LIST_ELEM_SIZE,\r\n\t\t\t\tSKIP_LIST_START_X,\r\n\t\t\t\tSKIP_LIST_START_Y - SKIP_LIST_SPACING * row\r\n\t\t\t);\r\n\t\t\tthis.data[rightPhantomsCol][row] = Number.POSITIVE_INFINITY;\r\n\t\t\tthis.nodeID[rightPhantomsCol][row] = this.nextIndex++;\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'CreateSkipList',\r\n\t\t\t\tthis.nodeID[rightPhantomsCol][row],\r\n\t\t\t\tPINF,\r\n\t\t\t\tSKIP_LIST_ELEM_SIZE,\r\n\t\t\t\tSKIP_LIST_ELEM_SIZE,\r\n\t\t\t\tSKIP_LIST_START_X + SKIP_LIST_SPACING * rightPhantomsCol,\r\n\t\t\t\tSKIP_LIST_START_Y - SKIP_LIST_SPACING * row\r\n\t\t\t);\r\n\t\t\tthis.cmd('ConnectSkipList', this.nodeID[0][row], this.nodeID[rightPhantomsCol][row], 3);\r\n\t\t\tthis.cmd('ConnectSkipList', this.nodeID[0][row - 1], this.nodeID[0][row], 0);\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'ConnectSkipList',\r\n\t\t\t\tthis.nodeID[rightPhantomsCol][row - 1],\r\n\t\t\t\tthis.nodeID[rightPhantomsCol][row],\r\n\t\t\t\t0\r\n\t\t\t);\r\n\t\t\tthis.cmd('Step');\r\n\t\t}\r\n\r\n\t\t// Find column where new element will be inserted\r\n\t\tlet newCol = 1;\r\n\t\twhile (value > this.data[newCol][0]) {\r\n\t\t\tnewCol++;\r\n\t\t}\r\n\r\n\t\t// Move IDs and data in next columns to the right\r\n\t\tfor (let col = this.nodeID.length - 1; col >= newCol; col--) {\r\n\t\t\tthis.nodeID[col + 1] = this.nodeID[col];\r\n\t\t\tthis.data[col + 1] = this.data[col];\r\n\t\t}\r\n\t\tthis.nodeID[newCol] = [];\r\n\t\tthis.data[newCol] = [];\r\n\r\n\t\t// Traverse and add\r\n\t\tlet col = 0;\r\n\t\tlet row = this.nodeID[0].length - 1;\r\n\r\n\t\tconst highlightID = this.nextIndex++;\r\n\t\tthis.cmd(\r\n\t\t\t'CreateHighlightCircle',\r\n\t\t\thighlightID,\r\n\t\t\t'#FF0000',\r\n\t\t\tSKIP_LIST_START_X,\r\n\t\t\tSKIP_LIST_START_Y - SKIP_LIST_SPACING * row\r\n\t\t);\r\n\t\tthis.cmd('SetHighlight', highlightID, 1);\r\n\t\tthis.cmd('Step');\r\n\r\n\t\tlet foundDuplicate = false;\r\n\t\twhile (row >= 0) {\r\n\t\t\t// Move right until next element is greater or equal\r\n\t\t\tlet nextCol = this.getNextCol(col, row);\r\n\t\t\tif (value === this.data[nextCol][row]) {\r\n\t\t\t\tfoundDuplicate = true;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\twhile (value > this.data[nextCol][row]) {\r\n\t\t\t\tthis.cmd(\r\n\t\t\t\t\t'Move',\r\n\t\t\t\t\thighlightID,\r\n\t\t\t\t\tSKIP_LIST_START_X + SKIP_LIST_SPACING * nextCol,\r\n\t\t\t\t\tSKIP_LIST_START_Y - SKIP_LIST_SPACING * row\r\n\t\t\t\t);\r\n\t\t\t\tthis.cmd('Step');\r\n\t\t\t\tcol = nextCol;\r\n\t\t\t\tnextCol = this.getNextCol(col, row);\r\n\t\t\t}\r\n\r\n\t\t\t// Move highlight circle downward\r\n\t\t\trow--;\r\n\t\t\tif (row >= 0) {\r\n\t\t\t\tthis.cmd(\r\n\t\t\t\t\t'Move',\r\n\t\t\t\t\thighlightID,\r\n\t\t\t\t\tSKIP_LIST_START_X + SKIP_LIST_SPACING * col,\r\n\t\t\t\t\tSKIP_LIST_START_Y - SKIP_LIST_SPACING * row\r\n\t\t\t\t);\r\n\t\t\t\tthis.cmd('Step');\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// Add nodes bottom-up to the new column if no duplicate has been found\r\n\t\tif (!foundDuplicate) {\r\n\t\t\tthis.shiftColumns(newCol);\r\n\t\t\trow++;\r\n\t\t\t// Having a highlight circle in the previous ID causes an object to look weird (this\r\n\t\t\t// seems to be an already existing bug) Creating a random object before it is a workaround\r\n\t\t\tthis.cmd('CreateCircle', this.nextIndex++, '', -100, -100, 0);\r\n\r\n\t\t\twhile (row <= heads) {\r\n\t\t\t\tthis.data[newCol][row] = value;\r\n\t\t\t\tthis.nodeID[newCol][row] = this.nextIndex++;\r\n\t\t\t\tthis.cmd(\r\n\t\t\t\t\t'CreateSkipList',\r\n\t\t\t\t\tthis.nodeID[newCol][row],\r\n\t\t\t\t\tvalue,\r\n\t\t\t\t\tSKIP_LIST_ELEM_SIZE,\r\n\t\t\t\t\tSKIP_LIST_ELEM_SIZE,\r\n\t\t\t\t\tSKIP_LIST_START_X + SKIP_LIST_SPACING * newCol,\r\n\t\t\t\t\tSKIP_LIST_START_Y - SKIP_LIST_SPACING * row\r\n\t\t\t\t);\r\n\t\t\t\tconst prevCol = this.getPrevCol(newCol, row);\r\n\t\t\t\tconst nextCol = this.getNextCol(newCol, row);\r\n\t\t\t\tthis.cmd('Disconnect', this.nodeID[prevCol][row], this.nodeID[nextCol][row]);\r\n\t\t\t\tthis.cmd('ConnectSkipList', this.nodeID[prevCol][row], this.nodeID[newCol][row], 3);\r\n\t\t\t\tthis.cmd('ConnectSkipList', this.nodeID[newCol][row], this.nodeID[nextCol][row], 3);\r\n\t\t\t\tif (row !== 0) {\r\n\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t'ConnectSkipList',\r\n\t\t\t\t\t\tthis.nodeID[newCol][row - 1],\r\n\t\t\t\t\t\tthis.nodeID[newCol][row],\r\n\t\t\t\t\t\t0\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\t\t\t\tthis.cmd('Step');\r\n\r\n\t\t\t\tthis.cmd(\r\n\t\t\t\t\t'Move',\r\n\t\t\t\t\thighlightID,\r\n\t\t\t\t\tSKIP_LIST_START_X + SKIP_LIST_SPACING * newCol,\r\n\t\t\t\t\tSKIP_LIST_START_Y - SKIP_LIST_SPACING * row\r\n\t\t\t\t);\r\n\t\t\t\tthis.cmd('Step');\r\n\t\t\t\trow++;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis.cmd('Delete', valueLabelId);\r\n\t\tthis.cmd('Delete', valueStringId);\r\n\t\tthis.cmd('Delete', cfLabelId);\r\n\t\tthis.cmd('Delete', cfStringId);\r\n\t\tthis.cmd('Delete', highlightID);\r\n\r\n\t\tthis.size++;\r\n\r\n\t\treturn this.commands;\r\n\t}\r\n\r\n\tremove(params) {\r\n\t\tthis.commands = [];\r\n\r\n\t\tconst value = parseInt(params);\r\n\r\n\t\tconst valueLabelId = this.nextIndex++;\r\n\t\tconst valueStringId = this.nextIndex++;\r\n\r\n\t\tthis.cmd('CreateLabel', valueLabelId, 'Value to remove:', VALUE_LABEL_X, VALUE_LABEL_Y);\r\n\t\tthis.cmd('CreateLabel', valueStringId, value, VALUE_STRING_X, VALUE_STRING_Y);\r\n\t\tthis.cmd('Step');\r\n\r\n\t\t// Traverse and remove\r\n\t\tlet col = 0;\r\n\t\tlet row = this.nodeID[0].length - 1;\r\n\t\tlet removedCol = -1;\r\n\r\n\t\tconst highlightID = this.nextIndex++;\r\n\t\tthis.cmd(\r\n\t\t\t'CreateHighlightCircle',\r\n\t\t\thighlightID,\r\n\t\t\t'#FF0000',\r\n\t\t\tSKIP_LIST_START_X,\r\n\t\t\tSKIP_LIST_START_Y - SKIP_LIST_SPACING * row\r\n\t\t);\r\n\t\tthis.cmd('Step');\r\n\r\n\t\twhile (row >= 0) {\r\n\t\t\t// Move right until next element is greater or equal\r\n\t\t\tlet nextCol = this.getNextCol(col, row);\r\n\t\t\twhile (value > this.data[nextCol][row]) {\r\n\t\t\t\tthis.cmd(\r\n\t\t\t\t\t'Move',\r\n\t\t\t\t\thighlightID,\r\n\t\t\t\t\tSKIP_LIST_START_X + SKIP_LIST_SPACING * nextCol,\r\n\t\t\t\t\tSKIP_LIST_START_Y - SKIP_LIST_SPACING * row\r\n\t\t\t\t);\r\n\t\t\t\tthis.cmd('Step');\r\n\t\t\t\tcol = nextCol;\r\n\t\t\t\tnextCol = this.getNextCol(col, row);\r\n\t\t\t}\r\n\r\n\t\t\tif (value === this.data[nextCol][row]) {\r\n\t\t\t\tremovedCol = nextCol;\r\n\t\t\t\tcol = nextCol;\r\n\t\t\t\tthis.cmd(\r\n\t\t\t\t\t'Move',\r\n\t\t\t\t\thighlightID,\r\n\t\t\t\t\tSKIP_LIST_START_X + SKIP_LIST_SPACING * col,\r\n\t\t\t\t\tSKIP_LIST_START_Y - SKIP_LIST_SPACING * row\r\n\t\t\t\t);\r\n\t\t\t\tthis.cmd('Step');\r\n\r\n\t\t\t\twhile (row >= 0) {\r\n\t\t\t\t\tnextCol = this.getNextCol(col, row);\r\n\t\t\t\t\tconst prevCol = this.getPrevCol(col, row);\r\n\t\t\t\t\tthis.cmd('Disconnect', this.nodeID[prevCol][row], this.nodeID[col][row]);\r\n\t\t\t\t\tthis.cmd('Disconnect', this.nodeID[col][row], this.nodeID[nextCol][row]);\r\n\t\t\t\t\tif (this.nodeID[col][row + 1] != null) {\r\n\t\t\t\t\t\tthis.cmd('Disconnect', this.nodeID[col][row + 1], this.nodeID[col][row]);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t'ConnectSkipList',\r\n\t\t\t\t\t\tthis.nodeID[prevCol][row],\r\n\t\t\t\t\t\tthis.nodeID[nextCol][row],\r\n\t\t\t\t\t\t3\r\n\t\t\t\t\t);\r\n\t\t\t\t\tthis.cmd('Delete', this.nodeID[col][row]);\r\n\t\t\t\t\tthis.cmd('Step');\r\n\r\n\t\t\t\t\trow--;\r\n\t\t\t\t\tif (row !== -1) {\r\n\t\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t\t'Move',\r\n\t\t\t\t\t\t\thighlightID,\r\n\t\t\t\t\t\t\tSKIP_LIST_START_X + SKIP_LIST_SPACING * col,\r\n\t\t\t\t\t\t\tSKIP_LIST_START_Y - SKIP_LIST_SPACING * row\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t\tthis.cmd('Step');\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\trow--;\r\n\t\t\t\tif (row !== -1) {\r\n\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t'Move',\r\n\t\t\t\t\t\thighlightID,\r\n\t\t\t\t\t\tSKIP_LIST_START_X + SKIP_LIST_SPACING * col,\r\n\t\t\t\t\t\tSKIP_LIST_START_Y - SKIP_LIST_SPACING * row\r\n\t\t\t\t\t);\r\n\t\t\t\t\tthis.cmd('Step');\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis.cmd('Delete', valueLabelId);\r\n\t\tthis.cmd('Delete', valueStringId);\r\n\t\tthis.cmd('Delete', highlightID);\r\n\r\n\t\tif (removedCol !== -1) {\r\n\t\t\t// Shift ID and data columns to the left (already erases last column)\r\n\t\t\tfor (let col = removedCol; col < this.nodeID.length - 1; col++) {\r\n\t\t\t\tthis.nodeID[col] = this.nodeID[col + 1];\r\n\t\t\t\tthis.data[col] = this.data[col + 1];\r\n\t\t\t}\r\n\t\t\tthis.nodeID.pop();\r\n\t\t\tthis.data.pop();\r\n\r\n\t\t\tthis.shiftColumns(removedCol);\r\n\t\t}\r\n\r\n\t\t// Remove empty rows\r\n\t\t// Find tallest column of actual values (not phantoms)\r\n\t\tlet maxHeight = 1;\r\n\t\tfor (let col = 1; col < this.nodeID.length - 1; col++) {\r\n\t\t\tmaxHeight = Math.max(maxHeight, this.nodeID[col].length);\r\n\t\t}\r\n\t\t// Remove rows above tallest column (so empty rows)\r\n\t\tfor (let row = this.nodeID[0].length - 1; row >= maxHeight; row--) {\r\n\t\t\tthis.data[0].pop();\r\n\t\t\tconst leftPhantomID = this.nodeID[0].pop();\r\n\t\t\tthis.cmd('Delete', leftPhantomID);\r\n\t\t\tconst rightPhantomsCol = this.nodeID.length - 1;\r\n\t\t\tthis.data[rightPhantomsCol].pop();\r\n\t\t\tconst rightPhantomID = this.nodeID[rightPhantomsCol].pop();\r\n\t\t\tthis.cmd('Delete', rightPhantomID);\r\n\t\t}\r\n\t\tthis.cmd('Step');\r\n\r\n\t\tthis.size--;\r\n\r\n\t\treturn this.commands;\r\n\t}\r\n\r\n\tget(params) {\r\n\t\tthis.commands = [];\r\n\r\n\t\tconst value = parseInt(params);\r\n\r\n\t\tlet col = 0;\r\n\t\tlet row = this.nodeID[0].length - 1;\r\n\t\t// let nextCol = this.getNextCol(col, row);\r\n\r\n\t\tconst highlightID = this.nextIndex++;\r\n\t\tthis.cmd(\r\n\t\t\t'CreateHighlightCircle',\r\n\t\t\thighlightID,\r\n\t\t\t'#FF0000',\r\n\t\t\tSKIP_LIST_START_X,\r\n\t\t\tSKIP_LIST_START_Y - SKIP_LIST_SPACING * row\r\n\t\t);\r\n\t\tthis.cmd('SetHighlight', highlightID, 1);\r\n\t\tthis.cmd('Step');\r\n\r\n\t\twhile (row >= 0 && value !== this.data[col][row]) {\r\n\t\t\t// Move right until next element is greater or equal\r\n\t\t\tlet nextCol = this.getNextCol(col, row);\r\n\t\t\twhile (value >= this.data[nextCol][row]) {\r\n\t\t\t\tthis.cmd(\r\n\t\t\t\t\t'Move',\r\n\t\t\t\t\thighlightID,\r\n\t\t\t\t\tSKIP_LIST_START_X + SKIP_LIST_SPACING * nextCol,\r\n\t\t\t\t\tSKIP_LIST_START_Y - SKIP_LIST_SPACING * row\r\n\t\t\t\t);\r\n\t\t\t\tthis.cmd('Step');\r\n\t\t\t\tcol = nextCol;\r\n\t\t\t\tnextCol = this.getNextCol(col, row);\r\n\t\t\t}\r\n\r\n\t\t\t// Move highlight circle downward if data has not been found\r\n\t\t\tif (value !== this.data[col][row]) {\r\n\t\t\t\trow--;\r\n\t\t\t\tthis.cmd(\r\n\t\t\t\t\t'Move',\r\n\t\t\t\t\thighlightID,\r\n\t\t\t\t\tSKIP_LIST_START_X + SKIP_LIST_SPACING * col,\r\n\t\t\t\t\tSKIP_LIST_START_Y - SKIP_LIST_SPACING * row\r\n\t\t\t\t);\r\n\t\t\t\tthis.cmd('Step');\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis.cmd('Delete', highlightID);\r\n\r\n\t\treturn this.commands;\r\n\t}\r\n\r\n\t// Shifts columns on screen\r\n\tshiftColumns(col) {\r\n\t\tfor (; col < this.nodeID.length; col++) {\r\n\t\t\tfor (let row = 0; row < this.nodeID[col].length; row++) {\r\n\t\t\t\tif (this.nodeID[col][row] != null) {\r\n\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t'Move',\r\n\t\t\t\t\t\tthis.nodeID[col][row],\r\n\t\t\t\t\t\tSKIP_LIST_START_X + SKIP_LIST_SPACING * col,\r\n\t\t\t\t\t\tSKIP_LIST_START_Y - SKIP_LIST_SPACING * row\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.cmd('Step');\r\n\t}\r\n\r\n\t// Gets the column of the next node (\"right pointer\")\r\n\tgetNextCol(col, row) {\r\n\t\tcol++;\r\n\t\twhile (this.data[col][row] == null) {\r\n\t\t\tcol++;\r\n\t\t}\r\n\t\treturn col;\r\n\t}\r\n\r\n\t// Gets the column of the previous node (\"left pointer\")\r\n\tgetPrevCol(col, row) {\r\n\t\tcol--;\r\n\t\twhile (this.data[col][row] == null) {\r\n\t\t\tcol--;\r\n\t\t}\r\n\t\treturn col;\r\n\t}\r\n\r\n\tclearAll() {\r\n\t\tthis.commands = [];\r\n\r\n\t\tfor (let col = 0; col < this.nodeID.length; col++) {\r\n\t\t\tfor (let row = 0; row < this.nodeID[col].length; row++) {\r\n\t\t\t\tthis.cmd('Delete', this.nodeID[col][row]);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis.nodeID = [[this.nextIndex++], [this.nextIndex++]];\r\n\t\tthis.data = [[Number.NEGATIVE_INFINITY], [Number.POSITIVE_INFINITY]];\r\n\t\tthis.size = 0;\r\n\r\n\t\tthis.cmd(\r\n\t\t\t'CreateSkipList',\r\n\t\t\tthis.nodeID[0][0],\r\n\t\t\tNINF,\r\n\t\t\tSKIP_LIST_ELEM_SIZE,\r\n\t\t\tSKIP_LIST_ELEM_SIZE,\r\n\t\t\tSKIP_LIST_START_X,\r\n\t\t\tSKIP_LIST_START_Y\r\n\t\t);\r\n\t\tthis.cmd(\r\n\t\t\t'CreateSkipList',\r\n\t\t\tthis.nodeID[1][0],\r\n\t\t\tPINF,\r\n\t\t\tSKIP_LIST_ELEM_SIZE,\r\n\t\t\tSKIP_LIST_ELEM_SIZE,\r\n\t\t\tSKIP_LIST_START_X + SKIP_LIST_SPACING,\r\n\t\t\tSKIP_LIST_START_Y\r\n\t\t);\r\n\t\tthis.cmd('ConnectSkipList', this.nodeID[0][0], this.nodeID[1][0], 3);\r\n\t\tthis.cmd('Step');\r\n\r\n\t\treturn this.commands;\r\n\t}\r\n}\r\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\r\n//\r\n// Redistribution and use in source and binary forms, with or without modification, are\r\n// permitted provided that the following conditions are met:\r\n//\r\n// 1. Redistributions of source code must retain the above copyright notice, this list of\r\n// conditions and the following disclaimer.\r\n//\r\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\r\n// of conditions and the following disclaimer in the documentation and/or other materials\r\n// provided with the distribution.\r\n//\r\n// THIS SOFTWARE IS PROVIDED BY David Galles ``AS IS'' AND ANY EXPRESS OR IMPLIED\r\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\r\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\r\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\r\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\r\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\r\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\r\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\r\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\r\n//\r\n// The views and conclusions contained in the software and documentation are those of the\r\n// authors and should not be interpreted as representing official policies, either expressed\r\n// or implied, of the University of San Francisco\r\n\r\nimport Algorithm, { addControlToAlgorithmBar } from './Algorithm.js';\r\n\r\n// Constants.\r\n\r\nconst LINK_COLOR = '#007700';\r\nconst HIGHLIGHT_CIRCLE_COLOR = '#007700';\r\nconst FOREGROUND_COLOR = '#007700';\r\nconst BACKGROUND_COLOR = '#EEFFEE';\r\nconst PRINT_COLOR = FOREGROUND_COLOR;\r\n\r\nconst WIDTH_DELTA = 50;\r\nconst HEIGHT_DELTA = 50;\r\nconst STARTING_Y = 50;\r\n\r\nconst FIRST_PRINT_POS_X = 50;\r\nconst PRINT_VERTICAL_GAP = 20;\r\nconst PRINT_HORIZONTAL_GAP = 50;\r\n\r\nexport default class SplayTree extends Algorithm {\r\n\tconstructor(am, w, h) {\r\n\t\tsuper(am, w, h);\r\n\t\tthis.startingX = w / 2;\r\n\t\tthis.first_print_pos_y = h - 2 * PRINT_VERTICAL_GAP;\r\n\t\tthis.print_max = w - 10;\r\n\r\n\t\tthis.addControls();\r\n\t\tthis.nextIndex = 0;\r\n\t\tthis.commands = [];\r\n\t\tthis.cmd('CreateLabel', 0, '', 20, 10, 0);\r\n\t\tthis.nextIndex = 1;\r\n\t\tthis.animationManager.StartNewAnimation(this.commands);\r\n\t\tthis.animationManager.skipForward();\r\n\t\tthis.animationManager.clearHistory();\r\n\t}\r\n\r\n\taddControls() {\r\n\t\tthis.insertField = addControlToAlgorithmBar('Text', '');\r\n\t\tthis.insertField.onkeydown = this.returnSubmit(\r\n\t\t\tthis.insertField,\r\n\t\t\tthis.insertCallback.bind(this),\r\n\t\t\t4\r\n\t\t);\r\n\t\tthis.insertButton = addControlToAlgorithmBar('Button', 'Insert');\r\n\t\tthis.insertButton.onclick = this.insertCallback.bind(this);\r\n\t\tthis.deleteField = addControlToAlgorithmBar('Text', '');\r\n\t\tthis.deleteField.onkeydown = this.returnSubmit(\r\n\t\t\tthis.deleteField,\r\n\t\t\tthis.deleteCallback.bind(this),\r\n\t\t\t4\r\n\t\t);\r\n\t\tthis.deleteButton = addControlToAlgorithmBar('Button', 'Delete');\r\n\t\tthis.deleteButton.onclick = this.deleteCallback.bind(this);\r\n\t\tthis.findField = addControlToAlgorithmBar('Text', '');\r\n\t\tthis.findField.onkeydown = this.returnSubmit(\r\n\t\t\tthis.findField,\r\n\t\t\tthis.findCallback.bind(this),\r\n\t\t\t4\r\n\t\t);\r\n\t\tthis.findButton = addControlToAlgorithmBar('Button', 'Find');\r\n\t\tthis.findButton.onclick = this.findCallback.bind(this);\r\n\t\tthis.printButton = addControlToAlgorithmBar('Button', 'Print');\r\n\t\tthis.printButton.onclick = this.printCallback.bind(this);\r\n\t}\r\n\r\n\treset() {\r\n\t\tthis.nextIndex = 1;\r\n\t\tthis.treeRoot = null;\r\n\t}\r\n\r\n\tinsertCallback() {\r\n\t\tlet insertedValue = this.insertField.value;\r\n\t\t// Get text value\r\n\t\tinsertedValue = this.normalizeNumber(insertedValue, 4);\r\n\t\tif (insertedValue !== '') {\r\n\t\t\t// set text value\r\n\t\t\tthis.insertField.value = '';\r\n\t\t\tthis.implementAction(this.insertElement.bind(this), insertedValue);\r\n\t\t}\r\n\t}\r\n\r\n\tdeleteCallback() {\r\n\t\tlet deletedValue = this.deleteField.value;\r\n\t\tif (deletedValue !== '') {\r\n\t\t\tdeletedValue = this.normalizeNumber(deletedValue, 4);\r\n\t\t\tthis.deleteField.value = '';\r\n\t\t\tthis.implementAction(this.deleteElement.bind(this), deletedValue);\r\n\t\t}\r\n\t}\r\n\r\n\t//  TODO:  This top-down version is broken.  Don't use\r\n\tsplay(value) {\r\n\t\tif (this.treeRoot == null) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\tif (this.treeRoot.data === value) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\tif (value < this.treeRoot.data) {\r\n\t\t\tif (this.treeRoot.left == null) {\r\n\t\t\t\treturn false;\r\n\t\t\t} else if (this.treeRoot.left.data === value) {\r\n\t\t\t\tthis.singleRotateRight(this.treeRoot);\r\n\t\t\t\treturn true;\r\n\t\t\t} else if (value < this.treeRoot.left.data) {\r\n\t\t\t\tif (this.treeRoot.left.left == null) {\r\n\t\t\t\t\tthis.singleRotateRight(this.treeRoot);\r\n\t\t\t\t\treturn this.splay(value);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.zigZigRight(this.treeRoot);\r\n\t\t\t\t\treturn this.splay(value);\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tif (this.treeRoot.left.right == null) {\r\n\t\t\t\t\tthis.singleRotateRight(this.treeRoot);\r\n\t\t\t\t\treturn this.splay(value);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.doubleRotateRight(this.treeRoot);\r\n\t\t\t\t\treturn this.splay(value);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tif (this.treeRoot.right == null) {\r\n\t\t\t\treturn false;\r\n\t\t\t} else if (this.treeRoot.right.data === value) {\r\n\t\t\t\tthis.singleRotateLeft(this.treeRoot);\r\n\t\t\t\treturn true;\r\n\t\t\t} else if (value > this.treeRoot.right.data) {\r\n\t\t\t\tif (this.treeRoot.right.right == null) {\r\n\t\t\t\t\tthis.singleRotateLeft(this.treeRoot);\r\n\t\t\t\t\treturn this.splay(value);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.zigZigLeft(this.treeRoot);\r\n\t\t\t\t\treturn this.splay(value);\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tif (this.treeRoot.right.left == null) {\r\n\t\t\t\t\tthis.singleRotateLeft(this.treeRoot);\r\n\t\t\t\t\treturn this.splay(value);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.doubleRotateLeft(this.treeRot);\r\n\t\t\t\t\treturn this.splay(value);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprintCallback() {\r\n\t\tthis.implementAction(this.printTree.bind(this), '');\r\n\t}\r\n\r\n\tprintTree() {\r\n\t\tthis.commands = [];\r\n\r\n\t\tif (this.treeRoot != null) {\r\n\t\t\tthis.highlightID = this.nextIndex++;\r\n\t\t\tconst firstLabel = this.nextIndex;\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'CreateHighlightCircle',\r\n\t\t\t\tthis.highlightID,\r\n\t\t\t\tHIGHLIGHT_CIRCLE_COLOR,\r\n\t\t\t\tthis.treeRoot.x,\r\n\t\t\t\tthis.treeRoot.y\r\n\t\t\t);\r\n\t\t\tthis.xPosOfNextLabel = FIRST_PRINT_POS_X;\r\n\t\t\tthis.yPosOfNextLabel = this.first_print_pos_y;\r\n\t\t\tthis.printTreeRec(this.treeRoot);\r\n\t\t\tthis.cmd('Delete', this.highlightID);\r\n\t\t\tthis.cmd('Step');\r\n\r\n\t\t\tfor (let i = firstLabel; i < this.nextIndex; i++) {\r\n\t\t\t\tthis.cmd('Delete', i);\r\n\t\t\t}\r\n\t\t\tthis.nextIndex = this.highlightID; /// Reuse objects.  Not necessary.\r\n\t\t}\r\n\t\treturn this.commands;\r\n\t}\r\n\r\n\tprintTreeRec(tree) {\r\n\t\tthis.cmd('Step');\r\n\t\tif (tree.left != null) {\r\n\t\t\tthis.cmd('Move', this.highlightID, tree.left.x, tree.left.y);\r\n\t\t\tthis.printTreeRec(tree.left);\r\n\t\t\tthis.cmd('Move', this.highlightID, tree.x, tree.y);\r\n\t\t\tthis.cmd('Step');\r\n\t\t}\r\n\t\tconst nextLabelID = this.nextIndex++;\r\n\t\tthis.cmd('CreateLabel', nextLabelID, tree.data, tree.x, tree.y);\r\n\t\tthis.cmd('SetForegroundColor', nextLabelID, PRINT_COLOR);\r\n\t\tthis.cmd('Move', nextLabelID, this.xPosOfNextLabel, this.yPosOfNextLabel);\r\n\t\tthis.cmd('Step');\r\n\r\n\t\tthis.xPosOfNextLabel += PRINT_HORIZONTAL_GAP;\r\n\t\tif (this.xPosOfNextLabel > this.print_max) {\r\n\t\t\tthis.xPosOfNextLabel = FIRST_PRINT_POS_X;\r\n\t\t\tthis.yPosOfNextLabel += PRINT_VERTICAL_GAP;\r\n\t\t}\r\n\t\tif (tree.right != null) {\r\n\t\t\tthis.cmd('Move', this.highlightID, tree.right.x, tree.right.y);\r\n\t\t\tthis.printTreeRec(tree.right);\r\n\t\t\tthis.cmd('Move', this.highlightID, tree.x, tree.y);\r\n\t\t\tthis.cmd('Step');\r\n\t\t}\r\n\t\treturn;\r\n\t}\r\n\r\n\tfindCallback() {\r\n\t\tconst findValue = this.normalizeNumber(this.findField.value, 4);\r\n\t\tthis.findField.value = '';\r\n\t\tthis.implementAction(this.findElement.bind(this), findValue);\r\n\t}\r\n\r\n\tfindElement(findValue) {\r\n\t\tthis.commands = [];\r\n\r\n\t\tthis.highlightID = this.nextIndex++;\r\n\r\n\t\tconst found = this.doFind(this.treeRoot, findValue);\r\n\r\n\t\tif (found) {\r\n\t\t\tthis.cmd('SetText', 0, 'Element ' + findValue + ' found.');\r\n\t\t} else {\r\n\t\t\tthis.cmd('SetText', 0, 'Element ' + findValue + ' not found.');\r\n\t\t}\r\n\r\n\t\treturn this.commands;\r\n\t}\r\n\r\n\tdoFind(tree, value) {\r\n\t\tthis.cmd('SetText', 0, 'Searching for ' + value);\r\n\t\tif (tree != null) {\r\n\t\t\tthis.cmd('SetHighlight', tree.graphicID, 1);\r\n\t\t\tif (tree.data === value) {\r\n\t\t\t\tthis.cmd(\r\n\t\t\t\t\t'SetText',\r\n\t\t\t\t\t0,\r\n\t\t\t\t\t'Searching for ' + value + ' : ' + value + ' = ' + value + ' (Element found!)'\r\n\t\t\t\t);\r\n\t\t\t\tthis.cmd('Step');\r\n\t\t\t\tthis.cmd('SetText', 0, 'Splaying found node to root of tree');\r\n\t\t\t\tthis.cmd('Step');\r\n\t\t\t\tthis.cmd('SetHighlight', tree.graphicID, 0);\r\n\t\t\t\tthis.splayUp(tree);\r\n\t\t\t\treturn true;\r\n\t\t\t} else {\r\n\t\t\t\tif (tree.data > value) {\r\n\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t'SetText',\r\n\t\t\t\t\t\t0,\r\n\t\t\t\t\t\t'Searching for ' +\r\n\t\t\t\t\t\t\tvalue +\r\n\t\t\t\t\t\t\t' : ' +\r\n\t\t\t\t\t\t\tvalue +\r\n\t\t\t\t\t\t\t' < ' +\r\n\t\t\t\t\t\t\ttree.data +\r\n\t\t\t\t\t\t\t' (look to left subtree)'\r\n\t\t\t\t\t);\r\n\t\t\t\t\tthis.cmd('Step');\r\n\t\t\t\t\tthis.cmd('SetHighlight', tree.graphicID, 0);\r\n\t\t\t\t\tif (tree.left != null) {\r\n\t\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t\t'CreateHighlightCircle',\r\n\t\t\t\t\t\t\tthis.highlightID,\r\n\t\t\t\t\t\t\tHIGHLIGHT_CIRCLE_COLOR,\r\n\t\t\t\t\t\t\ttree.x,\r\n\t\t\t\t\t\t\ttree.y\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t\tthis.cmd('Move', this.highlightID, tree.left.x, tree.left.y);\r\n\t\t\t\t\t\tthis.cmd('Step');\r\n\t\t\t\t\t\tthis.cmd('Delete', this.highlightID);\r\n\t\t\t\t\t\treturn this.doFind(tree.left, value);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.splayUp(tree);\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t'SetText',\r\n\t\t\t\t\t\t0,\r\n\t\t\t\t\t\t'Searching for ' +\r\n\t\t\t\t\t\t\tvalue +\r\n\t\t\t\t\t\t\t' : ' +\r\n\t\t\t\t\t\t\tvalue +\r\n\t\t\t\t\t\t\t' > ' +\r\n\t\t\t\t\t\t\ttree.data +\r\n\t\t\t\t\t\t\t' (look to right subtree)'\r\n\t\t\t\t\t);\r\n\t\t\t\t\tthis.cmd('Step');\r\n\t\t\t\t\tthis.cmd('SetHighlight', tree.graphicID, 0);\r\n\t\t\t\t\tif (tree.right != null) {\r\n\t\t\t\t\t\tthis.cmd(\r\n\t\t\t\t\t\t\t'CreateHighlightCircle',\r\n\t\t\t\t\t\t\tthis.highlightID,\r\n\t\t\t\t\t\t\tHIGHLIGHT_CIRCLE_COLOR,\r\n\t\t\t\t\t\t\ttree.x,\r\n\t\t\t\t\t\t\ttree.y\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t\tthis.cmd('Move', this.highlightID, tree.right.x, tree.right.y);\r\n\t\t\t\t\t\tthis.cmd('Step');\r\n\t\t\t\t\t\tthis.cmd('Delete', this.highlightID);\r\n\t\t\t\t\t\treturn this.doFind(tree.right, value);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.splayUp(tree);\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'SetText',\r\n\t\t\t\t0,\r\n\t\t\t\t'Searching for ' + value + ' : < Empty Tree > (Element not found)'\r\n\t\t\t);\r\n\t\t\tthis.cmd('Step');\r\n\t\t\tthis.cmd('SetText', 0, 'Searching for ' + value + ' :  (Element not found)');\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\r\n\tinsertElement(insertedValue) {\r\n\t\tthis.commands = [];\r\n\t\tthis.cmd('SetText', 0, 'Inserting ' + insertedValue);\r\n\t\tthis.highlightID = this.nextIndex++;\r\n\r\n\t\tif (this.treeRoot == null) {\r\n\t\t\tthis.cmd('CreateCircle', this.nextIndex, insertedValue, this.startingX, STARTING_Y);\r\n\t\t\tthis.cmd('SetForegroundColor', this.nextIndex, FOREGROUND_COLOR);\r\n\t\t\tthis.cmd('SetBackgroundColor', this.nextIndex, BACKGROUND_COLOR);\r\n\t\t\tthis.cmd('Step');\r\n\t\t\tthis.treeRoot = new BSTNode(insertedValue, this.nextIndex, this.startingX, STARTING_Y);\r\n\t\t\tthis.nextIndex += 1;\r\n\t\t} else {\r\n\t\t\tthis.cmd('CreateCircle', this.nextIndex, insertedValue, 100, 100);\r\n\t\t\tthis.cmd('SetForegroundColor', this.nextIndex, FOREGROUND_COLOR);\r\n\t\t\tthis.cmd('SetBackgroundColor', this.nextIndex, BACKGROUND_COLOR);\r\n\t\t\tthis.cmd('Step');\r\n\t\t\tconst insertElem = new BSTNode(insertedValue, this.nextIndex, 100, 100);\r\n\r\n\t\t\tthis.nextIndex += 1;\r\n\t\t\tthis.cmd('SetHighlight', insertElem.graphicID, 1);\r\n\t\t\tthis.insert(insertElem, this.treeRoot);\r\n\t\t\tthis.resizeTree();\r\n\t\t\tthis.cmd('SetText', 0, 'Splay inserted element to root of tree');\r\n\t\t\tthis.cmd('Step');\r\n\t\t\tthis.splayUp(insertElem);\r\n\t\t}\r\n\t\tthis.cmd('SetText', 0, '');\r\n\t\treturn this.commands;\r\n\t}\r\n\r\n\tinsert(elem, tree) {\r\n\t\tlet foundDuplicate = false;\r\n\t\tthis.cmd('SetHighlight', tree.graphicID, 1);\r\n\t\tthis.cmd('SetHighlight', elem.graphicID, 1);\r\n\r\n\t\tif (elem.data < tree.data) {\r\n\t\t\tthis.cmd('SetText', 0, elem.data + ' < ' + tree.data + '.  Looking at left subtree');\r\n\t\t} else if (elem.data > tree.data) {\r\n\t\t\tthis.cmd('SetText', 0, elem.data + ' >= ' + tree.data + '.  Looking at right subtree');\r\n\t\t} else {\r\n\t\t\tthis.cmd('SetText', 0, elem.data + ' = ' + tree.data + '. Ignoring duplicate');\r\n\t\t\tfoundDuplicate = true;\r\n\t\t}\r\n\t\tthis.cmd('Step');\r\n\t\tthis.cmd('SetHighlight', tree.graphicID, 0);\r\n\t\tthis.cmd('SetHighlight', elem.graphicID, 0);\r\n\r\n\t\tif (foundDuplicate) {\r\n\t\t\tthis.cmd('Delete', elem.graphicID, 0);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (elem.data < tree.data) {\r\n\t\t\tif (tree.left == null) {\r\n\t\t\t\tthis.cmd('SetText', 0, 'Found null tree, inserting element');\r\n\r\n\t\t\t\tthis.cmd('SetHighlight', elem.graphicID, 0);\r\n\t\t\t\ttree.left = elem;\r\n\t\t\t\telem.parent = tree;\r\n\t\t\t\tthis.cmd('Connect', tree.graphicID, elem.graphicID, LINK_COLOR);\r\n\t\t\t} else {\r\n\t\t\t\tthis.cmd(\r\n\t\t\t\t\t'CreateHighlightCircle',\r\n\t\t\t\t\tthis.highlightID,\r\n\t\t\t\t\tHIGHLIGHT_CIRCLE_COLOR,\r\n\t\t\t\t\ttree.x,\r\n\t\t\t\t\ttree.y\r\n\t\t\t\t);\r\n\t\t\t\tthis.cmd('Move', this.highlightID, tree.left.x, tree.left.y);\r\n\t\t\t\tthis.cmd('Step');\r\n\t\t\t\tthis.cmd('Delete', this.highlightID);\r\n\t\t\t\tthis.insert(elem, tree.left);\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tif (tree.right == null) {\r\n\t\t\t\tthis.cmd('SetText', 0, 'Found null tree, inserting element');\r\n\t\t\t\tthis.cmd('SetHighlight', elem.graphicID, 0);\r\n\t\t\t\ttree.right = elem;\r\n\t\t\t\telem.parent = tree;\r\n\t\t\t\tthis.cmd('Connect', tree.graphicID, elem.graphicID, LINK_COLOR);\r\n\t\t\t\telem.x = tree.x + WIDTH_DELTA / 2;\r\n\t\t\t\telem.y = tree.y + HEIGHT_DELTA;\r\n\t\t\t\tthis.cmd('Move', elem.graphicID, elem.x, elem.y);\r\n\t\t\t} else {\r\n\t\t\t\tthis.cmd(\r\n\t\t\t\t\t'CreateHighlightCircle',\r\n\t\t\t\t\tthis.highlightID,\r\n\t\t\t\t\tHIGHLIGHT_CIRCLE_COLOR,\r\n\t\t\t\t\ttree.x,\r\n\t\t\t\t\ttree.y\r\n\t\t\t\t);\r\n\t\t\t\tthis.cmd('Move', this.highlightID, tree.right.x, tree.right.y);\r\n\t\t\t\tthis.cmd('Step');\r\n\t\t\t\tthis.cmd('Delete', this.highlightID);\r\n\t\t\t\tthis.insert(elem, tree.right);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tdeleteElement(deletedValue) {\r\n\t\tthis.commands = [];\r\n\t\tthis.cmd('SetText', 0, 'Deleting ' + deletedValue);\r\n\t\tthis.cmd('Step');\r\n\t\tthis.cmd('SetText', 0, '');\r\n\t\tthis.highlightID = this.nextIndex++;\r\n\t\tthis.treeDelete(this.treeRoot, deletedValue);\r\n\t\tthis.cmd('SetText', 0, '');\r\n\t\t// Do delete\r\n\t\treturn this.commands;\r\n\t}\r\n\r\n\ttreeDelete(tree, valueToDelete) {\r\n\t\tthis.cmd('SetText', 0, 'Finding ' + valueToDelete + ' and splaying to rooot');\r\n\t\tthis.cmd('Step');\r\n\r\n\t\tconst inTree = this.doFind(this.treeRoot, valueToDelete);\r\n\t\tthis.cmd('SetText', 0, 'Removing root, leaving left and right trees');\r\n\t\tthis.cmd('Step');\r\n\t\tif (inTree) {\r\n\t\t\tif (this.treeRoot.right == null) {\r\n\t\t\t\tthis.cmd('Delete', this.treeRoot.graphicID);\r\n\t\t\t\tthis.cmd('SetText', 0, 'No right tree, make left tree the root.');\r\n\t\t\t\tthis.cmd('Step');\r\n\t\t\t\tthis.treeRoot = this.treeRoot.left;\r\n\t\t\t\tthis.treeRoot.parent = null;\r\n\t\t\t\tthis.resizeTree();\r\n\t\t\t} else if (this.treeRoot.left == null) {\r\n\t\t\t\tthis.cmd('Delete', this.treeRoot.graphicID);\r\n\t\t\t\tthis.cmd('SetText', 0, 'No left tree, make right tree the root.');\r\n\t\t\t\tthis.cmd('Step');\r\n\t\t\t\tthis.treeRoot = this.treeRoot.right;\r\n\t\t\t\tthis.treeRoot.parent = null;\r\n\t\t\t\tthis.resizeTree();\r\n\t\t\t} else {\r\n\t\t\t\tconst right = this.treeRoot.right;\r\n\t\t\t\tconst left = this.treeRoot.left;\r\n\t\t\t\tconst oldGraphicID = this.treeRoot.graphicID;\r\n\t\t\t\tthis.cmd('Disconnect', this.treeRoot.graphicID, left.graphicID);\r\n\t\t\t\tthis.cmd('Disconnect', this.treeRoot.graphicID, right.graphicID);\r\n\t\t\t\tthis.cmd('SetAlpha', this.treeRoot.graphicID, 0);\r\n\t\t\t\tthis.cmd('SetText', 0, 'Splay largest element in left tree to root');\r\n\t\t\t\tthis.cmd('Step');\r\n\r\n\t\t\t\tleft.parent = null;\r\n\t\t\t\tconst largestLeft = this.findMax(left);\r\n\t\t\t\tthis.splayUp(largestLeft);\r\n\t\t\t\tthis.cmd(\r\n\t\t\t\t\t'SetText',\r\n\t\t\t\t\t0,\r\n\t\t\t\t\t'Left tree now has no right subtree, connect left and right trees'\r\n\t\t\t\t);\r\n\t\t\t\tthis.cmd('Step');\r\n\t\t\t\tthis.cmd('Connect', largestLeft.graphicID, right.graphicID, LINK_COLOR);\r\n\t\t\t\tlargestLeft.parent = null;\r\n\t\t\t\tlargestLeft.right = right;\r\n\t\t\t\tright.parent = largestLeft;\r\n\t\t\t\tthis.treeRoot = largestLeft;\r\n\t\t\t\tthis.cmd('Delete', oldGraphicID);\r\n\t\t\t\tthis.resizeTree();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tsingleRotateRight(tree) {\r\n\t\tconst B = tree;\r\n\t\t// const t3 = B.right;\r\n\t\tconst A = tree.left;\r\n\t\t// const t1 = A.left;\r\n\t\tconst t2 = A.right;\r\n\r\n\t\tthis.cmd('SetText', 0, 'Zig Right');\r\n\t\tthis.cmd('SetEdgeHighlight', B.graphicID, A.graphicID, 1);\r\n\t\tthis.cmd('Step');\r\n\r\n\t\tif (t2 != null) {\r\n\t\t\tthis.cmd('Disconnect', A.graphicID, t2.graphicID);\r\n\t\t\tthis.cmd('Connect', B.graphicID, t2.graphicID, LINK_COLOR);\r\n\t\t\tt2.parent = B;\r\n\t\t}\r\n\t\tthis.cmd('Disconnect', B.graphicID, A.graphicID);\r\n\t\tthis.cmd('Connect', A.graphicID, B.graphicID, LINK_COLOR);\r\n\t\tA.parent = B.parent;\r\n\t\tif (B.parent == null) {\r\n\t\t\tthis.treeRoot = A;\r\n\t\t} else {\r\n\t\t\tthis.cmd('Disconnect', B.parent.graphicID, B.graphicID, LINK_COLOR);\r\n\t\t\tthis.cmd('Connect', B.parent.graphicID, A.graphicID, LINK_COLOR);\r\n\t\t\tif (B.isLeftChild()) {\r\n\t\t\t\tB.parent.left = A;\r\n\t\t\t} else {\r\n\t\t\t\tB.parent.right = A;\r\n\t\t\t}\r\n\t\t}\r\n\t\tA.right = B;\r\n\t\tB.parent = A;\r\n\t\tB.left = t2;\r\n\t\tthis.resizeTree();\r\n\t}\r\n\r\n\tzigZigRight(tree) {\r\n\t\tconst C = tree;\r\n\t\tconst B = tree.left;\r\n\t\tconst A = tree.left.left;\r\n\t\t// const t1 = A.left;\r\n\t\tconst t2 = A.right;\r\n\t\tconst t3 = B.right;\r\n\t\t// const t4 = C.right;\r\n\r\n\t\tthis.cmd('SetText', 0, 'Zig-Zig Right');\r\n\t\tthis.cmd('SetEdgeHighlight', C.graphicID, B.graphicID, 1);\r\n\t\tthis.cmd('SetEdgeHighlight', B.graphicID, A.graphicID, 1);\r\n\t\tthis.cmd('Step');\r\n\t\tthis.cmd('SetEdgeHighlight', C.graphicID, B.graphicID, 0);\r\n\t\tthis.cmd('SetEdgeHighlight', B.graphicID, A.graphicID, 0);\r\n\r\n\t\tif (C.parent != null) {\r\n\t\t\tthis.cmd('Disconnect', C.parent.graphicID, C.graphicID);\r\n\t\t\tthis.cmd('Connect', C.parent.graphicID, A.graphicID, LINK_COLOR);\r\n\t\t\tif (C.isLeftChild()) {\r\n\t\t\t\tC.parent.left = A;\r\n\t\t\t} else {\r\n\t\t\t\tC.parent.right = A;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tthis.treeRoot = A;\r\n\t\t}\r\n\r\n\t\tif (t2 != null) {\r\n\t\t\tthis.cmd('Disconnect', A.graphicID, t2.graphicID);\r\n\t\t\tthis.cmd('Connect', B.graphicID, t2.graphicID, LINK_COLOR);\r\n\t\t\tt2.parent = B;\r\n\t\t}\r\n\t\tif (t3 != null) {\r\n\t\t\tthis.cmd('Disconnect', B.graphicID, t3.graphicID);\r\n\t\t\tthis.cmd('Connect', C.graphicID, t3.graphicID, LINK_COLOR);\r\n\t\t\tt3.parent = C;\r\n\t\t}\r\n\t\tthis.cmd('Disconnect', B.graphicID, A.graphicID);\r\n\t\tthis.cmd('Connect', A.graphicID, B.graphicID, LINK_COLOR);\r\n\t\tthis.cmd('Disconnect', C.graphicID, B.graphicID);\r\n\t\tthis.cmd('Connect', B.graphicID, C.graphicID, LINK_COLOR);\r\n\r\n\t\tA.right = B;\r\n\t\tA.parent = C.parent;\r\n\t\tB.parent = A;\r\n\t\tB.left = t2;\r\n\t\tB.right = C;\r\n\t\tC.parent = B;\r\n\t\tC.left = t3;\r\n\t\tthis.resizeTree();\r\n\t}\r\n\r\n\tzigZigLeft(tree) {\r\n\t\tconst A = tree;\r\n\t\tconst B = tree.right;\r\n\t\tconst C = tree.right.right;\r\n\t\t// const t1 = A.left;\r\n\t\tconst t2 = B.left;\r\n\t\tconst t3 = C.left;\r\n\t\t// const t4 = C.right;\r\n\r\n\t\tthis.cmd('SetText', 0, 'Zig-Zig Left');\r\n\t\tthis.cmd('SetEdgeHighlight', A.graphicID, B.graphicID, 1);\r\n\t\tthis.cmd('SetEdgeHighlight', B.graphicID, C.graphicID, 1);\r\n\t\tthis.cmd('Step');\r\n\t\tthis.cmd('SetEdgeHighlight', A.graphicID, B.graphicID, 0);\r\n\t\tthis.cmd('SetEdgeHighlight', B.graphicID, C.graphicID, 0);\r\n\r\n\t\tif (A.parent != null) {\r\n\t\t\tthis.cmd('Disconnect', A.parent.graphicID, A.graphicID);\r\n\t\t\tthis.cmd('Connect', A.parent.graphicID, C.graphicID, LINK_COLOR);\r\n\t\t\tif (A.isLeftChild()) {\r\n\t\t\t\tA.parent.left = C;\r\n\t\t\t} else {\r\n\t\t\t\tA.parent.right = C;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tthis.treeRoot = C;\r\n\t\t}\r\n\r\n\t\tif (t2 != null) {\r\n\t\t\tthis.cmd('Disconnect', B.graphicID, t2.graphicID);\r\n\t\t\tthis.cmd('Connect', A.graphicID, t2.graphicID, LINK_COLOR);\r\n\t\t\tt2.parent = A;\r\n\t\t}\r\n\t\tif (t3 != null) {\r\n\t\t\tthis.cmd('Disconnect', C.graphicID, t3.graphicID);\r\n\t\t\tthis.cmd('Connect', B.graphicID, t3.graphicID, LINK_COLOR);\r\n\t\t\tt3.parent = B;\r\n\t\t}\r\n\t\tthis.cmd('Disconnect', A.graphicID, B.graphicID);\r\n\t\tthis.cmd('Disconnect', B.graphicID, C.graphicID);\r\n\t\tthis.cmd('Connect', C.graphicID, B.graphicID, LINK_COLOR);\r\n\t\tthis.cmd('Connect', B.graphicID, A.graphicID, LINK_COLOR);\r\n\t\tC.parent = A.parent;\r\n\t\tA.right = t2;\r\n\t\tB.left = A;\r\n\t\tA.parent = B;\r\n\t\tB.right = t3;\r\n\t\tC.left = B;\r\n\t\tB.parent = C;\r\n\r\n\t\tthis.resizeTree();\r\n\t}\r\n\r\n\tsingleRotateLeft(tree) {\r\n\t\tconst A = tree;\r\n\t\tconst B = tree.right;\r\n\t\t// const t1 = A.left;\r\n\t\tconst t2 = B.left;\r\n\t\t// const t3 = B.right;\r\n\r\n\t\tthis.cmd('SetText', 0, 'Zig Left');\r\n\t\tthis.cmd('SetEdgeHighlight', A.graphicID, B.graphicID, 1);\r\n\t\tthis.cmd('Step');\r\n\r\n\t\tif (t2 != null) {\r\n\t\t\tthis.cmd('Disconnect', B.graphicID, t2.graphicID);\r\n\t\t\tthis.cmd('Connect', A.graphicID, t2.graphicID, LINK_COLOR);\r\n\t\t\tt2.parent = A;\r\n\t\t}\r\n\t\tthis.cmd('Disconnect', A.graphicID, B.graphicID);\r\n\t\tthis.cmd('Connect', B.graphicID, A.graphicID, LINK_COLOR);\r\n\t\tB.parent = A.parent;\r\n\t\tif (A.parent == null) {\r\n\t\t\tthis.treeRoot = B;\r\n\t\t} else {\r\n\t\t\tthis.cmd('Disconnect', A.parent.graphicID, A.graphicID, LINK_COLOR);\r\n\t\t\tthis.cmd('Connect', A.parent.graphicID, B.graphicID, LINK_COLOR);\r\n\r\n\t\t\tif (A.isLeftChild()) {\r\n\t\t\t\tA.parent.left = B;\r\n\t\t\t} else {\r\n\t\t\t\tA.parent.right = B;\r\n\t\t\t}\r\n\t\t}\r\n\t\tB.left = A;\r\n\t\tA.parent = B;\r\n\t\tA.right = t2;\r\n\r\n\t\tthis.resizeTree();\r\n\t}\r\n\r\n\tsplayUp(tree) {\r\n\t\tif (tree.parent == null) {\r\n\t\t\treturn;\r\n\t\t} else if (tree.parent.parent == null) {\r\n\t\t\tif (tree.isLeftChild()) {\r\n\t\t\t\tthis.singleRotateRight(tree.parent);\r\n\t\t\t} else {\r\n\t\t\t\tthis.singleRotateLeft(tree.parent);\r\n\t\t\t}\r\n\t\t} else if (tree.isLeftChild() && !tree.parent.isLeftChild()) {\r\n\t\t\tthis.doubleRotateLeft(tree.parent.parent);\r\n\t\t\tthis.splayUp(tree);\r\n\t\t} else if (!tree.isLeftChild() && tree.parent.isLeftChild()) {\r\n\t\t\tthis.doubleRotateRight(tree.parent.parent);\r\n\t\t\tthis.splayUp(tree);\r\n\t\t} else if (tree.isLeftChild()) {\r\n\t\t\tthis.zigZigRight(tree.parent.parent);\r\n\t\t\tthis.splayUp(tree);\r\n\t\t} else {\r\n\t\t\tthis.zigZigLeft(tree.parent.parent);\r\n\t\t\tthis.splayUp(tree);\r\n\t\t}\r\n\t}\r\n\r\n\tfindMax(tree) {\r\n\t\tif (tree.right != null) {\r\n\t\t\tthis.highlightID = this.nextIndex++;\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'CreateHighlightCircle',\r\n\t\t\t\tthis.highlightID,\r\n\t\t\t\tHIGHLIGHT_CIRCLE_COLOR,\r\n\t\t\t\ttree.x,\r\n\t\t\t\ttree.y\r\n\t\t\t);\r\n\t\t\tthis.cmd('Step');\r\n\t\t\twhile (tree.right != null) {\r\n\t\t\t\tthis.cmd('Move', this.highlightID, tree.right.x, tree.right.y);\r\n\t\t\t\tthis.cmd('Step');\r\n\t\t\t\ttree = tree.right;\r\n\t\t\t}\r\n\t\t\tthis.cmd('Delete', this.highlightID);\r\n\t\t\treturn tree;\r\n\t\t} else {\r\n\t\t\treturn tree;\r\n\t\t}\r\n\t}\r\n\r\n\tdoubleRotateRight(tree) {\r\n\t\tthis.cmd('SetText', 0, 'Zig-Zag Right');\r\n\t\tconst A = tree.left;\r\n\t\tconst B = tree.left.right;\r\n\t\tconst C = tree;\r\n\t\t// const t1 = A.left;\r\n\t\tconst t2 = B.left;\r\n\t\tconst t3 = B.right;\r\n\t\t// const t4 = C.right;\r\n\r\n\t\tthis.cmd('SetEdgeHighlight', C.graphicID, A.graphicID, 1);\r\n\t\tthis.cmd('SetEdgeHighlight', A.graphicID, B.graphicID, 1);\r\n\r\n\t\tthis.cmd('Step');\r\n\r\n\t\tif (t2 != null) {\r\n\t\t\tthis.cmd('Disconnect', B.graphicID, t2.graphicID);\r\n\t\t\tt2.parent = A;\r\n\t\t\tA.right = t2;\r\n\t\t\tthis.cmd('Connect', A.graphicID, t2.graphicID, LINK_COLOR);\r\n\t\t}\r\n\t\tif (t3 != null) {\r\n\t\t\tthis.cmd('Disconnect', B.graphicID, t3.graphicID);\r\n\t\t\tt3.parent = C;\r\n\t\t\tC.left = t2;\r\n\t\t\tthis.cmd('Connect', C.graphicID, t3.graphicID, LINK_COLOR);\r\n\t\t}\r\n\t\tif (C.parent == null) {\r\n\t\t\tB.parent = null;\r\n\t\t\tthis.treeRoot = B;\r\n\t\t} else {\r\n\t\t\tthis.cmd('Disconnect', C.parent.graphicID, C.graphicID);\r\n\t\t\tthis.cmd('Connect', C.parent.graphicID, B.graphicID, LINK_COLOR);\r\n\t\t\tif (C.isLeftChild()) {\r\n\t\t\t\tC.parent.left = B;\r\n\t\t\t} else {\r\n\t\t\t\tC.parent.right = B;\r\n\t\t\t}\r\n\t\t\tB.parent = C.parent;\r\n\t\t\tC.parent = B;\r\n\t\t}\r\n\t\tthis.cmd('Disconnect', C.graphicID, A.graphicID);\r\n\t\tthis.cmd('Disconnect', A.graphicID, B.graphicID);\r\n\t\tthis.cmd('Connect', B.graphicID, A.graphicID, LINK_COLOR);\r\n\t\tthis.cmd('Connect', B.graphicID, C.graphicID, LINK_COLOR);\r\n\t\tB.left = A;\r\n\t\tA.parent = B;\r\n\t\tB.right = C;\r\n\t\tC.parent = B;\r\n\t\tA.right = t2;\r\n\t\tC.left = t3;\r\n\r\n\t\tthis.resizeTree();\r\n\t}\r\n\r\n\tdoubleRotateLeft(tree) {\r\n\t\tthis.cmd('SetText', 0, 'Zig-Zag Left');\r\n\t\tconst A = tree;\r\n\t\tconst B = tree.right.left;\r\n\t\tconst C = tree.right;\r\n\t\t// const t1 = A.left;\r\n\t\tconst t2 = B.left;\r\n\t\tconst t3 = B.right;\r\n\t\t// const t4 = C.right;\r\n\r\n\t\tthis.cmd('SetEdgeHighlight', A.graphicID, C.graphicID, 1);\r\n\t\tthis.cmd('SetEdgeHighlight', C.graphicID, B.graphicID, 1);\r\n\r\n\t\tthis.cmd('Step');\r\n\r\n\t\tif (t2 != null) {\r\n\t\t\tthis.cmd('Disconnect', B.graphicID, t2.graphicID);\r\n\t\t\tt2.parent = A;\r\n\t\t\tA.right = t2;\r\n\t\t\tthis.cmd('Connect', A.graphicID, t2.graphicID, LINK_COLOR);\r\n\t\t}\r\n\t\tif (t3 != null) {\r\n\t\t\tthis.cmd('Disconnect', B.graphicID, t3.graphicID);\r\n\t\t\tt3.parent = C;\r\n\t\t\tC.left = t2;\r\n\t\t\tthis.cmd('Connect', C.graphicID, t3.graphicID, LINK_COLOR);\r\n\t\t}\r\n\r\n\t\tif (A.parent == null) {\r\n\t\t\tB.parent = null;\r\n\t\t\tthis.treeRoot = B;\r\n\t\t} else {\r\n\t\t\tthis.cmd('Disconnect', A.parent.graphicID, A.graphicID);\r\n\t\t\tthis.cmd('Connect', A.parent.graphicID, B.graphicID, LINK_COLOR);\r\n\t\t\tif (A.isLeftChild()) {\r\n\t\t\t\tA.parent.left = B;\r\n\t\t\t} else {\r\n\t\t\t\tA.parent.right = B;\r\n\t\t\t}\r\n\t\t\tB.parent = A.parent;\r\n\t\t\tA.parent = B;\r\n\t\t}\r\n\t\tthis.cmd('Disconnect', A.graphicID, C.graphicID);\r\n\t\tthis.cmd('Disconnect', C.graphicID, B.graphicID);\r\n\t\tthis.cmd('Connect', B.graphicID, A.graphicID, LINK_COLOR);\r\n\t\tthis.cmd('Connect', B.graphicID, C.graphicID, LINK_COLOR);\r\n\t\tB.left = A;\r\n\t\tA.parent = B;\r\n\t\tB.right = C;\r\n\t\tC.parent = B;\r\n\t\tA.right = t2;\r\n\t\tC.left = t3;\r\n\r\n\t\tthis.resizeTree();\r\n\t}\r\n\r\n\tresizeTree() {\r\n\t\tlet startingPoint = this.startingX;\r\n\t\tthis.resizeWidths(this.treeRoot);\r\n\t\tif (this.treeRoot != null) {\r\n\t\t\tif (this.treeRoot.leftWidth > startingPoint) {\r\n\t\t\t\tstartingPoint = this.treeRoot.leftWidth;\r\n\t\t\t} else if (this.treeRoot.rightWidth > startingPoint) {\r\n\t\t\t\tstartingPoint = Math.max(\r\n\t\t\t\t\tthis.treeRoot.leftWidth,\r\n\t\t\t\t\t2 * startingPoint - this.treeRoot.rightWidth\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t\tthis.setNewPositions(this.treeRoot, startingPoint, STARTING_Y, 0);\r\n\t\t\tthis.animateNewPositions(this.treeRoot);\r\n\t\t\tthis.cmd('Step');\r\n\t\t}\r\n\t}\r\n\r\n\tsetNewPositions(tree, xPosition, yPosition, side) {\r\n\t\tif (tree != null) {\r\n\t\t\ttree.y = yPosition;\r\n\t\t\tif (side === -1) {\r\n\t\t\t\txPosition = xPosition - tree.rightWidth;\r\n\t\t\t} else if (side === 1) {\r\n\t\t\t\txPosition = xPosition + tree.leftWidth;\r\n\t\t\t}\r\n\t\t\ttree.x = xPosition;\r\n\t\t\tthis.setNewPositions(tree.left, xPosition, yPosition + HEIGHT_DELTA, -1);\r\n\t\t\tthis.setNewPositions(tree.right, xPosition, yPosition + HEIGHT_DELTA, 1);\r\n\t\t}\r\n\t}\r\n\r\n\tanimateNewPositions(tree) {\r\n\t\tif (tree != null) {\r\n\t\t\tthis.cmd('Move', tree.graphicID, tree.x, tree.y);\r\n\t\t\tthis.animateNewPositions(tree.left);\r\n\t\t\tthis.animateNewPositions(tree.right);\r\n\t\t}\r\n\t}\r\n\r\n\tresizeWidths(tree) {\r\n\t\tif (tree == null) {\r\n\t\t\treturn 0;\r\n\t\t}\r\n\t\ttree.leftWidth = Math.max(this.resizeWidths(tree.left), WIDTH_DELTA / 2);\r\n\t\ttree.rightWidth = Math.max(this.resizeWidths(tree.right), WIDTH_DELTA / 2);\r\n\t\treturn tree.leftWidth + tree.rightWidth;\r\n\t}\r\n\r\n\tdisableUI() {\r\n\t\tthis.insertField.disabled = true;\r\n\t\tthis.insertButton.disabled = true;\r\n\t\tthis.deleteField.disabled = true;\r\n\t\tthis.deleteButton.disabled = true;\r\n\t\tthis.findField.disabled = true;\r\n\t\tthis.findButton.disabled = true;\r\n\t\tthis.printButton.disabled = true;\r\n\t}\r\n\r\n\tenableUI() {\r\n\t\tthis.insertField.disabled = false;\r\n\t\tthis.insertButton.disabled = false;\r\n\t\tthis.deleteField.disabled = false;\r\n\t\tthis.deleteButton.disabled = false;\r\n\t\tthis.findField.disabled = false;\r\n\t\tthis.findButton.disabled = false;\r\n\t\tthis.printButton.disabled = false;\r\n\t}\r\n}\r\n\r\nclass BSTNode {\r\n\tconstructor(val, id, initialX, initialY) {\r\n\t\tthis.data = val;\r\n\t\tthis.x = initialX;\r\n\t\tthis.y = initialY;\r\n\t\tthis.graphicID = id;\r\n\t\tthis.left = null;\r\n\t\tthis.right = null;\r\n\t\tthis.parent = null;\r\n\t}\r\n\r\n\tisLeftChild() {\r\n\t\tif (this.parent == null) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\treturn this.parent.left === this;\r\n\t}\r\n}\r\n","// To add a new algorithm, import it here and add it to AlgorithmList\r\n\r\nimport AVL from './algo/AVL';\r\nimport ArrayList from './algo/ArrayList';\r\nimport BFS from './algo/BFS';\r\nimport BST from './algo/BST';\r\nimport BTree from './algo/BTree';\r\nimport BoyerMoore from './algo/BoyerMoore';\r\nimport BruteForce from './algo/BruteForce';\r\nimport BubbleSort from './algo/BubbleSort';\r\nimport ClosedHash from './algo/ClosedHash';\r\nimport CocktailSort from './algo/CocktailSort';\r\nimport DFS from './algo/DFS';\r\nimport DPLCS from './algo/DPLCS';\r\nimport DequeArray from './algo/DequeArray';\r\nimport DequeLL from './algo/DequeLL';\r\nimport { Dijkstra } from './algo/DijkstraPrim';\r\nimport DoublyLinkedList from './algo/DoublyLinkedList';\r\nimport Floyd from './algo/Floyd';\r\nimport Heap from './algo/Heap';\r\nimport InsertionSort from './algo/InsertionSort';\r\nimport KMP from './algo/KMP';\r\nimport Kruskal from './algo/Kruskal';\r\nimport LSDRadix from './algo/LSDRadix';\r\nimport LinkedList from './algo/LinkedList';\r\nimport MergeSort from './algo/MergeSort';\r\nimport OpenHash from './algo/OpenHash';\r\nimport { Prim } from './algo/DijkstraPrim';\r\nimport QueueArray from './algo/QueueArray';\r\nimport QueueLL from './algo/QueueLL';\r\nimport QuickSelect from './algo/QuickSelect';\r\nimport QuickSort from './algo/QuickSort';\r\nimport RabinKarp from './algo/RabinKarp';\r\nimport SelectionSort from './algo/SelectionSort';\r\nimport SinglyCircularlyLinkedList from './algo/SinglyCircularlyLinkedList';\r\nimport SkipList from './algo/SkipList';\r\nimport SplayTree from './algo/SplayTree';\r\nimport StackArray from './algo/StackArray';\r\nimport StackLL from './algo/StackLL';\r\n\r\n// format:\r\n// AlgorithmName: ['MenuDisplayName', ClassName, 'VerboseDisplayName' (opt)]\r\nexport const AlgorithmList = {\r\n\tArrayList: ['ArrayList', ArrayList],\r\n\tLinkedList: ['Singly LinkedList', LinkedList],\r\n\tDoublyLinkedList: ['Doubly LinkedList', DoublyLinkedList],\r\n\tSinglyCircularlyLinkedList: ['Circularly LinkedList', SinglyCircularlyLinkedList],\r\n\tStackArray: ['Stack (Array)', StackArray],\r\n\tStackLL: ['Stack (LinkedList)', StackLL],\r\n\tQueueArray: ['Queue (Array)', QueueArray],\r\n\tQueueLL: ['Queue (LinkedList)', QueueLL],\r\n\tDequeArray: ['Deque (Array)', DequeArray],\r\n\tDequeLL: ['Deque (LinkedList)', DequeLL],\r\n\tBST: ['Binary Search Tree', BST],\r\n\tHeap: ['Heaps / PQs', Heap],\r\n\tSkipList: ['SkipList', SkipList],\r\n\tClosedHash: ['HashMap (Probing)', ClosedHash],\r\n\tOpenHash: ['HashMap (Chaining)', OpenHash],\r\n\tSplayTree: ['SplayTree', SplayTree],\r\n\tAVL: ['AVL', AVL],\r\n\tBTree: ['2-4 Tree', BTree],\r\n\tBubbleSort: ['Bubble Sort', BubbleSort],\r\n\tCocktailSort: ['Cocktail Shaker Sort', CocktailSort],\r\n\tInsertionSort: ['Insertion Sort', InsertionSort],\r\n\tSelectionSort: ['Selection Sort', SelectionSort],\r\n\tQuickSort: ['QuickSort', QuickSort],\r\n\tQuickSelect: ['QuickSelect', QuickSelect],\r\n\tMergeSort: ['MergeSort', MergeSort],\r\n\tLSDRadix: ['LSD Radix Sort', LSDRadix],\r\n\tBruteForce: ['Brute Force', BruteForce],\r\n\tBoyerMoore: ['Boyer-Moore', BoyerMoore],\r\n\tKMP: ['KMP', KMP],\r\n\tRabinKarp: ['Rabin-Karp', RabinKarp],\r\n\tBFS: ['Breadth-First Search', BFS],\r\n\tDFS: ['Depth-First Search', DFS],\r\n\tDijkstra: [\"Dijkstra's\", Dijkstra],\r\n\tPrim: [\"Prim's\", Prim],\r\n\tKruskal: [\"Kruskal's\", Kruskal],\r\n\tDPLCS: ['LCS', DPLCS, 'Dynamic Programming (Longest Common Subsequence)'],\r\n\tFloyd: ['Floyd-Warshall', Floyd],\r\n};\r\n\r\nexport const isAlgorithm = name => {\r\n\treturn Object.keys(AlgorithmList).includes(name);\r\n};\r\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\r\n//\r\n// Redistribution and use in source and binary forms, with or without modification, are\r\n// permitted provided that the following conditions are met:\r\n//\r\n// 1. Redistributions of source code must retain the above copyright notice, this list of\r\n// conditions and the following disclaimer.\r\n//\r\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\r\n// of conditions and the following disclaimer in the documentation and/or other materials\r\n// provided with the distribution.\r\n//\r\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\r\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\r\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\r\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\r\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\r\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\r\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\r\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\r\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\r\n//\r\n// The views and conclusions contained in the software and documentation are those of the\r\n// authors and should not be interpreted as representing official policies, either expressed\r\n// or implied, of the University of San Francisco\r\n\r\nimport Algorithm, { addControlToAlgorithmBar } from './Algorithm.js';\r\n\r\nconst ARRAY_START_X = 100;\r\nconst ARRAY_START_Y = 200;\r\nconst ARRAY_ELEM_WIDTH = 50;\r\nconst ARRAY_ELEM_HEIGHT = 50;\r\n\r\nconst ARRRAY_ELEMS_PER_LINE = 15;\r\nconst ARRAY_LINE_SPACING = 130;\r\n\r\nconst TOP_POS_X = 180;\r\nconst TOP_POS_Y = 100;\r\nconst TOP_LABEL_X = 130;\r\nconst TOP_LABEL_Y = 100;\r\n\r\nconst PUSH_LABEL_X = 50;\r\nconst PUSH_LABEL_Y = 30;\r\nconst PUSH_ELEMENT_X = 120;\r\nconst PUSH_ELEMENT_Y = 30;\r\n\r\nconst SIZE = 30;\r\n\r\nexport default class StackArray extends Algorithm {\r\n\tconstructor(am, w, h) {\r\n\t\tsuper(am, w, h);\r\n\t\tthis.addControls();\r\n\t\tthis.nextIndex = 0;\r\n\t\tthis.commands = [];\r\n\t\tthis.setup();\r\n\t\tthis.initialIndex = this.nextIndex;\r\n\t}\r\n\r\n\taddControls() {\r\n\t\tthis.controls = [];\r\n\t\tthis.pushField = addControlToAlgorithmBar('Text', '');\r\n\t\tthis.pushField.onkeydown = this.returnSubmit(\r\n\t\t\tthis.pushField,\r\n\t\t\tthis.pushCallback.bind(this),\r\n\t\t\t6\r\n\t\t);\r\n\t\tthis.pushButton = addControlToAlgorithmBar('Button', 'Push');\r\n\t\tthis.pushButton.onclick = this.pushCallback.bind(this);\r\n\t\tthis.controls.push(this.pushField);\r\n\t\tthis.controls.push(this.pushButton);\r\n\r\n\t\tthis.popButton = addControlToAlgorithmBar('Button', 'Pop');\r\n\t\tthis.popButton.onclick = this.popCallback.bind(this);\r\n\t\tthis.controls.push(this.popButton);\r\n\r\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear Stack');\r\n\t\tthis.clearButton.onclick = this.clearCallback.bind(this);\r\n\t\tthis.controls.push(this.clearButton);\r\n\t}\r\n\r\n\tenableUI() {\r\n\t\tfor (let i = 0; i < this.controls.length; i++) {\r\n\t\t\tthis.controls[i].disabled = false;\r\n\t\t}\r\n\t}\r\n\r\n\tdisableUI() {\r\n\t\tfor (let i = 0; i < this.controls.length; i++) {\r\n\t\t\tthis.controls[i].disabled = true;\r\n\t\t}\r\n\t}\r\n\r\n\tsetup() {\r\n\t\tthis.nextIndex = 0;\r\n\r\n\t\tthis.arrayID = new Array(SIZE);\r\n\t\tthis.arrayLabelID = new Array(SIZE);\r\n\t\tfor (let i = 0; i < SIZE; i++) {\r\n\t\t\tthis.arrayID[i] = this.nextIndex++;\r\n\t\t\tthis.arrayLabelID[i] = this.nextIndex++;\r\n\t\t}\r\n\t\tthis.topID = this.nextIndex++;\r\n\t\tthis.topLabelID = this.nextIndex++;\r\n\r\n\t\tthis.arrayData = new Array(SIZE);\r\n\t\tthis.top = 0;\r\n\t\tthis.leftoverLabelID = this.nextIndex++;\r\n\t\tthis.commands = [];\r\n\r\n\t\tfor (let i = 0; i < SIZE; i++) {\r\n\t\t\tconst xpos = (i % ARRRAY_ELEMS_PER_LINE) * ARRAY_ELEM_WIDTH + ARRAY_START_X;\r\n\t\t\tconst ypos = Math.floor(i / ARRRAY_ELEMS_PER_LINE) * ARRAY_LINE_SPACING + ARRAY_START_Y;\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'CreateRectangle',\r\n\t\t\t\tthis.arrayID[i],\r\n\t\t\t\t'',\r\n\t\t\t\tARRAY_ELEM_WIDTH,\r\n\t\t\t\tARRAY_ELEM_HEIGHT,\r\n\t\t\t\txpos,\r\n\t\t\t\typos\r\n\t\t\t);\r\n\t\t\tthis.cmd('CreateLabel', this.arrayLabelID[i], i, xpos, ypos + ARRAY_ELEM_HEIGHT);\r\n\t\t\tthis.cmd('SetForegroundColor', this.arrayLabelID[i], '#0000FF');\r\n\t\t}\r\n\t\tthis.cmd('CreateLabel', this.topLabelID, 'top', TOP_LABEL_X, TOP_LABEL_Y);\r\n\t\tthis.cmd(\r\n\t\t\t'CreateRectangle',\r\n\t\t\tthis.topID,\r\n\t\t\t0,\r\n\t\t\tARRAY_ELEM_WIDTH,\r\n\t\t\tARRAY_ELEM_HEIGHT,\r\n\t\t\tTOP_POS_X,\r\n\t\t\tTOP_POS_Y\r\n\t\t);\r\n\r\n\t\tthis.cmd('CreateLabel', this.leftoverLabelID, '', PUSH_LABEL_X, PUSH_LABEL_Y);\r\n\r\n\t\tthis.highlight1ID = this.nextIndex++;\r\n\t\tthis.highlight2ID = this.nextIndex++;\r\n\r\n\t\tthis.animationManager.StartNewAnimation(this.commands);\r\n\t\tthis.animationManager.skipForward();\r\n\t\tthis.animationManager.clearHistory();\r\n\t}\r\n\r\n\treset() {\r\n\t\tthis.top = 0;\r\n\t\tthis.nextIndex = this.initialIndex;\r\n\t}\r\n\r\n\tpushCallback() {\r\n\t\tif (this.top < SIZE && this.pushField.value !== '') {\r\n\t\t\tconst pushVal = this.pushField.value;\r\n\t\t\tthis.pushField.value = '';\r\n\t\t\tthis.implementAction(this.push.bind(this), pushVal);\r\n\t\t}\r\n\t}\r\n\r\n\tpopCallback() {\r\n\t\tif (this.top > 0) {\r\n\t\t\tthis.implementAction(this.pop.bind(this), '');\r\n\t\t}\r\n\t}\r\n\r\n\tclearCallback() {\r\n\t\tthis.implementAction(this.clearData.bind(this), '');\r\n\t}\r\n\r\n\tclearData() {\r\n\t\tthis.commands = [];\r\n\t\tthis.clearAll();\r\n\t\treturn this.commands;\r\n\t}\r\n\r\n\tpush(elemToPush) {\r\n\t\tthis.commands = [];\r\n\r\n\t\tconst labPushID = this.nextIndex++;\r\n\t\tconst labPushValID = this.nextIndex++;\r\n\t\tthis.arrayData[this.top] = elemToPush;\r\n\r\n\t\tthis.cmd('SetText', this.leftoverLabelID, '');\r\n\r\n\t\tthis.cmd('CreateLabel', labPushID, 'Pushing Value: ', PUSH_LABEL_X, PUSH_LABEL_Y);\r\n\t\tthis.cmd('CreateLabel', labPushValID, elemToPush, PUSH_ELEMENT_X, PUSH_ELEMENT_Y);\r\n\r\n\t\tthis.cmd('Step');\r\n\t\tthis.cmd('Step');\r\n\t\tthis.cmd('Step');\r\n\t\tthis.cmd('CreateHighlightCircle', this.highlight1ID, '#0000FF', TOP_POS_X, TOP_POS_Y);\r\n\t\tthis.cmd('Step');\r\n\r\n\t\tconst xpos = (this.top % ARRRAY_ELEMS_PER_LINE) * ARRAY_ELEM_WIDTH + ARRAY_START_X;\r\n\t\tconst ypos =\r\n\t\t\tMath.floor(this.top / ARRRAY_ELEMS_PER_LINE) * ARRAY_LINE_SPACING + ARRAY_START_Y;\r\n\r\n\t\tthis.cmd('Move', this.highlight1ID, xpos, ypos + ARRAY_ELEM_HEIGHT);\r\n\t\tthis.cmd('Move', this.highlight1ID, xpos, ypos + ARRAY_ELEM_HEIGHT);\r\n\t\tthis.cmd('Move', this.highlight1ID, xpos, ypos + ARRAY_ELEM_HEIGHT);\r\n\t\tthis.cmd('Step');\r\n\r\n\t\tthis.cmd('Move', labPushValID, xpos, ypos);\r\n\t\tthis.cmd('Step');\r\n\r\n\t\tthis.cmd('Settext', this.arrayID[this.top], elemToPush);\r\n\t\tthis.cmd('Delete', labPushValID);\r\n\r\n\t\tthis.cmd('Delete', this.highlight1ID);\r\n\r\n\t\tthis.cmd('SetHighlight', this.topID, 1);\r\n\t\tthis.cmd('Step');\r\n\t\tthis.top = this.top + 1;\r\n\t\tthis.cmd('SetText', this.topID, this.top);\r\n\t\tthis.cmd('Delete', labPushID);\r\n\t\tthis.cmd('Step');\r\n\t\tthis.cmd('SetHighlight', this.topID, 0);\r\n\r\n\t\treturn this.commands;\r\n\t}\r\n\r\n\tpop() {\r\n\t\tthis.commands = [];\r\n\r\n\t\tconst labPopID = this.nextIndex++;\r\n\t\tconst labPopValID = this.nextIndex++;\r\n\r\n\t\tthis.cmd('SetText', this.leftoverLabelID, '');\r\n\r\n\t\tthis.cmd('CreateLabel', labPopID, 'Popped Value: ', PUSH_LABEL_X, PUSH_LABEL_Y);\r\n\r\n\t\tthis.cmd('SetHighlight', this.topID, 1);\r\n\t\tthis.cmd('Step');\r\n\t\tthis.top = this.top - 1;\r\n\t\tthis.cmd('SetText', this.topID, this.top);\r\n\t\tthis.cmd('Step');\r\n\t\tthis.cmd('SetHighlight', this.topID, 0);\r\n\r\n\t\tthis.cmd('CreateHighlightCircle', this.highlight1ID, '#0000FF', TOP_POS_X, TOP_POS_Y);\r\n\t\tthis.cmd('Step');\r\n\r\n\t\tconst xpos = (this.top % ARRRAY_ELEMS_PER_LINE) * ARRAY_ELEM_WIDTH + ARRAY_START_X;\r\n\t\tconst ypos =\r\n\t\t\tMath.floor(this.top / ARRRAY_ELEMS_PER_LINE) * ARRAY_LINE_SPACING + ARRAY_START_Y;\r\n\r\n\t\tthis.cmd('Move', this.highlight1ID, xpos, ypos + ARRAY_ELEM_HEIGHT);\r\n\t\tthis.cmd('Move', this.highlight1ID, xpos, ypos + ARRAY_ELEM_HEIGHT);\r\n\t\tthis.cmd('Move', this.highlight1ID, xpos, ypos + ARRAY_ELEM_HEIGHT);\r\n\t\tthis.cmd('Step');\r\n\r\n\t\tthis.cmd('CreateLabel', labPopValID, this.arrayData[this.top], xpos, ypos);\r\n\t\tthis.cmd('Settext', this.arrayID[this.top], '');\r\n\t\tthis.cmd('Move', labPopValID, PUSH_ELEMENT_X, PUSH_ELEMENT_Y);\r\n\t\tthis.cmd('Step');\r\n\t\tthis.cmd('Delete', labPopValID);\r\n\t\tthis.cmd('Delete', labPopID);\r\n\t\tthis.cmd('Delete', this.highlight1ID);\r\n\t\tthis.cmd('SetText', this.leftoverLabelID, 'Popped Value: ' + this.arrayData[this.top]);\r\n\r\n\t\treturn this.commands;\r\n\t}\r\n\r\n\tclearAll() {\r\n\t\tthis.commands = [];\r\n\t\tfor (let i = 0; i < this.top; i++) {\r\n\t\t\tthis.cmd('SetText', this.arrayID[i], '');\r\n\t\t}\r\n\t\tthis.top = 0;\r\n\t\tthis.cmd('SetText', this.topID, '0');\r\n\t\treturn this.commands;\r\n\t}\r\n}\r\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\r\n//\r\n// Redistribution and use in source and binary forms, with or without modification, are\r\n// permitted provided that the following conditions are met:\r\n//\r\n// 1. Redistributions of source code must retain the above copyright notice, this list of\r\n// conditions and the following disclaimer.\r\n//\r\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\r\n// of conditions and the following disclaimer in the documentation and/or other materials\r\n// provided with the distribution.\r\n//\r\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\r\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\r\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\r\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\r\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\r\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\r\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\r\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\r\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\r\n//\r\n// The views and conclusions contained in the software and documentation are those of the\r\n// authors and should not be interpreted as representing official policies, either expressed\r\n// or implied, of the University of San Francisco\r\n\r\nimport Algorithm, { addControlToAlgorithmBar } from './Algorithm.js';\r\n\r\nconst LINKED_LIST_START_X = 100;\r\nconst LINKED_LIST_START_Y = 200;\r\nconst LINKED_LIST_ELEM_WIDTH = 70;\r\nconst LINKED_LIST_ELEM_HEIGHT = 30;\r\n\r\nconst LINKED_LIST_INSERT_X = 250;\r\nconst LINKED_LIST_INSERT_Y = 50;\r\n\r\nconst LINKED_LIST_ELEMS_PER_LINE = 8;\r\nconst LINKED_LIST_ELEM_SPACING = 100;\r\nconst LINKED_LIST_LINE_SPACING = 100;\r\n\r\nconst TOP_POS_X = 180;\r\nconst TOP_POS_Y = 100;\r\nconst TOP_LABEL_X = 130;\r\nconst TOP_LABEL_Y = 100;\r\n\r\nconst TOP_ELEM_WIDTH = 30;\r\nconst TOP_ELEM_HEIGHT = 30;\r\n\r\nconst PUSH_LABEL_X = 50;\r\nconst PUSH_LABEL_Y = 30;\r\nconst PUSH_ELEMENT_X = 120;\r\nconst PUSH_ELEMENT_Y = 30;\r\n\r\nconst SIZE = 32;\r\n\r\nexport default class StackLL extends Algorithm {\r\n\tconstructor(am, w, h) {\r\n\t\tsuper(am, w, h);\r\n\r\n\t\tthis.addControls();\r\n\t\tthis.nextIndex = 0;\r\n\t\tthis.commands = [];\r\n\t\tthis.setup();\r\n\t\tthis.initialIndex = this.nextIndex;\r\n\t}\r\n\r\n\taddControls() {\r\n\t\tthis.controls = [];\r\n\t\tthis.pushField = addControlToAlgorithmBar('Text', '');\r\n\t\tthis.pushField.onkeydown = this.returnSubmit(\r\n\t\t\tthis.pushField,\r\n\t\t\tthis.pushCallback.bind(this),\r\n\t\t\t6\r\n\t\t);\r\n\t\tthis.pushButton = addControlToAlgorithmBar('Button', 'Push');\r\n\t\tthis.pushButton.onclick = this.pushCallback.bind(this);\r\n\t\tthis.controls.push(this.pushField);\r\n\t\tthis.controls.push(this.pushButton);\r\n\r\n\t\tthis.popButton = addControlToAlgorithmBar('Button', 'Pop');\r\n\t\tthis.popButton.onclick = this.popCallback.bind(this);\r\n\t\tthis.controls.push(this.popButton);\r\n\r\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear Stack');\r\n\t\tthis.clearButton.onclick = this.clearCallback.bind(this);\r\n\t\tthis.controls.push(this.clearButton);\r\n\t}\r\n\r\n\tenableUI() {\r\n\t\tfor (let i = 0; i < this.controls.length; i++) {\r\n\t\t\tthis.controls[i].disabled = false;\r\n\t\t}\r\n\t}\r\n\r\n\tdisableUI() {\r\n\t\tfor (let i = 0; i < this.controls.length; i++) {\r\n\t\t\tthis.controls[i].disabled = true;\r\n\t\t}\r\n\t}\r\n\r\n\tsetup() {\r\n\t\tthis.linkedListElemID = new Array(SIZE);\r\n\t\tfor (let i = 0; i < SIZE; i++) {\r\n\t\t\tthis.linkedListElemID[i] = this.nextIndex++;\r\n\t\t}\r\n\t\tthis.topID = this.nextIndex++;\r\n\t\tthis.topLabelID = this.nextIndex++;\r\n\r\n\t\tthis.arrayData = new Array(SIZE);\r\n\t\tthis.top = 0;\r\n\t\tthis.leftoverLabelID = this.nextIndex++;\r\n\r\n\t\tthis.cmd('CreateLabel', this.topLabelID, 'Top', TOP_LABEL_X, TOP_LABEL_Y);\r\n\t\tthis.cmd(\r\n\t\t\t'CreateRectangle',\r\n\t\t\tthis.topID,\r\n\t\t\t'',\r\n\t\t\tTOP_ELEM_WIDTH,\r\n\t\t\tTOP_ELEM_HEIGHT,\r\n\t\t\tTOP_POS_X,\r\n\t\t\tTOP_POS_Y\r\n\t\t);\r\n\t\tthis.cmd('SetNull', this.topID, 1);\r\n\r\n\t\tthis.cmd('CreateLabel', this.leftoverLabelID, '', PUSH_LABEL_X, PUSH_LABEL_Y);\r\n\r\n\t\tthis.animationManager.StartNewAnimation(this.commands);\r\n\t\tthis.animationManager.skipForward();\r\n\t\tthis.animationManager.clearHistory();\r\n\t}\r\n\r\n\tresetLinkedListPositions() {\r\n\t\tfor (let i = this.top - 1; i >= 0; i--) {\r\n\t\t\tconst nextX =\r\n\t\t\t\t((this.top - 1 - i) % LINKED_LIST_ELEMS_PER_LINE) * LINKED_LIST_ELEM_SPACING +\r\n\t\t\t\tLINKED_LIST_START_X;\r\n\t\t\tconst nextY =\r\n\t\t\t\tMath.floor((this.top - 1 - i) / LINKED_LIST_ELEMS_PER_LINE) *\r\n\t\t\t\t\tLINKED_LIST_LINE_SPACING +\r\n\t\t\t\tLINKED_LIST_START_Y;\r\n\t\t\tthis.cmd('Move', this.linkedListElemID[i], nextX, nextY);\r\n\t\t}\r\n\t}\r\n\r\n\treset() {\r\n\t\tthis.top = 0;\r\n\t\tthis.nextIndex = this.initialIndex;\r\n\t}\r\n\r\n\tpushCallback() {\r\n\t\tif (this.top < SIZE && this.pushField.value !== '') {\r\n\t\t\tconst pushVal = this.pushField.value;\r\n\t\t\tthis.pushField.value = '';\r\n\t\t\tthis.implementAction(this.push.bind(this), pushVal);\r\n\t\t}\r\n\t}\r\n\r\n\tpopCallback() {\r\n\t\tif (this.top > 0) {\r\n\t\t\tthis.implementAction(this.pop.bind(this), '');\r\n\t\t}\r\n\t}\r\n\r\n\tclearCallback() {\r\n\t\tthis.implementAction(this.clearAll.bind(this), '');\r\n\t}\r\n\r\n\tpush(elemToPush) {\r\n\t\tthis.commands = [];\r\n\r\n\t\tconst labPushID = this.nextIndex++;\r\n\t\tconst labPushValID = this.nextIndex++;\r\n\t\tthis.arrayData[this.top] = elemToPush;\r\n\r\n\t\tthis.cmd('SetText', this.leftoverLabelID, '');\r\n\r\n\t\tthis.cmd(\r\n\t\t\t'CreateLinkedList',\r\n\t\t\tthis.linkedListElemID[this.top],\r\n\t\t\t'',\r\n\t\t\tLINKED_LIST_ELEM_WIDTH,\r\n\t\t\tLINKED_LIST_ELEM_HEIGHT,\r\n\t\t\tLINKED_LIST_INSERT_X,\r\n\t\t\tLINKED_LIST_INSERT_Y,\r\n\t\t\t0.25,\r\n\t\t\t0,\r\n\t\t\t1,\r\n\t\t\t1\r\n\t\t);\r\n\r\n\t\tthis.cmd('CreateLabel', labPushID, 'Pushing Value: ', PUSH_LABEL_X, PUSH_LABEL_Y);\r\n\t\tthis.cmd('CreateLabel', labPushValID, elemToPush, PUSH_ELEMENT_X, PUSH_ELEMENT_Y);\r\n\r\n\t\tthis.cmd('Step');\r\n\r\n\t\tthis.cmd('Move', labPushValID, LINKED_LIST_INSERT_X, LINKED_LIST_INSERT_Y);\r\n\r\n\t\tthis.cmd('Step');\r\n\t\tthis.cmd('SetText', this.linkedListElemID[this.top], elemToPush);\r\n\t\tthis.cmd('Delete', labPushValID);\r\n\r\n\t\tif (this.top === 0) {\r\n\t\t\tthis.cmd('SetNull', this.topID, 0);\r\n\t\t\tthis.cmd('SetNull', this.linkedListElemID[this.top], 1);\r\n\t\t} else {\r\n\t\t\tthis.cmd(\r\n\t\t\t\t'Connect',\r\n\t\t\t\tthis.linkedListElemID[this.top],\r\n\t\t\t\tthis.linkedListElemID[this.top - 1]\r\n\t\t\t);\r\n\t\t\tthis.cmd('Step');\r\n\t\t\tthis.cmd('Disconnect', this.topID, this.linkedListElemID[this.top - 1]);\r\n\t\t}\r\n\t\tthis.cmd('Connect', this.topID, this.linkedListElemID[this.top]);\r\n\r\n\t\tthis.cmd('Step');\r\n\t\tthis.top = this.top + 1;\r\n\t\tthis.resetLinkedListPositions();\r\n\t\tthis.cmd('Delete', labPushID);\r\n\t\tthis.cmd('Step');\r\n\r\n\t\treturn this.commands;\r\n\t}\r\n\r\n\tpop() {\r\n\t\tthis.commands = [];\r\n\r\n\t\tconst labPopID = this.nextIndex++;\r\n\t\tconst labPopValID = this.nextIndex++;\r\n\r\n\t\tthis.cmd('SetText', this.leftoverLabelID, '');\r\n\r\n\t\tthis.cmd('CreateLabel', labPopID, 'Popped Value: ', PUSH_LABEL_X, PUSH_LABEL_Y);\r\n\t\tthis.cmd(\r\n\t\t\t'CreateLabel',\r\n\t\t\tlabPopValID,\r\n\t\t\tthis.arrayData[this.top - 1],\r\n\t\t\tLINKED_LIST_START_X,\r\n\t\t\tLINKED_LIST_START_Y\r\n\t\t);\r\n\r\n\t\tthis.cmd('Move', labPopValID, PUSH_ELEMENT_X, PUSH_ELEMENT_Y);\r\n\t\tthis.cmd('Step');\r\n\t\tthis.cmd('Disconnect', this.topID, this.linkedListElemID[this.top - 1]);\r\n\r\n\t\tif (this.top === 1) {\r\n\t\t\tthis.cmd('SetNull', this.topID, 1);\r\n\t\t} else {\r\n\t\t\tthis.cmd('Connect', this.topID, this.linkedListElemID[this.top - 2]);\r\n\t\t}\r\n\t\tthis.cmd('Step');\r\n\t\tthis.cmd('Delete', this.linkedListElemID[this.top - 1]);\r\n\t\tthis.top = this.top - 1;\r\n\t\tthis.resetLinkedListPositions();\r\n\r\n\t\tthis.cmd('Delete', labPopValID);\r\n\t\tthis.cmd('Delete', labPopID);\r\n\t\tthis.cmd('SetText', this.leftoverLabelID, 'Popped Value: ' + this.arrayData[this.top]);\r\n\r\n\t\treturn this.commands;\r\n\t}\r\n\r\n\tclearAll() {\r\n\t\tthis.commands = [];\r\n\t\tfor (let i = 0; i < this.top; i++) {\r\n\t\t\tthis.cmd('Delete', this.linkedListElemID[i]);\r\n\t\t}\r\n\t\tthis.top = 0;\r\n\t\tthis.cmd('SetNull', this.topID, 1);\r\n\t\treturn this.commands;\r\n\t}\r\n}\r\n","import React from 'react';\r\n\r\nexport const modals = {\r\n\tAVL: (\r\n\t\t<ul>\r\n\t\t\t<li>To cause a left rotation, add 1, 2 and 3, in that order</li>\r\n\t\t\t<li>To cause a right rotation, add 3, 2 and 1, in that order</li>\r\n\t\t\t<li>To cause a left-right rotation, add 3, 1 and 2, in that order</li>\r\n\t\t\t<li>To cause a right-left rotation, add 1, 3 and 2, in that order</li>\r\n\t\t</ul>\r\n\t),\r\n\tBoyerMoore: (\r\n\t\t<ul>\r\n\t\t\t<li>\r\n\t\t\t\tThe worst case is when we have a text with only one letter and a pattern with that\r\n\t\t\t\tsame letter, but a different first letter (for example, &quot;aaaaaaaaa&quot; for\r\n\t\t\t\ttext and &quot;baaaa&quot; for pattern), since we will only mismatch on the last\r\n\t\t\t\tcomparison\r\n\t\t\t</li>\r\n\t\t</ul>\r\n\t),\r\n\tBruteForce: (\r\n\t\t<ul>\r\n\t\t\t<li>\r\n\t\t\t\tThe worst case is when we have a text with only one letter and a pattern with that\r\n\t\t\t\tsame letter, but a different last letter (for example, &quot;aaaaaaaaa&quot; for\r\n\t\t\t\ttext and &quot;aaaab&quot; for pattern), since we will only mismatch on the last\r\n\t\t\t\tcomparison\r\n\t\t\t</li>\r\n\t\t</ul>\r\n\t),\r\n\tBST: (\r\n\t\t<ul>\r\n\t\t\t<li>To get a degenerate BST, you can add ascending data, such as 1, 2, 3, ...</li>\r\n\t\t\t<li>To get a full BST, you can add 2, 1, 4, 3, 5, in that order</li>\r\n\t\t\t<li>To get a complete BST, you can add 3, 2, 4, 1, in that order</li>\r\n\t\t\t<li>To get a full and complete BST, you can add 4, 2, 5, 1, 3, in that order</li>\r\n\t\t</ul>\r\n\t),\r\n\tBTree: (\r\n\t\t<ul>\r\n\t\t\t<li>\r\n\t\t\t\tTo cause overflow and trigger a promotion, add more than 3 data (for example 1, 2, 3\r\n\t\t\t\tand 4)\r\n\t\t\t</li>\r\n\t\t\t<li>\r\n\t\t\t\tTo remove from a leaf node, add 1, 2, 3 and 4, in that order, then remove 3 or 4\r\n\t\t\t</li>\r\n\t\t\t<li>\r\n\t\t\t\tTo remove from an inner node and use the predecessor, add 1, 3, 4, 5 and 2, in that\r\n\t\t\t\torder, then remove 3\r\n\t\t\t</li>\r\n\t\t\t<li>\r\n\t\t\t\tTo cause underflow and trigger a rotation/transfer, add 1, 2, 3 and 4, in that\r\n\t\t\t\torder, then remove 1\r\n\t\t\t</li>\r\n\t\t\t<li>To cause underflow and trigger a fusion, follow the steps above then remove 2</li>\r\n\t\t</ul>\r\n\t),\r\n\tBubbleSort: (\r\n\t\t<ul>\r\n\t\t\t<li>The best case is when we have a sorted array (terminates if no swaps are made)</li>\r\n\t\t\t<li>\r\n\t\t\t\tThe worst case is when we have a reverse sorted array (we perform\r\n\t\t\t\t<p className=\"equation\" style={{ marginTop: '-5px' }}>\r\n\t\t\t\t\tn + (n - 1) + (n - 2) + ... = n<sup>2</sup>\r\n\t\t\t\t</p>\r\n\t\t\t\tcomparisons)\r\n\t\t\t</li>\r\n\t\t</ul>\r\n\t),\r\n\tCocktailSort: (\r\n\t\t<ul>\r\n\t\t\t<li>The best case is when we have a sorted array (terminates if no swaps are made)</li>\r\n\t\t\t<li>\r\n\t\t\t\tThe worst case is when we have a reverse sorted array (we perform\r\n\t\t\t\t<p className=\"equation\" style={{ marginTop: '-5px' }}>\r\n\t\t\t\t\tn + (n - 1) + (n - 2) + ... = n<sup>2</sup>\r\n\t\t\t\t</p>\r\n\t\t\t\tcomparisons)\r\n\t\t\t</li>\r\n\t\t\t<li>\r\n\t\t\t\tEven though Cocktail Shaker Sort has the same big-O as Bubble Sort, it is still\r\n\t\t\t\tfaster; one case where it significantly outperforms Bubble Sort is when we have a\r\n\t\t\t\tsorted array, except for the last element which is the smallest, for example [2, 3,\r\n\t\t\t\t4, 5, 6, 7, 8, 9, 1]\r\n\t\t\t</li>\r\n\t\t</ul>\r\n\t),\r\n\tInsertionSort: (\r\n\t\t<ul>\r\n\t\t\t<li>The best case is when we have a sorted array (terminates if no swaps are made)</li>\r\n\t\t\t<li>\r\n\t\t\t\tThe worst case is when we have a reverse sorted array (we perform\r\n\t\t\t\t<p className=\"equation\" style={{ marginTop: '-5px' }}>\r\n\t\t\t\t\tn + (n - 1) + (n - 2) + ... = n<sup>2</sup>\r\n\t\t\t\t</p>\r\n\t\t\t\tcomparisons)\r\n\t\t\t</li>\r\n\t\t</ul>\r\n\t),\r\n\tQuickSelect: (\r\n\t\t<ul>\r\n\t\t\t<li>\r\n\t\t\t\tThe worst case occurs when we pick a bad pivot everytime (for example, the smallest\r\n\t\t\t\tor largest element), since we can no longer subvide the array\r\n\t\t\t</li>\r\n\t\t</ul>\r\n\t),\r\n\tQuickSort: (\r\n\t\t<ul>\r\n\t\t\t<li>\r\n\t\t\t\tThe worst case occurs when we pick a bad pivot everytime (for example, the smallest\r\n\t\t\t\tor largest element), since we can no longer subvide the array and the algorithms\r\n\t\t\t\tbecomes similar to Selection Sort\r\n\t\t\t</li>\r\n\t\t</ul>\r\n\t),\r\n\tSkipList: (\r\n\t\t<ul>\r\n\t\t\t<li>\r\n\t\t\t\tYou can get a degenerate SkipList by always adding with a constant amount of heads\r\n\t\t\t\t(for example 0 or 4)\r\n\t\t\t</li>\r\n\t\t</ul>\r\n\t),\r\n};\r\n\r\nexport const hasModal = name => Object.keys(modals).includes(name);\r\n","export default class SingleAnimation {\r\n\tconstructor(id, fromX, fromY, toX, toY) {\r\n\t\tthis.objectID = id;\r\n\t\tthis.fromX = fromX;\r\n\t\tthis.fromY = fromY;\r\n\t\tthis.toX = toX;\r\n\t\tthis.toY = toY;\r\n\t}\r\n}\r\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\r\n//\r\n// Redistribution and use in source and binary forms, with or without modification, are\r\n// permitted provided that the following conditions are met:\r\n//\r\n// 1. Redistributions of source code must retain the above copyright notice, this list of\r\n// conditions and the following disclaimer.\r\n//\r\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\r\n// of conditions and the following disclaimer in the documentation and/or other materials\r\n// provided with the distribution.\r\n//\r\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\r\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\r\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\r\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\r\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\r\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\r\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\r\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\r\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\r\n//\r\n// The views and conclusions contained in the software and documentation are those of the\r\n// authors and should not be interpreted as representing official policies, either expressed\r\n// or implied, of the University of San Francisco\r\n\r\n// Base \"class\": UndoBlock\r\n\r\nimport SingleAnimation from './SingleAnimation';\r\n\r\nexport class UndoBlock {\r\n\t// eslint-disable-next-line no-unused-vars\r\n\taddUndoAnimation(animationList) {\r\n\t\treturn false;\r\n\t}\r\n\r\n\t// eslint-disable-next-line no-unused-vars\r\n\tundoInitialStep(world) {}\r\n}\r\n\r\n////////////////////////////////////////////////////////////\r\n// UndoMove\r\n////////////////////////////////////////////////////////////\r\n\r\nexport class UndoMove extends UndoBlock {\r\n\tconstructor(id, fmX, fmy, tx, ty) {\r\n\t\tsuper();\r\n\t\tthis.objectID = id;\r\n\t\tthis.fromX = fmX;\r\n\t\tthis.fromY = fmy;\r\n\t\tthis.toX = tx;\r\n\t\tthis.toY = ty;\r\n\t}\r\n\r\n\taddUndoAnimation(animationList) {\r\n\t\tconst nextAnim = new SingleAnimation(\r\n\t\t\tthis.objectID,\r\n\t\t\tthis.fromX,\r\n\t\t\tthis.fromY,\r\n\t\t\tthis.toX,\r\n\t\t\tthis.toY\r\n\t\t);\r\n\t\tanimationList.push(nextAnim);\r\n\t\treturn true;\r\n\t}\r\n}\r\n\r\n////////////////////////////////////////////////////////////\r\n// UndoCreate\r\n////////////////////////////////////////////////////////////\r\n\r\nexport class UndoCreate extends UndoBlock {\r\n\tconstructor(id) {\r\n\t\tsuper();\r\n\t\tthis.objectID = id;\r\n\t}\r\n\r\n\tundoInitialStep(world) {\r\n\t\tworld.removeObject(this.objectID);\r\n\t}\r\n}\r\n\r\n////////////////////////////////////////////////////////////\r\n// UndoHighlight\r\n////////////////////////////////////////////////////////////\r\n\r\nexport class UndoHighlight extends UndoBlock {\r\n\tconstructor(id, val) {\r\n\t\tsuper();\r\n\t\tthis.objectID = id;\r\n\t\tthis.highlightValue = val;\r\n\t}\r\n\r\n\tundoInitialStep(world) {\r\n\t\tworld.setHighlight(this.objectID, this.highlightValue);\r\n\t}\r\n}\r\n\r\n////////////////////////////////////////////////////////////\r\n// UndoSetHeight\r\n////////////////////////////////////////////////////////////\r\n\r\nexport class UndoSetHeight extends UndoBlock {\r\n\tconstructor(id, val) {\r\n\t\tsuper();\r\n\t\tthis.objectID = id;\r\n\t\tthis.height = val;\r\n\t}\r\n\r\n\tundoInitialStep(world) {\r\n\t\tworld.setHeight(this.objectID, this.height);\r\n\t}\r\n}\r\n\r\n////////////////////////////////////////////////////////////\r\n// UndoSetWidth\r\n////////////////////////////////////////////////////////////\r\n\r\nexport class UndoSetWidth extends UndoBlock {\r\n\tconstructor(id, val) {\r\n\t\tsuper();\r\n\t\tthis.objectID = id;\r\n\t\tthis.width = val;\r\n\t}\r\n\r\n\tundoInitialStep(world) {\r\n\t\tworld.setWidth(this.objectID, this.width);\r\n\t}\r\n}\r\n\r\n////////////////////////////////////////////////////////////\r\n// UndoSetNumElements\r\n////////////////////////////////////////////////////////////\r\nexport class UndoSetNumElements extends UndoBlock {\r\n\tconstructor(obj, newNumElems) {\r\n\t\tsuper();\r\n\t\tthis.objectID = obj.objectID;\r\n\t\tthis.sizeBeforeChange = obj.getNumElements();\r\n\t\tthis.sizeAfterChange = newNumElems;\r\n\t\tif (this.sizeBeforeChange > this.sizeAfterChange) {\r\n\t\t\tthis.labels = new Array(this.sizeBeforeChange - this.sizeAfterChange);\r\n\t\t\tthis.colors = new Array(this.sizeBeforeChange - this.sizeAfterChange);\r\n\t\t\tfor (let i = 0; i < this.sizeBeforeChange - this.sizeAfterChange; i++) {\r\n\t\t\t\tthis.labels[i] = obj.getText(i + this.sizeAfterChange);\r\n\t\t\t\tthis.colors[i] = obj.getTextColor(i + this.sizeAfterChange);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tundoInitialStep(world) {\r\n\t\tworld.setNumElements(this.objectID, this.sizeBeforeChange);\r\n\t\tif (this.sizeBeforeChange > this.sizeAfterChange) {\r\n\t\t\tfor (let i = 0; i < this.sizeBeforeChange - this.sizeAfterChange; i++) {\r\n\t\t\t\tworld.setText(this.objectID, this.labels[i], i + this.sizeAfterChange);\r\n\t\t\t\tworld.setTextColor(this.objectID, this.colors[i], i + this.sizeAfterChange);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\n////////////////////////////////////////////////////////////\r\n// UndoSetAlpha\r\n////////////////////////////////////////////////////////////\r\n\r\nexport class UndoSetAlpha extends UndoBlock {\r\n\tconstructor(id, alph) {\r\n\t\tsuper();\r\n\t\tthis.objectID = id;\r\n\t\tthis.alphaVal = alph;\r\n\t}\r\n\r\n\tundoInitialStep(world) {\r\n\t\tworld.setAlpha(this.objectID, this.alphaVal);\r\n\t}\r\n}\r\n\r\n////////////////////////////////////////////////////////////\r\n// UndoSetNull\r\n////////////////////////////////////////////////////////////\r\n\r\nexport class UndoSetNull extends UndoBlock {\r\n\tconstructor(id, nv) {\r\n\t\tsuper();\r\n\t\tthis.objectID = id;\r\n\t\tthis.nullVal = nv;\r\n\t}\r\n\r\n\tundoInitialStep(world) {\r\n\t\tworld.setNull(this.objectID, this.nullVal);\r\n\t}\r\n}\r\n\r\n////////////////////////////////////////////////////////////\r\n// UndoSetPrevNull\r\n////////////////////////////////////////////////////////////\r\n\r\nexport class UndoSetPrevNull extends UndoBlock {\r\n\tconstructor(id, nv) {\r\n\t\tsuper();\r\n\t\tthis.objectID = id;\r\n\t\tthis.nullVal = nv;\r\n\t}\r\n\r\n\tundoInitialStep(world) {\r\n\t\tworld.SetPrevNull(this.objectID, this.nullVal);\r\n\t}\r\n}\r\n\r\n////////////////////////////////////////////////////////////\r\n// UndoSetNextNull\r\n////////////////////////////////////////////////////////////\r\n\r\nexport class UndoSetNextNull extends UndoBlock {\r\n\tconstructor(id, nv) {\r\n\t\tsuper();\r\n\t\tthis.objectID = id;\r\n\t\tthis.nullVal = nv;\r\n\t}\r\n\r\n\tundoInitialStep(world) {\r\n\t\tworld.SetNextNull(this.objectID, this.nullVal);\r\n\t}\r\n}\r\n\r\n////////////////////////////////////////////////////////////\r\n// UndoSetForegroundColor\r\n////////////////////////////////////////////////////////////\r\n\r\nexport class UndoSetForegroundColor extends UndoBlock {\r\n\tconstructor(id, color) {\r\n\t\tsuper();\r\n\t\tthis.objectID = id;\r\n\t\tthis.color = color;\r\n\t}\r\n\r\n\tundoInitialStep(world) {\r\n\t\tworld.setForegroundColor(this.objectID, this.color);\r\n\t}\r\n}\r\n\r\n////////////////////////////////////////////////////////////\r\n// UndoSetBackgroundColor\r\n////////////////////////////////////////////////////////////\r\n\r\nexport class UndoSetBackgroundColor extends UndoBlock {\r\n\tconstructor(id, color) {\r\n\t\tsuper();\r\n\t\tthis.objectID = id;\r\n\t\tthis.color = color;\r\n\t}\r\n\r\n\tundoInitialStep(world) {\r\n\t\tworld.setBackgroundColor(this.objectID, this.color);\r\n\t}\r\n}\r\n\r\n////////////////////////////////////////////////////////////\r\n// UndoSetHighlightIndex\r\n////////////////////////////////////////////////////////////\r\n\r\nexport class UndoSetHighlightIndex extends UndoBlock {\r\n\tconstructor(id, index) {\r\n\t\tsuper();\r\n\t\tthis.objectID = id;\r\n\t\tthis.index = index;\r\n\t}\r\n\r\n\tundoInitialStep(world) {\r\n\t\tworld.setHighlightIndex(this.objectID, this.index);\r\n\t}\r\n}\r\n\r\n////////////////////////////////////////////////////////////\r\n// UndoSetText\r\n////////////////////////////////////////////////////////////\r\n\r\nexport class UndoSetText extends UndoBlock {\r\n\tconstructor(id, str, index) {\r\n\t\tsuper();\r\n\t\tthis.objectID = id;\r\n\t\tthis.newText = str;\r\n\t\tthis.labelIndex = index;\r\n\t}\r\n\r\n\tundoInitialStep(world) {\r\n\t\tworld.setText(this.objectID, this.newText, this.labelIndex);\r\n\t}\r\n}\r\n////////////////////////////////////////////////////////////\r\n// UndoSetTextColor\r\n////////////////////////////////////////////////////////////\r\n\r\nexport class UndoSetTextColor extends UndoBlock {\r\n\tconstructor(id, color, index) {\r\n\t\tsuper();\r\n\t\tthis.objectID = id;\r\n\t\tthis.color = color;\r\n\t\tthis.index = index;\r\n\t}\r\n\r\n\tundoInitialStep(world) {\r\n\t\tworld.setTextColor(this.objectID, this.color, this.index);\r\n\t}\r\n}\r\n\r\n////////////////////////////////////////////////////////////\r\n// UndoHighlightEdge\r\n////////////////////////////////////////////////////////////\r\n\r\nexport class UndoHighlightEdge extends UndoBlock {\r\n\tconstructor(from, to, val) {\r\n\t\tsuper();\r\n\t\tthis.fromID = from;\r\n\t\tthis.toID = to;\r\n\t\tthis.highlightValue = val;\r\n\t}\r\n\r\n\tundoInitialStep(world) {\r\n\t\tworld.setEdgeHighlight(this.fromID, this.toID, this.highlightValue);\r\n\t}\r\n}\r\n\r\n////////////////////////////////////////////////////////////\r\n// UndoSetEdgeColor\r\n////////////////////////////////////////////////////////////\r\n\r\nexport class UndoSetEdgeColor extends UndoBlock {\r\n\tconstructor(from, to, oldColor) {\r\n\t\tsuper();\r\n\t\tthis.fromID = from;\r\n\t\tthis.toID = to;\r\n\t\tthis.color = oldColor;\r\n\t}\r\n\r\n\tundoInitialStep(world) {\r\n\t\tworld.setEdgeColor(this.fromID, this.toID, this.color);\r\n\t}\r\n}\r\n\r\n////////////////////////////////////////////////////////////\r\n// UndoSetEdgeAlpha\r\n////////////////////////////////////////////////////////////\r\n\r\nexport class UndoSetEdgeAlpha extends UndoBlock {\r\n\tconstructor(from, to, oldAplha) {\r\n\t\tsuper();\r\n\t\tthis.fromID = from;\r\n\t\tthis.toID = to;\r\n\t\tthis.alpha = oldAplha;\r\n\t}\r\n\r\n\tundoInitialStep(world) {\r\n\t\tworld.setEdgeAlpha(this.fromID, this.toID, this.alpha);\r\n\t}\r\n}\r\n\r\n////////////////////////////////////////////////////////////\r\n// UndoSetPosition\r\n////////////////////////////////////////////////////////////\r\n\r\nexport class UndoSetPosition extends UndoBlock {\r\n\tconstructor(id, x, y) {\r\n\t\tsuper();\r\n\t\tthis.objectID = id;\r\n\t\tthis.x = x;\r\n\t\tthis.y = y;\r\n\t}\r\n\r\n\tundoInitialStep(world) {\r\n\t\tworld.setNodePosition(this.objectID, this.x, this.y);\r\n\t}\r\n}\r\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\r\n//\r\n// Redistribution and use in source and binary forms, with or without modification, are\r\n// permitted provided that the following conditions are met:\r\n//\r\n// 1. Redistributions of source code must retain the above copyright notice, this list of\r\n// conditions and the following disclaimer.\r\n//\r\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\r\n// of conditions and the following disclaimer in the documentation and/or other materials\r\n// provided with the distribution.\r\n//\r\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\r\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\r\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\r\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\r\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\r\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\r\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\r\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\r\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\r\n//\r\n// The views and conclusions contained in the software and documentation are those of the\r\n// authors and should not be interpreted as representing official policies, either expressed\r\n// or implied, of the University of San Francisco\r\n\r\n// bind() {\r\n// \tvar _function = this;\r\n\r\n// \tvar args = Array.prototype.slice.call(arguments);\r\n// \tvar scope = args.shift()\r\n// \treturn function() {\r\n// \t\tfor (let i = 0; i < arguments.length; i++)\r\n// \t\t{\r\n// \t\t\targs.push(arguments[i]);\r\n// \t\t}\r\n// \t\treturn _function.apply(scope, args);\r\n// \t}\r\n// }\r\n\r\nexport default class EventListener {\r\n\tconstructor() {\r\n\t\tthis.events = [];\r\n\t}\r\n\r\n\tremoveListener(kind, scope, func) {\r\n\t\tif (this.events[kind] == null) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tlet scopeFunctions = null;\r\n\t\tlet i;\r\n\t\tfor (i = 0; i < this.events[kind].length; i++) {\r\n\t\t\tif (this.events[kind][i].scope === scope) {\r\n\t\t\t\tscopeFunctions = this.events[kind][i];\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (scopeFunctions == null) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tfor (i = 0; i < scopeFunctions.functions.length; i++) {\r\n\t\t\tif (scopeFunctions.functions[i] === func) {\r\n\t\t\t\tscopeFunctions.functions.splice(i, 1);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\taddListener(kind, scope, func) {\r\n\t\tif (this.events[kind] === undefined) {\r\n\t\t\tthis.events[kind] = [];\r\n\t\t}\r\n\t\tlet i;\r\n\t\tlet scopeFunctions = null;\r\n\t\tfor (i = 0; i < this.events[kind].length; i++) {\r\n\t\t\tif (this.events[kind][i].scope === scope) {\r\n\t\t\t\tscopeFunctions = this.events[kind][i];\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (scopeFunctions === null) {\r\n\t\t\tthis.events[kind].push({ scope: scope, functions: [] });\r\n\t\t\tscopeFunctions = this.events[kind][this.events[kind].length - 1];\r\n\t\t}\r\n\t\tfor (i = 0; i < scopeFunctions.functions.length; i++) {\r\n\t\t\tif (scopeFunctions.functions[i] === func) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t}\r\n\t\tscopeFunctions.functions.push(func);\r\n\t}\r\n\r\n\tfireEvent(kind, event) {\r\n\t\t// TODO:  Should add a deep clone here ...\r\n\t\tif (this.events[kind] !== undefined) {\r\n\t\t\tfor (let i = 0; i < this.events[kind].length; i++) {\r\n\t\t\t\tconst objects = this.events[kind][i];\r\n\t\t\t\tconst functs = objects.functions;\r\n\t\t\t\tconst scope = objects.scope;\r\n\t\t\t\tfor (let j = 0; j < functs.length; j++) {\r\n\t\t\t\t\tconst func = functs[j];\r\n\t\t\t\t\tfunc.call(scope, event);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\r\n//\r\n// Redistribution and use in source and binary forms, with or without modification, are\r\n// permitted provided that the following conditions are met:\r\n//\r\n// 1. Redistributions of source code must retain the above copyright notice, this list of\r\n// conditions and the following disclaimer.\r\n//\r\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\r\n// of conditions and the following disclaimer in the documentation and/or other materials\r\n// provided with the distribution.\r\n//\r\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\r\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\r\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\r\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\r\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\r\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\r\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\r\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\r\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\r\n//\r\n// The views and conclusions contained in the software and documentation are those of the\r\n// authors and should not be interpreted as representing official policies, either expressed\r\n// or implied, of the University of San Francisco\r\n\r\nexport default class AnimatedObject {\r\n\tconstructor() {\r\n\t\tthis.backgroundColor = '#FFFFFF';\r\n\t\tthis.foregroundColor = '#000000';\r\n\t\tthis.highlighted = false;\r\n\t\tthis.objectID = -1;\r\n\t\tthis.layer = 0;\r\n\t\tthis.addedToScene = true;\r\n\t\tthis.label = '';\r\n\t\tthis.labelColor = '#000000';\r\n\t\tthis.alpha = 1.0;\r\n\t\tthis.x = 0;\r\n\t\tthis.y = 0;\r\n\t\tthis.minHeightDiff = 3;\r\n\t\tthis.range = 5;\r\n\t\tthis.highlightIndex = -1;\r\n\t\tthis.highlightIndexDirty = true;\r\n\t\tthis.alwaysOnTop = false;\r\n\t}\r\n\r\n\tsetBackgroundColor(newColor) {\r\n\t\tthis.backgroundColor = newColor;\r\n\t}\r\n\r\n\t// setForegroundColor(newColor) {\r\n\t// \tthis.foregroundColor = newColor;\r\n\t// }\r\n\r\n\tsetNull() {}\r\n\r\n\tgetNull() {\r\n\t\treturn false;\r\n\t}\r\n\r\n\tsetAlpha(newAlpha) {\r\n\t\tthis.alpha = newAlpha;\r\n\t}\r\n\r\n\tgetAlpha() {\r\n\t\treturn this.alpha;\r\n\t}\r\n\r\n\tsetForegroundColor(newColor) {\r\n\t\tthis.foregroundColor = newColor;\r\n\t\tthis.labelColor = newColor;\r\n\t}\r\n\r\n\tgetHighlight() {\r\n\t\treturn this.highlighted;\r\n\t}\r\n\r\n\tgetWidth() {\r\n\t\t// TODO:  Do we want to throw here?  Should always override this ...\r\n\t\treturn 0;\r\n\t}\r\n\r\n\tgetHeight() {\r\n\t\t// TODO:  Do we want to throw here?  Should always override this ...\r\n\t\treturn 0;\r\n\t}\r\n\r\n\tsetHighlight(value, color) {\r\n\t\tthis.highlighted = value;\r\n\t\tthis.highlightColor = color == null ? '#ff0000' : color;\r\n\t}\r\n\r\n\tcenterX() {\r\n\t\treturn this.x;\r\n\t}\r\n\r\n\tsetWidth() {\r\n\t\tthrow new Error('setWidth() should be implemented in a base class');\r\n\t}\r\n\r\n\tcenterY() {\r\n\t\treturn this.y;\r\n\t}\r\n\r\n\tgetAlignLeftPos(otherObject) {\r\n\t\treturn [otherObject.right() + this.getWidth() / 2, otherObject.centerY()];\r\n\t}\r\n\r\n\tgetAlignRightPos(otherObject) {\r\n\t\treturn [otherObject.left() - this.getWidth() / 2, otherObject.centerY()];\r\n\t}\r\n\r\n\tgetAlignTopPos(otherObject) {\r\n\t\treturn [otherObject.centerX(), otherObject.top() - this.getHeight() / 2];\r\n\t}\r\n\r\n\tgetAlignBottomPos(otherObject) {\r\n\t\treturn [otherObject.centerX(), otherObject.bottom() + this.getHeight() / 2];\r\n\t}\r\n\r\n\talignLeft(otherObject) {\r\n\t\t// Assuming centering.  Overridden method could modify if not centered\r\n\t\t//  (See AnimatedLabel, for instance)\r\n\t\tthis.y = otherObject.centerY();\r\n\t\tthis.x = otherObject.right() + this.getWidth() / 2;\r\n\t}\r\n\r\n\talignRight(otherObject) {\r\n\t\t// Assuming centering.  Overridden method could modify if not centered\r\n\t\t//  (See AnimatedLabel, for instance)\r\n\t\tthis.y = otherObject.centerY();\r\n\t\tthis.x = otherObject.left() - this.getWidth() / 2;\r\n\t}\r\n\r\n\talignTop(otherObject) {\r\n\t\t// Assuming centering.  Overridden method could modify if not centered\r\n\r\n\t\tthis.x = otherObject.centerX();\r\n\t\tthis.y = otherObject.top() - this.getHeight() / 2;\r\n\t}\r\n\r\n\talignBottom(otherObject) {\r\n\t\tthis.x = otherObject.centerX();\r\n\t\tthis.y = otherObject.bottom() + this.getHeight() / 2;\r\n\t}\r\n\r\n\t/* TODO:  Do we need these in the base? \t\t\r\n\t\tfunction left(): Number\r\n\t\t{\r\n\t\t\treturn x - getWidth() / 2;\r\n\t\t}\r\n\t\t\r\n\t\tfunction right():Number\r\n\t\t{\r\n\t\t\treturn x + getWidth() / 2;\r\n\t\t}\r\n\t\t\r\n\t\tfunction top():Number\r\n\t\t{\r\n\t\t\treturn y - getHeight() / 2;\r\n\t\t}\r\n\t\t\r\n\t\tfunction bottom():Number\r\n\t\t{\r\n\t\t\treturn y + getHeight() / 2;\r\n\t\t}\r\n\t\t\r\n\t\tfunction centerX():Number\r\n\t\t{\r\n\t\t\treturn x;\r\n\t\t}\r\n\t\t\r\n\t\tfunction centerY():Number\r\n\t\t{\r\n\t\t\treturn y;\r\n\t\t}\r\n\t\t*/\r\n\r\n\tgetClosestCardinalPoint(fromX, fromY) {\r\n\t\tlet xDelta;\r\n\t\tlet yDelta;\r\n\t\tlet xPos;\r\n\t\tlet yPos;\r\n\r\n\t\tif (fromX < this.left()) {\r\n\t\t\txDelta = this.left() - fromX;\r\n\t\t\txPos = this.left();\r\n\t\t} else if (fromX > this.right()) {\r\n\t\t\txDelta = fromX - this.right();\r\n\t\t\txPos = this.right();\r\n\t\t} else {\r\n\t\t\txDelta = 0;\r\n\t\t\txPos = this.centerX();\r\n\t\t}\r\n\r\n\t\tif (fromY < this.top()) {\r\n\t\t\tyDelta = this.top() - fromY;\r\n\t\t\tyPos = this.top();\r\n\t\t} else if (fromY > this.bottom()) {\r\n\t\t\tyDelta = fromY - this.bottom();\r\n\t\t\tyPos = this.bottom();\r\n\t\t} else {\r\n\t\t\tyDelta = 0;\r\n\t\t\tyPos = this.centerY();\r\n\t\t}\r\n\r\n\t\tif (yDelta > xDelta) {\r\n\t\t\txPos = this.centerX();\r\n\t\t} else {\r\n\t\t\tyPos = this.centerY();\r\n\t\t}\r\n\r\n\t\treturn [xPos, yPos];\r\n\t}\r\n\r\n\tcentered() {\r\n\t\treturn false;\r\n\t}\r\n\r\n\tpulseHighlight(frameNum) {\r\n\t\tif (this.highlighted) {\r\n\t\t\tconst frameMod = frameNum / 7.0;\r\n\t\t\tconst delta = Math.abs((frameMod % (2 * this.range - 2)) - this.range + 1);\r\n\t\t\tthis.highlightDiff = delta + this.minHeightDiff;\r\n\t\t}\r\n\t}\r\n\r\n\t// eslint-disable-next-line no-unused-vars\r\n\tgetTailPointerAttachPos(fromX, fromY, anchorPoint) {\r\n\t\treturn [this.x, this.y];\r\n\t}\r\n\r\n\t// eslint-disable-next-line no-unused-vars\r\n\tgetHeadPointerAttachPos(fromX, fromY) {\r\n\t\treturn [this.x, this.y];\r\n\t}\r\n\r\n\t/*public function createUndoDelete() : UndoBlock\r\n{\r\n\t\t\t// Must be overriden!\r\n\t\t\treturn null;\r\n}\r\n*/\r\n\r\n\tidentifier() {\r\n\t\treturn this.objectID;\r\n\t}\r\n\r\n\t// eslint-disable-next-line no-unused-vars\r\n\tgetText(index) {\r\n\t\treturn this.label;\r\n\t}\r\n\r\n\t// eslint-disable-next-line no-unused-vars\r\n\tgetTextColor(textIndex) {\r\n\t\treturn this.labelColor;\r\n\t}\r\n\r\n\t// eslint-disable-next-line no-unused-vars\r\n\tsetTextColor(color, textIndex) {\r\n\t\tthis.labelColor = color;\r\n\t}\r\n\r\n\t// eslint-disable-next-line no-unused-vars\r\n\tsetText(newText, textIndex) {\r\n\t\tthis.label = newText;\r\n\t}\r\n\r\n\tsetHighlightIndex(hlIndex) {\r\n\t\tthis.highlightIndex = hlIndex;\r\n\t\tthis.highlightIndexDirty = true;\r\n\t}\r\n\r\n\tgetHighlightIndex() {\r\n\t\treturn this.highlightIndex;\r\n\t}\r\n}\r\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\r\n//\r\n// Redistribution and use in source and binary forms, with or without modification, are\r\n// permitted provided that the following conditions are met:\r\n//\r\n// 1. Redistributions of source code must retain the above copyright notice, this list of\r\n// conditions and the following disclaimer.\r\n//\r\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\r\n// of conditions and the following disclaimer in the documentation and/or other materials\r\n// provided with the distribution.\r\n//\r\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\r\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\r\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\r\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\r\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\r\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\r\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\r\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\r\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\r\n//\r\n// The views and conclusions contained in the software and documentation are those of the\r\n// authors and should not be interpreted as representing official policies, either expressed\r\n// or implied, of the University of San Francisco\r\n\r\nimport AnimatedObject from \"./AnimatedObject.js\";\r\nimport { UndoBlock } from \"./UndoFunctions.js\";\r\n\r\nexport default class AnimatedBTreeNode extends AnimatedObject {\r\n\tconstructor(id, widthPerElem, h, numElems, fillColor, edgeColor) {\r\n\t\tsuper();\r\n\t\tfillColor = fillColor == null ? \"#FFFFFF\" : fillColor;\r\n\t\tedgeColor = edgeColor == null ? \"#000000\" : edgeColor;\r\n\t\tthis.objectID = id;\r\n\r\n\t\tthis.backgroundColor = fillColor;\r\n\t\tthis.foregroundColor = edgeColor;\r\n\r\n\t\tthis.widthPerElement = widthPerElem;\r\n\t\tthis.nodeHeight = h;\r\n\t\tthis.numLabels = numElems;\r\n\t\tthis.labels = new Array(this.numLabels);\r\n\t\tthis.labelColors = new Array(this.numLabels);\r\n\t\tfor (let i = 0; i < this.numLabels; i++) {\r\n\t\t\tthis.labelColors[i] = this.foregroundColor;\r\n\t\t}\r\n\r\n\t\tthis.MIN_WIDTH = 10;\r\n\t\tthis.EDGE_POINTER_DISPLACEMENT = 5;\r\n\t}\r\n\r\n\tgetNumElements() {\r\n\t\treturn this.numLabels;\r\n\t}\r\n\r\n\tgetWidth() {\r\n\t\tif (this.numLabels > 0) {\r\n\t\t\treturn this.widthPerElement * this.numLabels;\r\n\t\t} else {\r\n\t\t\treturn this.MIN_WIDTH;\r\n\t\t}\r\n\t}\r\n\r\n\tsetNumElements(newNumElements) {\r\n\t\tlet i;\r\n\t\tif (this.numLabels < newNumElements) {\r\n\t\t\tfor (i = this.numLabels; i < newNumElements; i++) {\r\n\t\t\t\tthis.labels[i] = \"\";\r\n\t\t\t\tthis.labelColors[i] = this.foregroundColor;\r\n\t\t\t}\r\n\t\t\tthis.numLabels = newNumElements;\r\n\t\t} else if (this.numLabels > newNumElements) {\r\n\t\t\tfor (i = newNumElements; i < this.numLabels; i++) {\r\n\t\t\t\tthis.labels[i] = null;\r\n\t\t\t}\r\n\t\t\tthis.numLabels = newNumElements;\r\n\t\t}\r\n\t}\r\n\r\n\tleft() {\r\n\t\treturn this.x - this.getWidth() / 2.0;\r\n\t}\r\n\r\n\tright() {\r\n\t\treturn this.x + this.getWidth() / 2.0;\r\n\t}\r\n\r\n\ttop() {\r\n\t\treturn this.y - this.nodeHeight / 2.0;\r\n\t}\r\n\r\n\tbottom() {\r\n\t\treturn this.y + this.nodeHeight / 2.0;\r\n\t}\r\n\r\n\tdraw(context) {\r\n\t\tlet startX;\r\n\r\n\t\tstartX = this.left();\r\n\t\tif (isNaN(startX)) {\r\n\t\t\tstartX = 0;\r\n\t\t}\r\n\t\tconst startY = this.top();\r\n\r\n\t\tif (this.highlighted) {\r\n\t\t\tcontext.strokeStyle = \"#ff0000\";\r\n\t\t\tcontext.fillStyle = \"#ff0000\";\r\n\r\n\t\t\tcontext.beginPath();\r\n\t\t\tcontext.moveTo(startX - this.highlightDiff, startY - this.highlightDiff);\r\n\t\t\tcontext.lineTo(\r\n\t\t\t\tstartX + this.getWidth() + this.highlightDiff,\r\n\t\t\t\tstartY - this.highlightDiff\r\n\t\t\t);\r\n\t\t\tcontext.lineTo(\r\n\t\t\t\tstartX + this.getWidth() + this.highlightDiff,\r\n\t\t\t\tstartY + this.nodeHeight + this.highlightDiff\r\n\t\t\t);\r\n\t\t\tcontext.lineTo(\r\n\t\t\t\tstartX - this.highlightDiff,\r\n\t\t\t\tstartY + this.nodeHeight + this.highlightDiff\r\n\t\t\t);\r\n\t\t\tcontext.lineTo(startX - this.highlightDiff, startY - this.highlightDiff);\r\n\t\t\tcontext.closePath();\r\n\t\t\tcontext.stroke();\r\n\t\t\tcontext.fill();\r\n\t\t}\r\n\r\n\t\tcontext.strokeStyle = this.foregroundColor;\r\n\t\tcontext.fillStyle = this.backgroundColor;\r\n\r\n\t\tcontext.beginPath();\r\n\t\tcontext.moveTo(startX, startY);\r\n\t\tcontext.lineTo(startX + this.getWidth(), startY);\r\n\t\tcontext.lineTo(startX + this.getWidth(), startY + this.nodeHeight);\r\n\t\tcontext.lineTo(startX, startY + this.nodeHeight);\r\n\t\tcontext.lineTo(startX, startY);\r\n\t\tcontext.closePath();\r\n\t\tcontext.stroke();\r\n\t\tcontext.fill();\r\n\r\n\t\tcontext.textAlign = \"center\";\r\n\t\tcontext.textBaseline = \"middle\";\r\n\r\n\t\tfor (let i = 0; i < this.numLabels; i++) {\r\n\t\t\tconst labelx =\r\n\t\t\t\tthis.x -\r\n\t\t\t\t(this.widthPerElement * this.numLabels) / 2 +\r\n\t\t\t\tthis.widthPerElement / 2 +\r\n\t\t\t\ti * this.widthPerElement;\r\n\t\t\tconst labely = this.y;\r\n\r\n\t\t\tcontext.fillStyle = this.labelColors[i];\r\n\t\t\tcontext.fillText(this.labels[i], labelx, labely);\r\n\t\t}\r\n\t}\r\n\r\n\tgetHeight() {\r\n\t\treturn this.nodeHeight;\r\n\t}\r\n\r\n\tsetForegroundColor(newColor) {\r\n\t\tthis.foregroundColor = newColor;\r\n\t\tfor (let i = 0; i < this.numLabels; i++) {\r\n\t\t\tthis.labelColor[i] = newColor;\r\n\t\t}\r\n\t}\r\n\r\n\t// TODO:  Kill the magic numbers here\r\n\tgetTailPointerAttachPos(fromX, fromY, anchor) {\r\n\t\tif (anchor === 0) {\r\n\t\t\treturn [this.left() + AnimatedBTreeNode.EDGE_POINTER_DISPLACEMENT, this.y];\r\n\t\t} else if (anchor === this.numLabels) {\r\n\t\t\treturn [this.right() - AnimatedBTreeNode.EDGE_POINTER_DISPLACEMENT, this.y];\r\n\t\t} else {\r\n\t\t\treturn [this.left() + anchor * this.widthPerElement, this.y];\r\n\t\t}\r\n\t}\r\n\r\n\tgetHeadPointerAttachPos(fromX, fromY) {\r\n\t\tif (fromY < this.y - this.nodeHeight / 2) {\r\n\t\t\treturn [this.x, this.y - this.nodeHeight / 2];\r\n\t\t} else if (this.fromY > this.y + this.nodeHeight / 2) {\r\n\t\t\treturn [this.x, this.y + this.nodeHeight / 2];\r\n\t\t} else if (fromX < this.x - this.getWidth() / 2) {\r\n\t\t\treturn [this.x - this.getWidth() / 2, this.y];\r\n\t\t} else {\r\n\t\t\treturn [this.x + this.getWidth() / 2, this.y];\r\n\t\t}\r\n\t}\r\n\r\n\tcreateUndoDelete() {\r\n\t\treturn new UndoDeleteBTreeNode(\r\n\t\t\tthis.objectID,\r\n\t\t\tthis.numLabels,\r\n\t\t\tthis.labels,\r\n\t\t\tthis.x,\r\n\t\t\tthis.y,\r\n\t\t\tthis.widthPerElement,\r\n\t\t\tthis.nodeHeight,\r\n\t\t\tthis.labelColors,\r\n\t\t\tthis.backgroundColor,\r\n\t\t\tthis.foregroundColor,\r\n\t\t\tthis.layer,\r\n\t\t\tthis.highlighted\r\n\t\t);\r\n\t}\r\n\r\n\tgetTextColor(textIndex) {\r\n\t\ttextIndex = textIndex == null ? 0 : textIndex;\r\n\t\treturn this.labelColors[textIndex];\r\n\t}\r\n\r\n\tgetText(index) {\r\n\t\tindex = index == null ? 0 : index;\r\n\t\treturn this.labels[index];\r\n\t}\r\n\r\n\tsetTextColor(color, textIndex) {\r\n\t\ttextIndex = textIndex == null ? 0 : textIndex;\r\n\t\tthis.labelColors[textIndex] = color;\r\n\t}\r\n\r\n\tsetText(newText, textIndex) {\r\n\t\ttextIndex = textIndex == null ? 0 : textIndex;\r\n\t\tthis.labels[textIndex] = newText;\r\n\t}\r\n}\r\n\r\nclass UndoDeleteBTreeNode extends UndoBlock {\r\n\tconstructor(\r\n\t\tid,\r\n\t\tnumLab,\r\n\t\tlabelText,\r\n\t\tx,\r\n\t\ty,\r\n\t\twPerElement,\r\n\t\tnHeight,\r\n\t\tlColors,\r\n\t\tbgColor,\r\n\t\tfgColor,\r\n\t\tl,\r\n\t\thighlighted\r\n\t) {\r\n\t\tsuper();\r\n\t\tthis.objectID = id;\r\n\t\tthis.posX = x;\r\n\t\tthis.posY = y;\r\n\t\tthis.widthPerElem = wPerElement;\r\n\t\tthis.nodeHeight = nHeight;\r\n\t\tthis.backgroundColor = bgColor;\r\n\t\tthis.foregroundColor = fgColor;\r\n\t\tthis.numElems = numLab;\r\n\t\tthis.labels = labelText;\r\n\r\n\t\tthis.labelColors = lColors;\r\n\t\tthis.layer = l;\r\n\t\tthis.highlighted = highlighted;\r\n\t}\r\n\r\n\tundoInitialStep(world) {\r\n\t\tworld.addBTreeNode(\r\n\t\t\tthis.objectID,\r\n\t\t\tthis.widthPerElem,\r\n\t\t\tthis.nodeHeight,\r\n\t\t\tthis.numElems,\r\n\t\t\tthis.backgroundColor,\r\n\t\t\tthis.foregroundColor\r\n\t\t);\r\n\t\tworld.setNodePosition(this.objectID, this.posX, this.posY);\r\n\t\tfor (let i = 0; i < this.numElems; i++) {\r\n\t\t\tworld.setText(this.objectID, this.labels[i], i);\r\n\t\t\tworld.setTextColor(this.objectID, this.labelColors[i], i);\r\n\t\t}\r\n\t\tworld.setHighlight(this.objectID, this.highlighted);\r\n\t\tworld.setLayer(this.objectID, this.layer);\r\n\t}\r\n}\r\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\r\n//\r\n// Redistribution and use in source and binary forms, with or without modification, are\r\n// permitted provided that the following conditions are met:\r\n//\r\n// 1. Redistributions of source code must retain the above copyright notice, this list of\r\n// conditions and the following disclaimer.\r\n//\r\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\r\n// of conditions and the following disclaimer in the documentation and/or other materials\r\n// provided with the distribution.\r\n//\r\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\r\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\r\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\r\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\r\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\r\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\r\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\r\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\r\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\r\n//\r\n// The views and conclusions contained in the software and documentation are those of the\r\n// authors and should not be interpreted as representing official policies, either expressed\r\n// or implied, of the University of San Francisco\r\n\r\nimport AnimatedObject from './AnimatedObject';\r\nimport { UndoBlock } from './UndoFunctions';\r\n\r\nexport default class AnimatedCircle extends AnimatedObject {\r\n\tconstructor(objectID, objectLabel) {\r\n\t\tsuper();\r\n\t\tthis.objectID = objectID;\r\n\t\tthis.label = objectLabel;\r\n\t\tthis.radius = 20;\r\n\t\tthis.thickness = 3;\r\n\t\tthis.x = 0;\r\n\t\tthis.y = 0;\r\n\t\tthis.alpha = 1.0;\r\n\t\tthis.addedToScene = true;\r\n\t\tthis.highlightIndex = -1;\r\n\t\t/*\tthis.foregroundColor  = '#007700';\r\n\tthis.backgroundColor  = '#EEFFEE';\r\n */\r\n\t}\r\n\r\n\tgetTailPointerAttachPos(fromX, fromY) {\r\n\t\treturn this.getHeadPointerAttachPos(fromX, fromY);\r\n\t}\r\n\r\n\tgetWidth() {\r\n\t\treturn this.radius * 2;\r\n\t}\r\n\r\n\tsetWidth(newWidth) {\r\n\t\tthis.radius = newWidth / 2;\r\n\t}\r\n\r\n\tgetHeadPointerAttachPos(fromX, fromY) {\r\n\t\tconst xVec = fromX - this.x;\r\n\t\tconst yVec = fromY - this.y;\r\n\t\tconst len = Math.sqrt(xVec * xVec + yVec * yVec);\r\n\t\tif (len === 0) {\r\n\t\t\treturn [this.x, this.y];\r\n\t\t}\r\n\t\treturn [this.x + (xVec / len) * this.radius, this.y + (yVec / len) * this.radius];\r\n\t}\r\n\r\n\tsetHighlightIndex(hlIndex) {\r\n\t\tthis.highlightIndex = hlIndex;\r\n\t\tthis.highlightIndexDirty = true;\r\n\t}\r\n\r\n\tdraw(ctx) {\r\n\t\tctx.globalAlpha = this.alpha;\r\n\r\n\t\tif (this.highlighted) {\r\n\t\t\tctx.fillStyle = this.highlightColor;\r\n\t\t\tctx.beginPath();\r\n\t\t\tctx.arc(this.x, this.y, this.radius + this.highlightDiff, 0, Math.PI * 2, true);\r\n\t\t\tctx.closePath();\r\n\t\t\tctx.fill();\r\n\t\t}\r\n\r\n\t\tctx.fillStyle = this.backgroundColor;\r\n\t\tctx.strokeStyle = this.foregroundColor;\r\n\t\tctx.lineWidth = 1;\r\n\t\tctx.beginPath();\r\n\t\tctx.arc(this.x, this.y, this.radius, 0, Math.PI * 2, true);\r\n\t\tctx.closePath();\r\n\t\tctx.fill();\r\n\t\tctx.stroke();\r\n\t\tctx.textAlign = 'center';\r\n\t\tctx.font = '10px sans-serif';\r\n\t\tctx.textBaseline = 'middle';\r\n\t\tctx.lineWidth = 1;\r\n\t\tctx.fillStyle = this.foregroundColor;\r\n\r\n\t\tconst strList = this.label.split('\\n');\r\n\t\tif (strList.length === 1) {\r\n\t\t\tif (this.highlightIndexDirty && this.highlightIndex !== -1) {\r\n\t\t\t\tthis.leftWidth = ctx.measureText(\r\n\t\t\t\t\tthis.label.substring(0, this.highlightIndex)\r\n\t\t\t\t).width;\r\n\t\t\t\tthis.centerWidth = ctx.measureText(\r\n\t\t\t\t\tthis.label.substring(this.highlightIndex, this.highlightIndex + 1)\r\n\t\t\t\t).width;\r\n\t\t\t\tthis.textWidth = ctx.measureText(this.label).width;\r\n\t\t\t\tthis.highlightIndexDirty = false;\r\n\t\t\t}\r\n\t\t\tif (this.highlightIndex !== -1 && this.highlightIndex < this.label.length) {\r\n\t\t\t\t//this.highlghtIndex < this.label.length)\r\n\t\t\t\tconst startingXForHighlight = this.x - this.textWidth / 2;\r\n\t\t\t\tctx.textAlign = 'left';\r\n\t\t\t\tconst leftStr = this.label.substring(0, this.highlightIndex);\r\n\t\t\t\tconst highlightStr = this.label.substring(\r\n\t\t\t\t\tthis.highlightIndex,\r\n\t\t\t\t\tthis.highlightIndex + 1\r\n\t\t\t\t);\r\n\t\t\t\tconst rightStr = this.label.substring(this.highlightIndex + 1);\r\n\t\t\t\tctx.fillText(leftStr, startingXForHighlight, this.y);\r\n\t\t\t\tctx.strokeStyle = '#FF0000';\r\n\t\t\t\tctx.fillStyle = '#FF0000';\r\n\t\t\t\tctx.fillText(highlightStr, startingXForHighlight + this.leftWidth, this.y);\r\n\r\n\t\t\t\tctx.strokeStyle = this.labelColor;\r\n\t\t\t\tctx.fillStyle = this.labelColor;\r\n\t\t\t\tctx.fillText(\r\n\t\t\t\t\trightStr,\r\n\t\t\t\t\tstartingXForHighlight + this.leftWidth + this.centerWidth,\r\n\t\t\t\t\tthis.y\r\n\t\t\t\t);\r\n\t\t\t} else {\r\n\t\t\t\tctx.fillText(this.label, this.x, this.y);\r\n\t\t\t}\r\n\t\t} else if (strList.length % 2 === 0) {\r\n\t\t\tconst mid = strList.length / 2;\r\n\t\t\tfor (let i = 0; i < strList.length / 2; i++) {\r\n\t\t\t\tctx.fillText(strList[mid - i - 1], this.x, this.y - (i + 0.5) * 12);\r\n\t\t\t\tctx.fillText(strList[mid + i], this.x, this.y + (i + 0.5) * 12);\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tconst mid = (strList.length - 1) / 2;\r\n\t\t\tctx.fillText(strList[mid], this.x, this.y);\r\n\t\t\tfor (let i = 0; i < mid; i++) {\r\n\t\t\t\tctx.fillText(strList[mid - (i + 1)], this.x, this.y - (i + 1) * 12);\r\n\t\t\t\tctx.fillText(strList[mid + (i + 1)], this.x, this.y + (i + 1) * 12);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tcreateUndoDelete() {\r\n\t\treturn new UndoDeleteCircle(\r\n\t\t\tthis.objectID,\r\n\t\t\tthis.label,\r\n\t\t\tthis.x,\r\n\t\t\tthis.y,\r\n\t\t\tthis.foregroundColor,\r\n\t\t\tthis.backgroundColor,\r\n\t\t\tthis.layer,\r\n\t\t\tthis.radius\r\n\t\t);\r\n\t}\r\n}\r\n\r\nclass UndoDeleteCircle extends UndoBlock {\r\n\tconstructor(id, lab, x, y, foregroundColor, backgroundColor, l, radius) {\r\n\t\tsuper();\r\n\t\tthis.objectID = id;\r\n\t\tthis.posX = x;\r\n\t\tthis.posY = y;\r\n\t\tthis.nodeLabel = lab;\r\n\t\tthis.fgColor = foregroundColor;\r\n\t\tthis.bgColor = backgroundColor;\r\n\t\tthis.layer = l;\r\n\t\tthis.radius = radius;\r\n\t}\r\n\r\n\tundoInitialStep(world) {\r\n\t\tworld.addCircleObject(this.objectID, this.nodeLabel);\r\n\t\tworld.setWidth(this.objectID, this.radius * 2);\r\n\t\tworld.setNodePosition(this.objectID, this.posX, this.posY);\r\n\t\tworld.setForegroundColor(this.objectID, this.fgColor);\r\n\t\tworld.setBackgroundColor(this.objectID, this.bgColor);\r\n\t\tworld.setLayer(this.objectID, this.layer);\r\n\t}\r\n}\r\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\r\n//\r\n// Redistribution and use in source and binary forms, with or without modification, are\r\n// permitted provided that the following conditions are met:\r\n//\r\n// 1. Redistributions of source code must retain the above copyright notice, this list of\r\n// conditions and the following disclaimer.\r\n//\r\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\r\n// of conditions and the following disclaimer in the documentation and/or other materials\r\n// provided with the distribution.\r\n//\r\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\r\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\r\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\r\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\r\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\r\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\r\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\r\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\r\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\r\n//\r\n// The views and conclusions contained in the software and documentation are those of the\r\n// authors and should not be interpreted as representing official policies, either expressed\r\n// or implied, of the University of San Francisco\r\n\r\nimport AnimatedObject from \"./AnimatedObject.js\";\r\nimport { UndoBlock } from \"./UndoFunctions.js\";\r\n\r\nexport default class AnimatedCircularlyLinkedList extends AnimatedObject {\r\n\tconstructor(id, val, wth, hgt, linkPer, numLab, fillColor, edgeColor) {\r\n\t\tsuper();\r\n\t\tthis.w = wth;\r\n\t\tthis.h = hgt;\r\n\t\tthis.backgroundColor = fillColor;\r\n\t\tthis.foregroundColor = edgeColor;\r\n\r\n\t\tthis.linkPercent = linkPer;\r\n\r\n\t\tthis.numLabels = numLab;\r\n\r\n\t\tthis.labels = [];\r\n\t\tthis.labelPosX = [];\r\n\t\tthis.labelPosY = [];\r\n\t\tthis.labelColors = [];\r\n\t\tthis.nullPointer = false;\r\n\r\n\t\tthis.currentHeightDif = 6;\r\n\t\tthis.maxHeightDiff = 5;\r\n\t\tthis.minHeightDiff = 3;\r\n\r\n\t\tfor (let i = 0; i < this.numLabels; i++) {\r\n\t\t\tthis.labels[i] = \"\";\r\n\t\t\tthis.labelPosX[i] = 0;\r\n\t\t\tthis.labelPosY[i] = 0;\r\n\t\t\tthis.labelColors[i] = this.foregroundColor;\r\n\t\t}\r\n\r\n\t\tthis.labels[0] = val;\r\n\t\tthis.highlighted = false;\r\n\t\tthis.objectID = id;\r\n\t}\r\n\r\n\tsetNull(np) {\r\n\t\tif (this.nullPointer !== np) {\r\n\t\t\tthis.nullPointer = np;\r\n\t\t}\r\n\t}\r\n\r\n\tgetNull() {\r\n\t\treturn this.nullPointer;\r\n\t}\r\n\r\n\tleft() {\r\n\t\treturn this.x - (this.w * (1 - this.linkPercent)) / 2;\r\n\t}\r\n\r\n\tright() {\r\n\t\treturn this.x + (this.w * (this.linkPercent + 1)) / 2;\r\n\t}\r\n\r\n\ttop() {\r\n\t\treturn this.y - this.h / 2.0;\r\n\t}\r\n\r\n\tbottom() {\r\n\t\treturn this.y + this.h / 2.0;\r\n\t}\r\n\r\n\t// TODO: Should we move this to the draw function, and save the\r\n\t//       space of the arrays?  Bit of a leftover from the Flash code,\r\n\t//       which did drawing differently\r\n\tresetTextPosition() {\r\n\t\tthis.labelPosY[0] = this.y;\r\n\t\tthis.labelPosX[0] =\r\n\t\t\tthis.x + ((this.w * (1 - this.linkPercent)) / 2) * (1 / this.numLabels - 1);\r\n\t\tfor (let i = 1; i < this.numLabels; i++) {\r\n\t\t\tthis.labelPosY[i] = this.y;\r\n\t\t\tthis.labelPosX[i] =\r\n\t\t\t\tthis.labelPosX[i - 1] + (this.w * (1 - this.linkPercent)) / this.numLabels;\r\n\t\t}\r\n\t}\r\n\r\n\tgetTailPointerAttachPos() {\r\n\t\treturn [this.x + this.w / 2.0, this.y];\r\n\t}\r\n\r\n\tgetHeadPointerAttachPos(fromX, fromY) {\r\n\t\tif (fromX < this.x) {\r\n\t\t\treturn this.getClosestCardinalPoint(fromX, fromY); // Normal anchor\r\n\t\t} else {\r\n\t\t\treturn [this.x, this.bottom()]; // Curved pointer coming from the right, connect to bottom\r\n\t\t}\r\n\t}\r\n\r\n\tsetWidth(wdth) {\r\n\t\tthis.w = wdth;\r\n\t\tthis.resetTextPosition();\r\n\t}\r\n\r\n\tsetHeight(hght) {\r\n\t\tthis.h = hght;\r\n\t\tthis.resetTextPosition();\r\n\t}\r\n\r\n\tgetWidth() {\r\n\t\treturn this.w;\r\n\t}\r\n\r\n\tgetHeight() {\r\n\t\treturn this.h;\r\n\t}\r\n\r\n\tdraw(context) {\r\n\t\tlet startX;\r\n\t\tlet startY;\r\n\r\n\t\tstartX = this.left();\r\n\t\tstartY = this.top();\r\n\r\n\t\tif (this.highlighted) {\r\n\t\t\tcontext.strokeStyle = \"#ff0000\";\r\n\t\t\tcontext.fillStyle = \"#ff0000\";\r\n\r\n\t\t\tcontext.beginPath();\r\n\t\t\tcontext.moveTo(startX - this.highlightDiff, startY - this.highlightDiff);\r\n\t\t\tcontext.lineTo(startX + this.w + this.highlightDiff, startY - this.highlightDiff);\r\n\t\t\tcontext.lineTo(\r\n\t\t\t\tstartX + this.w + this.highlightDiff,\r\n\t\t\t\tstartY + this.h + this.highlightDiff\r\n\t\t\t);\r\n\t\t\tcontext.lineTo(startX - this.highlightDiff, startY + this.h + this.highlightDiff);\r\n\t\t\tcontext.lineTo(startX - this.highlightDiff, startY - this.highlightDiff);\r\n\t\t\tcontext.closePath();\r\n\t\t\tcontext.stroke();\r\n\t\t\tcontext.fill();\r\n\t\t}\r\n\t\tcontext.strokeStyle = this.foregroundColor;\r\n\t\tcontext.fillStyle = this.backgroundColor;\r\n\r\n\t\tcontext.beginPath();\r\n\t\tcontext.moveTo(startX, startY);\r\n\t\tcontext.lineTo(startX + this.w, startY);\r\n\t\tcontext.lineTo(startX + this.w, startY + this.h);\r\n\t\tcontext.lineTo(startX, startY + this.h);\r\n\t\tcontext.lineTo(startX, startY);\r\n\t\tcontext.closePath();\r\n\t\tcontext.stroke();\r\n\t\tcontext.fill();\r\n\r\n\t\tlet i;\r\n\t\tstartY = this.top();\r\n\t\tfor (i = 1; i < this.numLabels; i++) {\r\n\t\t\tstartX = this.x + this.w * (1 - this.linkPercent) * (i / this.numLabels - 1 / 2);\r\n\t\t\tcontext.beginPath();\r\n\t\t\tcontext.moveTo(startX, startY);\r\n\t\t\tcontext.lineTo(startX, startY + this.h);\r\n\t\t\tcontext.closePath();\r\n\t\t\tcontext.stroke();\r\n\t\t}\r\n\r\n\t\tstartX = this.right() - this.w * this.linkPercent;\r\n\t\tstartY = this.top();\r\n\r\n\t\tcontext.beginPath();\r\n\t\tcontext.moveTo(startX, startY + this.h);\r\n\t\tcontext.lineTo(startX, startY);\r\n\t\tif (this.nullPointer) {\r\n\t\t\tcontext.lineTo(this.right(), startY + this.h);\r\n\t\t}\r\n\t\tcontext.closePath();\r\n\t\tcontext.stroke();\r\n\r\n\t\tcontext.textAlign = \"center\";\r\n\t\tcontext.font = \"10px sans-serif\";\r\n\t\tcontext.textBaseline = \"middle\";\r\n\t\tcontext.lineWidth = 1;\r\n\r\n\t\tthis.resetTextPosition();\r\n\t\tfor (i = 0; i < this.numLabels; i++) {\r\n\t\t\tcontext.fillStyle = this.labelColors[i];\r\n\t\t\tcontext.fillText(this.labels[i], this.labelPosX[i], this.labelPosY[i]);\r\n\t\t}\r\n\t}\r\n\r\n\tsetTextColor(color, textIndex) {\r\n\t\tthis.labelColors[textIndex] = color;\r\n\t}\r\n\r\n\tgetTextColor(textIndex) {\r\n\t\treturn this.labelColors[textIndex];\r\n\t}\r\n\r\n\tgetText(index) {\r\n\t\treturn this.labels[index];\r\n\t}\r\n\r\n\tsetText(newText, textIndex) {\r\n\t\tthis.labels[textIndex] = newText;\r\n\t\tthis.resetTextPosition();\r\n\t}\r\n\r\n\tcreateUndoDelete() {\r\n\t\treturn new UndoDeleteLinkedList(\r\n\t\t\tthis.objectID,\r\n\t\t\tthis.numLabels,\r\n\t\t\tthis.labels,\r\n\t\t\tthis.x,\r\n\t\t\tthis.y,\r\n\t\t\tthis.w,\r\n\t\t\tthis.h,\r\n\t\t\tthis.linkPercent,\r\n\t\t\tthis.linkPositionEnd,\r\n\t\t\tthis.vertical,\r\n\t\t\tthis.labelColors,\r\n\t\t\tthis.backgroundColor,\r\n\t\t\tthis.foregroundColor,\r\n\t\t\tthis.layer,\r\n\t\t\tthis.nullPointer\r\n\t\t);\r\n\t}\r\n\r\n\tsetHighlight(value) {\r\n\t\tif (value !== this.highlighted) {\r\n\t\t\tthis.highlighted = value;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nclass UndoDeleteLinkedList extends UndoBlock {\r\n\tconstructor(id, numlab, lab, x, y, w, h, linkper, labColors, bgColor, fgColor, l, np) {\r\n\t\tsuper();\r\n\t\tthis.objectID = id;\r\n\t\tthis.posX = x;\r\n\t\tthis.posY = y;\r\n\t\tthis.width = w;\r\n\t\tthis.height = h;\r\n\t\tthis.backgroundColor = bgColor;\r\n\t\tthis.foregroundColor = fgColor;\r\n\t\tthis.labels = lab;\r\n\t\tthis.linkPercent = linkper;\r\n\t\tthis.labelColors = labColors;\r\n\t\tthis.layer = l;\r\n\t\tthis.numLabels = numlab;\r\n\t\tthis.nullPointer = np;\r\n\t}\r\n\r\n\tundoInitialStep(world) {\r\n\t\tworld.addLinkedListObject(\r\n\t\t\tthis.objectID,\r\n\t\t\tthis.labels[0],\r\n\t\t\tthis.width,\r\n\t\t\tthis.height,\r\n\t\t\tthis.linkPercent,\r\n\t\t\tthis.numLabels,\r\n\t\t\tthis.backgroundColor,\r\n\t\t\tthis.foregroundColor\r\n\t\t);\r\n\t\tworld.setNodePosition(this.objectID, this.posX, this.posY);\r\n\t\tworld.setLayer(this.objectID, this.layer);\r\n\t\tworld.setNull(this.objectID, this.nullPointer);\r\n\t\tfor (let i = 0; i < this.numLabels; i++) {\r\n\t\t\tworld.setText(this.objectID, this.labels[i], i);\r\n\t\t\tworld.setTextColor(this.objectID, this.labelColors[i], i);\r\n\t\t}\r\n\t}\r\n}\r\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\r\n//\r\n// Redistribution and use in source and binary forms, with or without modification, are\r\n// permitted provided that the following conditions are met:\r\n//\r\n// 1. Redistributions of source code must retain the above copyright notice, this list of\r\n// conditions and the following disclaimer.\r\n//\r\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\r\n// of conditions and the following disclaimer in the documentation and/or other materials\r\n// provided with the distribution.\r\n//\r\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\r\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\r\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\r\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\r\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\r\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\r\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\r\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\r\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\r\n//\r\n// The views and conclusions contained in the software and documentation are those of the\r\n// authors and should not be interpreted as representing official policies, either expressed\r\n// or implied, of the University of San Francisco\r\n\r\nimport AnimatedObject from './AnimatedObject.js';\r\nimport { UndoBlock } from './UndoFunctions.js';\r\n\r\nexport default class AnimatedDoublyLinkedList extends AnimatedObject {\r\n\tconstructor(id, val, wth, hgt, linkPer, numLab, fillColor, edgeColor) {\r\n\t\tsuper();\r\n\r\n\t\tthis.w = wth;\r\n\t\tthis.h = hgt;\r\n\t\tthis.backgroundColor = fillColor;\r\n\t\tthis.foregroundColor = edgeColor;\r\n\r\n\t\tthis.linkPercent = linkPer;\r\n\r\n\t\tthis.numLabels = numLab;\r\n\r\n\t\tthis.labels = [];\r\n\t\tthis.labelPosX = [];\r\n\t\tthis.labelPosY = [];\r\n\t\tthis.labelColors = [];\r\n\t\tthis.prevNullPointer = false;\r\n\t\tthis.nextNullPointer = false;\r\n\r\n\t\tthis.currentHeightDif = 6;\r\n\t\tthis.maxHeightDiff = 5;\r\n\t\tthis.minHeightDiff = 3;\r\n\r\n\t\tfor (let i = 0; i < this.numLabels; i++) {\r\n\t\t\tthis.labels[i] = '';\r\n\t\t\tthis.labelPosX[i] = 0;\r\n\t\t\tthis.labelPosY[i] = 0;\r\n\t\t\tthis.labelColors[i] = this.foregroundColor;\r\n\t\t}\r\n\r\n\t\tthis.labels[0] = val;\r\n\t\tthis.highlighted = false;\r\n\t\tthis.objectID = id;\r\n\t}\r\n\r\n\tsetPrevNull(np) {\r\n\t\tif (this.prevNullPointer !== np) {\r\n\t\t\tthis.prevNullPointer = np;\r\n\t\t}\r\n\t}\r\n\r\n\tsetNextNull(np) {\r\n\t\tif (this.nextNullPointer !== np) {\r\n\t\t\tthis.nextNullPointer = np;\r\n\t\t}\r\n\t}\r\n\r\n\tgetLeftNull() {\r\n\t\treturn this.prevNullPointer;\r\n\t}\r\n\r\n\tgetRightNull() {\r\n\t\treturn this.nextNullPointer;\r\n\t}\r\n\r\n\tleft() {\r\n\t\treturn this.x - (this.w * (1 - this.linkPercent)) / 2;\r\n\t}\r\n\r\n\tright() {\r\n\t\treturn this.x + (this.w * (this.linkPercent + 1)) / 2;\r\n\t}\r\n\r\n\ttop() {\r\n\t\treturn this.y - this.h / 2.0;\r\n\t}\r\n\r\n\tbottom() {\r\n\t\treturn this.y + this.h / 2.0;\r\n\t}\r\n\r\n\t// TODO: Should we move this to the draw function, and save the\r\n\t//       space of the arrays?  Bit of a leftover from the Flash code,\r\n\t//       which did drawing differently\r\n\tresetTextPosition() {\r\n\t\tthis.labelPosY[0] = this.y;\r\n\t\tthis.labelPosX[0] = this.left() + this.w * (this.linkPercent * 2); //* (1 / this.numLabels - 1);\r\n\t\tfor (let i = 1; i < this.numLabels; i++) {\r\n\t\t\tthis.labelPosY[i] = this.y;\r\n\t\t\tthis.labelPosX[i] =\r\n\t\t\t\tthis.labelPosX[i - 1] + (this.w * (1 - this.linkPercent)) / this.numLabels;\r\n\t\t}\r\n\t}\r\n\r\n\tgetTailPointerAttachPos(fromX, fromY, anchor) {\r\n\t\tif (anchor === 0) {\r\n\t\t\treturn [this.x + this.w / 2.0, this.y - this.h * 0.2];\r\n\t\t} else {\r\n\t\t\treturn [this.left() + (this.w * this.linkPercent) / 2, this.y + this.h * 0.2];\r\n\t\t}\r\n\t}\r\n\r\n\tgetHeadPointerAttachPos(fromX, fromY) {\r\n\t\tconst closest = this.getClosestCardinalPoint(fromX, fromY);\r\n\t\tif (closest[1] === this.y) {\r\n\t\t\tif (closest[0] === this.left()) {\r\n\t\t\t\treturn [closest[0], this.y - this.h * 0.2];\r\n\t\t\t} else {\r\n\t\t\t\treturn [closest[0], this.y + this.h * 0.2];\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\treturn [closest[0], closest[1]];\r\n\t\t}\r\n\t}\r\n\r\n\tsetWidth(wdth) {\r\n\t\tthis.w = wdth;\r\n\t\tthis.resetTextPosition();\r\n\t}\r\n\r\n\tsetHeight(hght) {\r\n\t\tthis.h = hght;\r\n\t\tthis.resetTextPosition();\r\n\t}\r\n\r\n\tgetWidth() {\r\n\t\treturn this.w;\r\n\t}\r\n\r\n\tgetHeight() {\r\n\t\treturn this.h;\r\n\t}\r\n\r\n\tdraw(context) {\r\n\t\tlet startX;\r\n\t\tlet startY;\r\n\r\n\t\tstartX = this.left();\r\n\t\tstartY = this.top();\r\n\r\n\t\t// Highlighted edges\r\n\t\tif (this.highlighted) {\r\n\t\t\tcontext.strokeStyle = '#ff0000';\r\n\t\t\tcontext.fillStyle = '#ff0000';\r\n\r\n\t\t\tcontext.beginPath();\r\n\t\t\tcontext.moveTo(startX - this.highlightDiff, startY - this.highlightDiff);\r\n\t\t\tcontext.lineTo(startX + this.w + this.highlightDiff, startY - this.highlightDiff);\r\n\t\t\tcontext.lineTo(\r\n\t\t\t\tstartX + this.w + this.highlightDiff,\r\n\t\t\t\tstartY + this.h + this.highlightDiff\r\n\t\t\t);\r\n\t\t\tcontext.lineTo(startX - this.highlightDiff, startY + this.h + this.highlightDiff);\r\n\t\t\tcontext.lineTo(startX - this.highlightDiff, startY - this.highlightDiff);\r\n\t\t\tcontext.closePath();\r\n\t\t\tcontext.stroke();\r\n\t\t\tcontext.fill();\r\n\t\t}\r\n\r\n\t\t// Node edges\r\n\t\tcontext.strokeStyle = this.foregroundColor;\r\n\t\tcontext.fillStyle = this.backgroundColor;\r\n\r\n\t\tcontext.beginPath();\r\n\t\tcontext.moveTo(startX, startY);\r\n\t\tcontext.lineTo(startX + this.w, startY);\r\n\t\tcontext.lineTo(startX + this.w, startY + this.h);\r\n\t\tcontext.lineTo(startX, startY + this.h);\r\n\t\tcontext.lineTo(startX, startY);\r\n\t\tcontext.closePath();\r\n\t\tcontext.stroke();\r\n\t\tcontext.fill();\r\n\r\n\t\t// Multiple label stuff (might be able to remove)\r\n\t\tlet i;\r\n\t\tstartY = this.top();\r\n\t\tfor (i = 1; i < this.numLabels; i++) {\r\n\t\t\tstartX = this.x + this.w * (1 - this.linkPercent) * (i / this.numLabels - 1 / 2);\r\n\t\t\tcontext.beginPath();\r\n\t\t\tcontext.moveTo(startX, startY);\r\n\t\t\tcontext.lineTo(startX, startY + this.h);\r\n\t\t\tcontext.closePath();\r\n\t\t\tcontext.stroke();\r\n\t\t}\r\n\r\n\t\t// Left inner line between node and pointer area\r\n\t\tstartX = this.left() + this.w * this.linkPercent;\r\n\t\tstartY = this.top();\r\n\r\n\t\tcontext.beginPath();\r\n\t\tcontext.moveTo(startX, startY + this.h);\r\n\t\tcontext.lineTo(startX, startY);\r\n\t\tif (this.prevNullPointer) {\r\n\t\t\t// Left null marker\r\n\t\t\tcontext.moveTo(this.left(), startY);\r\n\t\t\tcontext.lineTo(this.left() + this.w * this.linkPercent, startY + this.h);\r\n\t\t}\r\n\t\tcontext.closePath();\r\n\t\tcontext.stroke();\r\n\r\n\t\t// Right inner line between node and pointer area\r\n\t\tstartX = this.right() - this.w * this.linkPercent;\r\n\t\tstartY = this.top();\r\n\r\n\t\tcontext.beginPath();\r\n\t\tcontext.moveTo(startX, startY + this.h);\r\n\t\tcontext.lineTo(startX, startY);\r\n\t\tif (this.nextNullPointer) {\r\n\t\t\t// Right null marker\r\n\t\t\tcontext.moveTo(this.right() - this.w * this.linkPercent, startY);\r\n\t\t\tcontext.lineTo(this.right(), startY + this.h);\r\n\t\t}\r\n\t\tcontext.closePath();\r\n\t\tcontext.stroke();\r\n\r\n\t\t// Label\r\n\t\tcontext.textAlign = 'center';\r\n\t\tcontext.font = '10px sans-serif';\r\n\t\tcontext.textBaseline = 'middle';\r\n\t\tcontext.lineWidth = 1;\r\n\r\n\t\tthis.resetTextPosition();\r\n\t\tfor (i = 0; i < this.numLabels; i++) {\r\n\t\t\tcontext.fillStyle = this.labelColors[i];\r\n\t\t\tcontext.fillText(this.labels[i], this.labelPosX[i], this.labelPosY[i]);\r\n\t\t}\r\n\t}\r\n\r\n\tsetTextColor(color, textIndex) {\r\n\t\tthis.labelColors[textIndex] = color;\r\n\t}\r\n\r\n\tgetTextColor(textIndex) {\r\n\t\treturn this.labelColors[textIndex];\r\n\t}\r\n\r\n\tgetText(index) {\r\n\t\treturn this.labels[index];\r\n\t}\r\n\r\n\tsetText(newText, textIndex) {\r\n\t\tthis.labels[textIndex] = newText;\r\n\t\tthis.resetTextPosition();\r\n\t}\r\n\r\n\tcreateUndoDelete() {\r\n\t\treturn new UndoDeleteDoublyLinkedList(\r\n\t\t\tthis.objectID,\r\n\t\t\tthis.numLabels,\r\n\t\t\tthis.labels,\r\n\t\t\tthis.x,\r\n\t\t\tthis.y,\r\n\t\t\tthis.w,\r\n\t\t\tthis.h,\r\n\t\t\tthis.linkPercent,\r\n\t\t\tthis.labelColors,\r\n\t\t\tthis.backgroundColor,\r\n\t\t\tthis.foregroundColor,\r\n\t\t\tthis.layer,\r\n\t\t\tthis.prevNullPointer,\r\n\t\t\tthis.nextNullPointer\r\n\t\t);\r\n\t}\r\n\r\n\tsetHighlight(value) {\r\n\t\tif (value !== this.highlighted) {\r\n\t\t\tthis.highlighted = value;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nclass UndoDeleteDoublyLinkedList extends UndoBlock {\r\n\tconstructor(id, numlab, lab, x, y, w, h, linkper, labColors, bgColor, fgColor, l, lnp, rnp) {\r\n\t\tsuper();\r\n\t\tthis.objectID = id;\r\n\t\tthis.posX = x;\r\n\t\tthis.posY = y;\r\n\t\tthis.width = w;\r\n\t\tthis.height = h;\r\n\t\tthis.backgroundColor = bgColor;\r\n\t\tthis.foregroundColor = fgColor;\r\n\t\tthis.labels = lab;\r\n\t\tthis.linkPercent = linkper;\r\n\t\tthis.labelColors = labColors;\r\n\t\tthis.layer = l;\r\n\t\tthis.numLabels = numlab;\r\n\t\tthis.prevNullPointer = lnp;\r\n\t\tthis.nextNullPointer = rnp;\r\n\t}\r\n\r\n\tundoInitialStep(world) {\r\n\t\tworld.addDoublyLinkedListObject(\r\n\t\t\tthis.objectID,\r\n\t\t\tthis.labels[0],\r\n\t\t\tthis.width,\r\n\t\t\tthis.height,\r\n\t\t\tthis.linkPercent,\r\n\t\t\tthis.numLabels,\r\n\t\t\tthis.backgroundColor,\r\n\t\t\tthis.foregroundColor\r\n\t\t);\r\n\t\tworld.setNodePosition(this.objectID, this.posX, this.posY);\r\n\t\tworld.setLayer(this.objectID, this.layer);\r\n\t\tworld.setPrevNull(this.objectID, this.prevNullPointer);\r\n\t\tworld.setNextNull(this.objectID, this.nextNullPointer);\r\n\t\tfor (let i = 0; i < this.numLabels; i++) {\r\n\t\t\tworld.setText(this.objectID, this.labels[i], i);\r\n\t\t\tworld.setTextColor(this.objectID, this.labelColors[i], i);\r\n\t\t}\r\n\t}\r\n}\r\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\r\n//\r\n// Redistribution and use in source and binary forms, with or without modification, are\r\n// permitted provided that the following conditions are met:\r\n//\r\n// 1. Redistributions of source code must retain the above copyright notice, this list of\r\n// conditions and the following disclaimer.\r\n//\r\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\r\n// of conditions and the following disclaimer in the documentation and/or other materials\r\n// provided with the distribution.\r\n//\r\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\r\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\r\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\r\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\r\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\r\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\r\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\r\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\r\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\r\n//\r\n// The views and conclusions contained in the software and documentation are those of the\r\n// authors and should not be interpreted as representing official policies, either expressed\r\n// or implied, of the University of San Francisco\r\n\r\nimport AnimatedObject from './AnimatedObject.js';\r\nimport { UndoBlock } from './UndoFunctions.js';\r\n\r\nexport default class AnimatedLabel extends AnimatedObject {\r\n\tconstructor(id, val, center, initialWidth) {\r\n\t\tsuper();\r\n\t\tthis.centering = center;\r\n\t\tthis.label = val;\r\n\t\tthis.highlighted = false;\r\n\t\tthis.objectID = id;\r\n\t\tthis.alpha = 1.0;\r\n\t\tthis.addedToScene = true;\r\n\t\tthis.labelColor = '#000000';\r\n\t\tthis.textWidth = 0;\r\n\t\tif (initialWidth != null) {\r\n\t\t\tthis.textWidth = initialWidth;\r\n\t\t}\r\n\r\n\t\tthis.leftWidth = -1;\r\n\t\tthis.centerWidth = -1;\r\n\t\tthis.highlightIndex = -1;\r\n\t\tthis.alwaysOnTop = true;\r\n\t}\r\n\r\n\tcentered() {\r\n\t\treturn this.centering;\r\n\t}\r\n\r\n\tdraw(ctx) {\r\n\t\tif (!this.addedToScene) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tctx.globalAlpha = this.alpha;\r\n\t\tctx.font = '10px sans-serif';\r\n\r\n\t\tlet startingXForHighlight = this.x;\r\n\r\n\t\tif (this.highlightIndex >= this.label.length) {\r\n\t\t\tthis.highlightIndex = -1;\r\n\t\t}\r\n\t\tif (this.highlightIndexDirty && this.highlightIndex !== -1) {\r\n\t\t\tthis.leftWidth = ctx.measureText(this.label.substring(0, this.highlightIndex)).width;\r\n\t\t\tthis.centerWidth = ctx.measureText(\r\n\t\t\t\tthis.label.substring(this.highlightIndex, this.highlightIndex + 1)\r\n\t\t\t).width;\r\n\t\t\tthis.highlightIndexDirty = false;\r\n\t\t}\r\n\r\n\t\tif (this.centering) {\r\n\t\t\tif (this.highlightIndex !== -1) {\r\n\t\t\t\tstartingXForHighlight = this.x - this.width / 2;\r\n\t\t\t\tctx.textAlign = 'left';\r\n\t\t\t\tctx.textBaseline = 'middle';\r\n\t\t\t} else {\r\n\t\t\t\tctx.textAlign = 'center';\r\n\t\t\t\tctx.textBaseline = 'middle';\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tctx.textAlign = 'left';\r\n\t\t\tctx.textBaseline = 'top';\r\n\t\t}\r\n\t\tif (this.highlighted) {\r\n\t\t\tctx.strokeStyle = '#ffaaaa';\r\n\t\t\tctx.fillStyle = '#ff0000';\r\n\t\t\tctx.lineWidth = this.highlightDiff;\r\n\t\t\tctx.strokeText(this.label, this.x, this.y);\r\n\t\t\t//ctx.fillText(this.label, this.x, this.y);\r\n\t\t}\r\n\t\tctx.strokeStyle = this.labelColor;\r\n\t\tctx.fillStyle = this.labelColor;\r\n\t\tctx.lineWidth = 1;\r\n\t\tconst strList = this.label.split('\\n');\r\n\t\tif (strList.length === 1) {\r\n\t\t\tif (this.highlightIndex === -1) {\r\n\t\t\t\tctx.fillText(this.label, this.x, this.y);\r\n\t\t\t} else {\r\n\t\t\t\tconst leftStr = this.label.substring(0, this.highlightIndex);\r\n\t\t\t\tconst highlightStr = this.label.substring(\r\n\t\t\t\t\tthis.highlightIndex,\r\n\t\t\t\t\tthis.highlightIndex + 1\r\n\t\t\t\t);\r\n\t\t\t\tconst rightStr = this.label.substring(this.highlightIndex + 1);\r\n\t\t\t\tctx.fillText(leftStr, startingXForHighlight, this.y);\r\n\t\t\t\tctx.strokeStyle = '#FF0000';\r\n\t\t\t\tctx.fillStyle = '#FF0000';\r\n\t\t\t\tctx.fillText(highlightStr, startingXForHighlight + this.leftWidth, this.y);\r\n\r\n\t\t\t\tctx.strokeStyle = this.labelColor;\r\n\t\t\t\tctx.fillStyle = this.labelColor;\r\n\t\t\t\tctx.fillText(\r\n\t\t\t\t\trightStr,\r\n\t\t\t\t\tstartingXForHighlight + this.leftWidth + this.centerWidth,\r\n\t\t\t\t\tthis.y\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t\t//this.textWidth = ctx.measureText(this.label).width;\r\n\t\t} else {\r\n\t\t\tconst offset = this.centering ? (1.0 - strList.length) / 2.0 : 0;\r\n\t\t\tfor (let i = 0; i < strList.length; i++) {\r\n\t\t\t\tctx.fillText(strList[i], this.x, this.y + offset + i * 12);\r\n\t\t\t\t//this.textWidth = Math.max(this.textWidth, ctx.measureText(strList[i]).width);\r\n\t\t\t}\r\n\t\t}\r\n\t\tctx.closePath();\r\n\t}\r\n\r\n\tgetAlignLeftPos(otherObject) {\r\n\t\tif (this.centering) {\r\n\t\t\treturn [otherObject.left() - this.textWidth / 2, (this.y = otherObject.centerY())];\r\n\t\t} else {\r\n\t\t\treturn [otherObject.left() - this.textWidth, otherObject.centerY() - 5];\r\n\t\t}\r\n\t}\r\n\r\n\talignLeft(otherObject) {\r\n\t\tif (this.centering) {\r\n\t\t\tthis.y = otherObject.centerY();\r\n\t\t\tthis.x = otherObject.left() - this.textWidth / 2;\r\n\t\t} else {\r\n\t\t\tthis.y = otherObject.centerY() - 5;\r\n\t\t\tthis.x = otherObject.left() - this.textWidth;\r\n\t\t}\r\n\t}\r\n\r\n\talignRight(otherObject) {\r\n\t\tif (this.centering) {\r\n\t\t\tthis.y = otherObject.centerY();\r\n\t\t\tthis.x = otherObject.right() + this.textWidth / 2;\r\n\t\t} else {\r\n\t\t\tthis.y = otherObject.centerY() - 5;\r\n\t\t\tthis.x = otherObject.right();\r\n\t\t}\r\n\t}\r\n\r\n\tgetAlignRightPos(otherObject) {\r\n\t\tif (this.centering) {\r\n\t\t\treturn [otherObject.right() + this.textWidth / 2, otherObject.centerY()];\r\n\t\t} else {\r\n\t\t\treturn [otherObject.right(), otherObject.centerY() - 5];\r\n\t\t}\r\n\t}\r\n\r\n\talignTop(otherObject) {\r\n\t\tif (this.centering) {\r\n\t\t\tthis.y = otherObject.top() - 5;\r\n\t\t\tthis.x = otherObject.centerX();\r\n\t\t} else {\r\n\t\t\tthis.y = otherObject.top() - 10;\r\n\t\t\tthis.x = otherObject.centerX() - this.textWidth / 2;\r\n\t\t}\r\n\t}\r\n\r\n\tgetAlignTopPos(otherObject) {\r\n\t\tif (this.centering) {\r\n\t\t\treturn [otherObject.centerX(), otherObject.top() - 5];\r\n\t\t} else {\r\n\t\t\treturn [otherObject.centerX() - this.textWidth / 2, otherObject.top() - 10];\r\n\t\t}\r\n\t}\r\n\r\n\talignBottom(otherObject) {\r\n\t\tif (this.centering) {\r\n\t\t\tthis.y = otherObject.bottom() + 5;\r\n\t\t\tthis.x = otherObject.centerX();\r\n\t\t} else {\r\n\t\t\tthis.y = otherObject.bottom();\r\n\t\t\tthis.x = otherObject.centerX() - this.textWidth / 2;\r\n\t\t}\r\n\t}\r\n\r\n\tgetAlignBottomPos(otherObject) {\r\n\t\tif (this.centering) {\r\n\t\t\treturn [otherObject.centerX(), otherObject.bottom() + 5];\r\n\t\t} else {\r\n\t\t\treturn [otherObject.centerX() - this.textWidth / 2, otherObject.bottom()];\r\n\t\t}\r\n\t}\r\n\r\n\tgetWidth() {\r\n\t\treturn this.textWidth;\r\n\t}\r\n\r\n\tgetHeight() {\r\n\t\treturn 10; // HACK!  HACK!  HACK!  HACK!\r\n\t}\r\n\r\n\tsetHighlight(value) {\r\n\t\tthis.highlighted = value;\r\n\t}\r\n\r\n\tcreateUndoDelete() {\r\n\t\treturn new UndoDeleteLabel(\r\n\t\t\tthis.objectID,\r\n\t\t\tthis.label,\r\n\t\t\tthis.x,\r\n\t\t\tthis.y,\r\n\t\t\tthis.centering,\r\n\t\t\tthis.labelColor,\r\n\t\t\tthis.layer,\r\n\t\t\tthis.highlightIndex\r\n\t\t);\r\n\t}\r\n\r\n\tcenterX() {\r\n\t\tif (this.centering) {\r\n\t\t\treturn this.x;\r\n\t\t} else {\r\n\t\t\treturn this.x + this.textWidth;\r\n\t\t}\r\n\t}\r\n\r\n\tcenterY() {\r\n\t\tif (this.centering) {\r\n\t\t\treturn this.y;\r\n\t\t} else {\r\n\t\t\treturn this.y + 5; //\r\n\t\t}\r\n\t}\r\n\r\n\ttop() {\r\n\t\tif (this.centering) {\r\n\t\t\treturn this.y - 5; //TODO: Un-Hardwire\r\n\t\t} else {\r\n\t\t\treturn this.y;\r\n\t\t}\r\n\t}\r\n\r\n\tbottom() {\r\n\t\tif (this.centering) {\r\n\t\t\treturn this.y + 5; // TODO: + height / 2;\r\n\t\t} else {\r\n\t\t\treturn this.y + 10; // TODO: + hieght;\r\n\t\t}\r\n\t}\r\n\r\n\tright() {\r\n\t\tif (this.centering) {\r\n\t\t\treturn this.x + this.textWidth / 2; // TODO: + width / 2;\r\n\t\t} else {\r\n\t\t\treturn this.x + this.textWidth; // TODO: + width;\r\n\t\t}\r\n\t}\r\n\r\n\tleft() {\r\n\t\tif (this.centering) {\r\n\t\t\treturn this.x - this.textWidth / 2;\r\n\t\t} else {\r\n\t\t\treturn this.x; // TODO:  - a little?\r\n\t\t}\r\n\t}\r\n\r\n\tsetHighlightIndex(hlIndex) {\r\n\t\t// Only allow highlight index for labels that don't have End-Of-Line\r\n\t\tif (this.label.indexOf('\\n') === -1 && this.label.length > hlIndex) {\r\n\t\t\tthis.highlightIndex = hlIndex;\r\n\t\t\tthis.highlightIndexDirty = true;\r\n\t\t} else {\r\n\t\t\tthis.highlightIndex = -1;\r\n\t\t}\r\n\t}\r\n\r\n\tgetTailPointerAttachPos(fromX, fromY) {\r\n\t\treturn this.getClosestCardinalPoint(fromX, fromY);\r\n\t}\r\n\r\n\tgetHeadPointerAttachPos(fromX, fromY) {\r\n\t\treturn this.getClosestCardinalPoint(fromX, fromY);\r\n\t}\r\n\r\n\tsetText(newText, textIndex, initialWidth) {\r\n\t\tthis.label = newText;\r\n\t\tif (initialWidth != null) {\r\n\t\t\tthis.textWidth = initialWidth;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nclass UndoDeleteLabel extends UndoBlock {\r\n\tconstructor(id, lab, x, y, centered, color, l, hli) {\r\n\t\tsuper();\r\n\t\tthis.objectID = id;\r\n\t\tthis.posX = x;\r\n\t\tthis.posY = y;\r\n\t\tthis.nodeLabel = lab;\r\n\t\tthis.labCentered = centered;\r\n\t\tthis.labelColor = color;\r\n\t\tthis.layer = l;\r\n\t\tthis.highlightIndex = hli;\r\n\t\tthis.dirty = true;\r\n\t}\r\n\r\n\tundoInitialStep(world) {\r\n\t\tworld.addLabelObject(this.objectID, this.nodeLabel, this.labCentered);\r\n\t\tworld.setNodePosition(this.objectID, this.posX, this.posY);\r\n\t\tworld.setForegroundColor(this.objectID, this.labelColor);\r\n\t\tworld.setLayer(this.objectID, this.layer);\r\n\t}\r\n}\r\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\r\n//\r\n// Redistribution and use in source and binary forms, with or without modification, are\r\n// permitted provided that the following conditions are met:\r\n//\r\n// 1. Redistributions of source code must retain the above copyright notice, this list of\r\n// conditions and the following disclaimer.\r\n//\r\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\r\n// of conditions and the following disclaimer in the documentation and/or other materials\r\n// provided with the distribution.\r\n//\r\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\r\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\r\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\r\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\r\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\r\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\r\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\r\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\r\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\r\n//\r\n// The views and conclusions contained in the software and documentation are those of the\r\n// authors and should not be interpreted as representing official policies, either expressed\r\n// or implied, of the University of San Francisco\r\n\r\nimport AnimatedObject from \"./AnimatedObject.js\";\r\nimport { UndoBlock } from \"./UndoFunctions.js\";\r\n\r\nexport default class AnimatedLinkedList extends AnimatedObject {\r\n\tconstructor(\r\n\t\tid,\r\n\t\tval,\r\n\t\twth,\r\n\t\thgt,\r\n\t\tlinkPer,\r\n\t\tverticalOrientation,\r\n\t\tlinkPosEnd,\r\n\t\tnumLab,\r\n\t\tfillColor,\r\n\t\tedgeColor\r\n\t) {\r\n\t\tsuper();\r\n\t\tthis.w = wth;\r\n\t\tthis.h = hgt;\r\n\t\tthis.backgroundColor = fillColor;\r\n\t\tthis.foregroundColor = edgeColor;\r\n\r\n\t\tthis.vertical = verticalOrientation;\r\n\t\tthis.linkPositionEnd = linkPosEnd;\r\n\t\tthis.linkPercent = linkPer;\r\n\r\n\t\tthis.numLabels = numLab;\r\n\r\n\t\tthis.labels = [];\r\n\t\tthis.labelPosX = [];\r\n\t\tthis.labelPosY = [];\r\n\t\tthis.labelColors = [];\r\n\t\tthis.nullPointer = false;\r\n\r\n\t\tthis.currentHeightDif = 6;\r\n\t\tthis.maxHeightDiff = 5;\r\n\t\tthis.minHeightDiff = 3;\r\n\r\n\t\tfor (let i = 0; i < this.numLabels; i++) {\r\n\t\t\tthis.labels[i] = \"\";\r\n\t\t\tthis.labelPosX[i] = 0;\r\n\t\t\tthis.labelPosY[i] = 0;\r\n\t\t\tthis.labelColors[i] = this.foregroundColor;\r\n\t\t}\r\n\r\n\t\tthis.labels[0] = val;\r\n\t\tthis.highlighted = false;\r\n\t\tthis.objectID = id;\r\n\t}\r\n\r\n\tleft() {\r\n\t\tif (this.vertical) {\r\n\t\t\treturn this.x - this.w / 2.0;\r\n\t\t} else if (this.linkPositionEnd) {\r\n\t\t\treturn this.x - (this.w * (1 - this.linkPercent)) / 2;\r\n\t\t} else {\r\n\t\t\treturn this.x - (this.w * (this.linkPercent + 1)) / 2;\r\n\t\t}\r\n\t}\r\n\r\n\tsetNull(np) {\r\n\t\tif (this.nullPointer !== np) {\r\n\t\t\tthis.nullPointer = np;\r\n\t\t}\r\n\t}\r\n\r\n\tgetNull() {\r\n\t\treturn this.nullPointer;\r\n\t}\r\n\r\n\tright() {\r\n\t\tif (this.vertical) {\r\n\t\t\treturn this.x + this.w / 2.0;\r\n\t\t} else if (this.linkPositionEnd) {\r\n\t\t\treturn this.x + (this.w * (this.linkPercent + 1)) / 2;\r\n\t\t} else {\r\n\t\t\treturn this.x + (this.w * (1 - this.linkPercent)) / 2;\r\n\t\t}\r\n\t}\r\n\r\n\ttop() {\r\n\t\tif (!this.vertical) {\r\n\t\t\treturn this.y - this.h / 2.0;\r\n\t\t} else if (this.linkPositionEnd) {\r\n\t\t\treturn this.y - (this.h * (1 - this.linkPercent)) / 2;\r\n\t\t} else {\r\n\t\t\treturn this.y - (this.h * (1 + this.linkPercent)) / 2;\r\n\t\t}\r\n\t}\r\n\r\n\tbottom() {\r\n\t\tif (!this.vertical) {\r\n\t\t\treturn this.y + this.h / 2.0;\r\n\t\t} else if (this.linkPositionEnd) {\r\n\t\t\treturn this.y + (this.h * (1 + this.linkPercent)) / 2;\r\n\t\t} else {\r\n\t\t\treturn this.y + (this.h * (1 - this.linkPercent)) / 2;\r\n\t\t}\r\n\t}\r\n\r\n\t// TODO: Should we move this to the draw function, and save the\r\n\t//       space of the arrays?  Bit of a leftover from the Flash code,\r\n\t//       which did drawing differently\r\n\tresetTextPosition() {\r\n\t\tif (this.vertical) {\r\n\t\t\tthis.labelPosX[0] = this.x;\r\n\r\n\t\t\tthis.labelPosY[0] =\r\n\t\t\t\tthis.y + ((this.h * (1 - this.linkPercent)) / 2) * (1 / this.numLabels - 1);\r\n\t\t\t//\t\t\t\tlabelPosY[0] = -height * (1-linkPercent) / 2 + height*(1-linkPercent)/2*numLabels;\r\n\t\t\tfor (let i = 1; i < this.numLabels; i++) {\r\n\t\t\t\tthis.labelPosY[i] =\r\n\t\t\t\t\tthis.labelPosY[i - 1] + (this.h * (1 - this.linkPercent)) / this.numLabels;\r\n\t\t\t\tthis.labelPosX[i] = this.x;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tthis.labelPosY[0] = this.y;\r\n\t\t\tthis.labelPosX[0] =\r\n\t\t\t\tthis.x + ((this.w * (1 - this.linkPercent)) / 2) * (1 / this.numLabels - 1);\r\n\t\t\tfor (let i = 1; i < this.numLabels; i++) {\r\n\t\t\t\tthis.labelPosY[i] = this.y;\r\n\t\t\t\tthis.labelPosX[i] =\r\n\t\t\t\t\tthis.labelPosX[i - 1] + (this.w * (1 - this.linkPercent)) / this.numLabels;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t// eslint-disable-next-line no-unused-vars\r\n\tgetTailPointerAttachPos(fromX, fromY, anchor) {\r\n\t\tif (this.vertical && this.linkPositionEnd) {\r\n\t\t\treturn [this.x, this.y + this.h / 2.0];\r\n\t\t} else if (this.vertical && !this.linkPositionEnd) {\r\n\t\t\treturn [this.x, this.y - this.h / 2.0];\r\n\t\t} else if (!this.vertical && this.linkPositionEnd) {\r\n\t\t\treturn [this.x + this.w / 2.0, this.y];\r\n\t\t} // (!this.vertical && !this.linkPositionEnd)\r\n\t\telse {\r\n\t\t\treturn [this.x - this.w / 2.0, this.y];\r\n\t\t}\r\n\t}\r\n\r\n\tgetHeadPointerAttachPos(fromX, fromY) {\r\n\t\treturn this.getClosestCardinalPoint(fromX, fromY);\r\n\t}\r\n\r\n\tsetWidth(wdth) {\r\n\t\tthis.w = wdth;\r\n\t\tthis.resetTextPosition();\r\n\t}\r\n\r\n\tsetHeight(hght) {\r\n\t\tthis.h = hght;\r\n\t\tthis.resetTextPosition();\r\n\t}\r\n\r\n\tgetWidth() {\r\n\t\treturn this.w;\r\n\t}\r\n\r\n\tgetHeight() {\r\n\t\treturn this.h;\r\n\t}\r\n\r\n\tdraw(context) {\r\n\t\tlet startX;\r\n\t\tlet startY;\r\n\r\n\t\tstartX = this.left();\r\n\t\tstartY = this.top();\r\n\r\n\t\tif (this.highlighted) {\r\n\t\t\tcontext.strokeStyle = \"#ff0000\";\r\n\t\t\tcontext.fillStyle = \"#ff0000\";\r\n\r\n\t\t\tcontext.beginPath();\r\n\t\t\tcontext.moveTo(startX - this.highlightDiff, startY - this.highlightDiff);\r\n\t\t\tcontext.lineTo(startX + this.w + this.highlightDiff, startY - this.highlightDiff);\r\n\t\t\tcontext.lineTo(\r\n\t\t\t\tstartX + this.w + this.highlightDiff,\r\n\t\t\t\tstartY + this.h + this.highlightDiff\r\n\t\t\t);\r\n\t\t\tcontext.lineTo(startX - this.highlightDiff, startY + this.h + this.highlightDiff);\r\n\t\t\tcontext.lineTo(startX - this.highlightDiff, startY - this.highlightDiff);\r\n\t\t\tcontext.closePath();\r\n\t\t\tcontext.stroke();\r\n\t\t\tcontext.fill();\r\n\t\t}\r\n\t\tcontext.strokeStyle = this.foregroundColor;\r\n\t\tcontext.fillStyle = this.backgroundColor;\r\n\r\n\t\tcontext.beginPath();\r\n\t\tcontext.moveTo(startX, startY);\r\n\t\tcontext.lineTo(startX + this.w, startY);\r\n\t\tcontext.lineTo(startX + this.w, startY + this.h);\r\n\t\tcontext.lineTo(startX, startY + this.h);\r\n\t\tcontext.lineTo(startX, startY);\r\n\t\tcontext.closePath();\r\n\t\tcontext.stroke();\r\n\t\tcontext.fill();\r\n\r\n\t\tlet i;\r\n\t\tif (this.vertical) {\r\n\t\t\tstartX = this.left();\r\n\t\t\tfor (i = 1; i < this.numLabels; i++) {\r\n\t\t\t\t//TODO: this doesn't look right ...\r\n\t\t\t\tstartY = this.y + this.h * (1 - this.linkPercent) * (i / this.numLabels - 1 / 2);\r\n\r\n\t\t\t\tcontext.beginPath();\r\n\t\t\t\tcontext.moveTo(startX, startY);\r\n\t\t\t\tcontext.lineTo(startX + this.w, startY);\r\n\t\t\t\tcontext.closePath();\r\n\t\t\t\tcontext.stroke();\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tstartY = this.top();\r\n\t\t\tfor (i = 1; i < this.numLabels; i++) {\r\n\t\t\t\tstartX = this.x + this.w * (1 - this.linkPercent) * (i / this.numLabels - 1 / 2);\r\n\t\t\t\tcontext.beginPath();\r\n\t\t\t\tcontext.moveTo(startX, startY);\r\n\t\t\t\tcontext.lineTo(startX, startY + this.h);\r\n\t\t\t\tcontext.closePath();\r\n\t\t\t\tcontext.stroke();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (this.vertical && this.linkPositionEnd) {\r\n\t\t\tstartX = this.left();\r\n\t\t\tstartY = this.bottom() - this.h * this.linkPercent;\r\n\r\n\t\t\tcontext.beginPath();\r\n\t\t\tcontext.moveTo(startX + this.w, startY);\r\n\t\t\tcontext.lineTo(startX, startY);\r\n\t\t\tif (this.nullPointer) {\r\n\t\t\t\tcontext.lineTo(this.startX + this.w, this.bottom());\r\n\t\t\t}\r\n\t\t\tcontext.closePath();\r\n\t\t\tcontext.stroke();\r\n\t\t} else if (this.vertical && !this.linkPositionEnd) {\r\n\t\t\tstartX = this.left();\r\n\t\t\tstartY = this.top() + this.h * this.linkPercent;\r\n\r\n\t\t\tcontext.beginPath();\r\n\t\t\tcontext.moveTo(startX + this.w, startY);\r\n\t\t\tcontext.lineTo(startX, startY);\r\n\t\t\tif (this.nullPointer) {\r\n\t\t\t\tcontext.lineTo(startX + this.w, this.top());\r\n\t\t\t}\r\n\t\t\tcontext.closePath();\r\n\t\t\tcontext.stroke();\r\n\t\t} else if (!this.vertical && this.linkPositionEnd) {\r\n\t\t\tstartX = this.right() - this.w * this.linkPercent;\r\n\t\t\tstartY = this.top();\r\n\r\n\t\t\tcontext.beginPath();\r\n\t\t\tcontext.moveTo(startX, startY + this.h);\r\n\t\t\tcontext.lineTo(startX, startY);\r\n\t\t\tif (this.nullPointer) {\r\n\t\t\t\tcontext.lineTo(this.right(), startY + this.h);\r\n\t\t\t}\r\n\t\t\tcontext.closePath();\r\n\t\t\tcontext.stroke();\r\n\t\t} // (!vertical && !linkPositionEnd)\r\n\t\telse {\r\n\t\t\tstartX = this.left() + this.w * this.linkPercent;\r\n\t\t\tstartY = this.top();\r\n\r\n\t\t\tcontext.beginPath();\r\n\t\t\tcontext.moveTo(startX, startY + this.h);\r\n\t\t\tcontext.lineTo(startX, startY);\r\n\t\t\tif (this.nullPointer) {\r\n\t\t\t\tcontext.lineTo(this.left(), startY);\r\n\t\t\t}\r\n\t\t\tcontext.closePath();\r\n\t\t\tcontext.stroke();\r\n\t\t}\r\n\r\n\t\tcontext.textAlign = \"center\";\r\n\t\tcontext.font = \"10px sans-serif\";\r\n\t\tcontext.textBaseline = \"middle\";\r\n\t\tcontext.lineWidth = 1;\r\n\r\n\t\tthis.resetTextPosition();\r\n\t\tfor (i = 0; i < this.numLabels; i++) {\r\n\t\t\tcontext.fillStyle = this.labelColors[i];\r\n\t\t\tcontext.fillText(this.labels[i], this.labelPosX[i], this.labelPosY[i]);\r\n\t\t}\r\n\t}\r\n\r\n\tsetTextColor(color, textIndex) {\r\n\t\tthis.labelColors[textIndex] = color;\r\n\t}\r\n\r\n\tgetTextColor(textIndex) {\r\n\t\treturn this.labelColors[textIndex];\r\n\t}\r\n\r\n\tgetText(index) {\r\n\t\treturn this.labels[index];\r\n\t}\r\n\r\n\tsetText(newText, textIndex) {\r\n\t\tthis.labels[textIndex] = newText;\r\n\t\tthis.resetTextPosition();\r\n\t}\r\n\r\n\tcreateUndoDelete() {\r\n\t\treturn new UndoDeleteLinkedList(\r\n\t\t\tthis.objectID,\r\n\t\t\tthis.numLabels,\r\n\t\t\tthis.labels,\r\n\t\t\tthis.x,\r\n\t\t\tthis.y,\r\n\t\t\tthis.w,\r\n\t\t\tthis.h,\r\n\t\t\tthis.linkPercent,\r\n\t\t\tthis.linkPositionEnd,\r\n\t\t\tthis.vertical,\r\n\t\t\tthis.labelColors,\r\n\t\t\tthis.backgroundColor,\r\n\t\t\tthis.foregroundColor,\r\n\t\t\tthis.layer,\r\n\t\t\tthis.nullPointer\r\n\t\t);\r\n\t}\r\n\r\n\tsetHighlight(value) {\r\n\t\tif (value !== this.highlighted) {\r\n\t\t\tthis.highlighted = value;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nclass UndoDeleteLinkedList extends UndoBlock {\r\n\tconstructor(\r\n\t\tid,\r\n\t\tnumlab,\r\n\t\tlab,\r\n\t\tx,\r\n\t\ty,\r\n\t\tw,\r\n\t\th,\r\n\t\tlinkper,\r\n\t\tposEnd,\r\n\t\tvert,\r\n\t\tlabColors,\r\n\t\tbgColor,\r\n\t\tfgColor,\r\n\t\tl,\r\n\t\tnp\r\n\t) {\r\n\t\tsuper();\r\n\t\tthis.objectID = id;\r\n\t\tthis.posX = x;\r\n\t\tthis.posY = y;\r\n\t\tthis.width = w;\r\n\t\tthis.height = h;\r\n\t\tthis.backgroundColor = bgColor;\r\n\t\tthis.foregroundColor = fgColor;\r\n\t\tthis.labels = lab;\r\n\t\tthis.linkPercent = linkper;\r\n\t\tthis.verticalOrentation = vert;\r\n\t\tthis.linkAtEnd = posEnd;\r\n\t\tthis.labelColors = labColors;\r\n\t\tthis.layer = l;\r\n\t\tthis.numLabels = numlab;\r\n\t\tthis.nullPointer = np;\r\n\t}\r\n\r\n\tundoInitialStep(world) {\r\n\t\tworld.addLinkedListObject(\r\n\t\t\tthis.objectID,\r\n\t\t\tthis.labels[0],\r\n\t\t\tthis.width,\r\n\t\t\tthis.height,\r\n\t\t\tthis.linkPercent,\r\n\t\t\tthis.verticalOrentation,\r\n\t\t\tthis.linkAtEnd,\r\n\t\t\tthis.numLabels,\r\n\t\t\tthis.backgroundColor,\r\n\t\t\tthis.foregroundColor\r\n\t\t);\r\n\t\tworld.setNodePosition(this.objectID, this.posX, this.posY);\r\n\t\tworld.setLayer(this.objectID, this.layer);\r\n\t\tworld.setNull(this.objectID, this.nullPointer);\r\n\t\tfor (let i = 0; i < this.numLabels; i++) {\r\n\t\t\tworld.setText(this.objectID, this.labels[i], i);\r\n\t\t\tworld.setTextColor(this.objectID, this.labelColors[i], i);\r\n\t\t}\r\n\t}\r\n}\r\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\r\n//\r\n// Redistribution and use in source and binary forms, with or without modification, are\r\n// permitted provided that the following conditions are met:\r\n//\r\n// 1. Redistributions of source code must retain the above copyright notice, this list of\r\n// conditions and the following disclaimer.\r\n//\r\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\r\n// of conditions and the following disclaimer in the documentation and/or other materials\r\n// provided with the distribution.\r\n//\r\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\r\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\r\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\r\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\r\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\r\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\r\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\r\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\r\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\r\n//\r\n// The views and conclusions contained in the software and documentation are those of the\r\n// authors and should not be interpreted as representing official policies, either expressed\r\n// or implied, of the University of San Francisco\r\n\r\n// Values for xJust / yJust:  \"center\", \"left\", \"right\", \"top\", \"bottom\"\r\n\r\nimport AnimatedObject from './AnimatedObject.js';\r\nimport { UndoBlock } from './UndoFunctions.js';\r\n\r\nexport default class AnimatedRectangle extends AnimatedObject {\r\n\tconstructor(id, val, wth, hgt, xJust, yJust, fillColor, edgeColor) {\r\n\t\tsuper();\r\n\t\tthis.w = wth;\r\n\t\tthis.h = hgt;\r\n\t\tthis.xJustify = xJust;\r\n\t\tthis.yJustify = yJust;\r\n\t\tthis.label = val;\r\n\t\tthis.labelColor = edgeColor;\r\n\r\n\t\tthis.backgroundColor = fillColor;\r\n\t\tthis.foregroundColor = edgeColor;\r\n\t\tthis.labelColor = this.foregroundColor;\r\n\t\tthis.highlighted = false;\r\n\t\tthis.objectID = id;\r\n\t\tthis.nullPointer = false;\r\n\t\tthis.alpha = 1.0;\r\n\t\tthis.addedToScene = true;\r\n\t}\r\n\r\n\tsetNull(np) {\r\n\t\tthis.nullPointer = np;\r\n\t}\r\n\r\n\tgetNull() {\r\n\t\treturn this.nullPointer;\r\n\t}\r\n\r\n\tleft() {\r\n\t\tif (this.xJustify === 'left') {\r\n\t\t\treturn this.x;\r\n\t\t} else if (this.xJustify === 'center') {\r\n\t\t\treturn this.x - this.w / 2.0;\r\n\t\t} // (this.xJustify == \"right\")\r\n\t\telse {\r\n\t\t\treturn this.x - this.w;\r\n\t\t}\r\n\t}\r\n\r\n\tcenterX() {\r\n\t\tif (this.xJustify === 'center') {\r\n\t\t\treturn this.x;\r\n\t\t} else if (this.xJustify === 'left') {\r\n\t\t\treturn this.x + this.w / 2.0;\r\n\t\t} // (this.xJustify == \"right\")\r\n\t\telse {\r\n\t\t\treturn this.x - this.w / 2.0;\r\n\t\t}\r\n\t}\r\n\r\n\tcenterY() {\r\n\t\tif (this.yJustify === 'center') {\r\n\t\t\treturn this.y;\r\n\t\t} else if (this.yJustify === 'top') {\r\n\t\t\treturn this.y + this.h / 2.0;\r\n\t\t} // (this.xJustify == \"bottom\")\r\n\t\telse {\r\n\t\t\treturn this.y - this.w / 2.0;\r\n\t\t}\r\n\t}\r\n\r\n\ttop() {\r\n\t\tif (this.yJustify === 'top') {\r\n\t\t\treturn this.y;\r\n\t\t} else if (this.yJustify === 'center') {\r\n\t\t\treturn this.y - this.h / 2.0;\r\n\t\t} //(this.xJustify == \"bottom\")\r\n\t\telse {\r\n\t\t\treturn this.y - this.h;\r\n\t\t}\r\n\t}\r\n\r\n\tbottom() {\r\n\t\tif (this.yJustify === 'top') {\r\n\t\t\treturn this.y + this.h;\r\n\t\t} else if (this.yJustify === 'center') {\r\n\t\t\treturn this.y + this.h / 2.0;\r\n\t\t} //(this.xJustify == \"bottom\")\r\n\t\telse {\r\n\t\t\treturn this.y;\r\n\t\t}\r\n\t}\r\n\r\n\tright() {\r\n\t\tif (this.xJustify === 'left') {\r\n\t\t\treturn this.x + this.w;\r\n\t\t} else if (this.xJustify === 'center') {\r\n\t\t\treturn this.x + this.w / 2.0;\r\n\t\t} // (this.xJustify == \"right\")\r\n\t\telse {\r\n\t\t\treturn this.x;\r\n\t\t}\r\n\t}\r\n\r\n\tgetHeadPointerAttachPos(fromX, fromY) {\r\n\t\treturn this.getClosestCardinalPoint(fromX, fromY);\r\n\t}\r\n\r\n\tgetTailPointerAttachPos(fromX, fromY, anchor) {\r\n\t\tswitch (anchor) {\r\n\t\t\tcase 0: // Default\r\n\t\t\t\treturn this.getClosestCardinalPoint(fromX, fromY);\r\n\t\t\tcase 1: // Top\r\n\t\t\t\treturn [this.x, this.top()];\r\n\t\t\tcase 2: // Bottom\r\n\t\t\t\treturn [this.x, this.bottom()];\r\n\t\t\tcase 3: // Left\r\n\t\t\t\treturn [this.left(), this.y];\r\n\t\t\tcase 4: // Right\r\n\t\t\t\treturn [this.right(), this.y];\r\n\t\t\tdefault:\r\n\t\t\t\treturn null;\r\n\t\t}\r\n\t}\r\n\r\n\tsetWidth(wdth) {\r\n\t\tthis.w = wdth;\r\n\t}\r\n\r\n\tsetHeight(hght) {\r\n\t\tthis.h = hght;\r\n\t}\r\n\r\n\tgetWidth() {\r\n\t\treturn this.w;\r\n\t}\r\n\r\n\tgetHeight() {\r\n\t\treturn this.h;\r\n\t}\r\n\r\n\t// TODO:  Fix me!\r\n\tdraw(context) {\r\n\t\tif (!this.addedToScene) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tlet startX;\r\n\t\tlet startY;\r\n\t\t// eslint-disable-next-line no-unused-vars\r\n\t\tlet labelPosX;\r\n\t\t// eslint-disable-next-line no-unused-vars\r\n\t\tlet labelPosY;\r\n\r\n\t\tcontext.globalAlpha = this.alpha;\r\n\r\n\t\tif (this.xJustify === 'left') {\r\n\t\t\tstartX = this.x;\r\n\t\t\tlabelPosX = this.x + this.w / 2.0;\r\n\t\t} else if (this.xJustify === 'center') {\r\n\t\t\tstartX = this.x - this.w / 2.0;\r\n\t\t\tlabelPosX = this.x;\r\n\t\t} else if (this.xJustify === 'right') {\r\n\t\t\tstartX = this.x - this.w;\r\n\t\t\tlabelPosX = this.x - this.w / 2.0;\r\n\t\t}\r\n\t\tif (this.yJustify === 'top') {\r\n\t\t\tstartY = this.y;\r\n\t\t\tlabelPosY = this.y + this.h / 2.0;\r\n\t\t} else if (this.yJustify === 'center') {\r\n\t\t\tstartY = this.y - this.h / 2.0;\r\n\t\t\tlabelPosY = this.y;\r\n\t\t} else if (this.yJustify === 'bottom') {\r\n\t\t\tstartY = this.y - this.h;\r\n\t\t\tlabelPosY = this.y - this.h / 2.0;\r\n\t\t}\r\n\r\n\t\tcontext.lineWidth = 1;\r\n\r\n\t\tif (this.highlighted) {\r\n\t\t\tcontext.strokeStyle = '#ff0000';\r\n\t\t\tcontext.fillStyle = '#ff0000';\r\n\r\n\t\t\tcontext.beginPath();\r\n\t\t\tcontext.moveTo(startX - this.highlightDiff, startY - this.highlightDiff);\r\n\t\t\tcontext.lineTo(startX + this.w + this.highlightDiff, startY - this.highlightDiff);\r\n\t\t\tcontext.lineTo(\r\n\t\t\t\tstartX + this.w + this.highlightDiff,\r\n\t\t\t\tstartY + this.h + this.highlightDiff\r\n\t\t\t);\r\n\t\t\tcontext.lineTo(startX - this.highlightDiff, startY + this.h + this.highlightDiff);\r\n\t\t\tcontext.lineTo(startX - this.highlightDiff, startY - this.highlightDiff);\r\n\t\t\tcontext.closePath();\r\n\t\t\tcontext.stroke();\r\n\t\t\tcontext.fill();\r\n\t\t}\r\n\t\tcontext.strokeStyle = this.foregroundColor;\r\n\t\tcontext.fillStyle = this.backgroundColor;\r\n\r\n\t\tcontext.beginPath();\r\n\t\tcontext.moveTo(startX, startY);\r\n\t\tcontext.lineTo(startX + this.w, startY);\r\n\t\tcontext.lineTo(startX + this.w, startY + this.h);\r\n\t\tcontext.lineTo(startX, startY + this.h);\r\n\t\tcontext.lineTo(startX, startY);\r\n\t\tcontext.closePath();\r\n\t\tcontext.stroke();\r\n\t\tcontext.fill();\r\n\r\n\t\tif (this.nullPointer) {\r\n\t\t\tcontext.beginPath();\r\n\t\t\tcontext.moveTo(startX, startY);\r\n\t\t\tcontext.lineTo(startX + this.w, startY + this.h);\r\n\t\t\tcontext.closePath();\r\n\t\t\tcontext.stroke();\r\n\t\t}\r\n\r\n\t\tcontext.fillStyle = this.labelColor;\r\n\r\n\t\tcontext.textAlign = 'center';\r\n\t\tcontext.font = '10px sans-serif';\r\n\t\tcontext.textBaseline = 'middle';\r\n\t\tcontext.lineWidth = 1;\r\n\t\tcontext.fillText(this.label, this.x, this.y);\r\n\t}\r\n\r\n\t// eslint-disable-next-line no-unused-vars\r\n\tsetText(newText, textIndex) {\r\n\t\tthis.label = newText;\r\n\t\t// TODO:  setting text position?\r\n\t}\r\n\r\n\tcreateUndoDelete() {\r\n\t\t// TODO: Add color?\r\n\t\treturn new UndoDeleteRectangle(\r\n\t\t\tthis.objectID,\r\n\t\t\tthis.label,\r\n\t\t\tthis.x,\r\n\t\t\tthis.y,\r\n\t\t\tthis.w,\r\n\t\t\tthis.h,\r\n\t\t\tthis.xJustify,\r\n\t\t\tthis.yJustify,\r\n\t\t\tthis.backgroundColor,\r\n\t\t\tthis.foregroundColor,\r\n\t\t\tthis.highlighted,\r\n\t\t\tthis.layer\r\n\t\t);\r\n\t}\r\n\r\n\tsetHighlight(value) {\r\n\t\tthis.highlighted = value;\r\n\t}\r\n}\r\n\r\nclass UndoDeleteRectangle extends UndoBlock {\r\n\tconstructor(id, lab, x, y, w, h, xJust, yJust, bgColor, fgColor, highlight, lay) {\r\n\t\tsuper();\r\n\t\tthis.objectID = id;\r\n\t\tthis.posX = x;\r\n\t\tthis.posY = y;\r\n\t\tthis.width = w;\r\n\t\tthis.height = h;\r\n\t\tthis.xJustify = xJust;\r\n\t\tthis.yJustify = yJust;\r\n\t\tthis.backgroundColor = bgColor;\r\n\t\tthis.foregroundColor = fgColor;\r\n\t\tthis.nodeLabel = lab;\r\n\t\tthis.layer = lay;\r\n\t\tthis.highlighted = highlight;\r\n\t}\r\n\r\n\tundoInitialStep(world) {\r\n\t\tworld.addRectangleObject(\r\n\t\t\tthis.objectID,\r\n\t\t\tthis.nodeLabel,\r\n\t\t\tthis.width,\r\n\t\t\tthis.height,\r\n\t\t\tthis.xJustify,\r\n\t\t\tthis.yJustify,\r\n\t\t\tthis.backgroundColor,\r\n\t\t\tthis.foregroundColor\r\n\t\t);\r\n\t\tworld.setNodePosition(this.objectID, this.posX, this.posY);\r\n\t\tworld.setLayer(this.objectID, this.layer);\r\n\t\tworld.setHighlight(this.objectID, this.highlighted);\r\n\t}\r\n}\r\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\r\n//\r\n// Redistribution and use in source and binary forms, with or without modification, are\r\n// permitted provided that the following conditions are met:\r\n//\r\n// 1. Redistributions of source code must retain the above copyright notice, this list of\r\n// conditions and the following disclaimer.\r\n//\r\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\r\n// of conditions and the following disclaimer in the documentation and/or other materials\r\n// provided with the distribution.\r\n//\r\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\r\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\r\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\r\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\r\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\r\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\r\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\r\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\r\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\r\n//\r\n// The views and conclusions contained in the software and documentation are those of the\r\n// authors and should not be interpreted as representing official policies, either expressed\r\n// or implied, of the University of San Francisco\r\n\r\nimport AnimatedObject from './AnimatedObject.js';\r\nimport { UndoBlock } from './UndoFunctions.js';\r\n\r\nexport default class AnimatedSkipList extends AnimatedObject {\r\n\tconstructor(objectID, label, w, h, labelColor, fillColor, edgeColor) {\r\n\t\tsuper();\r\n\r\n\t\tthis.w = w;\r\n\t\tthis.h = h;\r\n\t\tthis.fillColor = fillColor;\r\n\t\tthis.edgeColor = edgeColor;\r\n\r\n\t\tthis.label = label;\r\n\t\tthis.labelPosX = 0;\r\n\t\tthis.labelPosY = 0;\r\n\t\tthis.labelColor = labelColor;\r\n\r\n\t\tthis.highlighted = false;\r\n\t\tthis.objectID = objectID;\r\n\t}\r\n\r\n\tleft() {\r\n\t\treturn this.x - this.w / 2;\r\n\t}\r\n\r\n\tright() {\r\n\t\treturn this.x + this.w / 2;\r\n\t}\r\n\r\n\ttop() {\r\n\t\treturn this.y - this.h / 2;\r\n\t}\r\n\r\n\tbottom() {\r\n\t\treturn this.y + this.h / 2;\r\n\t}\r\n\r\n\tresetTextPosition() {\r\n\t\tthis.labelPosY = this.y;\r\n\t\tthis.labelPosX = this.x;\r\n\t}\r\n\r\n\tgetTailPointerAttachPos(fromX, fromY, anchor) {\r\n\t\tswitch (anchor) {\r\n\t\t\tcase 0: // Top\r\n\t\t\t\treturn [this.x, this.top()];\r\n\t\t\tcase 1: // Bottom\r\n\t\t\t\treturn [this.x, this.bottom()];\r\n\t\t\tcase 2: // Left\r\n\t\t\t\treturn [this.left(), this.y];\r\n\t\t\tcase 3: // Right\r\n\t\t\t\treturn [this.right(), this.y];\r\n\t\t\tdefault:\r\n\t\t\t\treturn;\r\n\t\t}\r\n\t}\r\n\r\n\tgetHeadPointerAttachPos(fromX, fromY) {\r\n\t\treturn this.getClosestCardinalPoint(fromX, fromY); // Normal anchor\r\n\t}\r\n\r\n\tsetWidth(wdth) {\r\n\t\tthis.w = wdth;\r\n\t\tthis.resetTextPosition();\r\n\t}\r\n\r\n\tsetHeight(hght) {\r\n\t\tthis.h = hght;\r\n\t\tthis.resetTextPosition();\r\n\t}\r\n\r\n\tgetWidth() {\r\n\t\treturn this.w;\r\n\t}\r\n\r\n\tgetHeight() {\r\n\t\treturn this.h;\r\n\t}\r\n\r\n\tdraw(context) {\r\n\t\tconst startX = this.left();\r\n\t\tconst startY = this.top();\r\n\r\n\t\tif (this.highlighted) {\r\n\t\t\tcontext.strokeStyle = '#ff0000';\r\n\t\t\tcontext.fillStyle = '#ff0000';\r\n\r\n\t\t\tcontext.beginPath();\r\n\t\t\tcontext.moveTo(startX - this.highlightDiff, startY - this.highlightDiff);\r\n\t\t\tcontext.lineTo(startX + this.w + this.highlightDiff, startY - this.highlightDiff);\r\n\t\t\tcontext.lineTo(\r\n\t\t\t\tstartX + this.w + this.highlightDiff,\r\n\t\t\t\tstartY + this.h + this.highlightDiff\r\n\t\t\t);\r\n\t\t\tcontext.lineTo(startX - this.highlightDiff, startY + this.h + this.highlightDiff);\r\n\t\t\tcontext.lineTo(startX - this.highlightDiff, startY - this.highlightDiff);\r\n\t\t\tcontext.closePath();\r\n\t\t\tcontext.stroke();\r\n\t\t\tcontext.fill();\r\n\t\t}\r\n\t\tcontext.strokeStyle = this.edgeColor;\r\n\t\tcontext.fillStyle = this.fillColor;\r\n\r\n\t\tcontext.beginPath();\r\n\t\tcontext.moveTo(startX, startY);\r\n\t\tcontext.lineTo(startX + this.w, startY);\r\n\t\tcontext.lineTo(startX + this.w, startY + this.h);\r\n\t\tcontext.lineTo(startX, startY + this.h);\r\n\t\tcontext.lineTo(startX, startY);\r\n\t\tcontext.closePath();\r\n\t\tcontext.stroke();\r\n\t\tcontext.fill();\r\n\r\n\t\tcontext.textAlign = 'center';\r\n\t\tcontext.font = '10px sans-serif';\r\n\t\tcontext.textBaseline = 'middle';\r\n\t\tcontext.lineWidth = 1;\r\n\r\n\t\tthis.resetTextPosition();\r\n\t\tcontext.fillStyle = this.labelColor;\r\n\t\tif (this.label === '\\u2212\\u221E' /* -inf */ || this.label === '\\u221E' /* inf */) {\r\n\t\t\tcontext.font = '18px Arial';\r\n\t\t}\r\n\t\tcontext.fillText(this.label, this.labelPosX, this.labelPosY);\r\n\t}\r\n\r\n\tsetTextColor(color) {\r\n\t\tthis.labelColor = color;\r\n\t}\r\n\r\n\tgetTextColor() {\r\n\t\treturn this.labelColor;\r\n\t}\r\n\r\n\tgetText() {\r\n\t\treturn this.label;\r\n\t}\r\n\r\n\tsetText(newText) {\r\n\t\tthis.label = newText;\r\n\t\tthis.resetTextPosition();\r\n\t}\r\n\r\n\tcreateUndoDelete() {\r\n\t\treturn new UndoDeleteSkipList(\r\n\t\t\tthis.objectID,\r\n\t\t\tthis.label,\r\n\t\t\tthis.w,\r\n\t\t\tthis.h,\r\n\t\t\tthis.x,\r\n\t\t\tthis.y,\r\n\t\t\tthis.labelColor,\r\n\t\t\tthis.fillColor,\r\n\t\t\tthis.edgeColor,\r\n\t\t\tthis.layer\r\n\t\t);\r\n\t}\r\n\r\n\tsetHighlight(value) {\r\n\t\tif (value !== this.highlighted) {\r\n\t\t\tthis.highlighted = value;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nclass UndoDeleteSkipList extends UndoBlock {\r\n\tconstructor(objectID, label, w, h, x, y, labelColor, fillColor, edgeColor, layer) {\r\n\t\tsuper();\r\n\t\tthis.objectID = objectID;\r\n\t\tthis.label = label;\r\n\t\tthis.w = w;\r\n\t\tthis.h = h;\r\n\t\tthis.x = x;\r\n\t\tthis.y = y;\r\n\t\tthis.labelColor = labelColor;\r\n\t\tthis.fillColor = fillColor;\r\n\t\tthis.edgeColor = edgeColor;\r\n\t\tthis.layer = layer;\r\n\t}\r\n\r\n\tundoInitialStep(world) {\r\n\t\tworld.addSkipListObject(\r\n\t\t\tthis.objectID,\r\n\t\t\tthis.label,\r\n\t\t\tthis.w,\r\n\t\t\tthis.h,\r\n\t\t\tthis.labelColor,\r\n\t\t\tthis.fillColor,\r\n\t\t\tthis.edgeColor\r\n\t\t);\r\n\t\tworld.setNodePosition(this.objectID, this.x, this.y);\r\n\t\tworld.setLayer(this.objectID, this.layer);\r\n\t}\r\n}\r\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\r\n//\r\n// Redistribution and use in source and binary forms, with or without modification, are\r\n// permitted provided that the following conditions are met:\r\n//\r\n// 1. Redistributions of source code must retain the above copyright notice, this list of\r\n// conditions and the following disclaimer.\r\n//\r\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\r\n// of conditions and the following disclaimer in the documentation and/or other materials\r\n// provided with the distribution.\r\n//\r\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\r\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\r\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\r\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\r\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\r\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\r\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\r\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\r\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\r\n//\r\n// The views and conclusions contained in the software and documentation are those of the\r\n// authors and should not be interpreted as representing official policies, either expressed\r\n// or implied, of the University of San Francisco\r\n\r\n// \"Class\" animatedCircle\r\n\r\nimport AnimatedObject from \"./AnimatedObject.js\";\r\nimport { UndoBlock } from \"./UndoFunctions.js\";\r\n\r\nexport default class HighlightCircle extends AnimatedObject {\r\n\tconstructor(objectID, color, radius) {\r\n\t\tsuper();\r\n\t\tthis.objectID = objectID;\r\n\t\tthis.radius = radius;\r\n\t\tthis.thickness = 4;\r\n\t\tthis.foregroundColor = color;\r\n\t\tthis.x = 0;\r\n\t\tthis.y = 0;\r\n\t\tthis.alpha = 1;\r\n\t}\r\n\r\n\tdraw(ctx) {\r\n\t\tctx.globalAlpha = this.alpha;\r\n\t\tctx.strokeStyle = this.foregroundColor;\r\n\t\tctx.lineWidth = this.thickness;\r\n\t\tctx.beginPath();\r\n\t\tctx.arc(this.x, this.y, this.radius, 0, Math.PI * 2, true);\r\n\t\tctx.closePath();\r\n\t\tctx.stroke();\r\n\t}\r\n\r\n\tcreateUndoDelete() {\r\n\t\treturn new UndoDeleteHighlightCircle(\r\n\t\t\tthis.objectID,\r\n\t\t\tthis.x,\r\n\t\t\tthis.y,\r\n\t\t\tthis.foregroundColor,\r\n\t\t\tthis.radius,\r\n\t\t\tthis.layer,\r\n\t\t\tthis.alpha\r\n\t\t);\r\n\t}\r\n}\r\n\r\nclass UndoDeleteHighlightCircle extends UndoBlock {\r\n\tconstructor(objectID, x, y, circleColor, r, layer, alpha) {\r\n\t\tsuper();\r\n\t\tthis.objectID = objectID;\r\n\t\tthis.x = x;\r\n\t\tthis.y = y;\r\n\t\tthis.color = circleColor;\r\n\t\tthis.r = r;\r\n\t\tthis.layer = layer;\r\n\t\tthis.alpha = alpha;\r\n\t}\r\n\r\n\tundoInitialStep(world) {\r\n\t\tworld.addHighlightCircleObject(this.objectID, this.color, this.r);\r\n\t\tworld.setLayer(this.objectID, this.layer);\r\n\t\tworld.setNodePosition(this.objectID, this.x, this.y);\r\n\t\tworld.setAlpha(this.objectID, this.alpha);\r\n\t}\r\n}\r\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\r\n//\r\n// Redistribution and use in source and binary forms, with or without modification, are\r\n// permitted provided that the following conditions are met:\r\n//\r\n// 1. Redistributions of source code must retain the above copyright notice, this list of\r\n// conditions and the following disclaimer.\r\n//\r\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\r\n// of conditions and the following disclaimer in the documentation and/or other materials\r\n// provided with the distribution.\r\n//\r\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\r\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\r\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\r\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\r\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\r\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\r\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\r\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\r\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\r\n//\r\n// The views and conclusions contained in the software and documentation are those of the\r\n// authors and should not be interpreted as representing official policies, either expressed\r\n// or implied, of the University of San Francisco\r\n\r\n// This class is somewhat poorly named -- it handles links between vertices in graphs,\r\n//  pointers in linked lists, and so on.\r\n\r\nconst LINE_maxHeightDiff = 5;\r\nconst LINE_minHeightDiff = 3;\r\nconst LINE_range = LINE_maxHeightDiff - LINE_minHeightDiff + 1;\r\n// const LINE_highlightDiff = 3;\r\n\r\nexport default class Line {\r\n\tconstructor(n1, n2, color, cv, d, weight, anchorIndex) {\r\n\t\tthis.arrowHeight = 8;\r\n\t\tthis.arrowWidth = 4;\r\n\r\n\t\tthis.Node1 = n1;\r\n\t\tthis.Node2 = n2;\r\n\t\tthis.Dirty = false;\r\n\t\tthis.directed = d;\r\n\t\tthis.edgeColor = color;\r\n\t\tthis.edgeLabel = weight;\r\n\t\tthis.highlighted = false;\r\n\t\tthis.addedToScene = true;\r\n\t\tthis.anchorPoint = anchorIndex;\r\n\t\tthis.highlightDiff = 0;\r\n\t\tthis.curve = cv;\r\n\r\n\t\tthis.alpha = 1.0;\r\n\t}\r\n\r\n\tcolor() {\r\n\t\treturn this.edgeColor;\r\n\t}\r\n\r\n\tsetColor(newColor) {\r\n\t\tthis.edgeColor = newColor;\r\n\t\tthis.Dirty = true;\r\n\t}\r\n\r\n\tsetHighlight(highlightVal) {\r\n\t\tthis.highlighted = highlightVal;\r\n\t}\r\n\r\n\tpulseHighlight(frameNum) {\r\n\t\tif (this.highlighted) {\r\n\t\t\tconst frameMod = frameNum / 14.0;\r\n\t\t\tconst delta = Math.abs((frameMod % (2 * LINE_range - 2)) - LINE_range + 1);\r\n\t\t\tthis.highlightDiff = delta + LINE_minHeightDiff;\r\n\t\t\tthis.Dirty = true;\r\n\t\t}\r\n\t}\r\n\r\n\thasNode(n) {\r\n\t\treturn this.Node1 === n || this.Node2 === n;\r\n\t}\r\n\r\n\tcreateUndoDisconnect() {\r\n\t\treturn new UndoConnect(\r\n\t\t\tthis.Node1.objectID,\r\n\t\t\tthis.Node2.objectID,\r\n\t\t\ttrue,\r\n\t\t\tthis.edgeColor,\r\n\t\t\tthis.directed,\r\n\t\t\tthis.curve,\r\n\t\t\tthis.edgeLabel,\r\n\t\t\tthis.anchorPoint\r\n\t\t);\r\n\t}\r\n\r\n\tsign(n) {\r\n\t\tif (n > 0) {\r\n\t\t\treturn 1;\r\n\t\t} else {\r\n\t\t\treturn -1;\r\n\t\t}\r\n\t}\r\n\r\n\tdrawArrow(pensize, color, context) {\r\n\t\tcontext.strokeStyle = color;\r\n\t\tcontext.fillStyle = color;\r\n\t\tcontext.lineWidth = pensize;\r\n\r\n\t\tconst fromPos = this.Node1.getTailPointerAttachPos(\r\n\t\t\tthis.Node2.x,\r\n\t\t\tthis.Node2.y,\r\n\t\t\tthis.anchorPoint\r\n\t\t);\r\n\t\tconst toPos = this.Node2.getHeadPointerAttachPos(this.Node1.x, this.Node1.y);\r\n\r\n\t\tconst deltaX = toPos[0] - fromPos[0];\r\n\t\tconst deltaY = toPos[1] - fromPos[1];\r\n\t\tconst midX = deltaX / 2.0 + fromPos[0];\r\n\t\tconst midY = deltaY / 2.0 + fromPos[1];\r\n\t\tconst controlX = midX - deltaY * this.curve;\r\n\r\n\t\tconst controlY = midY + deltaX * this.curve;\r\n\r\n\t\tcontext.beginPath();\r\n\t\tcontext.moveTo(fromPos[0], fromPos[1]);\r\n\t\tcontext.quadraticCurveTo(controlX, controlY, toPos[0], toPos[1]);\r\n\t\tcontext.stroke();\r\n\t\t//context.closePath();\r\n\r\n\t\t// Position of the edge label:  First, we will place it right along the\r\n\t\t// middle of the curve (or the middle of the line, for curve == 0)\r\n\t\tlet labelPosX = 0.25 * fromPos[0] + 0.5 * controlX + 0.25 * toPos[0];\r\n\t\tlet labelPosY = 0.25 * fromPos[1] + 0.5 * controlY + 0.25 * toPos[1];\r\n\r\n\t\t// Next, we push the edge position label out just a little in the direction of\r\n\t\t// the curve, so that the label doesn't intersect the cuve (as long as the label\r\n\t\t// is only a few characters, that is)\r\n\t\tconst midLen = Math.sqrt(deltaY * deltaY + deltaX * deltaX);\r\n\t\tif (midLen !== 0) {\r\n\t\t\tlabelPosX += ((-deltaY * this.sign(this.curve)) / midLen) * 10;\r\n\t\t\tlabelPosY += ((deltaX * this.sign(this.curve)) / midLen) * 10;\r\n\t\t}\r\n\r\n\t\tcontext.textAlign = 'center';\r\n\t\tcontext.font = '10px sans-serif';\r\n\t\tcontext.textBaseline = 'middle';\r\n\t\tcontext.fillText(this.edgeLabel, labelPosX, labelPosY);\r\n\r\n\t\tif (this.directed) {\r\n\t\t\tlet xVec = controlX - toPos[0];\r\n\t\t\tlet yVec = controlY - toPos[1];\r\n\t\t\tconst len = Math.sqrt(xVec * xVec + yVec * yVec);\r\n\r\n\t\t\tif (len > 0) {\r\n\t\t\t\txVec = xVec / len;\r\n\t\t\t\tyVec = yVec / len;\r\n\r\n\t\t\t\tcontext.beginPath();\r\n\t\t\t\tcontext.moveTo(toPos[0], toPos[1]);\r\n\t\t\t\tcontext.lineTo(\r\n\t\t\t\t\ttoPos[0] + xVec * this.arrowHeight - yVec * this.arrowWidth,\r\n\t\t\t\t\ttoPos[1] + yVec * this.arrowHeight + xVec * this.arrowWidth\r\n\t\t\t\t);\r\n\t\t\t\tcontext.lineTo(\r\n\t\t\t\t\ttoPos[0] + xVec * this.arrowHeight + yVec * this.arrowWidth,\r\n\t\t\t\t\ttoPos[1] + yVec * this.arrowHeight - xVec * this.arrowWidth\r\n\t\t\t\t);\r\n\t\t\t\tcontext.lineTo(toPos[0], toPos[1]);\r\n\t\t\t\tcontext.closePath();\r\n\t\t\t\tcontext.stroke();\r\n\t\t\t\tcontext.fill();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tdraw(ctx) {\r\n\t\tif (!this.addedToScene) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tctx.globalAlpha = this.alpha;\r\n\r\n\t\tif (this.highlighted) this.drawArrow(this.highlightDiff, '#FF0000', ctx);\r\n\t\tthis.drawArrow(1, this.edgeColor, ctx);\r\n\t}\r\n}\r\n\r\nexport class UndoConnect {\r\n\tconstructor(from, to, createConnection, edgeColor, isDirected, cv, lab, anch) {\r\n\t\tthis.fromID = from;\r\n\t\tthis.toID = to;\r\n\t\tthis.connect = createConnection;\r\n\t\tthis.color = edgeColor;\r\n\t\tthis.directed = isDirected;\r\n\t\tthis.curve = cv;\r\n\t\tthis.edgeLabel = lab;\r\n\t\tthis.anchorPoint = anch;\r\n\t}\r\n\r\n\tundoInitialStep(world) {\r\n\t\tif (this.connect) {\r\n\t\t\tworld.connectEdge(\r\n\t\t\t\tthis.fromID,\r\n\t\t\t\tthis.toID,\r\n\t\t\t\tthis.color,\r\n\t\t\t\tthis.curve,\r\n\t\t\t\tthis.directed,\r\n\t\t\t\tthis.edgeLabel,\r\n\t\t\t\tthis.anchorPoint\r\n\t\t\t);\r\n\t\t} else {\r\n\t\t\tworld.disconnect(this.fromID, this.toID);\r\n\t\t}\r\n\t}\r\n\r\n\taddUndoAnimation() {\r\n\t\treturn false;\r\n\t}\r\n}\r\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\r\n//\r\n// Redistribution and use in source and binary forms, with or without modification, are\r\n// permitted provided that the following conditions are met:\r\n//\r\n// 1. Redistributions of source code must retain the above copyright notice, this list of\r\n// conditions and the following disclaimer.\r\n//\r\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\r\n// of conditions and the following disclaimer in the documentation and/or other materials\r\n// provided with the distribution.\r\n//\r\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\r\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\r\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\r\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\r\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\r\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\r\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\r\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\r\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\r\n//\r\n// The views and conclusions contained in the software and documentation are those of the\r\n// authors and should not be interpreted as representing official policies, either expressed\r\n// or implied, of the University of San Francisco\r\n\r\n// Object Manager\r\n//\r\n// Manage all of our animated objects.  Control any animated object should occur through\r\n// this interface (not language enforced, because enforcing such things in Javascript is\r\n// problematic.)\r\n//\r\n// This class is only accessed through:\r\n//\r\n//  AnimationMain\r\n//  Undo objects (which are themselves controlled by AnimationMain\r\n\r\nimport AnimatedBTreeNode from './AnimatedBTreeNode.js';\r\nimport AnimatedCircle from './AnimatedCircle.js';\r\nimport AnimatedCircularlyLinkedList from './AnimatedCircularlyLinkedList.js';\r\nimport AnimatedDoublyLinkedList from './AnimatedDoublyLinkedList.js';\r\nimport AnimatedLabel from './AnimatedLabel.js';\r\nimport AnimatedLinkedList from './AnimatedLinkedList.js';\r\nimport AnimatedRectangle from './AnimatedRectangle.js';\r\nimport AnimatedSkipList from './AnimatedSkipList.js';\r\nimport HighlightCircle from './HighlightCircle.js';\r\nimport Line from './Line.js';\r\n\r\nexport default class ObjectManager {\r\n\tconstructor(canvasRef) {\r\n\t\tthis.Nodes = [];\r\n\t\tthis.Edges = [];\r\n\t\tthis.BackEdges = [];\r\n\t\tthis.activeLayers = [];\r\n\t\tthis.activeLayers[0] = true;\r\n\t\tthis.ctx = canvasRef.current.getContext('2d');\r\n\t\tthis.framenum = 0;\r\n\t\tthis.width = 0;\r\n\t\tthis.height = 0;\r\n\t\tthis.statusReport = new AnimatedLabel(-1, 'XXX', false, 30);\r\n\t\tthis.statusReport.x = 30;\r\n\t}\r\n\r\n\tdraw() {\r\n\t\tthis.framenum++;\r\n\t\tif (this.framenum > 1000) this.framenum = 0;\r\n\r\n\t\tthis.ctx.clearRect(0, 0, this.width, this.height); // clear canvas\r\n\t\tthis.statusReport.y = this.height - 15;\r\n\r\n\t\tlet i;\r\n\t\tlet j;\r\n\t\tfor (i = 0; i < this.Nodes.length; i++) {\r\n\t\t\tif (\r\n\t\t\t\tthis.Nodes[i] != null &&\r\n\t\t\t\t!this.Nodes[i].highlighted &&\r\n\t\t\t\tthis.Nodes[i].addedToScene &&\r\n\t\t\t\t!this.Nodes[i].alwaysOnTop\r\n\t\t\t) {\r\n\t\t\t\tthis.Nodes[i].draw(this.ctx);\r\n\t\t\t}\r\n\t\t}\r\n\t\tfor (i = 0; i < this.Nodes.length; i++) {\r\n\t\t\tif (\r\n\t\t\t\tthis.Nodes[i] != null &&\r\n\t\t\t\tthis.Nodes[i].highlighted &&\r\n\t\t\t\t!this.Nodes[i].alwaysOnTop &&\r\n\t\t\t\tthis.Nodes[i].addedToScene\r\n\t\t\t) {\r\n\t\t\t\tthis.Nodes[i].pulseHighlight(this.framenum);\r\n\t\t\t\tthis.Nodes[i].draw(this.ctx);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tfor (i = 0; i < this.Nodes.length; i++) {\r\n\t\t\tif (this.Nodes[i] != null && this.Nodes[i].alwaysOnTop && this.Nodes[i].addedToScene) {\r\n\t\t\t\tthis.Nodes[i].pulseHighlight(this.framenum);\r\n\t\t\t\tthis.Nodes[i].draw(this.ctx);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tfor (i = 0; i < this.Edges.length; i++) {\r\n\t\t\tif (this.Edges[i] != null) {\r\n\t\t\t\tfor (j = 0; j < this.Edges[i].length; j++) {\r\n\t\t\t\t\tif (this.Edges[i][j].addedToScene) {\r\n\t\t\t\t\t\tthis.Edges[i][j].pulseHighlight(this.framenum);\r\n\t\t\t\t\t\tthis.Edges[i][j].draw(this.ctx);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.statusReport.draw(this.ctx);\r\n\t}\r\n\r\n\tupdate() {}\r\n\r\n\tsetLayers(shown, layers) {\r\n\t\tfor (let i = 0; i < layers.length; i++) {\r\n\t\t\tthis.activeLayers[layers[i]] = shown;\r\n\t\t}\r\n\t\tthis.resetLayers();\r\n\t}\r\n\r\n\taddHighlightCircleObject(objectID, objectColor, radius) {\r\n\t\tif (this.Nodes[objectID] != null && this.Nodes[objectID] !== undefined) {\r\n\t\t\tthrow new Error(\r\n\t\t\t\t'addHighlightCircleObject:Object with same ID (' +\r\n\t\t\t\t\tString(objectID) +\r\n\t\t\t\t\t') already Exists!'\r\n\t\t\t);\r\n\t\t}\r\n\t\tconst newNode = new HighlightCircle(objectID, objectColor, radius);\r\n\t\tthis.Nodes[objectID] = newNode;\r\n\t}\r\n\r\n\tsetEdgeAlpha(fromID, toID, alphaVal) {\r\n\t\tlet oldAlpha = 1.0;\r\n\t\tif (this.Edges[fromID] != null && this.Edges[fromID] !== undefined) {\r\n\t\t\tconst len = this.Edges[fromID].length;\r\n\t\t\tfor (let i = len - 1; i >= 0; i--) {\r\n\t\t\t\tif (\r\n\t\t\t\t\tthis.Edges[fromID][i] != null &&\r\n\t\t\t\t\tthis.Edges[fromID][i] !== undefined &&\r\n\t\t\t\t\tthis.Edges[fromID][i].Node2 === this.Nodes[toID]\r\n\t\t\t\t) {\r\n\t\t\t\t\toldAlpha = this.Edges[fromID][i].alpha;\r\n\t\t\t\t\tthis.Edges[fromID][i].alpha = alphaVal;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn oldAlpha;\r\n\t}\r\n\r\n\tsetAlpha(nodeID, alphaVal) {\r\n\t\tif (this.Nodes[nodeID] != null && this.Nodes[nodeID] !== undefined) {\r\n\t\t\tthis.Nodes[nodeID].setAlpha(alphaVal);\r\n\t\t}\r\n\t}\r\n\r\n\tgetAlpha(nodeID) {\r\n\t\tif (this.Nodes[nodeID] != null && this.Nodes[nodeID] !== undefined) {\r\n\t\t\treturn this.Nodes[nodeID].getAlpha();\r\n\t\t} else {\r\n\t\t\treturn -1;\r\n\t\t}\r\n\t}\r\n\r\n\tgetTextColor(nodeID, index) {\r\n\t\tif (this.Nodes[nodeID] != null && this.Nodes[nodeID] !== undefined) {\r\n\t\t\treturn this.Nodes[nodeID].getTextColor(index);\r\n\t\t} else {\r\n\t\t\treturn '#000000';\r\n\t\t}\r\n\t}\r\n\r\n\tsetTextColor(nodeID, color, index) {\r\n\t\tif (this.Nodes[nodeID] != null && this.Nodes[nodeID] !== undefined) {\r\n\t\t\tthis.Nodes[nodeID].setTextColor(color, index);\r\n\t\t}\r\n\t}\r\n\r\n\tsetHighlightIndex(nodeID, index) {\r\n\t\tif (this.Nodes[nodeID] != null && this.Nodes[nodeID] !== undefined) {\r\n\t\t\tthis.Nodes[nodeID].setHighlightIndex(index);\r\n\t\t}\r\n\t}\r\n\r\n\tsetAllLayers(layers) {\r\n\t\tthis.activeLayers = [];\r\n\t\tfor (let i = 0; i < layers.length; i++) {\r\n\t\t\tthis.activeLayers[layers[i]] = true;\r\n\t\t}\r\n\t\tthis.resetLayers();\r\n\t}\r\n\r\n\tresetLayers() {\r\n\t\tlet i;\r\n\t\tfor (i = 0; i < this.Nodes.length; i++) {\r\n\t\t\tif (this.Nodes[i] != null && this.Nodes[i] !== undefined) {\r\n\t\t\t\tthis.Nodes[i].addedToScene = this.activeLayers[this.Nodes[i].layer] === true;\r\n\t\t\t}\r\n\t\t}\r\n\t\tfor (i = this.Edges.length - 1; i >= 0; i--) {\r\n\t\t\tif (this.Edges[i] != null && this.Edges[i] !== undefined) {\r\n\t\t\t\tfor (let j = 0; j < this.Edges[i].length; j++) {\r\n\t\t\t\t\tif (this.Edges[i][j] != null && this.Edges[i][j] !== undefined) {\r\n\t\t\t\t\t\tthis.Edges[i][j].addedToScene =\r\n\t\t\t\t\t\t\tthis.activeLayers[this.Edges[i][j].Node1.layer] === true &&\r\n\t\t\t\t\t\t\tthis.activeLayers[this.Edges[i][j].Node2.layer] === true;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tsetLayer(objectID, layer) {\r\n\t\tif (this.Nodes[objectID] != null && this.Nodes[objectID] !== undefined) {\r\n\t\t\tthis.Nodes[objectID].layer = layer;\r\n\t\t\tif (this.activeLayers[layer]) {\r\n\t\t\t\tthis.Nodes[objectID].addedToScene = true;\r\n\t\t\t} else {\r\n\t\t\t\tthis.Nodes[objectID].addedToScene = false;\r\n\t\t\t}\r\n\t\t\tif (this.Edges[objectID] != null && this.Edges[objectID] !== undefined) {\r\n\t\t\t\tfor (let i = 0; i < this.Edges[objectID].length; i++) {\r\n\t\t\t\t\tconst nextEdge = this.Edges[objectID][i];\r\n\t\t\t\t\tif (nextEdge != null && nextEdge !== undefined) {\r\n\t\t\t\t\t\tnextEdge.addedToScene =\r\n\t\t\t\t\t\t\tnextEdge.Node1.addedToScene && nextEdge.Node2.addedToScene;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (this.BackEdges[objectID] != null && this.BackEdges[objectID] !== undefined) {\r\n\t\t\t\tfor (let i = 0; i < this.BackEdges[objectID].length; i++) {\r\n\t\t\t\t\tconst nextEdge = this.BackEdges[objectID][i];\r\n\t\t\t\t\tif (nextEdge != null && nextEdge !== undefined) {\r\n\t\t\t\t\t\tnextEdge.addedToScene =\r\n\t\t\t\t\t\t\tnextEdge.Node1.addedToScene && nextEdge.Node2.addedToScene;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tclearAllObjects() {\r\n\t\tthis.Nodes = [];\r\n\t\tthis.Edges = [];\r\n\t\tthis.BackEdges = [];\r\n\t}\r\n\r\n\tsetForegroundColor(objectID, color) {\r\n\t\tif (this.Nodes[objectID] != null && this.Nodes[objectID] !== undefined) {\r\n\t\t\tthis.Nodes[objectID].setForegroundColor(color);\r\n\t\t}\r\n\t}\r\n\r\n\tsetBackgroundColor(objectID, color) {\r\n\t\tif (this.Nodes[objectID] != null) {\r\n\t\t\tthis.Nodes[objectID].setBackgroundColor(color);\r\n\t\t}\r\n\t}\r\n\r\n\tsetHighlight(nodeID, val, color) {\r\n\t\tif (this.Nodes[nodeID] == null || this.Nodes[nodeID] === undefined) {\r\n\t\t\t// TODO:  Error here?\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tthis.Nodes[nodeID].setHighlight(val, color);\r\n\t}\r\n\r\n\tgetHighlight(nodeID) {\r\n\t\tif (this.Nodes[nodeID] == null || this.Nodes[nodeID] === undefined) {\r\n\t\t\t// TODO:  Error here?\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\treturn this.Nodes[nodeID].getHighlight();\r\n\t}\r\n\r\n\tgetHighlightIndex(nodeID) {\r\n\t\tif (this.Nodes[nodeID] == null || this.Nodes[nodeID] === undefined) {\r\n\t\t\t// TODO:  Error here?\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\treturn this.Nodes[nodeID].getHighlightIndex();\r\n\t}\r\n\r\n\tsetWidth(nodeID, val) {\r\n\t\tif (this.Nodes[nodeID] == null || this.Nodes[nodeID] === undefined) {\r\n\t\t\t// TODO:  Error here?\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tthis.Nodes[nodeID].setWidth(val);\r\n\t}\r\n\r\n\tsetHeight(nodeID, val) {\r\n\t\tif (this.Nodes[nodeID] == null || this.Nodes[nodeID] === undefined) {\r\n\t\t\t// TODO:  Error here?\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tthis.Nodes[nodeID].setHeight(val);\r\n\t}\r\n\r\n\tgetHeight(nodeID) {\r\n\t\tif (this.Nodes[nodeID] == null || this.Nodes[nodeID] === undefined) {\r\n\t\t\t// TODO:  Error here?\r\n\t\t\treturn -1;\r\n\t\t}\r\n\t\treturn this.Nodes[nodeID].getHeight();\r\n\t}\r\n\r\n\tgetWidth(nodeID) {\r\n\t\tif (this.Nodes[nodeID] == null || this.Nodes[nodeID] === undefined) {\r\n\t\t\t// TODO:  Error here?\r\n\t\t\treturn -1;\r\n\t\t}\r\n\t\treturn this.Nodes[nodeID].getWidth();\r\n\t}\r\n\r\n\tbackgroundColor(objectID) {\r\n\t\tif (this.Nodes[objectID] != null) {\r\n\t\t\treturn this.Nodes[objectID].backgroundColor;\r\n\t\t} else {\r\n\t\t\treturn '#000000';\r\n\t\t}\r\n\t}\r\n\r\n\tforegroundColor(objectID) {\r\n\t\tif (this.Nodes[objectID] != null) {\r\n\t\t\treturn this.Nodes[objectID].foregroundColor;\r\n\t\t} else {\r\n\t\t\treturn '#000000';\r\n\t\t}\r\n\t}\r\n\r\n\tdisconnect(objectIDfrom, objectIDto) {\r\n\t\tlet undo = null;\r\n\t\tlet len;\r\n\t\tlet deleted;\r\n\t\tif (this.Edges[objectIDfrom] != null) {\r\n\t\t\tlen = this.Edges[objectIDfrom].length;\r\n\t\t\tfor (let i = len - 1; i >= 0; i--) {\r\n\t\t\t\tif (\r\n\t\t\t\t\tthis.Edges[objectIDfrom][i] != null &&\r\n\t\t\t\t\tthis.Edges[objectIDfrom][i].Node2 === this.Nodes[objectIDto]\r\n\t\t\t\t) {\r\n\t\t\t\t\tdeleted = this.Edges[objectIDfrom][i];\r\n\t\t\t\t\tundo = deleted.createUndoDisconnect();\r\n\t\t\t\t\tthis.Edges[objectIDfrom][i] = this.Edges[objectIDfrom][len - 1];\r\n\t\t\t\t\tlen -= 1;\r\n\t\t\t\t\tthis.Edges[objectIDfrom].pop();\r\n\t\t\t\t\t// break;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (this.BackEdges[objectIDto] != null) {\r\n\t\t\tlen = this.BackEdges[objectIDto].length;\r\n\t\t\tfor (let i = len - 1; i >= 0; i--) {\r\n\t\t\t\tif (\r\n\t\t\t\t\tthis.BackEdges[objectIDto][i] != null &&\r\n\t\t\t\t\tthis.BackEdges[objectIDto][i].Node1 === this.Nodes[objectIDfrom]\r\n\t\t\t\t) {\r\n\t\t\t\t\tdeleted = this.BackEdges[objectIDto][i];\r\n\t\t\t\t\t// Note:  Don't need to remove this child, did it above on the regular edge\r\n\t\t\t\t\tthis.BackEdges[objectIDto][i] = this.BackEdges[objectIDto][len - 1];\r\n\t\t\t\t\tlen -= 1;\r\n\t\t\t\t\tthis.BackEdges[objectIDto].pop();\r\n\t\t\t\t\t// break;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn undo;\r\n\t}\r\n\r\n\tdeleteIncident(objectID) {\r\n\t\tconst undoStack = [];\r\n\t\tlet len;\r\n\t\tlet deleted;\r\n\t\tif (this.Edges[objectID] != null) {\r\n\t\t\tlen = this.Edges[objectID].length;\r\n\t\t\tfor (let i = len - 1; i >= 0; i--) {\r\n\t\t\t\tdeleted = this.Edges[objectID][i];\r\n\t\t\t\tconst node2ID = deleted.Node2.identifier();\r\n\t\t\t\tundoStack.push(deleted.createUndoDisconnect());\r\n\r\n\t\t\t\tlet len2 = this.BackEdges[node2ID].length;\r\n\t\t\t\tfor (let j = len2 - 1; j >= 0; j--) {\r\n\t\t\t\t\tif (this.BackEdges[node2ID][j] === deleted) {\r\n\t\t\t\t\t\tthis.BackEdges[node2ID][j] = this.BackEdges[node2ID][len2 - 1];\r\n\t\t\t\t\t\tlen2 -= 1;\r\n\t\t\t\t\t\tthis.BackEdges[node2ID].pop();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.Edges[objectID] = null;\r\n\t\t}\r\n\t\tif (this.BackEdges[objectID] != null) {\r\n\t\t\tlen = this.BackEdges[objectID].length;\r\n\t\t\tfor (let i = len - 1; i >= 0; i--) {\r\n\t\t\t\tdeleted = this.BackEdges[objectID][i];\r\n\t\t\t\tconst node1ID = deleted.Node1.identifier();\r\n\t\t\t\tundoStack.push(deleted.createUndoDisconnect());\r\n\r\n\t\t\t\tlet len2 = this.Edges[node1ID].length;\r\n\t\t\t\tfor (let j = len2 - 1; j >= 0; j--) {\r\n\t\t\t\t\tif (this.Edges[node1ID][j] === deleted) {\r\n\t\t\t\t\t\tthis.Edges[node1ID][j] = this.Edges[node1ID][len2 - 1];\r\n\t\t\t\t\t\tlen2 -= 1;\r\n\t\t\t\t\t\tthis.Edges[node1ID].pop();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.BackEdges[objectID] = null;\r\n\t\t}\r\n\t\treturn undoStack;\r\n\t}\r\n\r\n\tremoveObject(ObjectID) {\r\n\t\tconst OldObject = this.Nodes[ObjectID];\r\n\t\tif (ObjectID === this.Nodes.length - 1) {\r\n\t\t\tthis.Nodes.pop();\r\n\t\t} else {\r\n\t\t\tthis.Nodes[ObjectID] = null;\r\n\t\t}\r\n\t\treturn OldObject;\r\n\t}\r\n\r\n\tgetObject(objectID) {\r\n\t\tif (this.Nodes[objectID] == null || this.Nodes[objectID] === undefined) {\r\n\t\t\tthrow new Error('getObject:Object with ID (' + String(objectID) + ') does not exist');\r\n\t\t}\r\n\t\treturn this.Nodes[objectID];\r\n\t}\r\n\r\n\taddCircleObject(objectID, objectLabel) {\r\n\t\tif (this.Nodes[objectID] != null && this.Nodes[objectID] !== undefined) {\r\n\t\t\tthrow new Error(\r\n\t\t\t\t'addCircleObject:Object with same ID (' + String(objectID) + ') already Exists!'\r\n\t\t\t);\r\n\t\t}\r\n\t\tconst newNode = new AnimatedCircle(objectID, objectLabel);\r\n\t\tthis.Nodes[objectID] = newNode;\r\n\t}\r\n\r\n\tgetNodeX(nodeID) {\r\n\t\tif (this.Nodes[nodeID] == null || this.Nodes[nodeID] === undefined) {\r\n\t\t\tthrow new Error('getting x position of an object that does not exit');\r\n\t\t}\r\n\t\treturn this.Nodes[nodeID].x;\r\n\t}\r\n\r\n\tgetTextWidth(text) {\r\n\t\t// TODO:  Need to make fonts more flexible, and less hardwired.\r\n\t\tthis.ctx.font = '10px sans-serif';\r\n\t\t// if (text === undefined) {\r\n\t\t// \tw = 3;\r\n\t\t// }\r\n\t\tconst strList = text.split('\\n');\r\n\t\tlet width = 0;\r\n\t\tif (strList.length === 1) {\r\n\t\t\twidth = this.ctx.measureText(text).width;\r\n\t\t} else {\r\n\t\t\tfor (let i = 0; i < strList.length; i++) {\r\n\t\t\t\twidth = Math.max(width, this.ctx.measureText(strList[i]).width);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn width;\r\n\t}\r\n\r\n\tsetText(nodeID, text, index) {\r\n\t\tif (this.Nodes[nodeID] == null || this.Nodes[nodeID] === undefined) {\r\n\t\t\tthrow new Error('setting text of an object that does not exist');\r\n\t\t}\r\n\t\tthis.Nodes[nodeID].setText(text, index, this.getTextWidth(text));\r\n\t}\r\n\r\n\tgetText(nodeID, index) {\r\n\t\tif (this.Nodes[nodeID] == null || this.Nodes[nodeID] === undefined) {\r\n\t\t\tthrow new Error('getting text of an object that does not exit');\r\n\t\t}\r\n\t\treturn this.Nodes[nodeID].getText(index);\r\n\t}\r\n\r\n\tgetNodeY(nodeID) {\r\n\t\tif (this.Nodes[nodeID] == null || this.Nodes[nodeID] === undefined) {\r\n\t\t\tthrow new Error('getting y position of an object that does not exit');\r\n\t\t}\r\n\t\treturn this.Nodes[nodeID].y;\r\n\t}\r\n\r\n\tconnectEdge(objectIDfrom, objectIDto, color, curve, directed, lab, connectionPoint) {\r\n\t\tconst fromObj = this.Nodes[objectIDfrom];\r\n\t\tconst toObj = this.Nodes[objectIDto];\r\n\t\tif (fromObj == null || toObj == null) {\r\n\t\t\tthrow new Error(\"Tried to connect two nodes, one didn't exist!\");\r\n\t\t}\r\n\t\tconst l = new Line(fromObj, toObj, color, curve, directed, lab, connectionPoint);\r\n\t\tif (this.Edges[objectIDfrom] == null) {\r\n\t\t\tthis.Edges[objectIDfrom] = [];\r\n\t\t}\r\n\t\tif (this.BackEdges[objectIDto] == null) {\r\n\t\t\tthis.BackEdges[objectIDto] = [];\r\n\t\t}\r\n\t\t// if (\r\n\t\t// \tthis.Edges[objectIDfrom].some(x => x.Node2.objectID === objectIDto) &&\r\n\t\t// \tthis.BackEdges[objectIDto].some(x => x.Node1.objectID === objectIDfrom)\r\n\t\t// ) {\r\n\t\t// \treturn;\r\n\t\t// }\r\n\t\tl.addedToScene = fromObj.addedToScene && toObj.addedToScene;\r\n\t\tthis.Edges[objectIDfrom].push(l);\r\n\t\tthis.BackEdges[objectIDto].push(l);\r\n\t}\r\n\r\n\tsetNull(objectID, nullVal) {\r\n\t\tif (this.Nodes[objectID] != null && this.Nodes[objectID] !== undefined) {\r\n\t\t\tthis.Nodes[objectID].setNull(nullVal);\r\n\t\t}\r\n\t}\r\n\r\n\tsetPrevNull(objectID, nullVal) {\r\n\t\tif (this.Nodes[objectID] != null && this.Nodes[objectID] !== undefined) {\r\n\t\t\tthis.Nodes[objectID].setPrevNull(nullVal);\r\n\t\t}\r\n\t}\r\n\r\n\tsetNextNull(objectID, nullVal) {\r\n\t\tif (this.Nodes[objectID] != null && this.Nodes[objectID] !== undefined) {\r\n\t\t\tthis.Nodes[objectID].setNextNull(nullVal);\r\n\t\t}\r\n\t}\r\n\r\n\tgetNull(objectID) {\r\n\t\tif (this.Nodes[objectID] != null && this.Nodes[objectID] !== undefined) {\r\n\t\t\treturn this.Nodes[objectID].getNull();\r\n\t\t}\r\n\t\treturn false; // TODO:  Error here?\r\n\t}\r\n\r\n\tgetLeftNull(objectID) {\r\n\t\tif (this.Nodes[objectID] != null && this.Nodes[objectID] !== undefined) {\r\n\t\t\treturn this.Nodes[objectID].getLeftNull();\r\n\t\t}\r\n\t\treturn false; // TODO:  Error here?\r\n\t}\r\n\r\n\tgetRightNull(objectID) {\r\n\t\tif (this.Nodes[objectID] != null && this.Nodes[objectID] !== undefined) {\r\n\t\t\treturn this.Nodes[objectID].getRightNull();\r\n\t\t}\r\n\t\treturn false; // TODO:  Error here?\r\n\t}\r\n\r\n\tsetEdgeColor(\r\n\t\tfromID,\r\n\t\ttoID,\r\n\t\tcolor // returns old color\r\n\t) {\r\n\t\tlet oldColor = '#000000';\r\n\t\tif (this.Edges[fromID] != null && this.Edges[fromID] !== undefined) {\r\n\t\t\tconst len = this.Edges[fromID].length;\r\n\t\t\tfor (let i = len - 1; i >= 0; i--) {\r\n\t\t\t\tif (\r\n\t\t\t\t\tthis.Edges[fromID][i] != null &&\r\n\t\t\t\t\tthis.Edges[fromID][i] !== undefined &&\r\n\t\t\t\t\tthis.Edges[fromID][i].Node2 === this.Nodes[toID]\r\n\t\t\t\t) {\r\n\t\t\t\t\toldColor = this.Edges[fromID][i].color();\r\n\t\t\t\t\tthis.Edges[fromID][i].setColor(color);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn oldColor;\r\n\t}\r\n\r\n\talignTop(id1, id2) {\r\n\t\tif (\r\n\t\t\tthis.Nodes[id1] == null ||\r\n\t\t\tthis.Nodes[id1] === undefined ||\r\n\t\t\tthis.Nodes[id2] == null ||\r\n\t\t\tthis.Nodes[id2] === undefined\r\n\t\t) {\r\n\t\t\tthrow new Error(\r\n\t\t\t\t\"Tring to align two nodes, one doesn't exist: \" + String(id1) + ',' + String(id2)\r\n\t\t\t);\r\n\t\t}\r\n\t\tthis.Nodes[id1].alignTop(this.Nodes[id2]);\r\n\t}\r\n\r\n\talignLeft(id1, id2) {\r\n\t\tif (\r\n\t\t\tthis.Nodes[id1] == null ||\r\n\t\t\tthis.Nodes[id1] === undefined ||\r\n\t\t\tthis.Nodes[id2] == null ||\r\n\t\t\tthis.Nodes[id2] === undefined\r\n\t\t) {\r\n\t\t\tthrow new Error(\r\n\t\t\t\t\"Tring to align two nodes, one doesn't exist: \" + String(id1) + ',' + String(id2)\r\n\t\t\t);\r\n\t\t}\r\n\t\tthis.Nodes[id1].alignLeft(this.Nodes[id2]);\r\n\t}\r\n\r\n\talignRight(id1, id2) {\r\n\t\tif (\r\n\t\t\tthis.Nodes[id1] == null ||\r\n\t\t\tthis.Nodes[id1] === undefined ||\r\n\t\t\tthis.Nodes[id2] == null ||\r\n\t\t\tthis.Nodes[id2] === undefined\r\n\t\t) {\r\n\t\t\tthrow new Error(\r\n\t\t\t\t\"Tring to align two nodes, one doesn't exist: \" + String(id1) + ',' + String(id2)\r\n\t\t\t);\r\n\t\t}\r\n\t\tthis.Nodes[id1].alignRight(this.Nodes[id2]);\r\n\t}\r\n\r\n\tgetAlignRightPos(id1, id2) {\r\n\t\tif (\r\n\t\t\tthis.Nodes[id1] == null ||\r\n\t\t\tthis.Nodes[id1] === undefined ||\r\n\t\t\tthis.Nodes[id2] == null ||\r\n\t\t\tthis.Nodes[id2] === undefined\r\n\t\t) {\r\n\t\t\tthrow new Error(\r\n\t\t\t\t\"Tring to align two nodes, one doesn't exist: \" + String(id1) + ',' + String(id2)\r\n\t\t\t);\r\n\t\t}\r\n\t\treturn this.Nodes[id1].getAlignRightPos(this.Nodes[id2]);\r\n\t}\r\n\r\n\tgetAlignLeftPos(id1, id2) {\r\n\t\tif (\r\n\t\t\tthis.Nodes[id1] == null ||\r\n\t\t\tthis.Nodes[id1] === undefined ||\r\n\t\t\tthis.Nodes[id2] == null ||\r\n\t\t\tthis.Nodes[id2] === undefined\r\n\t\t) {\r\n\t\t\tthrow new Error(\r\n\t\t\t\t\"Tring to align two nodes, one doesn't exist: \" + String(id1) + ',' + String(id2)\r\n\t\t\t);\r\n\t\t}\r\n\t\treturn this.Nodes[id1].getAlignLeftPos(this.Nodes[id2]);\r\n\t}\r\n\r\n\talignBottom(id1, id2) {\r\n\t\tif (\r\n\t\t\tthis.Nodes[id1] == null ||\r\n\t\t\tthis.Nodes[id1] === undefined ||\r\n\t\t\tthis.Nodes[id2] == null ||\r\n\t\t\tthis.Nodes[id2] === undefined\r\n\t\t) {\r\n\t\t\tthrow new Error(\r\n\t\t\t\t\"Tring to align two nodes, one doesn't exist: \" + String(id1) + ',' + String(id2)\r\n\t\t\t);\r\n\t\t}\r\n\t\tthis.Nodes[id1].alignBottom(this.Nodes[id2]);\r\n\t}\r\n\r\n\tsetEdgeHighlight(\r\n\t\tfromID,\r\n\t\ttoID,\r\n\t\tval // returns old color\r\n\t) {\r\n\t\tlet oldHighlight = false;\r\n\t\tif (this.Edges[fromID] != null && this.Edges[fromID] !== undefined) {\r\n\t\t\tconst len = this.Edges[fromID].length;\r\n\t\t\tfor (let i = len - 1; i >= 0; i--) {\r\n\t\t\t\tif (\r\n\t\t\t\t\tthis.Edges[fromID][i] != null &&\r\n\t\t\t\t\tthis.Edges[fromID][i] !== undefined &&\r\n\t\t\t\t\tthis.Edges[fromID][i].Node2 === this.Nodes[toID]\r\n\t\t\t\t) {\r\n\t\t\t\t\toldHighlight = this.Edges[fromID][i].highlighted;\r\n\t\t\t\t\tthis.Edges[fromID][i].setHighlight(val);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn oldHighlight;\r\n\t}\r\n\r\n\taddLabelObject(objectID, objectLabel, centering) {\r\n\t\tif (this.Nodes[objectID] != null && this.Nodes[objectID] !== undefined) {\r\n\t\t\tthrow new Error('addLabelObject: Object Already Exists!');\r\n\t\t}\r\n\r\n\t\tconst newLabel = new AnimatedLabel(\r\n\t\t\tobjectID,\r\n\t\t\tobjectLabel,\r\n\t\t\tcentering,\r\n\t\t\tthis.getTextWidth(objectLabel)\r\n\t\t);\r\n\t\tthis.Nodes[objectID] = newLabel;\r\n\t}\r\n\r\n\taddLinkedListObject(\r\n\t\tobjectID,\r\n\t\tnodeLabel,\r\n\t\twidth,\r\n\t\theight,\r\n\t\tlinkPer,\r\n\t\tverticalOrientation,\r\n\t\tlinkPosEnd,\r\n\t\tnumLabels,\r\n\t\tbackgroundColor,\r\n\t\tforegroundColor\r\n\t) {\r\n\t\tif (this.Nodes[objectID] != null) {\r\n\t\t\tthrow new Error('addLinkedListObject:Object with same ID already Exists!');\r\n\t\t}\r\n\t\tconst newNode = new AnimatedLinkedList(\r\n\t\t\tobjectID,\r\n\t\t\tnodeLabel,\r\n\t\t\twidth,\r\n\t\t\theight,\r\n\t\t\tlinkPer,\r\n\t\t\tverticalOrientation,\r\n\t\t\tlinkPosEnd,\r\n\t\t\tnumLabels,\r\n\t\t\tbackgroundColor,\r\n\t\t\tforegroundColor\r\n\t\t);\r\n\t\tthis.Nodes[objectID] = newNode;\r\n\t}\r\n\r\n\taddDoublyLinkedListObject(\r\n\t\tobjectID,\r\n\t\tnodeLabel,\r\n\t\twidth,\r\n\t\theight,\r\n\t\tlinkPer,\r\n\t\tnumLabels,\r\n\t\tbackgroundColor,\r\n\t\tforegroundColor\r\n\t) {\r\n\t\tif (this.Nodes[objectID] != null) {\r\n\t\t\tthrow new Error('addDoublyLinkedListObject:Object with same ID already Exists!');\r\n\t\t}\r\n\t\tconst newNode = new AnimatedDoublyLinkedList(\r\n\t\t\tobjectID,\r\n\t\t\tnodeLabel,\r\n\t\t\twidth,\r\n\t\t\theight,\r\n\t\t\tlinkPer,\r\n\t\t\tnumLabels,\r\n\t\t\tbackgroundColor,\r\n\t\t\tforegroundColor\r\n\t\t);\r\n\t\tthis.Nodes[objectID] = newNode;\r\n\t}\r\n\r\n\taddCircularlyLinkedListObject(\r\n\t\tobjectID,\r\n\t\tnodeLabel,\r\n\t\twidth,\r\n\t\theight,\r\n\t\tlinkPer,\r\n\t\tnumLabels,\r\n\t\tbackgroundColor,\r\n\t\tforegroundColor\r\n\t) {\r\n\t\tif (this.Nodes[objectID] != null) {\r\n\t\t\tthrow new Error('addCircularlyLinkedListObject:Object with same ID already Exists!');\r\n\t\t}\r\n\t\tconst newNode = new AnimatedCircularlyLinkedList(\r\n\t\t\tobjectID,\r\n\t\t\tnodeLabel,\r\n\t\t\twidth,\r\n\t\t\theight,\r\n\t\t\tlinkPer,\r\n\t\t\tnumLabels,\r\n\t\t\tbackgroundColor,\r\n\t\t\tforegroundColor\r\n\t\t);\r\n\t\tthis.Nodes[objectID] = newNode;\r\n\t}\r\n\r\n\taddSkipListObject(\r\n\t\tobjectID,\r\n\t\tnodeLabel,\r\n\t\twidth,\r\n\t\theight,\r\n\t\tlabelColor,\r\n\t\tbackgroundColor,\r\n\t\tforegroundColor\r\n\t) {\r\n\t\tif (this.Nodes[objectID] != null) {\r\n\t\t\tthrow new Error('addSkipListObject:Object with same ID already Exists!');\r\n\t\t}\r\n\t\tconst newNode = new AnimatedSkipList(\r\n\t\t\tobjectID,\r\n\t\t\tnodeLabel,\r\n\t\t\twidth,\r\n\t\t\theight,\r\n\t\t\tlabelColor,\r\n\t\t\tbackgroundColor,\r\n\t\t\tforegroundColor\r\n\t\t);\r\n\t\tthis.Nodes[objectID] = newNode;\r\n\t}\r\n\r\n\tgetNumElements(objectID) {\r\n\t\treturn this.Nodes[objectID].getNumElements();\r\n\t}\r\n\r\n\tsetNumElements(objectID, numElems) {\r\n\t\tthis.Nodes[objectID].setNumElements(numElems);\r\n\t}\r\n\r\n\taddBTreeNode(objectID, widthPerElem, height, numElems, backgroundColor, foregroundColor) {\r\n\t\tbackgroundColor = backgroundColor === undefined ? '#FFFFFF' : backgroundColor;\r\n\t\tforegroundColor = foregroundColor === undefined ? '#FFFFFF' : foregroundColor;\r\n\r\n\t\tif (this.Nodes[objectID] != null && this.Nodes[objectID] !== undefined) {\r\n\t\t\tthrow new Error('addBTreeNode:Object with same ID already Exists!');\r\n\t\t}\r\n\r\n\t\tconst newNode = new AnimatedBTreeNode(\r\n\t\t\tobjectID,\r\n\t\t\twidthPerElem,\r\n\t\t\theight,\r\n\t\t\tnumElems,\r\n\t\t\tbackgroundColor,\r\n\t\t\tforegroundColor\r\n\t\t);\r\n\t\tthis.Nodes[objectID] = newNode;\r\n\t}\r\n\r\n\taddRectangleObject(\r\n\t\tobjectID,\r\n\t\tnodeLabel,\r\n\t\twidth,\r\n\t\theight,\r\n\t\txJustify,\r\n\t\tyJustify,\r\n\t\tbackgroundColor,\r\n\t\tforegroundColor\r\n\t) {\r\n\t\tif (this.Nodes[objectID] != null || this.Nodes[objectID] !== undefined) {\r\n\t\t\tthrow new Error('addRectangleObject:Object with same ID already Exists!');\r\n\t\t}\r\n\t\tconst newNode = new AnimatedRectangle(\r\n\t\t\tobjectID,\r\n\t\t\tnodeLabel,\r\n\t\t\twidth,\r\n\t\t\theight,\r\n\t\t\txJustify,\r\n\t\t\tyJustify,\r\n\t\t\tbackgroundColor,\r\n\t\t\tforegroundColor\r\n\t\t);\r\n\t\tthis.Nodes[objectID] = newNode;\r\n\t}\r\n\r\n\tsetNodePosition(nodeID, newX, newY) {\r\n\t\tif (this.Nodes[nodeID] == null || this.Nodes[nodeID] === undefined) {\r\n\t\t\t// TODO:  Error here?\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (newX === undefined || newY === undefined) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tthis.Nodes[nodeID].x = newX;\r\n\t\tthis.Nodes[nodeID].y = newY;\r\n\t\t/* Don't need to dirty anything, since we repaint everything every frame\r\n\t\t (TODO:  Revisit if we do conditional redraws)\r\n\t\t }*/\r\n\t}\r\n}\r\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\r\n//\r\n// Redistribution and use in source and binary forms, with or without modification, are\r\n// permitted provided that the following conditions are met:\r\n//\r\n// 1. Redistributions of source code must retain the above copyright notice, this list of\r\n// conditions and the following disclaimer.\r\n//\r\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\r\n// of conditions and the following disclaimer in the documentation and/or other materials\r\n// provided with the distribution.\r\n//\r\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\r\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\r\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\r\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\r\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\r\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\r\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\r\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\r\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\r\n//\r\n// The views and conclusions contained in the software and documentation are those of the\r\n// authors and should not be interpreted as representing official policies, either expressed\r\n// or implied, of the University of San Francisco\r\n\r\n// Global timer used for doing animation callbacks.\r\n//  TODO:  Make this an instance variable of Animation Manager.\r\n\r\n/* global canvas */\r\n\r\nimport {\r\n\tUndoCreate,\r\n\tUndoHighlight,\r\n\tUndoHighlightEdge,\r\n\tUndoMove,\r\n\tUndoSetAlpha,\r\n\tUndoSetBackgroundColor,\r\n\tUndoSetEdgeAlpha,\r\n\tUndoSetEdgeColor,\r\n\tUndoSetForegroundColor,\r\n\tUndoSetHeight,\r\n\tUndoSetHighlightIndex,\r\n\tUndoSetNextNull,\r\n\tUndoSetNull,\r\n\tUndoSetNumElements,\r\n\tUndoSetPosition,\r\n\tUndoSetPrevNull,\r\n\tUndoSetText,\r\n\tUndoSetTextColor,\r\n\tUndoSetWidth,\r\n} from './UndoFunctions.js';\r\nimport EventListener from './CustomEvents.js';\r\nimport ObjectManager from './ObjectManager.js';\r\nimport React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport SingleAnimation from './SingleAnimation.js';\r\nimport { Slider } from '@material-ui/core';\r\nimport { UndoConnect } from './Line.js';\r\n\r\nlet swapped = false;\r\n\r\nfunction reorderSibling(node1, node2) {\r\n\tnode1.parentNode.replaceChild(node1, node2);\r\n\tnode1.parentNode.insertBefore(node2, node1);\r\n}\r\n\r\nfunction swapControlDiv() {\r\n\tswapped = !swapped;\r\n\tif (swapped) {\r\n\t\treorderSibling(\r\n\t\t\tdocument.getElementById('canvas'),\r\n\t\t\tdocument.getElementById('generalAnimationControlSection')\r\n\t\t);\r\n\t\tsetCookie('VisualizationControlSwapped', 'true', 30);\r\n\t} else {\r\n\t\treorderSibling(\r\n\t\t\tdocument.getElementById('generalAnimationControlSection'),\r\n\t\t\tdocument.getElementById('canvas')\r\n\t\t);\r\n\t\tsetCookie('VisualizationControlSwapped', 'false', 30);\r\n\t}\r\n}\r\n\r\n// Utility funciton to read a cookie\r\nfunction getCookie(cookieName) {\r\n\tlet i, x, y;\r\n\tconst cookies = document.cookie.split(';');\r\n\tfor (i = 0; i < cookies.length; i++) {\r\n\t\tx = cookies[i].substr(0, cookies[i].indexOf('='));\r\n\t\ty = cookies[i].substr(cookies[i].indexOf('=') + 1);\r\n\t\tx = x.replace(/^\\s+|\\s+$/g, '');\r\n\t\tif (x === cookieName) {\r\n\t\t\treturn unescape(y);\r\n\t\t}\r\n\t}\r\n}\r\n\r\n// Utility funciton to write a cookie\r\nfunction setCookie(cookieName, value, expireDays) {\r\n\tconst exdate = new Date();\r\n\texdate.setDate(exdate.getDate() + expireDays);\r\n\t// const cookieValue =\r\n\t// \tescape(value) + (expireDays == null ? \"\" : \"; expires=\" + exdate.toUTCString());\r\n\tdocument.cookie = cookieName + '=' + value;\r\n}\r\n\r\nconst ANIMATION_SPEED_DEFAULT = 75;\r\n\r\n// TODO:  Move these out of global space into animation manager?\r\n\r\nfunction controlKey(keyASCII) {\r\n\treturn (\r\n\t\tkeyASCII === 8 ||\r\n\t\tkeyASCII === 9 ||\r\n\t\tkeyASCII === 37 ||\r\n\t\tkeyASCII === 38 ||\r\n\t\tkeyASCII === 39 ||\r\n\t\tkeyASCII === 40 ||\r\n\t\tkeyASCII === 46\r\n\t);\r\n}\r\n\r\nfunction returnSubmit(field, funct, maxsize, intOnly) {\r\n\tif (maxsize !== undefined) {\r\n\t\tfield.size = maxsize;\r\n\t}\r\n\treturn function(event) {\r\n\t\tlet keyASCII = 0;\r\n\t\tif (window.event) {\r\n\t\t\t// IE\r\n\t\t\tkeyASCII = event.keyCode;\r\n\t\t} else if (event.which) {\r\n\t\t\t// Netscape/Firefox/Opera\r\n\t\t\tkeyASCII = event.which;\r\n\t\t}\r\n\r\n\t\tif (keyASCII === 13) {\r\n\t\t\tfunct();\r\n\t\t\treturn false;\r\n\t\t} else if (\r\n\t\t\tkeyASCII === 59 ||\r\n\t\t\tkeyASCII === 45 ||\r\n\t\t\tkeyASCII === 46 ||\r\n\t\t\tkeyASCII === 190 ||\r\n\t\t\tkeyASCII === 173\r\n\t\t) {\r\n\t\t\treturn false;\r\n\t\t} else if (\r\n\t\t\t(maxsize !== undefined && field.value.length >= maxsize) ||\r\n\t\t\t(intOnly && (keyASCII < 48 || keyASCII > 57))\r\n\t\t) {\r\n\t\t\tif (!controlKey(keyASCII)) return false;\r\n\t\t}\r\n\t\treturn true;\r\n\t};\r\n}\r\n\r\n// function addControl(type, name, location) {\r\n// \tconst element = document.createElement(\"input\");\r\n\r\n// \telement.setAttribute(\"type\", type);\r\n// \telement.setAttribute(\"value\", name);\r\n\r\n// \tconst tableEntry = document.createElement(\"td\");\r\n\r\n// \ttableEntry.appendChild(element);\r\n\r\n// \tconst controlBar = document.getElementById(tableEntry);\r\n\r\n// \t//Append the element in page (in span).\r\n// \tcontrolBar.appendChild(element);\r\n// \treturn element;\r\n// }\r\n\r\nfunction addControlToAnimationBar(animBarRef, type, name, callback) {\r\n\tconst element = document.createElement('input');\r\n\r\n\telement.setAttribute('type', type);\r\n\telement.setAttribute('value', name);\r\n\tif (type === 'Button') {\r\n\t\telement.onclick = callback;\r\n\t} else if (type === 'Text') {\r\n\t\telement.onkeydown = callback;\r\n\t}\r\n\r\n\tconst tableEntry = document.createElement('td');\r\n\r\n\ttableEntry.appendChild(element);\r\n\r\n\t// const controlBar = document.getElementById('GeneralAnimationControls');\r\n\r\n\t//Append the element in page (in span).\r\n\tanimBarRef.current.appendChild(tableEntry);\r\n\treturn element;\r\n}\r\n\r\nexport default class AnimationManager extends EventListener {\r\n\tconstructor(canvasRef, animBarRef) {\r\n\t\tsuper();\r\n\r\n\t\tthis.objectManager = new ObjectManager(canvasRef);\r\n\t\t// Holder for all animated objects.\r\n\t\t// All animation is done by manipulating objects in\\\r\n\t\t// this container\r\n\t\tthis.animatedObjects = this.objectManager;\r\n\r\n\t\t// Control variables for stopping / starting animation\r\n\r\n\t\tthis.animationPaused = false;\r\n\t\tthis.awaitingStep = false;\r\n\t\tthis.currentlyAnimating = false;\r\n\r\n\t\t// Array holding the code for the animation.  This is\r\n\t\t// an array of strings, each of which is an animation command\r\n\t\t// currentAnimation is an index into this array\r\n\t\tthis.AnimationSteps = [];\r\n\t\tthis.currentAnimation = 0;\r\n\r\n\t\tthis.previousAnimationSteps = [];\r\n\r\n\t\t// Control variables for where we are in the current animation block.\r\n\t\t//  currFrame holds the frame number of the current animation block,\r\n\t\t//  while animationBlockLength holds the length of the current animation\r\n\t\t//  block (in frame numbers).\r\n\t\tthis.currFrame = 0;\r\n\t\tthis.animationBlockLength = 0;\r\n\r\n\t\t//  The animation block that is currently running.  Array of singleAnimations\r\n\t\tthis.currentBlock = null;\r\n\r\n\t\t/////////////////////////////////////\r\n\t\t// Variables for handling undo.\r\n\t\t////////////////////////////////////\r\n\t\t//  A stack of UndoBlock objects (subclassed, UndoBlock is an abstract base class)\r\n\t\t//  each of which can undo a single animation element\r\n\t\tthis.undoStack = [];\r\n\t\tthis.doingUndo = false;\r\n\r\n\t\t// A stack containing the beginning of each animation block, as an index\r\n\t\t// into the AnimationSteps array\r\n\t\tthis.undoAnimationStepIndices = [];\r\n\t\tthis.undoAnimationStepIndicesStack = [];\r\n\r\n\t\tthis.animationBlockLength = 10;\r\n\t\t// var this.;\r\n\t\t// var animationManager;\r\n\t\t// var canvas;\r\n\r\n\t\tthis.paused = false;\r\n\t\t// var this.playPauseBackButton;\r\n\t\t// var this.skipBackButton;\r\n\t\t// var this.stepBackButton;\r\n\t\t// var this.stepForwardButton;\r\n\t\t// var this.skipForwardButton;\r\n\r\n\t\t// this.widthEntry;\r\n\t\t// let this.heightEntry;\r\n\t\tthis.canvas = canvasRef;\r\n\r\n\t\tthis.skipBackButton = addControlToAnimationBar(animBarRef, 'Button', 'Skip Back', () =>\r\n\t\t\tthis.skipBack()\r\n\t\t);\r\n\t\tthis.stepBackButton = addControlToAnimationBar(animBarRef, 'Button', 'Step Back', () =>\r\n\t\t\tthis.stepBack()\r\n\t\t);\r\n\t\tthis.playPauseBackButton = addControlToAnimationBar(animBarRef, 'Button', 'Pause', () =>\r\n\t\t\tthis.doPlayPause()\r\n\t\t);\r\n\t\tthis.stepForwardButton = addControlToAnimationBar(\r\n\t\t\tanimBarRef,\r\n\t\t\t'Button',\r\n\t\t\t'Step Forward',\r\n\t\t\t() => this.step()\r\n\t\t);\r\n\t\tthis.skipForwardButton = addControlToAnimationBar(\r\n\t\t\tanimBarRef,\r\n\t\t\t'Button',\r\n\t\t\t'Skip Forward',\r\n\t\t\t() => this.skipForward()\r\n\t\t);\r\n\r\n\t\tconst element = document.createElement('div');\r\n\t\telement.setAttribute('display', 'inline-block');\r\n\t\telement.setAttribute('float', 'left');\r\n\r\n\t\tlet speed = getCookie('VisualizationSpeed');\r\n\t\tif (speed == null || speed === '') {\r\n\t\t\tspeed = ANIMATION_SPEED_DEFAULT;\r\n\t\t} else {\r\n\t\t\tspeed = parseInt(speed);\r\n\t\t}\r\n\r\n\t\tconst slider = (\r\n\t\t\t<Slider\r\n\t\t\t\tdefaultValue={speed}\r\n\t\t\t\tonChange={(e, val) => {\r\n\t\t\t\t\tthis.setSpeed(val);\r\n\t\t\t\t\tsetCookie('VisualizationSpeed', String(val), 30);\r\n\t\t\t\t}}\r\n\t\t\t/>\r\n\t\t);\r\n\r\n\t\tlet tableEntry = document.createElement('td');\r\n\r\n\t\tconst controlBar = document.getElementById('GeneralAnimationControls');\r\n\r\n\t\tconst newTable = document.createElement('table');\r\n\r\n\t\tlet midLevel = document.createElement('tr');\r\n\t\tlet bottomLevel = document.createElement('td');\r\n\t\tmidLevel.appendChild(bottomLevel);\r\n\t\tReactDOM.render(slider, bottomLevel);\r\n\t\tnewTable.appendChild(midLevel);\r\n\r\n\t\tmidLevel = document.createElement('tr');\r\n\t\tbottomLevel = document.createElement('td');\r\n\t\tbottomLevel.align = 'center';\r\n\t\tlet txtNode = document.createTextNode('Animation Speed');\r\n\t\tmidLevel.appendChild(bottomLevel);\r\n\t\tbottomLevel.appendChild(txtNode);\r\n\t\tnewTable.appendChild(midLevel);\r\n\r\n\t\ttableEntry.appendChild(newTable);\r\n\r\n\t\t//Append the element in page (in span).\r\n\t\tcontrolBar.appendChild(tableEntry);\r\n\r\n\t\t//tableEntry.appendChild(element);\r\n\r\n\t\t// $(element).slider({\r\n\t\t// \tanimate: true,\r\n\t\t// \tvalue: speed,\r\n\t\t// \tchange: (e, ui) => {\r\n\t\t// \t\tsetCookie('VisualizationSpeed', String(ui.value), 30);\r\n\t\t// \t},\r\n\t\t// \tslide: (e, ui) => {\r\n\t\t// \t\tthis.setSpeed(ui.value);\r\n\t\t// \t},\r\n\t\t// });\r\n\r\n\t\tthis.setSpeed(speed);\r\n\r\n\t\telement.setAttribute('style', 'width:200px');\r\n\r\n\t\tlet width = getCookie('VisualizationWidth');\r\n\t\twidth = width == null || width === '' ? 1000 : parseInt(width);\r\n\r\n\t\tlet height = getCookie('VisualizationHeight');\r\n\t\theight = height == null || height === '' ? 500 : parseInt(height);\r\n\r\n\t\tconst swappedControls = getCookie('VisualizationControlSwapped');\r\n\t\tswapped = swappedControls === 'true';\r\n\t\tif (swapped) {\r\n\t\t\treorderSibling(\r\n\t\t\t\tdocument.getElementById('canvas'),\r\n\t\t\t\tdocument.getElementById('generalAnimationControlSection')\r\n\t\t\t);\r\n\t\t}\r\n\r\n\t\tcanvas.width = width;\r\n\t\tcanvas.height = height;\r\n\r\n\t\ttableEntry = document.createElement('td');\r\n\t\ttxtNode = document.createTextNode(' w:');\r\n\t\ttableEntry.appendChild(txtNode);\r\n\t\tcontrolBar.appendChild(tableEntry);\r\n\r\n\t\tthis.widthEntry = addControlToAnimationBar(animBarRef, 'Text', canvas.width, () =>\r\n\t\t\treturnSubmit(this.widthEntry, this.changeSize.bind(this), 4, true)\r\n\t\t);\r\n\t\tthis.widthEntry.size = 4;\r\n\r\n\t\ttableEntry = document.createElement('td');\r\n\t\ttxtNode = document.createTextNode('       h:');\r\n\t\ttableEntry.appendChild(txtNode);\r\n\t\tcontrolBar.appendChild(tableEntry);\r\n\r\n\t\tthis.heightEntry = addControlToAnimationBar(animBarRef, 'Text', canvas.height, () =>\r\n\t\t\treturnSubmit(this.heightEntry, this.changeSize.bind(this), 4, true)\r\n\t\t);\r\n\r\n\t\tthis.heightEntry.size = 4;\r\n\t\tthis.sizeButton = addControlToAnimationBar(animBarRef, 'Button', 'Change Canvas Size', () =>\r\n\t\t\tthis.changeSize()\r\n\t\t);\r\n\r\n\t\tthis.swapButton = addControlToAnimationBar(\r\n\t\t\tanimBarRef,\r\n\t\t\t'Button',\r\n\t\t\t'Move Controls',\r\n\t\t\tswapControlDiv\r\n\t\t);\r\n\r\n\t\tthis.addListener('AnimationStarted', this, this.animStarted);\r\n\t\tthis.addListener('AnimationEnded', this, this.animEnded);\r\n\t\tthis.addListener('AnimationWaiting', this, this.animWaiting);\r\n\t\tthis.addListener('AnimationUndoUnavailable', this, this.anumUndoUnavailable);\r\n\t\tthis.objectManager.width = canvas.width;\r\n\t\tthis.objectManager.height = canvas.height;\r\n\t}\r\n\r\n\tlerp(from, to, percent) {\r\n\t\treturn (to - from) * percent + from;\r\n\t}\r\n\r\n\t// Pause / unpause animation\r\n\tsetPaused(pausedValue) {\r\n\t\tthis.animationPaused = pausedValue;\r\n\t\tif (!this.animationPaused) {\r\n\t\t\tthis.step();\r\n\t\t}\r\n\t}\r\n\r\n\t// Set the speed of the animation, from 0 (slow) to 100 (fast)\r\n\tsetSpeed(newSpeed) {\r\n\t\tthis.animationBlockLength = Math.floor((100 - newSpeed) / 2);\r\n\t}\r\n\r\n\tparseBool(str) {\r\n\t\tconst uppercase = str.toUpperCase();\r\n\t\tconst returnVal = !(\r\n\t\t\tuppercase === 'False' ||\r\n\t\t\tuppercase === 'f' ||\r\n\t\t\tuppercase === ' 0' ||\r\n\t\t\tuppercase === '0' ||\r\n\t\t\tuppercase === ''\r\n\t\t);\r\n\t\treturn returnVal;\r\n\t}\r\n\r\n\tparseColor(clr) {\r\n\t\tif (clr.charAt(0) === '#') {\r\n\t\t\treturn clr;\r\n\t\t} else if (clr.substring(0, 2) === '0x') {\r\n\t\t\treturn '#' + clr.substring(2);\r\n\t\t}\r\n\t}\r\n\r\n\tchangeSize() {\r\n\t\tconst width = parseInt(this.widthEntry.value);\r\n\t\tconst height = parseInt(this.heightEntry.value);\r\n\r\n\t\tif (width > 100) {\r\n\t\t\tcanvas.width = width;\r\n\t\t\tthis.animatedObjects.width = width;\r\n\t\t\tsetCookie('VisualizationWidth', String(width), 30);\r\n\t\t}\r\n\t\tif (height > 100) {\r\n\t\t\tcanvas.height = height;\r\n\t\t\tthis.animatedObjects.height = height;\r\n\t\t\tsetCookie('VisualizationHeight', String(height), 30);\r\n\t\t}\r\n\t\tthis.widthEntry.value = canvas.width;\r\n\t\tthis.heightEntry.value = canvas.height;\r\n\r\n\t\tthis.animatedObjects.draw();\r\n\t\tthis.fireEvent('CanvasSizeChanged', { width: canvas.width, height: canvas.height });\r\n\t}\r\n\r\n\tstartNextBlock() {\r\n\t\tthis.awaitingStep = false;\r\n\t\tthis.currentBlock = [];\r\n\t\tlet undoBlock = [];\r\n\t\tif (this.currentAnimation === this.AnimationSteps.length) {\r\n\t\t\tthis.currentlyAnimating = false;\r\n\t\t\tthis.awaitingStep = false;\r\n\t\t\tthis.fireEvent('AnimationEnded', 'NoData');\r\n\t\t\t// clearTimeout(timer);\r\n\t\t\tthis.stopTimer();\r\n\t\t\tthis.animatedObjects.update();\r\n\t\t\tthis.animatedObjects.draw();\r\n\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tthis.undoAnimationStepIndices.push(this.currentAnimation);\r\n\r\n\t\tlet foundBreak = false;\r\n\t\tlet anyAnimations = false;\r\n\r\n\t\twhile (this.currentAnimation < this.AnimationSteps.length && !foundBreak) {\r\n\t\t\tconst nextCommand = this.AnimationSteps[this.currentAnimation].split('<;>');\r\n\t\t\tif (nextCommand[0].toUpperCase() === 'CREATECIRCLE') {\r\n\t\t\t\tthis.animatedObjects.addCircleObject(parseInt(nextCommand[1]), nextCommand[2]);\r\n\t\t\t\tif (nextCommand.length > 4) {\r\n\t\t\t\t\tthis.animatedObjects.setNodePosition(\r\n\t\t\t\t\t\tparseInt(nextCommand[1]),\r\n\t\t\t\t\t\tparseInt(nextCommand[3]),\r\n\t\t\t\t\t\tparseInt(nextCommand[4])\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\t\t\t\tundoBlock.push(new UndoCreate(parseInt(nextCommand[1])));\r\n\t\t\t} else if (nextCommand[0].toUpperCase() === 'CONNECT') {\r\n\t\t\t\tif (nextCommand.length > 7) {\r\n\t\t\t\t\tthis.animatedObjects.connectEdge(\r\n\t\t\t\t\t\tparseInt(nextCommand[1]),\r\n\t\t\t\t\t\tparseInt(nextCommand[2]),\r\n\t\t\t\t\t\tthis.parseColor(nextCommand[3]),\r\n\t\t\t\t\t\tparseFloat(nextCommand[4]),\r\n\t\t\t\t\t\tthis.parseBool(nextCommand[5]),\r\n\t\t\t\t\t\tnextCommand[6],\r\n\t\t\t\t\t\tparseInt(nextCommand[7])\r\n\t\t\t\t\t);\r\n\t\t\t\t} else if (nextCommand.length > 6) {\r\n\t\t\t\t\tthis.animatedObjects.connectEdge(\r\n\t\t\t\t\t\tparseInt(nextCommand[1]),\r\n\t\t\t\t\t\tparseInt(nextCommand[2]),\r\n\t\t\t\t\t\tthis.parseColor(nextCommand[3]),\r\n\t\t\t\t\t\tparseFloat(nextCommand[4]),\r\n\t\t\t\t\t\tthis.parseBool(nextCommand[5]),\r\n\t\t\t\t\t\tnextCommand[6],\r\n\t\t\t\t\t\t0\r\n\t\t\t\t\t);\r\n\t\t\t\t} else if (nextCommand.length > 5) {\r\n\t\t\t\t\tthis.animatedObjects.connectEdge(\r\n\t\t\t\t\t\tparseInt(nextCommand[1]),\r\n\t\t\t\t\t\tparseInt(nextCommand[2]),\r\n\t\t\t\t\t\tthis.parseColor(nextCommand[3]),\r\n\t\t\t\t\t\tparseFloat(nextCommand[4]),\r\n\t\t\t\t\t\tthis.parseBool(nextCommand[5]),\r\n\t\t\t\t\t\t'',\r\n\t\t\t\t\t\t0\r\n\t\t\t\t\t);\r\n\t\t\t\t} else if (nextCommand.length > 4) {\r\n\t\t\t\t\tthis.animatedObjects.connectEdge(\r\n\t\t\t\t\t\tparseInt(nextCommand[1]),\r\n\t\t\t\t\t\tparseInt(nextCommand[2]),\r\n\t\t\t\t\t\tthis.parseColor(nextCommand[3]),\r\n\t\t\t\t\t\tparseFloat(nextCommand[4]),\r\n\t\t\t\t\t\ttrue,\r\n\t\t\t\t\t\t'',\r\n\t\t\t\t\t\t0\r\n\t\t\t\t\t);\r\n\t\t\t\t} else if (nextCommand.length > 3) {\r\n\t\t\t\t\tthis.animatedObjects.connectEdge(\r\n\t\t\t\t\t\tparseInt(nextCommand[1]),\r\n\t\t\t\t\t\tparseInt(nextCommand[2]),\r\n\t\t\t\t\t\tthis.parseColor(nextCommand[3]),\r\n\t\t\t\t\t\t0.0,\r\n\t\t\t\t\t\ttrue,\r\n\t\t\t\t\t\t'',\r\n\t\t\t\t\t\t0\r\n\t\t\t\t\t);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.animatedObjects.connectEdge(\r\n\t\t\t\t\t\tparseInt(nextCommand[1]),\r\n\t\t\t\t\t\tparseInt(nextCommand[2]),\r\n\t\t\t\t\t\t'#000000',\r\n\t\t\t\t\t\t0.0,\r\n\t\t\t\t\t\ttrue,\r\n\t\t\t\t\t\t'',\r\n\t\t\t\t\t\t0\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\t\t\t\tundoBlock.push(\r\n\t\t\t\t\tnew UndoConnect(parseInt(nextCommand[1]), parseInt(nextCommand[2]), false)\r\n\t\t\t\t);\r\n\t\t\t} else if (nextCommand[0].toUpperCase() === 'CONNECTNEXT') {\r\n\t\t\t\tthis.animatedObjects.connectEdge(\r\n\t\t\t\t\tparseInt(nextCommand[1]),\r\n\t\t\t\t\tparseInt(nextCommand[2]),\r\n\t\t\t\t\t'#000000',\r\n\t\t\t\t\t0.0,\r\n\t\t\t\t\ttrue,\r\n\t\t\t\t\t'',\r\n\t\t\t\t\t0\r\n\t\t\t\t);\r\n\t\t\t\tundoBlock.push(\r\n\t\t\t\t\tnew UndoConnect(parseInt(nextCommand[1]), parseInt(nextCommand[2]), false)\r\n\t\t\t\t);\r\n\t\t\t} else if (nextCommand[0].toUpperCase() === 'CONNECTPREV') {\r\n\t\t\t\tthis.animatedObjects.connectEdge(\r\n\t\t\t\t\tparseInt(nextCommand[1]),\r\n\t\t\t\t\tparseInt(nextCommand[2]),\r\n\t\t\t\t\t'#000000',\r\n\t\t\t\t\t0.0,\r\n\t\t\t\t\ttrue,\r\n\t\t\t\t\t'',\r\n\t\t\t\t\t1\r\n\t\t\t\t);\r\n\t\t\t\tundoBlock.push(\r\n\t\t\t\t\tnew UndoConnect(parseInt(nextCommand[1]), parseInt(nextCommand[2]), false)\r\n\t\t\t\t);\r\n\t\t\t} else if (nextCommand[0].toUpperCase() === 'CONNECTCURVE') {\r\n\t\t\t\tthis.animatedObjects.connectEdge(\r\n\t\t\t\t\tparseInt(nextCommand[1]),\r\n\t\t\t\t\tparseInt(nextCommand[2]),\r\n\t\t\t\t\t'#000000',\r\n\t\t\t\t\tparseFloat(nextCommand[3]),\r\n\t\t\t\t\ttrue,\r\n\t\t\t\t\t'',\r\n\t\t\t\t\t1\r\n\t\t\t\t);\r\n\t\t\t\tundoBlock.push(\r\n\t\t\t\t\tnew UndoConnect(parseInt(nextCommand[1]), parseInt(nextCommand[2]), false)\r\n\t\t\t\t);\r\n\t\t\t} else if (nextCommand[0].toUpperCase() === 'CONNECTSKIPLIST') {\r\n\t\t\t\tthis.animatedObjects.connectEdge(\r\n\t\t\t\t\tparseInt(nextCommand[1]),\r\n\t\t\t\t\tparseInt(nextCommand[2]),\r\n\t\t\t\t\t'#000000',\r\n\t\t\t\t\t0,\r\n\t\t\t\t\tfalse,\r\n\t\t\t\t\t'',\r\n\t\t\t\t\tparseInt(nextCommand[3])\r\n\t\t\t\t);\r\n\t\t\t\tundoBlock.push(\r\n\t\t\t\t\tnew UndoConnect(parseInt(nextCommand[1]), parseInt(nextCommand[2]), false)\r\n\t\t\t\t);\r\n\t\t\t} else if (nextCommand[0].toUpperCase() === 'CREATERECTANGLE') {\r\n\t\t\t\tif (nextCommand.length === 9) {\r\n\t\t\t\t\tthis.animatedObjects.addRectangleObject(\r\n\t\t\t\t\t\tparseInt(nextCommand[1]), // ID\r\n\t\t\t\t\t\tnextCommand[2], // Label\r\n\t\t\t\t\t\tparseInt(nextCommand[3]), // w\r\n\t\t\t\t\t\tparseInt(nextCommand[4]), // h\r\n\t\t\t\t\t\tnextCommand[7], // xJustify\r\n\t\t\t\t\t\tnextCommand[8], // yJustify\r\n\t\t\t\t\t\t'#ffffff', // background color\r\n\t\t\t\t\t\t'#000000'\r\n\t\t\t\t\t); // foreground color\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.animatedObjects.addRectangleObject(\r\n\t\t\t\t\t\tparseInt(nextCommand[1]), // ID\r\n\t\t\t\t\t\tnextCommand[2], // Label\r\n\t\t\t\t\t\tparseInt(nextCommand[3]), // w\r\n\t\t\t\t\t\tparseInt(nextCommand[4]), // h\r\n\t\t\t\t\t\t'center', // xJustify\r\n\t\t\t\t\t\t'center', // yJustify\r\n\t\t\t\t\t\t'#ffffff', // background color\r\n\t\t\t\t\t\t'#000000'\r\n\t\t\t\t\t); // foreground color\r\n\t\t\t\t}\r\n\t\t\t\tif (nextCommand.length > 6) {\r\n\t\t\t\t\tthis.animatedObjects.setNodePosition(\r\n\t\t\t\t\t\tparseInt(nextCommand[1]),\r\n\t\t\t\t\t\tparseInt(nextCommand[5]),\r\n\t\t\t\t\t\tparseInt(nextCommand[6])\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\t\t\t\tundoBlock.push(new UndoCreate(parseInt(nextCommand[1])));\r\n\t\t\t} else if (nextCommand[0].toUpperCase() === 'MOVE') {\r\n\t\t\t\tconst objectID = parseInt(nextCommand[1]);\r\n\t\t\t\tconst nextAnim = new SingleAnimation(\r\n\t\t\t\t\tobjectID,\r\n\t\t\t\t\tthis.animatedObjects.getNodeX(objectID),\r\n\t\t\t\t\tthis.animatedObjects.getNodeY(objectID),\r\n\t\t\t\t\tparseInt(nextCommand[2]),\r\n\t\t\t\t\tparseInt(nextCommand[3])\r\n\t\t\t\t);\r\n\t\t\t\tthis.currentBlock.push(nextAnim);\r\n\r\n\t\t\t\tundoBlock.push(\r\n\t\t\t\t\tnew UndoMove(\r\n\t\t\t\t\t\tnextAnim.objectID,\r\n\t\t\t\t\t\tnextAnim.toX,\r\n\t\t\t\t\t\tnextAnim.toY,\r\n\t\t\t\t\t\tnextAnim.fromX,\r\n\t\t\t\t\t\tnextAnim.fromY\r\n\t\t\t\t\t)\r\n\t\t\t\t);\r\n\r\n\t\t\t\tanyAnimations = true;\r\n\t\t\t} else if (nextCommand[0].toUpperCase() === 'MOVETOALIGNRIGHT') {\r\n\t\t\t\tconst id = parseInt(nextCommand[1]);\r\n\t\t\t\tconst otherId = parseInt(nextCommand[2]);\r\n\t\t\t\tconst newXY = this.animatedObjects.getAlignRightPos(id, otherId);\r\n\r\n\t\t\t\tconst nextAnim = new SingleAnimation(\r\n\t\t\t\t\tid,\r\n\t\t\t\t\tthis.animatedObjects.getNodeX(id),\r\n\t\t\t\t\tthis.animatedObjects.getNodeY(id),\r\n\t\t\t\t\tnewXY[0],\r\n\t\t\t\t\tnewXY[1]\r\n\t\t\t\t);\r\n\t\t\t\tthis.currentBlock.push(nextAnim);\r\n\t\t\t\tundoBlock.push(\r\n\t\t\t\t\tnew UndoMove(\r\n\t\t\t\t\t\tnextAnim.objectID,\r\n\t\t\t\t\t\tnextAnim.toX,\r\n\t\t\t\t\t\tnextAnim.toY,\r\n\t\t\t\t\t\tnextAnim.fromX,\r\n\t\t\t\t\t\tnextAnim.fromY\r\n\t\t\t\t\t)\r\n\t\t\t\t);\r\n\t\t\t\tanyAnimations = true;\r\n\t\t\t} else if (nextCommand[0].toUpperCase() === 'STEP') {\r\n\t\t\t\tfoundBreak = true;\r\n\t\t\t} else if (nextCommand[0].toUpperCase() === 'SETFOREGROUNDCOLOR') {\r\n\t\t\t\tconst id = parseInt(nextCommand[1]);\r\n\t\t\t\tconst oldColor = this.animatedObjects.foregroundColor(id);\r\n\t\t\t\tthis.animatedObjects.setForegroundColor(id, this.parseColor(nextCommand[2]));\r\n\t\t\t\tundoBlock.push(new UndoSetForegroundColor(id, oldColor));\r\n\t\t\t} else if (nextCommand[0].toUpperCase() === 'SETBACKGROUNDCOLOR') {\r\n\t\t\t\tconst id = parseInt(nextCommand[1]);\r\n\t\t\t\tconst oldColor = this.animatedObjects.backgroundColor(id);\r\n\t\t\t\tthis.animatedObjects.setBackgroundColor(id, this.parseColor(nextCommand[2]));\r\n\t\t\t\tundoBlock.push(new UndoSetBackgroundColor(id, oldColor));\r\n\t\t\t} else if (nextCommand[0].toUpperCase() === 'SETHIGHLIGHT') {\r\n\t\t\t\tconst newHighlight = this.parseBool(nextCommand[2]);\r\n\t\t\t\tthis.animatedObjects.setHighlight(parseInt(nextCommand[1]), newHighlight, nextCommand[3]);\r\n\t\t\t\tundoBlock.push(new UndoHighlight(parseInt(nextCommand[1]), !newHighlight));\r\n\t\t\t} else if (nextCommand[0].toUpperCase() === 'DISCONNECT') {\r\n\t\t\t\tconst undoConnect = this.animatedObjects.disconnect(\r\n\t\t\t\t\tparseInt(nextCommand[1]),\r\n\t\t\t\t\tparseInt(nextCommand[2])\r\n\t\t\t\t);\r\n\t\t\t\tif (undoConnect !== null) {\r\n\t\t\t\t\tundoBlock.push(undoConnect);\r\n\t\t\t\t}\r\n\t\t\t} else if (nextCommand[0].toUpperCase() === 'SETALPHA') {\r\n\t\t\t\tconst oldAlpha = this.animatedObjects.getAlpha(parseInt(nextCommand[1]));\r\n\t\t\t\tthis.animatedObjects.setAlpha(parseInt(nextCommand[1]), parseFloat(nextCommand[2]));\r\n\t\t\t\tundoBlock.push(new UndoSetAlpha(parseInt(nextCommand[1]), oldAlpha));\r\n\t\t\t} else if (nextCommand[0].toUpperCase() === 'SETTEXT') {\r\n\t\t\t\tif (nextCommand.length > 3) {\r\n\t\t\t\t\tconst oldText = this.animatedObjects.getText(\r\n\t\t\t\t\t\tparseInt(nextCommand[1]),\r\n\t\t\t\t\t\tparseInt(nextCommand[3])\r\n\t\t\t\t\t);\r\n\t\t\t\t\tthis.animatedObjects.setText(\r\n\t\t\t\t\t\tparseInt(nextCommand[1]),\r\n\t\t\t\t\t\tnextCommand[2],\r\n\t\t\t\t\t\tparseInt(nextCommand[3])\r\n\t\t\t\t\t);\r\n\t\t\t\t\tif (oldText !== undefined) {\r\n\t\t\t\t\t\tundoBlock.push(\r\n\t\t\t\t\t\t\tnew UndoSetText(\r\n\t\t\t\t\t\t\t\tparseInt(nextCommand[1]),\r\n\t\t\t\t\t\t\t\toldText,\r\n\t\t\t\t\t\t\t\tparseInt(nextCommand[3])\r\n\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tconst oldText = this.animatedObjects.getText(parseInt(nextCommand[1]), 0);\r\n\t\t\t\t\tthis.animatedObjects.setText(parseInt(nextCommand[1]), nextCommand[2], 0);\r\n\t\t\t\t\tif (oldText !== undefined) {\r\n\t\t\t\t\t\tundoBlock.push(new UndoSetText(parseInt(nextCommand[1]), oldText, 0));\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t} else if (nextCommand[0].toUpperCase() === 'DELETE') {\r\n\t\t\t\tconst objectID = parseInt(nextCommand[1]);\r\n\r\n\t\t\t\tconst removedEdges = this.animatedObjects.deleteIncident(objectID);\r\n\t\t\t\tif (removedEdges.length > 0) {\r\n\t\t\t\t\tundoBlock = undoBlock.concat(removedEdges);\r\n\t\t\t\t}\r\n\t\t\t\tconst obj = this.animatedObjects.getObject(objectID);\r\n\t\t\t\tif (obj !== null) {\r\n\t\t\t\t\tundoBlock.push(obj.createUndoDelete());\r\n\t\t\t\t\tthis.animatedObjects.removeObject(objectID);\r\n\t\t\t\t}\r\n\t\t\t} else if (nextCommand[0].toUpperCase() === 'CREATEHIGHLIGHTCIRCLE') {\r\n\t\t\t\tif (nextCommand.length > 5) {\r\n\t\t\t\t\tthis.animatedObjects.addHighlightCircleObject(\r\n\t\t\t\t\t\tparseInt(nextCommand[1]),\r\n\t\t\t\t\t\tthis.parseColor(nextCommand[2]),\r\n\t\t\t\t\t\tparseFloat(nextCommand[5])\r\n\t\t\t\t\t);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.animatedObjects.addHighlightCircleObject(\r\n\t\t\t\t\t\tparseInt(nextCommand[1]),\r\n\t\t\t\t\t\tthis.parseColor(nextCommand[2]),\r\n\t\t\t\t\t\t20\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\t\t\t\tif (nextCommand.length > 4) {\r\n\t\t\t\t\tthis.animatedObjects.setNodePosition(\r\n\t\t\t\t\t\tparseInt(nextCommand[1]),\r\n\t\t\t\t\t\tparseInt(nextCommand[3]),\r\n\t\t\t\t\t\tparseInt(nextCommand[4])\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\t\t\t\tundoBlock.push(new UndoCreate(parseInt(nextCommand[1])));\r\n\t\t\t} else if (nextCommand[0].toUpperCase() === 'CREATELABEL') {\r\n\t\t\t\tif (nextCommand.length === 6) {\r\n\t\t\t\t\tthis.animatedObjects.addLabelObject(\r\n\t\t\t\t\t\tparseInt(nextCommand[1]),\r\n\t\t\t\t\t\tnextCommand[2],\r\n\t\t\t\t\t\tthis.parseBool(nextCommand[5])\r\n\t\t\t\t\t);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.animatedObjects.addLabelObject(\r\n\t\t\t\t\t\tparseInt(nextCommand[1]),\r\n\t\t\t\t\t\tnextCommand[2],\r\n\t\t\t\t\t\ttrue\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\t\t\t\tif (nextCommand.length >= 5) {\r\n\t\t\t\t\tthis.animatedObjects.setNodePosition(\r\n\t\t\t\t\t\tparseInt(nextCommand[1]),\r\n\t\t\t\t\t\tparseFloat(nextCommand[3]),\r\n\t\t\t\t\t\tparseFloat(nextCommand[4])\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\t\t\t\tundoBlock.push(new UndoCreate(parseInt(nextCommand[1])));\r\n\t\t\t} else if (nextCommand[0].toUpperCase() === 'SETEDGECOLOR') {\r\n\t\t\t\tconst from = parseInt(nextCommand[1]);\r\n\t\t\t\tconst to = parseInt(nextCommand[2]);\r\n\t\t\t\tconst newColor = this.parseColor(nextCommand[3]);\r\n\t\t\t\tconst oldColor = this.animatedObjects.setEdgeColor(from, to, newColor);\r\n\t\t\t\tundoBlock.push(new UndoSetEdgeColor(from, to, oldColor));\r\n\t\t\t} else if (nextCommand[0].toUpperCase() === 'SETEDGEALPHA') {\r\n\t\t\t\tconst from = parseInt(nextCommand[1]);\r\n\t\t\t\tconst to = parseInt(nextCommand[2]);\r\n\t\t\t\tconst newAlpha = parseFloat(nextCommand[3]);\r\n\t\t\t\tconst oldAplpha = this.animatedObjects.setEdgeAlpha(from, to, newAlpha);\r\n\t\t\t\tundoBlock.push(new UndoSetEdgeAlpha(from, to, oldAplpha));\r\n\t\t\t} else if (nextCommand[0].toUpperCase() === 'SETEDGEHIGHLIGHT') {\r\n\t\t\t\tconst newHighlight = this.parseBool(nextCommand[3]);\r\n\t\t\t\tconst from = parseInt(nextCommand[1]);\r\n\t\t\t\tconst to = parseInt(nextCommand[2]);\r\n\t\t\t\tconst oldHighlight = this.animatedObjects.setEdgeHighlight(from, to, newHighlight);\r\n\t\t\t\tundoBlock.push(new UndoHighlightEdge(from, to, oldHighlight));\r\n\t\t\t} else if (nextCommand[0].toUpperCase() === 'SETHEIGHT') {\r\n\t\t\t\tconst id = parseInt(nextCommand[1]);\r\n\t\t\t\tconst oldHeight = this.animatedObjects.getHeight(id);\r\n\t\t\t\tthis.animatedObjects.setHeight(id, parseInt(nextCommand[2]));\r\n\t\t\t\tundoBlock.push(new UndoSetHeight(id, oldHeight));\r\n\t\t\t} else if (nextCommand[0].toUpperCase() === 'SETLAYER') {\r\n\t\t\t\tthis.animatedObjects.setLayer(parseInt(nextCommand[1]), parseInt(nextCommand[2]));\r\n\t\t\t\t//TODO: Add undo information here\r\n\t\t\t} else if (nextCommand[0].toUpperCase() === 'CREATELINKEDLIST') {\r\n\t\t\t\tif (nextCommand.length === 11) {\r\n\t\t\t\t\tthis.animatedObjects.addLinkedListObject(\r\n\t\t\t\t\t\tparseInt(nextCommand[1]),\r\n\t\t\t\t\t\tnextCommand[2],\r\n\t\t\t\t\t\tparseInt(nextCommand[3]),\r\n\t\t\t\t\t\tparseInt(nextCommand[4]),\r\n\t\t\t\t\t\tparseFloat(nextCommand[7]),\r\n\t\t\t\t\t\tthis.parseBool(nextCommand[8]),\r\n\t\t\t\t\t\tthis.parseBool(nextCommand[9]),\r\n\t\t\t\t\t\tparseInt(nextCommand[10]),\r\n\t\t\t\t\t\t'#FFFFFF',\r\n\t\t\t\t\t\t'#000000'\r\n\t\t\t\t\t);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.animatedObjects.addLinkedListObject(\r\n\t\t\t\t\t\tparseInt(nextCommand[1]),\r\n\t\t\t\t\t\tnextCommand[2],\r\n\t\t\t\t\t\tparseInt(nextCommand[3]),\r\n\t\t\t\t\t\tparseInt(nextCommand[4]),\r\n\t\t\t\t\t\t0.25,\r\n\t\t\t\t\t\ttrue,\r\n\t\t\t\t\t\tfalse,\r\n\t\t\t\t\t\t1,\r\n\t\t\t\t\t\t'#FFFFFF',\r\n\t\t\t\t\t\t'#000000'\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\t\t\t\tif (nextCommand.length > 6) {\r\n\t\t\t\t\tthis.animatedObjects.setNodePosition(\r\n\t\t\t\t\t\tparseInt(nextCommand[1]),\r\n\t\t\t\t\t\tparseInt(nextCommand[5]),\r\n\t\t\t\t\t\tparseInt(nextCommand[6])\r\n\t\t\t\t\t);\r\n\t\t\t\t\tundoBlock.push(new UndoCreate(parseInt(nextCommand[1])));\r\n\t\t\t\t}\r\n\t\t\t} else if (nextCommand[0].toUpperCase() === 'CREATEDOUBLYLINKEDLIST') {\r\n\t\t\t\tif (nextCommand.length === 9) {\r\n\t\t\t\t\tthis.animatedObjects.addDoublyLinkedListObject(\r\n\t\t\t\t\t\tparseInt(nextCommand[1]), // ID\r\n\t\t\t\t\t\tnextCommand[2], // Label\r\n\t\t\t\t\t\tparseInt(nextCommand[3]), // Width\r\n\t\t\t\t\t\tparseInt(nextCommand[4]), // Height\r\n\t\t\t\t\t\tparseFloat(nextCommand[7]), // Link Percent\r\n\t\t\t\t\t\tparseInt(nextCommand[8]), // Num Labels\r\n\t\t\t\t\t\t'#FFFFFF',\r\n\t\t\t\t\t\t'#000000'\r\n\t\t\t\t\t);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.animatedObjects.addDoublyLinkedListObject(\r\n\t\t\t\t\t\tparseInt(nextCommand[1]),\r\n\t\t\t\t\t\tnextCommand[2],\r\n\t\t\t\t\t\tparseInt(nextCommand[3]),\r\n\t\t\t\t\t\tparseInt(nextCommand[4]),\r\n\t\t\t\t\t\t0.25,\r\n\t\t\t\t\t\t1,\r\n\t\t\t\t\t\t'#FFFFFF',\r\n\t\t\t\t\t\t'#000000'\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\t\t\t\tif (nextCommand.length > 6) {\r\n\t\t\t\t\tthis.animatedObjects.setNodePosition(\r\n\t\t\t\t\t\tparseInt(nextCommand[1]),\r\n\t\t\t\t\t\tparseInt(nextCommand[5]),\r\n\t\t\t\t\t\tparseInt(nextCommand[6])\r\n\t\t\t\t\t);\r\n\t\t\t\t\tundoBlock.push(new UndoCreate(parseInt(nextCommand[1])));\r\n\t\t\t\t}\r\n\t\t\t} else if (nextCommand[0].toUpperCase() === 'CREATECIRCULARLYLINKEDLIST') {\r\n\t\t\t\tif (nextCommand.length === 9) {\r\n\t\t\t\t\tthis.animatedObjects.addCircularlyLinkedListObject(\r\n\t\t\t\t\t\tparseInt(nextCommand[1]), // ID\r\n\t\t\t\t\t\tnextCommand[2], // Label\r\n\t\t\t\t\t\tparseInt(nextCommand[3]), // Width\r\n\t\t\t\t\t\tparseInt(nextCommand[4]), // Height\r\n\t\t\t\t\t\tparseFloat(nextCommand[7]), // Link Percent\r\n\t\t\t\t\t\tparseInt(nextCommand[8]), // Num Labels\r\n\t\t\t\t\t\t'#FFFFFF',\r\n\t\t\t\t\t\t'#000000'\r\n\t\t\t\t\t);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.animatedObjects.addCircularlyLinkedListObject(\r\n\t\t\t\t\t\tparseInt(nextCommand[1]),\r\n\t\t\t\t\t\tnextCommand[2],\r\n\t\t\t\t\t\tparseInt(nextCommand[3]),\r\n\t\t\t\t\t\tparseInt(nextCommand[4]),\r\n\t\t\t\t\t\t0.25,\r\n\t\t\t\t\t\t1,\r\n\t\t\t\t\t\t'#FFFFFF',\r\n\t\t\t\t\t\t'#000000'\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\t\t\t\tif (nextCommand.length > 6) {\r\n\t\t\t\t\tthis.animatedObjects.setNodePosition(\r\n\t\t\t\t\t\tparseInt(nextCommand[1]),\r\n\t\t\t\t\t\tparseInt(nextCommand[5]),\r\n\t\t\t\t\t\tparseInt(nextCommand[6])\r\n\t\t\t\t\t);\r\n\t\t\t\t\tundoBlock.push(new UndoCreate(parseInt(nextCommand[1])));\r\n\t\t\t\t}\r\n\t\t\t} else if (nextCommand[0].toUpperCase() === 'CREATESKIPLIST') {\r\n\t\t\t\tif (nextCommand.length === 7) {\r\n\t\t\t\t\tthis.animatedObjects.addSkipListObject(\r\n\t\t\t\t\t\tparseInt(nextCommand[1]), // ID\r\n\t\t\t\t\t\tnextCommand[2], // Label\r\n\t\t\t\t\t\tparseInt(nextCommand[3]), // Width\r\n\t\t\t\t\t\tparseInt(nextCommand[4]), // Height\r\n\t\t\t\t\t\t'#000000', // Label color\r\n\t\t\t\t\t\t'#FFFFFF', // Fill color\r\n\t\t\t\t\t\t'#000000'\r\n\t\t\t\t\t); // Edge color\r\n\r\n\t\t\t\t\tthis.animatedObjects.setNodePosition(\r\n\t\t\t\t\t\tparseInt(nextCommand[1]), // ID\r\n\t\t\t\t\t\tparseInt(nextCommand[5]), // X\r\n\t\t\t\t\t\tparseInt(nextCommand[6])\r\n\t\t\t\t\t); // Y\r\n\t\t\t\t\tundoBlock.push(new UndoCreate(parseInt(nextCommand[1])));\r\n\t\t\t\t}\r\n\t\t\t} else if (nextCommand[0].toUpperCase() === 'SETNULL') {\r\n\t\t\t\tconst oldNull = this.animatedObjects.getNull(parseInt(nextCommand[1]));\r\n\t\t\t\tthis.animatedObjects.setNull(\r\n\t\t\t\t\tparseInt(nextCommand[1]),\r\n\t\t\t\t\tthis.parseBool(nextCommand[2])\r\n\t\t\t\t);\r\n\t\t\t\tundoBlock.push(new UndoSetNull(parseInt(nextCommand[1]), oldNull));\r\n\t\t\t} else if (nextCommand[0].toUpperCase() === 'SETPREVNULL') {\r\n\t\t\t\tconst oldNull = this.animatedObjects.getLeftNull(parseInt(nextCommand[1]));\r\n\t\t\t\tthis.animatedObjects.setPrevNull(\r\n\t\t\t\t\tparseInt(nextCommand[1]),\r\n\t\t\t\t\tthis.parseBool(nextCommand[2])\r\n\t\t\t\t);\r\n\t\t\t\tundoBlock.push(new UndoSetPrevNull(parseInt(nextCommand[1]), oldNull));\r\n\t\t\t} else if (nextCommand[0].toUpperCase() === 'SETNEXTNULL') {\r\n\t\t\t\tconst oldNull = this.animatedObjects.getRightNull(parseInt(nextCommand[1]));\r\n\t\t\t\tthis.animatedObjects.setNextNull(\r\n\t\t\t\t\tparseInt(nextCommand[1]),\r\n\t\t\t\t\tthis.parseBool(nextCommand[2])\r\n\t\t\t\t);\r\n\t\t\t\tundoBlock.push(new UndoSetNextNull(parseInt(nextCommand[1]), oldNull));\r\n\t\t\t} else if (nextCommand[0].toUpperCase() === 'SETTEXTCOLOR') {\r\n\t\t\t\tif (nextCommand.length > 3) {\r\n\t\t\t\t\tconst oldColor = this.animatedObjects.getTextColor(\r\n\t\t\t\t\t\tparseInt(nextCommand[1]),\r\n\t\t\t\t\t\tparseInt(nextCommand[3])\r\n\t\t\t\t\t);\r\n\t\t\t\t\tthis.animatedObjects.setTextColor(\r\n\t\t\t\t\t\tparseInt(nextCommand[1]),\r\n\t\t\t\t\t\tthis.parseColor(nextCommand[2]),\r\n\t\t\t\t\t\tparseInt(nextCommand[3])\r\n\t\t\t\t\t);\r\n\t\t\t\t\tundoBlock.push(\r\n\t\t\t\t\t\tnew UndoSetTextColor(\r\n\t\t\t\t\t\t\tparseInt(nextCommand[1]),\r\n\t\t\t\t\t\t\toldColor,\r\n\t\t\t\t\t\t\tparseInt(nextCommand[3])\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tconst oldColor = this.animatedObjects.getTextColor(parseInt(nextCommand[1]), 0);\r\n\t\t\t\t\tthis.animatedObjects.setTextColor(\r\n\t\t\t\t\t\tparseInt(nextCommand[1]),\r\n\t\t\t\t\t\tthis.parseColor(nextCommand[2]),\r\n\t\t\t\t\t\t0\r\n\t\t\t\t\t);\r\n\t\t\t\t\tundoBlock.push(new UndoSetTextColor(parseInt(nextCommand[1]), oldColor, 0));\r\n\t\t\t\t}\r\n\t\t\t} else if (nextCommand[0].toUpperCase() === 'CREATEBTREENODE') {\r\n\t\t\t\tthis.animatedObjects.addBTreeNode(\r\n\t\t\t\t\tparseInt(nextCommand[1]),\r\n\t\t\t\t\tparseFloat(nextCommand[2]),\r\n\t\t\t\t\tparseFloat(nextCommand[3]),\r\n\t\t\t\t\tparseInt(nextCommand[4]),\r\n\t\t\t\t\tthis.parseColor(nextCommand[7]),\r\n\t\t\t\t\tthis.parseColor(nextCommand[8])\r\n\t\t\t\t);\r\n\t\t\t\tthis.animatedObjects.setNodePosition(\r\n\t\t\t\t\tparseInt(nextCommand[1]),\r\n\t\t\t\t\tparseInt(nextCommand[5]),\r\n\t\t\t\t\tparseInt(nextCommand[6])\r\n\t\t\t\t);\r\n\t\t\t\tundoBlock.push(new UndoCreate(parseInt(nextCommand[1])));\r\n\t\t\t} else if (nextCommand[0].toUpperCase() === 'SETWIDTH') {\r\n\t\t\t\tconst id = parseInt(nextCommand[1]);\r\n\t\t\t\tthis.animatedObjects.setWidth(id, parseInt(nextCommand[2]));\r\n\t\t\t\tconst oldWidth = this.animatedObjects.getWidth(id);\r\n\t\t\t\tundoBlock.push(new UndoSetWidth(id, oldWidth));\r\n\t\t\t} else if (nextCommand[0].toUpperCase() === 'SETNUMELEMENTS') {\r\n\t\t\t\tconst oldElem = this.animatedObjects.getObject(parseInt(nextCommand[1]));\r\n\t\t\t\tundoBlock.push(new UndoSetNumElements(oldElem, parseInt(nextCommand[2])));\r\n\t\t\t\tthis.animatedObjects.setNumElements(\r\n\t\t\t\t\tparseInt(nextCommand[1]),\r\n\t\t\t\t\tparseInt(nextCommand[2])\r\n\t\t\t\t);\r\n\t\t\t} else if (nextCommand[0].toUpperCase() === 'SETPOSITION') {\r\n\t\t\t\tconst id = parseInt(nextCommand[1]);\r\n\t\t\t\tconst oldX = this.animatedObjects.getNodeX(id);\r\n\t\t\t\tconst oldY = this.animatedObjects.getNodeY(id);\r\n\t\t\t\tundoBlock.push(new UndoSetPosition(id, oldX, oldY));\r\n\t\t\t\tthis.animatedObjects.setNodePosition(\r\n\t\t\t\t\tid,\r\n\t\t\t\t\tparseInt(nextCommand[2]),\r\n\t\t\t\t\tparseInt(nextCommand[3])\r\n\t\t\t\t);\r\n\t\t\t} else if (nextCommand[0].toUpperCase() === 'ALIGNRIGHT') {\r\n\t\t\t\tconst id = parseInt(nextCommand[1]);\r\n\t\t\t\tconst oldX = this.animatedObjects.getNodeX(id);\r\n\t\t\t\t// const oldY = this.animatedObjects.getNodeY(id);\r\n\t\t\t\tundoBlock.push(new UndoSetPosition(id, oldX.oldY));\r\n\t\t\t\tthis.animatedObjects.alignRight(id, parseInt(nextCommand[2]));\r\n\t\t\t} else if (nextCommand[0].toUpperCase() === 'ALIGNLEFT') {\r\n\t\t\t\tconst id = parseInt(nextCommand[1]);\r\n\t\t\t\tconst oldX = this.animatedObjects.getNodeX(id);\r\n\t\t\t\t// const oldY = this.animatedObjects.getNodeY(id);\r\n\t\t\t\tundoBlock.push(new UndoSetPosition(id, oldX.oldY));\r\n\t\t\t\tthis.animatedObjects.alignLeft(id, parseInt(nextCommand[2]));\r\n\t\t\t} else if (nextCommand[0].toUpperCase() === 'ALIGNTOP') {\r\n\t\t\t\tconst id = parseInt(nextCommand[1]);\r\n\t\t\t\tconst oldX = this.animatedObjects.getNodeX(id);\r\n\t\t\t\t// const oldY = this.animatedObjects.getNodeY(id);\r\n\t\t\t\tundoBlock.push(new UndoSetPosition(id, oldX.oldY));\r\n\t\t\t\tthis.animatedObjects.alignTop(id, parseInt(nextCommand[2]));\r\n\t\t\t} else if (nextCommand[0].toUpperCase() === 'ALIGNBOTTOM') {\r\n\t\t\t\tconst id = parseInt(nextCommand[1]);\r\n\t\t\t\tconst oldX = this.animatedObjects.getNodeX(id);\r\n\t\t\t\t// const oldY = this.animatedObjects.getNodeY(id);\r\n\t\t\t\tundoBlock.push(new UndoSetPosition(id, oldX.oldY));\r\n\t\t\t\tthis.animatedObjects.alignBottom(id, parseInt(nextCommand[2]));\r\n\t\t\t} else if (nextCommand[0].toUpperCase() === 'SETHIGHLIGHTINDEX') {\r\n\t\t\t\tconst id = parseInt(nextCommand[1]);\r\n\t\t\t\tconst index = parseInt(nextCommand[2]);\r\n\t\t\t\tconst oldIndex = this.animatedObjects.getHighlightIndex(id);\r\n\t\t\t\tundoBlock.push(new UndoSetHighlightIndex(id, oldIndex));\r\n\t\t\t\tthis.animatedObjects.setHighlightIndex(id, index);\r\n\t\t\t} else {\r\n\t\t\t\t//\t\t\tthrow \"Unknown command: \" + nextCommand[0];\r\n\t\t\t}\r\n\r\n\t\t\tthis.currentAnimation = this.currentAnimation + 1;\r\n\t\t}\r\n\t\tthis.currFrame = 0;\r\n\r\n\t\t// Hack:  If there are not any animations, and we are currently paused,\r\n\t\t// then set the current frame to the end of the anumation, so that we will\r\n\t\t// advance immediagely upon the next step button.  If we are not paused, then\r\n\t\t// animate as normal.\r\n\r\n\t\tif (\r\n\t\t\t(!anyAnimations && this.animationPaused) ||\r\n\t\t\t(!anyAnimations && this.currentAnimation === this.AnimationSteps.length)\r\n\t\t) {\r\n\t\t\tthis.currFrame = this.animationBlockLength;\r\n\t\t}\r\n\r\n\t\tthis.undoStack.push(undoBlock);\r\n\t}\r\n\r\n\t//  Start a new animation.  The input parameter commands is an array of strings,\r\n\t//  which represents the animation to start\r\n\tStartNewAnimation(commands) {\r\n\t\t// clearTimeout(timer);\r\n\t\tthis.stopTimer();\r\n\t\tif (this.AnimationSteps !== null) {\r\n\t\t\tthis.previousAnimationSteps.push(this.AnimationSteps);\r\n\t\t\tthis.undoAnimationStepIndicesStack.push(this.undoAnimationStepIndices);\r\n\t\t}\r\n\t\tif (commands === undefined || commands.length === 0) {\r\n\t\t\tthis.AnimationSteps = ['Step'];\r\n\t\t} else {\r\n\t\t\tthis.AnimationSteps = commands;\r\n\t\t}\r\n\t\tthis.undoAnimationStepIndices = [];\r\n\t\tthis.currentAnimation = 0;\r\n\t\tthis.startNextBlock();\r\n\t\tthis.currentlyAnimating = true;\r\n\t\tthis.fireEvent('AnimationStarted', 'NoData');\r\n\t\t// timer = setTimeout(\"timeout()\", 30);\r\n\t\tthis.startTimer();\r\n\r\n\t\t// window.requestAnimationFrame(step);\r\n\t}\r\n\r\n\t// Step backwards one step.  A no-op if the animation is not currently paused\r\n\tstepBack() {\r\n\t\tif (this.awaitingStep && this.undoStack !== null && this.undoStack.length !== 0) {\r\n\t\t\t//  TODO:  Get events working correctly!\r\n\t\t\tthis.fireEvent('AnimationStarted', 'NoData');\r\n\t\t\t// clearTimeout(timer);\r\n\t\t\tthis.stopTimer();\r\n\r\n\t\t\tthis.awaitingStep = false;\r\n\t\t\tthis.undoLastBlock();\r\n\t\t\t// Re-kick thie timer.  The timer may or may not be running at this point,\r\n\t\t\t// so to be safe we'll kill it and start it again.\r\n\t\t\t// clearTimeout(timer);\r\n\t\t\tthis.stopTimer();\r\n\t\t\t// timer = setTimeout(\"timeout()\", 30);\r\n\t\t\tthis.startTimer();\r\n\t\t} else if (\r\n\t\t\t!this.currentlyAnimating &&\r\n\t\t\tthis.animationPaused &&\r\n\t\t\tthis.undoAnimationStepIndices !== null\r\n\t\t) {\r\n\t\t\tthis.fireEvent('AnimationStarted', 'NoData');\r\n\t\t\tthis.currentlyAnimating = true;\r\n\t\t\tthis.undoLastBlock();\r\n\t\t\t// Re-kick thie timer.  The timer may or may not be running at this point,\r\n\t\t\t// so to be safe we'll kill it and start it again.\r\n\t\t\t// clearTimeout(timer);\r\n\t\t\tthis.stopTimer();\r\n\t\t\t// timer = setTimeout(\"timeout()\", 30);\r\n\t\t\tthis.startTimer();\r\n\t\t}\r\n\t}\r\n\r\n\t// Step forwards one step.  A no-op if the animation is not currently paused\r\n\tstep() {\r\n\t\tif (this.awaitingStep) {\r\n\t\t\tthis.startNextBlock();\r\n\t\t\tthis.fireEvent('AnimationStarted', 'NoData');\r\n\t\t\tthis.currentlyAnimating = true;\r\n\t\t\t// Re-kick thie timer.  The timer should be going now, but we've had some difficulty with\r\n\t\t\t// it timing itself out, so we'll be safe and kick it now.\r\n\t\t\t// clearTimeout(timer);\r\n\t\t\tthis.stopTimer();\r\n\t\t\t// timer = setTimeout(\"timeout()\", 30);\r\n\t\t\tthis.startTimer();\r\n\t\t}\r\n\t}\r\n\r\n\t/// WARNING:  Could be dangerous to call while an animation is running ...\r\n\tclearHistory() {\r\n\t\tthis.undoStack = [];\r\n\t\tthis.undoAnimationStepIndices = null;\r\n\t\tthis.previousAnimationSteps = [];\r\n\t\tthis.undoAnimationStepIndicesStack = [];\r\n\t\tthis.AnimationSteps = null;\r\n\t\tthis.fireEvent('AnimationUndoUnavailable', 'NoData');\r\n\t\t// clearTimeout(timer);\r\n\t\tthis.stopTimer();\r\n\t\tthis.animatedObjects.update();\r\n\t\tthis.animatedObjects.draw();\r\n\t}\r\n\r\n\tskipBack() {\r\n\t\tlet keepUndoing =\r\n\t\t\tthis.undoAnimationStepIndices !== null && this.undoAnimationStepIndices.length !== 0;\r\n\t\tif (keepUndoing) {\r\n\t\t\tlet i;\r\n\t\t\tfor (i = 0; this.currentBlock !== null && i < this.currentBlock.length; i++) {\r\n\t\t\t\tconst objectID = this.currentBlock[i].objectID;\r\n\t\t\t\tthis.animatedObjects.setNodePosition(\r\n\t\t\t\t\tobjectID,\r\n\t\t\t\t\tthis.currentBlock[i].toX,\r\n\t\t\t\t\tthis.currentBlock[i].toY\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t\tif (this.doingUndo) {\r\n\t\t\t\tthis.finishUndoBlock(this.undoStack.pop());\r\n\t\t\t}\r\n\t\t\twhile (keepUndoing) {\r\n\t\t\t\tthis.undoLastBlock();\r\n\t\t\t\tfor (i = 0; i < this.currentBlock.length; i++) {\r\n\t\t\t\t\tconst objectID = this.currentBlock[i].objectID;\r\n\t\t\t\t\tthis.animatedObjects.setNodePosition(\r\n\t\t\t\t\t\tobjectID,\r\n\t\t\t\t\t\tthis.currentBlock[i].toX,\r\n\t\t\t\t\t\tthis.currentBlock[i].toY\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\t\t\t\tkeepUndoing = this.finishUndoBlock(this.undoStack.pop());\r\n\t\t\t}\r\n\t\t\t// clearTimeout(timer);\r\n\t\t\tthis.stopTimer();\r\n\t\t\tthis.animatedObjects.update();\r\n\t\t\tthis.animatedObjects.draw();\r\n\t\t\tif (this.undoStack == null || this.undoStack.length === 0) {\r\n\t\t\t\tthis.fireEvent('AnimationUndoUnavailable', 'NoData');\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tresetAll() {\r\n\t\tthis.clearHistory();\r\n\t\tthis.animatedObjects.clearAllObjects();\r\n\t\tthis.animatedObjects.draw();\r\n\t\t// clearTimeout(timer);\r\n\t\tthis.stopTimer();\r\n\t}\r\n\r\n\tskipForward() {\r\n\t\tif (this.currentlyAnimating) {\r\n\t\t\tthis.animatedObjects.runFast = true;\r\n\t\t\twhile (\r\n\t\t\t\tthis.AnimationSteps !== null &&\r\n\t\t\t\tthis.currentAnimation < this.AnimationSteps.length\r\n\t\t\t) {\r\n\t\t\t\tfor (let i = 0; this.currentBlock !== null && i < this.currentBlock.length; i++) {\r\n\t\t\t\t\tconst objectID = this.currentBlock[i].objectID;\r\n\t\t\t\t\tthis.animatedObjects.setNodePosition(\r\n\t\t\t\t\t\tobjectID,\r\n\t\t\t\t\t\tthis.currentBlock[i].toX,\r\n\t\t\t\t\t\tthis.currentBlock[i].toY\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\t\t\t\tif (this.doingUndo) {\r\n\t\t\t\t\tthis.finishUndoBlock(this.undoStack.pop());\r\n\t\t\t\t}\r\n\t\t\t\tthis.startNextBlock();\r\n\t\t\t\tfor (let i = 0; i < this.currentBlock.length; i++) {\r\n\t\t\t\t\tconst objectID = this.currentBlock[i].objectID;\r\n\t\t\t\t\tthis.animatedObjects.setNodePosition(\r\n\t\t\t\t\t\tobjectID,\r\n\t\t\t\t\t\tthis.currentBlock[i].toX,\r\n\t\t\t\t\t\tthis.currentBlock[i].toY\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.animatedObjects.update();\r\n\t\t\tthis.currentlyAnimating = false;\r\n\t\t\tthis.awaitingStep = false;\r\n\t\t\tthis.doingUndo = false;\r\n\r\n\t\t\tthis.animatedObjects.runFast = false;\r\n\t\t\tthis.fireEvent('AnimationEnded', 'NoData');\r\n\t\t\t// clearTimeout(timer);\r\n\t\t\tthis.stopTimer();\r\n\t\t\tthis.animatedObjects.update();\r\n\t\t\tthis.animatedObjects.draw();\r\n\t\t}\r\n\t}\r\n\r\n\tfinishUndoBlock(undoBlock) {\r\n\t\tfor (let i = undoBlock.length - 1; i >= 0; i--) {\r\n\t\t\tundoBlock[i].undoInitialStep(this.animatedObjects);\r\n\t\t}\r\n\t\tthis.doingUndo = false;\r\n\r\n\t\t// If we are at the final end of the animation ...\r\n\t\tif (this.undoAnimationStepIndices.length === 0) {\r\n\t\t\tthis.awaitingStep = false;\r\n\t\t\tthis.currentlyAnimating = false;\r\n\t\t\tthis.undoAnimationStepIndices = this.undoAnimationStepIndicesStack.pop();\r\n\t\t\tthis.AnimationSteps = this.previousAnimationSteps.pop();\r\n\t\t\tthis.fireEvent('AnimationEnded', 'NoData');\r\n\t\t\tthis.fireEvent('AnimationUndo', 'NoData');\r\n\t\t\tthis.currentBlock = [];\r\n\t\t\tif (this.undoStack == null || this.undoStack.length === 0) {\r\n\t\t\t\tthis.currentlyAnimating = false;\r\n\t\t\t\tthis.awaitingStep = false;\r\n\t\t\t\tthis.fireEvent('AnimationUndoUnavailable', 'NoData');\r\n\t\t\t}\r\n\r\n\t\t\t// clearTimeout(timer);\r\n\t\t\tthis.stopTimer();\r\n\t\t\tthis.animatedObjects.update();\r\n\t\t\tthis.animatedObjects.draw();\r\n\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\treturn true;\r\n\t}\r\n\r\n\tundoLastBlock() {\r\n\t\tif (this.undoAnimationStepIndices.length === 0) {\r\n\t\t\t// Nothing on the undo stack.  Return\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (this.undoAnimationStepIndices.length > 0) {\r\n\t\t\tthis.doingUndo = true;\r\n\t\t\tlet anyAnimations = false;\r\n\t\t\tthis.currentAnimation = this.undoAnimationStepIndices.pop();\r\n\t\t\tthis.currentBlock = [];\r\n\t\t\tconst undo = this.undoStack[this.undoStack.length - 1];\r\n\t\t\tlet i;\r\n\t\t\tfor (i = undo.length - 1; i >= 0; i--) {\r\n\t\t\t\tconst animateNext = undo[i].addUndoAnimation(this.currentBlock);\r\n\t\t\t\tanyAnimations = anyAnimations || animateNext;\r\n\t\t\t}\r\n\t\t\tthis.currFrame = 0;\r\n\r\n\t\t\t// Hack:  If there are not any animations, and we are currently paused,\r\n\t\t\t// then set the current frame to the end of the animation, so that we will\r\n\t\t\t// advance immediagely upon the next step button.  If we are not paused, then\r\n\t\t\t// animate as normal.\r\n\t\t\tif (!anyAnimations && this.animationPaused) {\r\n\t\t\t\tthis.currFrame = this.animationBlockLength;\r\n\t\t\t}\r\n\t\t\tthis.currentlyAnimating = true;\r\n\t\t}\r\n\t}\r\n\r\n\tsetLayer(shown, layers) {\r\n\t\tthis.animatedObjects.setLayer(shown, layers);\r\n\t\t// Drop in an extra draw call here, just in case we are not\r\n\t\t// in the middle of an update loop when this changes\r\n\t\tthis.animatedObjects.draw();\r\n\t}\r\n\r\n\tsetAllLayers(layers) {\r\n\t\tthis.animatedObjects.setAllLayers(layers);\r\n\t\t// Drop in an extra draw call here, just in case we are not\r\n\t\t// in the middle of an update loop when this changes\r\n\t\tthis.animatedObjects.draw();\r\n\t}\r\n\r\n\tupdate() {\r\n\t\tif (this.currentlyAnimating) {\r\n\t\t\tthis.currFrame = this.currFrame + 1;\r\n\t\t\tlet i;\r\n\t\t\tfor (i = 0; i < this.currentBlock.length; i++) {\r\n\t\t\t\tif (\r\n\t\t\t\t\tthis.currFrame === this.animationBlockLength ||\r\n\t\t\t\t\t(this.currFrame === 1 && this.animationBlockLength === 0)\r\n\t\t\t\t) {\r\n\t\t\t\t\tthis.animatedObjects.setNodePosition(\r\n\t\t\t\t\t\tthis.currentBlock[i].objectID,\r\n\t\t\t\t\t\tthis.currentBlock[i].toX,\r\n\t\t\t\t\t\tthis.currentBlock[i].toY\r\n\t\t\t\t\t);\r\n\t\t\t\t} else if (this.currFrame < this.animationBlockLength) {\r\n\t\t\t\t\tconst objectID = this.currentBlock[i].objectID;\r\n\t\t\t\t\tconst percent = 1 / (this.animationBlockLength - this.currFrame);\r\n\t\t\t\t\t// const oldX = this.animatedObjects.getNodeX(objectID);\r\n\t\t\t\t\t// const oldY = this.animatedObjects.getNodeY(objectID);\r\n\t\t\t\t\t// const targetX = this.currentBlock[i].toX;\r\n\t\t\t\t\t// const targety = this.currentBlock[i].toY;\r\n\t\t\t\t\tconst newX = this.lerp(\r\n\t\t\t\t\t\tthis.animatedObjects.getNodeX(objectID),\r\n\t\t\t\t\t\tthis.currentBlock[i].toX,\r\n\t\t\t\t\t\tpercent\r\n\t\t\t\t\t);\r\n\t\t\t\t\tconst newY = this.lerp(\r\n\t\t\t\t\t\tthis.animatedObjects.getNodeY(objectID),\r\n\t\t\t\t\t\tthis.currentBlock[i].toY,\r\n\t\t\t\t\t\tpercent\r\n\t\t\t\t\t);\r\n\t\t\t\t\tthis.animatedObjects.setNodePosition(objectID, newX, newY);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (this.currFrame >= this.animationBlockLength) {\r\n\t\t\t\tif (this.doingUndo) {\r\n\t\t\t\t\tif (this.finishUndoBlock(this.undoStack.pop())) {\r\n\t\t\t\t\t\tthis.awaitingStep = true;\r\n\t\t\t\t\t\tthis.fireEvent('AnimationWaiting', 'NoData');\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (\r\n\t\t\t\t\t\tthis.animationPaused &&\r\n\t\t\t\t\t\tthis.currentAnimation < this.AnimationSteps.length\r\n\t\t\t\t\t) {\r\n\t\t\t\t\t\tthis.awaitingStep = true;\r\n\t\t\t\t\t\tthis.fireEvent('AnimationWaiting', 'NoData');\r\n\t\t\t\t\t\tthis.currentBlock = [];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.startNextBlock();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.animatedObjects.update();\r\n\t\t}\r\n\t}\r\n\r\n\tanimWaiting() {\r\n\t\tthis.stepForwardButton.disabled = false;\r\n\t\tif (this.skipBackButton.disabled === false) {\r\n\t\t\tthis.stepBackButton.disabled = false;\r\n\t\t}\r\n\t\tthis.objectManager.statusReport.setText('Animation Paused');\r\n\t\tthis.objectManager.statusReport.setForegroundColor('#FF0000');\r\n\t}\r\n\r\n\tanimStarted() {\r\n\t\tthis.skipForwardButton.disabled = false;\r\n\t\tthis.skipBackButton.disabled = false;\r\n\t\tthis.stepForwardButton.disabled = true;\r\n\t\tthis.stepBackButton.disabled = true;\r\n\t\tthis.objectManager.statusReport.setText('Animation Running');\r\n\t\tthis.objectManager.statusReport.setForegroundColor('#009900');\r\n\t}\r\n\r\n\tanimEnded() {\r\n\t\tthis.skipForwardButton.disabled = true;\r\n\t\tthis.stepForwardButton.disabled = true;\r\n\t\tif (this.skipBackButton.disabled === false && this.paused) {\r\n\t\t\tthis.stepBackButton.disabled = false;\r\n\t\t}\r\n\t\tthis.objectManager.statusReport.setText('Animation Completed');\r\n\t\tthis.objectManager.statusReport.setForegroundColor('#000000');\r\n\t}\r\n\r\n\tanumUndoUnavailable() {\r\n\t\tthis.skipBackButton.disabled = true;\r\n\t\tthis.stepBackButton.disabled = true;\r\n\t}\r\n\r\n\ttimeout() {\r\n\t\t// We need to set the timeout *first*, otherwise if we\r\n\t\t// try to clear it later, we get behavior we don't want ...\r\n\t\tthis.timer = setTimeout(() => this.timeout(), 30);\r\n\t\tthis.update();\r\n\t\tthis.objectManager.draw();\r\n\t}\r\n\r\n\tdoPlayPause() {\r\n\t\tthis.paused = !this.paused;\r\n\t\tif (this.paused) {\r\n\t\t\tthis.playPauseBackButton.setAttribute('value', 'Play');\r\n\t\t\tif (this.skipBackButton.disabled === false) {\r\n\t\t\t\tthis.stepBackButton.disabled = false;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tthis.playPauseBackButton.setAttribute('value', 'Pause');\r\n\t\t}\r\n\t\tthis.setPaused(this.paused);\r\n\t}\r\n\r\n\tstartTimer() {\r\n\t\tthis.timer = setTimeout(() => this.timeout(), 30);\r\n\t}\r\n\r\n\tstopTimer() {\r\n\t\tclearInterval(this.timer);\r\n\t}\r\n}\r\n","import '../css/AlgoScreen.css';\r\nimport { AlgorithmList, isAlgorithm } from '../AlgorithmList';\r\nimport { hasModal, modals } from '../examples/ExampleModals';\r\nimport AnimationManager from '../anim/AnimationMain';\r\nimport { Link } from 'react-router-dom';\r\nimport PropTypes from 'prop-types';\r\nimport React from 'react';\r\n\r\nclass AlgoScreen extends React.Component {\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\tconst location = props.location;\r\n\t\tthis.canvasRef = React.createRef();\r\n\t\tthis.animBarRef = React.createRef();\r\n\t\tconst algoName = location.pathname.slice(1);\r\n\r\n\t\tthis.state = {\r\n\t\t\talgoName: algoName,\r\n\t\t\texamplesEnabled: false,\r\n\t\t};\r\n\t}\r\n\r\n\ttoggleExamples() {\r\n\t\tthis.setState({ examplesEnabled: !this.state.examplesEnabled });\r\n\t}\r\n\r\n\tcomponentDidMount() {\r\n\t\tif (isAlgorithm(this.state.algoName)) {\r\n\t\t\tthis.animManag = new AnimationManager(this.canvasRef, this.animBarRef);\r\n\r\n\t\t\tthis.currentAlg = new AlgorithmList[this.state.algoName][1](\r\n\t\t\t\tthis.animManag,\r\n\t\t\t\tthis.canvasRef.current.width,\r\n\t\t\t\tthis.canvasRef.current.height\r\n\t\t\t);\r\n\t\t}\r\n\t}\r\n\r\n\trender() {\r\n\t\tconst algoName = this.state.algoName;\r\n\t\tif (!isAlgorithm(algoName)) {\r\n\t\t\treturn <h1>404!</h1>;\r\n\t\t}\r\n\t\tconst header = AlgorithmList[algoName][2]\r\n\t\t\t? AlgorithmList[algoName][2]\r\n\t\t\t: AlgorithmList[algoName][0];\r\n\r\n\t\treturn (\r\n\t\t\t<div className=\"VisualizationMainPage\">\r\n\t\t\t\t<div id=\"container\">\r\n\t\t\t\t\t<div id=\"header\">\r\n\t\t\t\t\t\t<h1>{header}</h1>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<div id=\"mainContent\">\r\n\t\t\t\t\t\t<div id=\"algoControlSection\">\r\n\t\t\t\t\t\t\t<table id=\"AlgorithmSpecificControls\"></table>\r\n\t\t\t\t\t\t\t{hasModal(algoName) ? (\r\n\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\tclassName={this.state.examplesEnabled ? 'selected' : ''}\r\n\t\t\t\t\t\t\t\t\tid=\"examplesButton\"\r\n\t\t\t\t\t\t\t\t\tonClick={() => this.toggleExamples()}\r\n\t\t\t\t\t\t\t\t></button>\r\n\t\t\t\t\t\t\t) : null}\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t<canvas id=\"canvas\" width=\"1000\" height=\"503\" ref={this.canvasRef}></canvas>\r\n\r\n\t\t\t\t\t\t<div id=\"generalAnimationControlSection\">\r\n\t\t\t\t\t\t\t<table id=\"GeneralAnimationControls\" ref={this.animBarRef}></table>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<div\r\n\t\t\t\t\t\tid=\"examplesModal\"\r\n\t\t\t\t\t\tclassName={`modal${this.state.examplesEnabled ? ' show' : ''}`}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<div className=\"modal-content\">{modals[algoName]}</div>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<div id=\"footer\">\r\n\t\t\t\t\t\t<p>\r\n\t\t\t\t\t\t\t<Link to=\"/\">Return to Home Page</Link>\r\n\t\t\t\t\t\t</p>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nAlgoScreen.propTypes = {\r\n\tlocation: PropTypes.object,\r\n};\r\n\r\nexport default AlgoScreen;\r\n","import React from 'react';\r\n\r\nconst AboutContent = () => {\r\n\treturn (\r\n\t\t<p>\r\n\t\t\tThis is a tool to help you visualize and understand the data structures and algorithms\r\n\t\t\tcovered in the GT CS1332 course. It is based on the{' '}\r\n\t\t\t<a href=\"https://www.cs.usfca.edu/~galles/visualization/about.html\">\r\n\t\t\t\tData Structures Visualizations website\r\n\t\t\t</a>{' '}\r\n\t\t\tby David Gales. The CS1332 Visualization Tool was adapted and expanded by Rodrigo Pontes\r\n\t\t\tin 2019, under the supervision of Mary Hudachek-Buswell, to include data structures and\r\n\t\t\talgorithms covered in the course. Icons from{' '}\r\n\t\t\t<a href=\"https://material.io/resources/icons/?style=baseline\">\r\n\t\t\t\tGoogle&#39;s Material Icons\r\n\t\t\t</a>{' '}\r\n\t\t\tare also used.\r\n\t\t</p>\r\n\t);\r\n};\r\n\r\nexport default AboutContent;\r\n","import '../css/App.css';\r\nimport { Link, Route, Switch } from 'react-router-dom';\r\nimport AboutContent from './AboutContent';\r\nimport { AlgorithmList } from '../AlgorithmList';\r\nimport React from 'react';\r\n\r\nconst Home = () => {\r\n\tconst buttons = Object.entries(AlgorithmList).map(([name, disp], idx) => {\r\n\t\treturn (\r\n\t\t\t<Link to={`/${name}`} key={idx}>\r\n\t\t\t\t<input className=\"button\" type=\"button\" value={disp[0]} />\r\n\t\t\t</Link>\r\n\t\t);\r\n\t});\r\n\treturn (\r\n\t\t<div className=\"container\">\r\n\t\t\t<div className=\"header\">\r\n\t\t\t\t<h1>CS1332 Data Structures Visualizations</h1>\r\n\t\t\t</div>\r\n\t\t\t<div className=\"menu\">\r\n\t\t\t\t<ul>\r\n\t\t\t\t\t<li>\r\n\t\t\t\t\t\t<Link to=\"/\">Home</Link>\r\n\t\t\t\t\t</li>\r\n\t\t\t\t\t<li>\r\n\t\t\t\t\t\t<Link to=\"/about\">About</Link>\r\n\t\t\t\t\t</li>\r\n\t\t\t\t</ul>\r\n\t\t\t</div>\r\n\r\n\t\t\t<div className=\"content\">\r\n\t\t\t\t<Switch>\r\n\t\t\t\t\t<Route exact path=\"/\">\r\n\t\t\t\t\t\t{buttons}\r\n\t\t\t\t\t</Route>\r\n\t\t\t\t\t<Route path=\"/about\">\r\n\t\t\t\t\t\t<AboutContent />\r\n\t\t\t\t\t</Route>\r\n\t\t\t\t</Switch>\r\n\t\t\t</div>\r\n\r\n\t\t\t<div className=\"footer\">\r\n\t\t\t\tCopyright 2011 <a href=\"http://www.cs.usfca.edu/galles\">David Galles</a>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default Home;\r\n","/* global process */\n\nimport './css/App.css';\nimport { Route, BrowserRouter as Router, Switch } from 'react-router-dom';\nimport AlgoScreen from './screens/AlgoScreen';\nimport Home from './screens/Home';\nimport React from 'react';\n\nconst App = () => {\n\treturn (\n\t\t<Router basename={process.env.PUBLIC_URL + '/'}>\n\t\t\t<Switch>\n\t\t\t\t<Route exact path=\"/\" component={Home} />\n\t\t\t\t<Route path=\"/about\" component={Home} />\n\t\t\t\t<Route component={AlgoScreen} />\n\t\t\t</Switch>\n\t\t</Router>\n\t);\n};\n\nexport default App;\n","import * as serviceWorker from './serviceWorker';\nimport App from './App';\nimport React from 'react';\nimport ReactDOM from 'react-dom';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}